{"meta":{"version":1,"warehouse":"5.0.1"},"models":{"Asset":[{"_id":"source/avatar.png","path":"avatar.png","modified":1,"renderable":0},{"_id":"themes/Hacker/source/css/style.styl","path":"css/style.styl","modified":1,"renderable":1},{"_id":"themes/Hacker/source/images/icon-heart.svg","path":"images/icon-heart.svg","modified":1,"renderable":1},{"_id":"themes/Hacker/source/css/base/normalize.css","path":"css/base/normalize.css","modified":1,"renderable":1},{"_id":"themes/Hacker/source/css/components/archive.styl","path":"css/components/archive.styl","modified":1,"renderable":1},{"_id":"themes/Hacker/source/css/components/article.styl","path":"css/components/article.styl","modified":1,"renderable":1},{"_id":"themes/Hacker/source/css/components/categories.styl","path":"css/components/categories.styl","modified":1,"renderable":1},{"_id":"themes/Hacker/source/css/components/footer.styl","path":"css/components/footer.styl","modified":1,"renderable":1},{"_id":"themes/Hacker/source/css/components/header.styl","path":"css/components/header.styl","modified":1,"renderable":1},{"_id":"themes/Hacker/source/css/components/icon.styl","path":"css/components/icon.styl","modified":1,"renderable":1},{"_id":"themes/Hacker/source/css/components/layout.styl","path":"css/components/layout.styl","modified":1,"renderable":1},{"_id":"themes/Hacker/source/css/components/pagination.styl","path":"css/components/pagination.styl","modified":1,"renderable":1},{"_id":"themes/Hacker/source/css/components/responsive.styl","path":"css/components/responsive.styl","modified":1,"renderable":1},{"_id":"themes/Hacker/source/css/components/syntax.styl","path":"css/components/syntax.styl","modified":1,"renderable":1},{"_id":"themes/Hacker/source/css/components/tags.styl","path":"css/components/tags.styl","modified":1,"renderable":1}],"Cache":[{"_id":"source/.DS_Store","hash":"fc3292e731af9f737371bfcfc5b71cf6d6c59b54","modified":1743140671113},{"_id":"source/404.html","hash":"2bebc26e5749d74bfa7724460f30e454863293f9","modified":1743140671113},{"_id":"source/_posts/CentOS7安装gcc.md","hash":"1c6720a12a0e53444a5ad78374ad402e915175ec","modified":1743142209878},{"_id":"source/_posts/GitHub发现优质项目的小技巧，你掌握了几个？.md","hash":"47377d51ffb476e7ed98c1102aecfd4d0092b815","modified":1743142213269},{"_id":"source/_posts/Linux环境下的MySQL的安装和配置.md","hash":"240d271f659d660ff1df1fe006eb5b8090b048da","modified":1743142216060},{"_id":"source/_posts/MacOS修改文件时间.md","hash":"9c8f36adb3af780cbade42acd2579dd49c79cc53","modified":1743142219482},{"_id":"source/_posts/Redis7的单实例安装与基本配置.md","hash":"bd25bc7947050413415f6ff159903ea279496b39","modified":1743142222153},{"_id":"source/_posts/SSH连接不到EC2-Linux实例原因排查.md","hash":"82186582562ee104028059c3cec075ae71b8d79e","modified":1743142229179},{"_id":"source/_posts/SpringBoot2.5适配TongWeb7示例.md","hash":"87b1a17d88187805c8453f70800a145e2c25d9d6","modified":1743142225294},{"_id":"source/_posts/UOS升级OpenSSH.md","hash":"1d5a1f577cfbaf08cd655c58ec791a2d8025be33","modified":1743142232881},{"_id":"source/_posts/Windows环境下Oracle数据库的自动备份脚本.md","hash":"9b9dd8de6cd7e6c05755539b2242da93bc59881e","modified":1743142244239},{"_id":"source/_posts/Windows环境下的MySQL安装与配置.md","hash":"faf0b7e6ce6c15549c647d50fae8071e6632213a","modified":1743142240124},{"_id":"source/_posts/【MySQL-实战-45-讲：第六章节（全局锁和表锁）】学习小节.md","hash":"dd74d553c1b80ebdda3ed2b41bea40635b45bace","modified":1743140671114},{"_id":"source/_posts/【MySQL-实战-45-讲：第四、五章节（深入浅出索引）】学习小节.md","hash":"eb8586d14355655739af6958f4168f132d430618","modified":1743140671114},{"_id":"source/_posts/【MySQL实战45讲：第七章节（行锁功过：怎么减少行锁对性能的影响？）】学习小结.md","hash":"64c403ccbe89f54672802a4c0a7846f937c5dc23","modified":1743140671114},{"_id":"source/_posts/【高性能MySQL：第一章节（MySQL架构与历史）】学习小节.md","hash":"251819921f97a57f1ce603d620062c9198949dc2","modified":1743140671114},{"_id":"source/_posts/【高性能MySQL：第五章节（创建高性能的索引）】学习小节.md","hash":"24f12eecdcfa44f4e60e49d6c7a905d6ddbb23e7","modified":1743140671114},{"_id":"source/_posts/【高性能MySQL：第四章节（Schema与数据类型优化）】学习小节.md","hash":"7e79df59591a00b96e62a2bdb7fa933fde3b1980","modified":1743140671114},{"_id":"source/_posts/使用ChatGPT的提问技巧.md","hash":"948668dd8841f409c0d84fe03a01414acc6a9e00","modified":1743142199910},{"_id":"source/_posts/使用rsyslog归集系统日志.md","hash":"c328d22446a9b21b1d5897d37a47b32af495c18b","modified":1743142202971},{"_id":"source/_posts/关于SSH服务“Permission-denied-please-try-again-”问题的解决方案.md","hash":"b6b4b51c0b26112a045f2d6a75c9477291c98880","modified":1743142176062},{"_id":"source/_posts/如何利用备忘录让会议更高效？.md","hash":"e51e717ce538ce8ad95fdd60ea190e8969bdfa72","modified":1743142196063},{"_id":"source/_posts/如何获取Linux系统的年龄.md","hash":"cd9ab1b0cdb827a64b643653c709ba8055d9cdd9","modified":1743142192659},{"_id":"source/_posts/常用软件记录.md","hash":"03fe0dd1bd750bdd6436f70ebb2d16fd3ac22b59","modified":1743142356685},{"_id":"source/_posts/微信读书这些技巧让免费阅读成为可能.md","hash":"4a87d62b0b2c6b4812cadb31ab0a4f0b5be7c9e5","modified":1743142205659},{"_id":"source/_posts/断舍离：迈向简约生活的第一步.md","hash":"a8a024cda9e71e113761f7c4588b03b02cc88094","modified":1743142173609},{"_id":"source/_posts/电子邮件礼仪.md","hash":"d2d0d8ba763daf6b4bf35fd7b2f6e5cca96f08a3","modified":1743142168555},{"_id":"source/_posts/苹果手机问题排查指导.md","hash":"7767c7fe7533d611825225405b53b40d4ab50d02","modified":1743141588517},{"_id":"source/_posts/记一次HTTPS证书过期的处置过程.md","hash":"685a5f0b6fa99f6cf89940f31683cde8ca7162da","modified":1743142180051},{"_id":"source/_posts/达梦数据库信创安全加固说明.md","hash":"1b59df2dc3ff729a9606ee810d91aebbf42551aa","modified":1743142163282},{"_id":"source/_posts/达梦查询分页排序问题.md","hash":"818ec65ea419f618416e6314e675a60c0deef16c","modified":1743142373374},{"_id":"source/about/index.md","hash":"2cf70dad92871eb0088b7ee097e3c2377dc273ae","modified":1743140671116},{"_id":"source/categories/index.md","hash":"a3b28929db738436bdf54c98081db115ff604b3f","modified":1743140671117},{"_id":"source/tags/index.md","hash":"da05e748732d38639c4bd410b0dd07f91f98e5f7","modified":1743140671117},{"_id":"source/avatar.png","hash":"727c1fc7caf49bb397ab7ea041c810b5e5fe310d","modified":1743140671116},{"_id":"themes/Hacker/.gitignore","hash":"c57cf4e0d24c5db09716f924a45ad879650f7548","modified":1743141422464},{"_id":"themes/Hacker/CHANGELOG.md","hash":"5ee7ae48cc5308758894eb961caaef89ecc04048","modified":1743141422464},{"_id":"themes/Hacker/CHANGELOG_zh-CN.md","hash":"5055c0a138469e673b3136c60033c5ae30a32787","modified":1743141422464},{"_id":"themes/Hacker/LICENSE","hash":"3127907a7623734f830e8c69ccee03b693bf993e","modified":1743141422465},{"_id":"themes/Hacker/README.md","hash":"18d28d5466f58f275e0aec504748bbe50f4c62f5","modified":1743141422465},{"_id":"themes/Hacker/README_zh-CN.md","hash":"4fb25729cfb2e6a5727977dd9c2cdb566f839ac1","modified":1743141422465},{"_id":"themes/Hacker/_config.example.yml","hash":"eed5b26f970fcc5dd978104a6621e2664e50325a","modified":1743141422465},{"_id":"themes/Hacker/languages/default.yml","hash":"d4466fb0a6102e50777ee56957f78de696891a0e","modified":1743141422465},{"_id":"themes/Hacker/languages/zh-CN.yml","hash":"d822b531c8e0edd5e1ae85ac3de96017e4781b3f","modified":1743141422465},{"_id":"themes/Hacker/layout/archive.ejs","hash":"2238cbe29009aafb16969d2c70dceb3f71772123","modified":1743141422465},{"_id":"themes/Hacker/layout/categories.ejs","hash":"bfad4e7eade650c535f0194974e2646619657b8b","modified":1743141422465},{"_id":"themes/Hacker/layout/index.ejs","hash":"1d2c487a95d25e763b5f7e004194eb6ee6b18135","modified":1743141422466},{"_id":"themes/Hacker/layout/layout.ejs","hash":"1bd1ff49fb17548b934e0664ba6cefd60b086fa9","modified":1743141422466},{"_id":"themes/Hacker/layout/page.ejs","hash":"84e00bbcc643dff4bd02880b3bbea658f510835f","modified":1743141422466},{"_id":"themes/Hacker/layout/post.ejs","hash":"84e00bbcc643dff4bd02880b3bbea658f510835f","modified":1743141422466},{"_id":"themes/Hacker/layout/tags.ejs","hash":"ee89e6a9c14bdb5e5e8cf975a558c780fe8dabff","modified":1743141422466},{"_id":"themes/Hacker/layout/components/archive.ejs","hash":"1f79ebaf52b8229cf5c58bb8325cf0177859a05c","modified":1743141422465},{"_id":"themes/Hacker/layout/components/article.ejs","hash":"06dd5da86efddecedd26a998fa66c53c580867f0","modified":1743141422465},{"_id":"themes/Hacker/layout/components/baiduanalytics.ejs","hash":"75ea315908beaf390265e00167cf8a30b5d0d94a","modified":1743141422465},{"_id":"themes/Hacker/layout/components/categories.ejs","hash":"3665bf5d1c7181db22dc1c48d62ebf42757d8c27","modified":1743141422465},{"_id":"themes/Hacker/layout/components/footer.ejs","hash":"538795f4af3a98e824aefc4b68a1bcd210c091e9","modified":1743141422466},{"_id":"themes/Hacker/layout/components/comment.ejs","hash":"d1fffabbca58cbeb0ff33855fd1b7ea6079e82b3","modified":1743141422466},{"_id":"themes/Hacker/layout/components/googleanalytics.ejs","hash":"27e6906523eae89fed4a6e86ebb2ad614a25c647","modified":1743141422466},{"_id":"themes/Hacker/layout/components/head.ejs","hash":"10475fdfc513c9380f18d034e15b3b051c8e9269","modified":1743141422466},{"_id":"themes/Hacker/layout/components/header.ejs","hash":"444c9712b048ca0aa0eb68fe4845c122c180591e","modified":1743141422466},{"_id":"themes/Hacker/layout/components/pagination.ejs","hash":"4ab5e3b0239e467923a0f91c771bcc9ee7889cfe","modified":1743141422466},{"_id":"themes/Hacker/source/css/style.styl","hash":"208e5f6d010e4e2c5590dae5e4fca8de592d3ef1","modified":1743141422467},{"_id":"themes/Hacker/source/images/icon-heart.svg","hash":"ec483e96c88eea013fd8ac71a34a875107397f43","modified":1743141422467},{"_id":"themes/Hacker/source/css/base/normalize.css","hash":"e58275a588bb631a37a2988145eea231ed23176b","modified":1743141422466},{"_id":"themes/Hacker/source/css/components/archive.styl","hash":"3ebb7790a46587297966f200fb4fcdbba25269df","modified":1743141422466},{"_id":"themes/Hacker/source/css/components/article.styl","hash":"f613fc6ed4dec8171bf7a03bd8878eaa995082bb","modified":1743141422466},{"_id":"themes/Hacker/source/css/components/categories.styl","hash":"c67e20d60351295cb178b568af42d430f4bcc3e6","modified":1743141422467},{"_id":"themes/Hacker/source/css/components/footer.styl","hash":"80ef890252d31d3bbfe71740fdcfc54ae14cad8e","modified":1743141422467},{"_id":"themes/Hacker/source/css/components/header.styl","hash":"fa5e6d715d288a327406df78225284c70530cb98","modified":1743141422467},{"_id":"themes/Hacker/source/css/components/icon.styl","hash":"8da3ff5b6cd1609fdfe0c564d47391367abc8808","modified":1743141422467},{"_id":"themes/Hacker/source/css/components/layout.styl","hash":"9c6e6bc00f377666f6815bc5e23438893357f8f6","modified":1743141422467},{"_id":"themes/Hacker/source/css/components/pagination.styl","hash":"1cec6cb1835f99432cc5c6ba674782237fea4f95","modified":1743141422467},{"_id":"themes/Hacker/source/css/components/responsive.styl","hash":"053e7ec4c22845422440660b7e1d6b0dea5b4fbd","modified":1743141422467},{"_id":"themes/Hacker/source/css/components/syntax.styl","hash":"8c0d919322194dc295e5404bcd68949f962f88dc","modified":1743141422467},{"_id":"themes/Hacker/source/css/components/tags.styl","hash":"684cf4eb4b8671476365e955dceebf096cc0e6ed","modified":1743141422467}],"Category":[{"name":"开发者笔记","_id":"cm8se3td50004bb8l2krgd4gg"}],"Data":[],"Page":[{"_content":"<!DOCTYPE HTML>\n<html>\n<head>\n  <meta http-equiv=\"content-type\" content=\"text/html;charset=utf-8;\"/>\n  <meta http-equiv=\"X-UA-Compatible\" content=\"IE=edge,chrome=1\" />\n  <meta name=\"robots\" content=\"all\" />\n  <meta name=\"robots\" content=\"index,follow\"/>\n  <title>公益404 | 澄澈少年的网络日志</title>\n  <link rel=\"stylesheet\" type=\"text/css\" href=\"https://qzone.qq.com/gy/404/style/404style.css\">\n</head>\n<body>\n  <script type=\"text/plain\" src=\"http://www.qq.com/404/search_children.js\"\n          charset=\"utf-8\" homePageUrl=\"/\"\n          homePageName=\"回到我的主页\">\n  </script>\n  <script async src=\"https://qzone.qq.com/gy/404/data.js\" charset=\"utf-8\"></script>\n  <script async src=\"https://qzone.qq.com/gy/404/page.js\" charset=\"utf-8\"></script>\n</body>\n</html>","source":"404.html","raw":"<!DOCTYPE HTML>\n<html>\n<head>\n  <meta http-equiv=\"content-type\" content=\"text/html;charset=utf-8;\"/>\n  <meta http-equiv=\"X-UA-Compatible\" content=\"IE=edge,chrome=1\" />\n  <meta name=\"robots\" content=\"all\" />\n  <meta name=\"robots\" content=\"index,follow\"/>\n  <title>公益404 | 澄澈少年的网络日志</title>\n  <link rel=\"stylesheet\" type=\"text/css\" href=\"https://qzone.qq.com/gy/404/style/404style.css\">\n</head>\n<body>\n  <script type=\"text/plain\" src=\"http://www.qq.com/404/search_children.js\"\n          charset=\"utf-8\" homePageUrl=\"/\"\n          homePageName=\"回到我的主页\">\n  </script>\n  <script async src=\"https://qzone.qq.com/gy/404/data.js\" charset=\"utf-8\"></script>\n  <script async src=\"https://qzone.qq.com/gy/404/page.js\" charset=\"utf-8\"></script>\n</body>\n</html>","date":"2025-03-28T05:45:42.834Z","updated":"2025-03-28T05:44:31.113Z","path":"404.html","title":"","comments":1,"layout":"page","_id":"cm8se3tcx0000bb8l02k1bh5v","content":"<!DOCTYPE HTML>\n<html>\n<head>\n  <meta http-equiv=\"content-type\" content=\"text/html;charset=utf-8;\"/>\n  <meta http-equiv=\"X-UA-Compatible\" content=\"IE=edge,chrome=1\" />\n  <meta name=\"robots\" content=\"all\" />\n  <meta name=\"robots\" content=\"index,follow\"/>\n  <title>公益404 | 澄澈少年的网络日志</title>\n  <link rel=\"stylesheet\" type=\"text/css\" href=\"https://qzone.qq.com/gy/404/style/404style.css\">\n</head>\n<body>\n  <script type=\"text/plain\" src=\"http://www.qq.com/404/search_children.js\"\n          charset=\"utf-8\" homePageUrl=\"/\"\n          homePageName=\"回到我的主页\">\n  </script>\n  <script async src=\"https://qzone.qq.com/gy/404/data.js\" charset=\"utf-8\"></script>\n  <script async src=\"https://qzone.qq.com/gy/404/page.js\" charset=\"utf-8\"></script>\n</body>\n</html>","excerpt":"","more":"<!DOCTYPE HTML>\n<html>\n<head>\n  <meta http-equiv=\"content-type\" content=\"text/html;charset=utf-8;\"/>\n  <meta http-equiv=\"X-UA-Compatible\" content=\"IE=edge,chrome=1\" />\n  <meta name=\"robots\" content=\"all\" />\n  <meta name=\"robots\" content=\"index,follow\"/>\n  <title>公益404 | 澄澈少年的网络日志</title>\n  <link rel=\"stylesheet\" type=\"text/css\" href=\"https://qzone.qq.com/gy/404/style/404style.css\">\n</head>\n<body>\n  <script type=\"text/plain\" src=\"http://www.qq.com/404/search_children.js\"\n          charset=\"utf-8\" homePageUrl=\"/\"\n          homePageName=\"回到我的主页\">\n  </script>\n  <script async src=\"https://qzone.qq.com/gy/404/data.js\" charset=\"utf-8\"></script>\n  <script async src=\"https://qzone.qq.com/gy/404/page.js\" charset=\"utf-8\"></script>\n</body>\n</html>"},{"title":"关于我","abbrlink":"9ff79b23","layout":"about","_content":"\n很高兴您能看到到这里，说明你对我有点感兴趣，我是一个99年的后端工程师，主要使用Java语言来开发一些业务系统，用于通过信息化技术手段来提升企业运营效率。目前从事有关国产化的研发工作，以助力国家信息技术应用创新产业的发展。创立这个博客的初衷是我想通过博客来记录一些自己的想法，同时分享一些技术经验，希望对大家有用。\n\n联系我：\n- [GitHub](https://github.com/yangzhao917)\n- Email：yz0917@foxmail.com\n- ID：阿钊的写字板","source":"about/index.md","raw":"---\ntitle: 关于我\nabbrlink: 9ff79b23\nlayout: about\n---\n\n很高兴您能看到到这里，说明你对我有点感兴趣，我是一个99年的后端工程师，主要使用Java语言来开发一些业务系统，用于通过信息化技术手段来提升企业运营效率。目前从事有关国产化的研发工作，以助力国家信息技术应用创新产业的发展。创立这个博客的初衷是我想通过博客来记录一些自己的想法，同时分享一些技术经验，希望对大家有用。\n\n联系我：\n- [GitHub](https://github.com/yangzhao917)\n- Email：yz0917@foxmail.com\n- ID：阿钊的写字板","date":"2025-03-28T05:45:42.834Z","updated":"2025-03-28T05:44:31.116Z","path":"about/index.html","comments":1,"_id":"cm8se3td20002bb8l4d44dx0q","content":"<p>很高兴您能看到到这里，说明你对我有点感兴趣，我是一个99年的后端工程师，主要使用Java语言来开发一些业务系统，用于通过信息化技术手段来提升企业运营效率。目前从事有关国产化的研发工作，以助力国家信息技术应用创新产业的发展。创立这个博客的初衷是我想通过博客来记录一些自己的想法，同时分享一些技术经验，希望对大家有用。</p>\n<p>联系我：</p>\n<ul>\n<li><a href=\"https://github.com/yangzhao917\">GitHub</a></li>\n<li>Email：<a href=\"mailto:&#x79;&#x7a;&#48;&#57;&#x31;&#x37;&#64;&#x66;&#x6f;&#120;&#x6d;&#x61;&#105;&#x6c;&#46;&#x63;&#111;&#x6d;\">&#x79;&#x7a;&#48;&#57;&#x31;&#x37;&#64;&#x66;&#x6f;&#120;&#x6d;&#x61;&#105;&#x6c;&#46;&#x63;&#111;&#x6d;</a></li>\n<li>ID：阿钊的写字板</li>\n</ul>\n","excerpt":"","more":"<p>很高兴您能看到到这里，说明你对我有点感兴趣，我是一个99年的后端工程师，主要使用Java语言来开发一些业务系统，用于通过信息化技术手段来提升企业运营效率。目前从事有关国产化的研发工作，以助力国家信息技术应用创新产业的发展。创立这个博客的初衷是我想通过博客来记录一些自己的想法，同时分享一些技术经验，希望对大家有用。</p>\n<p>联系我：</p>\n<ul>\n<li><a href=\"https://github.com/yangzhao917\">GitHub</a></li>\n<li>Email：<a href=\"mailto:&#x79;&#x7a;&#48;&#57;&#x31;&#x37;&#64;&#x66;&#x6f;&#120;&#x6d;&#x61;&#105;&#x6c;&#46;&#x63;&#111;&#x6d;\">&#x79;&#x7a;&#48;&#57;&#x31;&#x37;&#64;&#x66;&#x6f;&#120;&#x6d;&#x61;&#105;&#x6c;&#46;&#x63;&#111;&#x6d;</a></li>\n<li>ID：阿钊的写字板</li>\n</ul>\n"},{"title":"categories","date":"2025-03-27T19:02:35.000Z","layout":"categories","_content":"","source":"categories/index.md","raw":"---\ntitle: categories\ndate: 2025-03-27 19:02:35\nlayout: \"categories\"\n---\n","updated":"2025-03-28T05:44:31.117Z","path":"categories/index.html","comments":1,"_id":"cm8se3td70006bb8lfww77kdg","content":"","excerpt":"","more":""},{"title":"tags","date":"2025-03-27T19:02:41.000Z","layout":"tags","_content":"","source":"tags/index.md","raw":"---\ntitle: tags\ndate: 2025-03-27 19:02:41\nlayout: \"tags\"\n---\n","updated":"2025-03-28T05:44:31.117Z","path":"tags/index.html","comments":1,"_id":"cm8se3tda0008bb8lab38evoj","content":"","excerpt":"","more":""}],"Post":[{"title":"CentOS7 安装 gcc/gcc-c++","abbrlink":"aba7d07","date":"2024-06-03T04:18:38.000Z","toc":true,"_content":"\n\n<meta name=\"referrer\" content=\"no-referrer\" />\n\n本文用于记录gcc、gcc+c++在CentOS 7下的在线安装、离线安装两种安装方式。\n\n<!--more-->\n\n## gcc是什么？\n\nGCC（GNU Compiler Collection）是一个支持多种编程语言（如C、C++、Fortran等）的开源编译器系统，它能够将源代码编译成可执行的机器代码。\n\n### 在线安装\n\n```bash\nyum install gcc -y\n```\n\n### 离线安装\n\n下载地址：https://mirrors.aliyun.com/centos/7/os/x86_64/Packages/\n\n下载列表：\n\n```bash\n# -P：指定到下载目录，如果目录不存在，则自动创建\nwget -P ./gcc https://mirrors.aliyun.com/centos/7/os/x86_64/Packages/cpp-4.8.5-44.el7.x86_64.rpm\nwget -P ./gcc https://mirrors.aliyun.com/centos/7/os/x86_64/Packages/gcc-4.8.5-44.el7.x86_64.rpm\nwget -P ./gcc https://mirrors.aliyun.com/centos/7/os/x86_64/Packages/glibc-devel-2.17-317.el7.x86_64.rpm\nwget -P ./gcc https://mirrors.aliyun.com/centos/7/os/x86_64/Packages/glibc-headers-2.17-317.el7.x86_64.rpm\nwget -P ./gcc https://mirrors.aliyun.com/centos/7/os/x86_64/Packages/kernel-headers-3.10.0-1160.el7.x86_64.rpm\nwget -P ./gcc https://mirrors.aliyun.com/centos/7/os/x86_64/Packages/libmpc-1.0.1-3.el7.x86_64.rpm\nwget -P ./gcc https://mirrors.aliyun.com/centos/7/os/x86_64/Packages/mpfr-3.1.1-4.el7.x86_64.rpm\n\n# --nodeps 不检查包的依赖关系；--force强制安装\nrpm  -ivh  ./gcc/*.rpm --nodeps --force\n```\n\n## gcc+c++是什么\n\nGCC-C++（也称为g++）是GCC（GNU Compiler Collection）中的一个编译器组件，用于编译C++语言的源代码。它是GCC的一个子集，专门处理C++代码。\n\n### 在线安装\n\n```bash\nyum install gcc-c++ -y\n```\n\n### 离线安装\n\n```bash\nwget -P gcc-c++ https://mirrors.aliyun.com/centos/7/os/x86_64/Packages/gcc-c++-4.8.5-44.el7.x86_64.rpm\nwget -P gcc-c++ https://mirrors.aliyun.com/centos/7/os/x86_64/Packages/compat-libstdc++-33-3.2.3-72.el7.x86_64.rpm\nwget -P gcc-c++ https://mirrors.aliyun.com/centos/7/os/x86_64/Packages/libstdc++-devel-4.8.5-44.el7.x86_64.rpm\n\n# --nodeps 不检查包的依赖关系；--force强制安装\nrpm  -ivh  ./gcc-c++/*.rpm --nodeps --force\n```\n\n","source":"_posts/CentOS7安装gcc.md","raw":"---\ntitle: CentOS7 安装 gcc/gcc-c++\ncategories: ['开发者笔记']\ntags: ['Linux']\nabbrlink: aba7d07\ndate: 2024-06-03 04:18:38\ntoc: true\n---\n\n\n<meta name=\"referrer\" content=\"no-referrer\" />\n\n本文用于记录gcc、gcc+c++在CentOS 7下的在线安装、离线安装两种安装方式。\n\n<!--more-->\n\n## gcc是什么？\n\nGCC（GNU Compiler Collection）是一个支持多种编程语言（如C、C++、Fortran等）的开源编译器系统，它能够将源代码编译成可执行的机器代码。\n\n### 在线安装\n\n```bash\nyum install gcc -y\n```\n\n### 离线安装\n\n下载地址：https://mirrors.aliyun.com/centos/7/os/x86_64/Packages/\n\n下载列表：\n\n```bash\n# -P：指定到下载目录，如果目录不存在，则自动创建\nwget -P ./gcc https://mirrors.aliyun.com/centos/7/os/x86_64/Packages/cpp-4.8.5-44.el7.x86_64.rpm\nwget -P ./gcc https://mirrors.aliyun.com/centos/7/os/x86_64/Packages/gcc-4.8.5-44.el7.x86_64.rpm\nwget -P ./gcc https://mirrors.aliyun.com/centos/7/os/x86_64/Packages/glibc-devel-2.17-317.el7.x86_64.rpm\nwget -P ./gcc https://mirrors.aliyun.com/centos/7/os/x86_64/Packages/glibc-headers-2.17-317.el7.x86_64.rpm\nwget -P ./gcc https://mirrors.aliyun.com/centos/7/os/x86_64/Packages/kernel-headers-3.10.0-1160.el7.x86_64.rpm\nwget -P ./gcc https://mirrors.aliyun.com/centos/7/os/x86_64/Packages/libmpc-1.0.1-3.el7.x86_64.rpm\nwget -P ./gcc https://mirrors.aliyun.com/centos/7/os/x86_64/Packages/mpfr-3.1.1-4.el7.x86_64.rpm\n\n# --nodeps 不检查包的依赖关系；--force强制安装\nrpm  -ivh  ./gcc/*.rpm --nodeps --force\n```\n\n## gcc+c++是什么\n\nGCC-C++（也称为g++）是GCC（GNU Compiler Collection）中的一个编译器组件，用于编译C++语言的源代码。它是GCC的一个子集，专门处理C++代码。\n\n### 在线安装\n\n```bash\nyum install gcc-c++ -y\n```\n\n### 离线安装\n\n```bash\nwget -P gcc-c++ https://mirrors.aliyun.com/centos/7/os/x86_64/Packages/gcc-c++-4.8.5-44.el7.x86_64.rpm\nwget -P gcc-c++ https://mirrors.aliyun.com/centos/7/os/x86_64/Packages/compat-libstdc++-33-3.2.3-72.el7.x86_64.rpm\nwget -P gcc-c++ https://mirrors.aliyun.com/centos/7/os/x86_64/Packages/libstdc++-devel-4.8.5-44.el7.x86_64.rpm\n\n# --nodeps 不检查包的依赖关系；--force强制安装\nrpm  -ivh  ./gcc-c++/*.rpm --nodeps --force\n```\n\n","slug":"CentOS7安装gcc","published":1,"updated":"2025-03-28T06:10:09.878Z","comments":1,"layout":"post","photos":[],"_id":"cm8se3td00001bb8l3h2984qz","content":"<meta name=\"referrer\" content=\"no-referrer\" />\n\n<p>本文用于记录gcc、gcc+c++在CentOS 7下的在线安装、离线安装两种安装方式。</p>\n<span id=\"more\"></span>\n\n<h2 id=\"gcc是什么？\"><a href=\"#gcc是什么？\" class=\"headerlink\" title=\"gcc是什么？\"></a>gcc是什么？</h2><p>GCC（GNU Compiler Collection）是一个支持多种编程语言（如C、C++、Fortran等）的开源编译器系统，它能够将源代码编译成可执行的机器代码。</p>\n<h3 id=\"在线安装\"><a href=\"#在线安装\" class=\"headerlink\" title=\"在线安装\"></a>在线安装</h3><figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">yum install gcc -y</span><br></pre></td></tr></table></figure>\n\n<h3 id=\"离线安装\"><a href=\"#离线安装\" class=\"headerlink\" title=\"离线安装\"></a>离线安装</h3><p>下载地址：<a href=\"https://mirrors.aliyun.com/centos/7/os/x86_64/Packages/\">https://mirrors.aliyun.com/centos/7/os/x86_64/Packages/</a></p>\n<p>下载列表：</p>\n<figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\"># -P：指定到下载目录，如果目录不存在，则自动创建</span></span><br><span class=\"line\">wget -P ./gcc https://mirrors.aliyun.com/centos/7/os/x86_64/Packages/cpp-4.8.5-44.el7.x86_64.rpm</span><br><span class=\"line\">wget -P ./gcc https://mirrors.aliyun.com/centos/7/os/x86_64/Packages/gcc-4.8.5-44.el7.x86_64.rpm</span><br><span class=\"line\">wget -P ./gcc https://mirrors.aliyun.com/centos/7/os/x86_64/Packages/glibc-devel-2.17-317.el7.x86_64.rpm</span><br><span class=\"line\">wget -P ./gcc https://mirrors.aliyun.com/centos/7/os/x86_64/Packages/glibc-headers-2.17-317.el7.x86_64.rpm</span><br><span class=\"line\">wget -P ./gcc https://mirrors.aliyun.com/centos/7/os/x86_64/Packages/kernel-headers-3.10.0-1160.el7.x86_64.rpm</span><br><span class=\"line\">wget -P ./gcc https://mirrors.aliyun.com/centos/7/os/x86_64/Packages/libmpc-1.0.1-3.el7.x86_64.rpm</span><br><span class=\"line\">wget -P ./gcc https://mirrors.aliyun.com/centos/7/os/x86_64/Packages/mpfr-3.1.1-4.el7.x86_64.rpm</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\"># --nodeps 不检查包的依赖关系；--force强制安装</span></span><br><span class=\"line\">rpm  -ivh  ./gcc/*.rpm --nodeps --force</span><br></pre></td></tr></table></figure>\n\n<h2 id=\"gcc-c-是什么\"><a href=\"#gcc-c-是什么\" class=\"headerlink\" title=\"gcc+c++是什么\"></a>gcc+c++是什么</h2><p>GCC-C++（也称为g++）是GCC（GNU Compiler Collection）中的一个编译器组件，用于编译C++语言的源代码。它是GCC的一个子集，专门处理C++代码。</p>\n<h3 id=\"在线安装-1\"><a href=\"#在线安装-1\" class=\"headerlink\" title=\"在线安装\"></a>在线安装</h3><figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">yum install gcc-c++ -y</span><br></pre></td></tr></table></figure>\n\n<h3 id=\"离线安装-1\"><a href=\"#离线安装-1\" class=\"headerlink\" title=\"离线安装\"></a>离线安装</h3><figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">wget -P gcc-c++ https://mirrors.aliyun.com/centos/7/os/x86_64/Packages/gcc-c++-4.8.5-44.el7.x86_64.rpm</span><br><span class=\"line\">wget -P gcc-c++ https://mirrors.aliyun.com/centos/7/os/x86_64/Packages/compat-libstdc++-33-3.2.3-72.el7.x86_64.rpm</span><br><span class=\"line\">wget -P gcc-c++ https://mirrors.aliyun.com/centos/7/os/x86_64/Packages/libstdc++-devel-4.8.5-44.el7.x86_64.rpm</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\"># --nodeps 不检查包的依赖关系；--force强制安装</span></span><br><span class=\"line\">rpm  -ivh  ./gcc-c++/*.rpm --nodeps --force</span><br></pre></td></tr></table></figure>\n\n","excerpt":"<meta name=\"referrer\" content=\"no-referrer\" />\n\n<p>本文用于记录gcc、gcc+c++在CentOS 7下的在线安装、离线安装两种安装方式。</p>","more":"<h2 id=\"gcc是什么？\"><a href=\"#gcc是什么？\" class=\"headerlink\" title=\"gcc是什么？\"></a>gcc是什么？</h2><p>GCC（GNU Compiler Collection）是一个支持多种编程语言（如C、C++、Fortran等）的开源编译器系统，它能够将源代码编译成可执行的机器代码。</p>\n<h3 id=\"在线安装\"><a href=\"#在线安装\" class=\"headerlink\" title=\"在线安装\"></a>在线安装</h3><figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">yum install gcc -y</span><br></pre></td></tr></table></figure>\n\n<h3 id=\"离线安装\"><a href=\"#离线安装\" class=\"headerlink\" title=\"离线安装\"></a>离线安装</h3><p>下载地址：<a href=\"https://mirrors.aliyun.com/centos/7/os/x86_64/Packages/\">https://mirrors.aliyun.com/centos/7/os/x86_64/Packages/</a></p>\n<p>下载列表：</p>\n<figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\"># -P：指定到下载目录，如果目录不存在，则自动创建</span></span><br><span class=\"line\">wget -P ./gcc https://mirrors.aliyun.com/centos/7/os/x86_64/Packages/cpp-4.8.5-44.el7.x86_64.rpm</span><br><span class=\"line\">wget -P ./gcc https://mirrors.aliyun.com/centos/7/os/x86_64/Packages/gcc-4.8.5-44.el7.x86_64.rpm</span><br><span class=\"line\">wget -P ./gcc https://mirrors.aliyun.com/centos/7/os/x86_64/Packages/glibc-devel-2.17-317.el7.x86_64.rpm</span><br><span class=\"line\">wget -P ./gcc https://mirrors.aliyun.com/centos/7/os/x86_64/Packages/glibc-headers-2.17-317.el7.x86_64.rpm</span><br><span class=\"line\">wget -P ./gcc https://mirrors.aliyun.com/centos/7/os/x86_64/Packages/kernel-headers-3.10.0-1160.el7.x86_64.rpm</span><br><span class=\"line\">wget -P ./gcc https://mirrors.aliyun.com/centos/7/os/x86_64/Packages/libmpc-1.0.1-3.el7.x86_64.rpm</span><br><span class=\"line\">wget -P ./gcc https://mirrors.aliyun.com/centos/7/os/x86_64/Packages/mpfr-3.1.1-4.el7.x86_64.rpm</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\"># --nodeps 不检查包的依赖关系；--force强制安装</span></span><br><span class=\"line\">rpm  -ivh  ./gcc/*.rpm --nodeps --force</span><br></pre></td></tr></table></figure>\n\n<h2 id=\"gcc-c-是什么\"><a href=\"#gcc-c-是什么\" class=\"headerlink\" title=\"gcc+c++是什么\"></a>gcc+c++是什么</h2><p>GCC-C++（也称为g++）是GCC（GNU Compiler Collection）中的一个编译器组件，用于编译C++语言的源代码。它是GCC的一个子集，专门处理C++代码。</p>\n<h3 id=\"在线安装-1\"><a href=\"#在线安装-1\" class=\"headerlink\" title=\"在线安装\"></a>在线安装</h3><figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">yum install gcc-c++ -y</span><br></pre></td></tr></table></figure>\n\n<h3 id=\"离线安装-1\"><a href=\"#离线安装-1\" class=\"headerlink\" title=\"离线安装\"></a>离线安装</h3><figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">wget -P gcc-c++ https://mirrors.aliyun.com/centos/7/os/x86_64/Packages/gcc-c++-4.8.5-44.el7.x86_64.rpm</span><br><span class=\"line\">wget -P gcc-c++ https://mirrors.aliyun.com/centos/7/os/x86_64/Packages/compat-libstdc++-33-3.2.3-72.el7.x86_64.rpm</span><br><span class=\"line\">wget -P gcc-c++ https://mirrors.aliyun.com/centos/7/os/x86_64/Packages/libstdc++-devel-4.8.5-44.el7.x86_64.rpm</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\"># --nodeps 不检查包的依赖关系；--force强制安装</span></span><br><span class=\"line\">rpm  -ivh  ./gcc-c++/*.rpm --nodeps --force</span><br></pre></td></tr></table></figure>"},{"title":"GitHub发现优质项目的小技巧，你掌握了几个？","abbrlink":"d6bf6e8c","date":"2023-12-07T22:44:52.000Z","toc":true,"_content":"<meta name=\"referrer\" content=\"no-referrer\" />\n\nGitHub是一个全球性的代码托管平台，上面托管了非常多的优秀项目和学习资料。但是对于庞大的资源内容掌握一些搜索方法和技巧来提高搜索效率是十分有必要的。下面是我经过验证的一些不错的技巧和相关资料，希望能对你有所帮助。\n\n<!--more-->\n\n## 搜索小技巧\n\n![Untitled](http://qiniu-image.gotojava.cn/blog/2023-12-15-191043.png)\n\nWatch：表示有多少人关注这个项目；\n\nStar：表示有多少人给这个项目点赞，如果你给这个项目点赞，这个项目会出现在你的点赞列表中。点赞数越多，代表这个项目在社区的热度就越高；\n\nFork：表示有多少人拷贝或者克隆了这个项目。如果我们Fork了这个项目，就可以在Fork的基础上再进行优化，优化后的项目在得到原作者认可的情况下，可以再次提交给作者。\n\n### 根据项目名称搜索\n\n> 语法：in:name\n\n![Untitled](http://qiniu-image.gotojava.cn/blog/2023-12-15-191044.png)\n\n```\npdf2excel in:name\n```\n\n### 根据项目描述搜索\n\n> 语法：in:description\n\n![Untitled](http://qiniu-image.gotojava.cn/blog/2023-12-15-191044.jpg)\n\n```\nJava教程 in:description\n```\n\n### 根据项目帮助文档搜索\n\n> 语法：in:readme\n\n![Untitled](http://qiniu-image.gotojava.cn/blog/2023-12-15-191046.png)\n\n```\nJava教程 in:in:readme\n```\n\n### 根据项目描述、项目文档组合搜索\n\n> 语法：in:readme,description\n\n![Untitled](http://qiniu-image.gotojava.cn/blog/2023-12-15-191047.jpg)\n\n```\nJava教程 in:description,readme\n```\n\n### 根据starts点赞量搜索，点赞量越高代表项目比较收欢迎\n\n> 语法：stars:≥100\n\n![Untitled](http://qiniu-image.gotojava.cn/blog/2023-12-15-191049.jpg)\n\n```\n# 搜索项目名称，项目说明，项目文档中包含pdf2md，stars数量大于等于100的项目\npdf2md in:name,description,readme stars:>=100\n```\n\n### 根据forks克隆数量搜索，克隆数量越高代表项目比较收欢迎\n\n> 语法：forks:数量\n\n![Untitled](http://qiniu-image.gotojava.cn/blog/2023-12-15-191050.jpg)\n\n```\n# 搜索项目名称，项目说明，项目文档中包含pdf2doc，forks数量大于等于100的项目\npdf2doc in:name,description,readme forks:>=100\n\n# 搜索项目名称，项目说明，项目文档中包含pdf2doc，forks数量100到500区间的项目\npdf2doc in:name,description,readme forks:100..500\n```\n\n## 浏览小技巧\n\n- 在线查看项目\n\n在仓库详情按下【.】键，神奇的事情发生了，当前仓库的内容会被当做资源在一个在线的VSCode中打开，方便我们浏览项目的内容，包括在VSCode中代码搜索、快捷跳转、安装插件增强编辑器功能等。\n\n<aside>\n💡 实际上github.com的域名会跳转变成”github.dev“。然后当前的仓库就加载到了在线的VSCode中。\n</aside>\n\n- 在线运行项目\n\n在项目地址前面加入”gitpod.io/”前缀。我们要看的项目就会在gitpod.io项目中运行，使用操作和VSCode是一样的，既然能运行，那么当然也就可以在线阅读项目喽。而且gitpod.io会自动帮我们识别项目类型并处理安装项目的依赖，简直太香了~\n\n![Untitled](http://qiniu-image.gotojava.cn/blog/2023-12-15-191052.jpg)\n\n## 如何寻找优质项目\n\n### GitHub Trending\n\n[https://github.com/trending](https://github.com/trending)\n\n<aside>\n💡 GitHub Trending是<b>一个展示GitHub上当前最受欢迎项目的功能</b>。 每天，GitHub会计算许多项目的活跃度，从而得出一个受欢迎程度排行榜，包括今天、本周和本月的热门项目。\n</aside>\n\n- https://github.com/521xueweihan/HelloGitHub\n\n<aside>\n💡 分享 GitHub 上有趣、入门级的开源项目。\n</aside>\n\n### awesome\n\n![Untitled](http://qiniu-image.gotojava.cn/blog/2023-12-15-191056.jpg)\n\n<aside>\n💡 GitHub Awesome 是<b>一个Github 上的一个项目集合，也是一个社区驱动的项目，旨在收集GitHub 上的各种优秀的、值得推荐的项目</b>。 Awesome 通常指令人敬畏的、令人赞叹的事物，所以这个项目的名称取为Awesome XXX，表明它收录的是优秀的、值得推荐的项目。\n</aside>\n\n### 找例子\n\n> 语法：关键词 sample\n\n![Untitled](http://qiniu-image.gotojava.cn/blog/2023-12-15-191058.jpg)\n\n### 找模板\n\n> 语法：xxx starter/boilerplat\n\n![Untitled](http://qiniu-image.gotojava.cn/blog/2023-12-15-191101.jpg)\n\n### 找教程\n\n> 语法：xxx tutorial\n\n![Untitled](http://qiniu-image.gotojava.cn/blog/2023-12-15-191104.jpg)\n\n## 指导初学者\n\n### 指导初学者做出首次贡献的方式\n\n<aside>\n💡 该项目旨在简化和指导初学者做出首次贡献的方式。如果您想做出第一次贡献，请按照以下步骤操作。\n</aside>\n\n[https://github.com/firstcontributions/first-contributions](https://github.com/firstcontributions/first-contributions)\n\n### 最浅显易懂的Git教程\n\n[Git教程-廖雪峰老师的经典教程](https://www.liaoxuefeng.com/wiki/896043488029600)\n","source":"_posts/GitHub发现优质项目的小技巧，你掌握了几个？.md","raw":"---\ntitle: GitHub发现优质项目的小技巧，你掌握了几个？\nabbrlink: d6bf6e8c\ndate: 2023-12-07 22:44:52\ntoc: true\n---\n<meta name=\"referrer\" content=\"no-referrer\" />\n\nGitHub是一个全球性的代码托管平台，上面托管了非常多的优秀项目和学习资料。但是对于庞大的资源内容掌握一些搜索方法和技巧来提高搜索效率是十分有必要的。下面是我经过验证的一些不错的技巧和相关资料，希望能对你有所帮助。\n\n<!--more-->\n\n## 搜索小技巧\n\n![Untitled](http://qiniu-image.gotojava.cn/blog/2023-12-15-191043.png)\n\nWatch：表示有多少人关注这个项目；\n\nStar：表示有多少人给这个项目点赞，如果你给这个项目点赞，这个项目会出现在你的点赞列表中。点赞数越多，代表这个项目在社区的热度就越高；\n\nFork：表示有多少人拷贝或者克隆了这个项目。如果我们Fork了这个项目，就可以在Fork的基础上再进行优化，优化后的项目在得到原作者认可的情况下，可以再次提交给作者。\n\n### 根据项目名称搜索\n\n> 语法：in:name\n\n![Untitled](http://qiniu-image.gotojava.cn/blog/2023-12-15-191044.png)\n\n```\npdf2excel in:name\n```\n\n### 根据项目描述搜索\n\n> 语法：in:description\n\n![Untitled](http://qiniu-image.gotojava.cn/blog/2023-12-15-191044.jpg)\n\n```\nJava教程 in:description\n```\n\n### 根据项目帮助文档搜索\n\n> 语法：in:readme\n\n![Untitled](http://qiniu-image.gotojava.cn/blog/2023-12-15-191046.png)\n\n```\nJava教程 in:in:readme\n```\n\n### 根据项目描述、项目文档组合搜索\n\n> 语法：in:readme,description\n\n![Untitled](http://qiniu-image.gotojava.cn/blog/2023-12-15-191047.jpg)\n\n```\nJava教程 in:description,readme\n```\n\n### 根据starts点赞量搜索，点赞量越高代表项目比较收欢迎\n\n> 语法：stars:≥100\n\n![Untitled](http://qiniu-image.gotojava.cn/blog/2023-12-15-191049.jpg)\n\n```\n# 搜索项目名称，项目说明，项目文档中包含pdf2md，stars数量大于等于100的项目\npdf2md in:name,description,readme stars:>=100\n```\n\n### 根据forks克隆数量搜索，克隆数量越高代表项目比较收欢迎\n\n> 语法：forks:数量\n\n![Untitled](http://qiniu-image.gotojava.cn/blog/2023-12-15-191050.jpg)\n\n```\n# 搜索项目名称，项目说明，项目文档中包含pdf2doc，forks数量大于等于100的项目\npdf2doc in:name,description,readme forks:>=100\n\n# 搜索项目名称，项目说明，项目文档中包含pdf2doc，forks数量100到500区间的项目\npdf2doc in:name,description,readme forks:100..500\n```\n\n## 浏览小技巧\n\n- 在线查看项目\n\n在仓库详情按下【.】键，神奇的事情发生了，当前仓库的内容会被当做资源在一个在线的VSCode中打开，方便我们浏览项目的内容，包括在VSCode中代码搜索、快捷跳转、安装插件增强编辑器功能等。\n\n<aside>\n💡 实际上github.com的域名会跳转变成”github.dev“。然后当前的仓库就加载到了在线的VSCode中。\n</aside>\n\n- 在线运行项目\n\n在项目地址前面加入”gitpod.io/”前缀。我们要看的项目就会在gitpod.io项目中运行，使用操作和VSCode是一样的，既然能运行，那么当然也就可以在线阅读项目喽。而且gitpod.io会自动帮我们识别项目类型并处理安装项目的依赖，简直太香了~\n\n![Untitled](http://qiniu-image.gotojava.cn/blog/2023-12-15-191052.jpg)\n\n## 如何寻找优质项目\n\n### GitHub Trending\n\n[https://github.com/trending](https://github.com/trending)\n\n<aside>\n💡 GitHub Trending是<b>一个展示GitHub上当前最受欢迎项目的功能</b>。 每天，GitHub会计算许多项目的活跃度，从而得出一个受欢迎程度排行榜，包括今天、本周和本月的热门项目。\n</aside>\n\n- https://github.com/521xueweihan/HelloGitHub\n\n<aside>\n💡 分享 GitHub 上有趣、入门级的开源项目。\n</aside>\n\n### awesome\n\n![Untitled](http://qiniu-image.gotojava.cn/blog/2023-12-15-191056.jpg)\n\n<aside>\n💡 GitHub Awesome 是<b>一个Github 上的一个项目集合，也是一个社区驱动的项目，旨在收集GitHub 上的各种优秀的、值得推荐的项目</b>。 Awesome 通常指令人敬畏的、令人赞叹的事物，所以这个项目的名称取为Awesome XXX，表明它收录的是优秀的、值得推荐的项目。\n</aside>\n\n### 找例子\n\n> 语法：关键词 sample\n\n![Untitled](http://qiniu-image.gotojava.cn/blog/2023-12-15-191058.jpg)\n\n### 找模板\n\n> 语法：xxx starter/boilerplat\n\n![Untitled](http://qiniu-image.gotojava.cn/blog/2023-12-15-191101.jpg)\n\n### 找教程\n\n> 语法：xxx tutorial\n\n![Untitled](http://qiniu-image.gotojava.cn/blog/2023-12-15-191104.jpg)\n\n## 指导初学者\n\n### 指导初学者做出首次贡献的方式\n\n<aside>\n💡 该项目旨在简化和指导初学者做出首次贡献的方式。如果您想做出第一次贡献，请按照以下步骤操作。\n</aside>\n\n[https://github.com/firstcontributions/first-contributions](https://github.com/firstcontributions/first-contributions)\n\n### 最浅显易懂的Git教程\n\n[Git教程-廖雪峰老师的经典教程](https://www.liaoxuefeng.com/wiki/896043488029600)\n","slug":"GitHub发现优质项目的小技巧，你掌握了几个？","published":1,"updated":"2025-03-28T06:10:13.269Z","comments":1,"layout":"post","photos":[],"_id":"cm8se3td30003bb8larry3xyy","content":"<meta name=\"referrer\" content=\"no-referrer\" />\n\n<p>GitHub是一个全球性的代码托管平台，上面托管了非常多的优秀项目和学习资料。但是对于庞大的资源内容掌握一些搜索方法和技巧来提高搜索效率是十分有必要的。下面是我经过验证的一些不错的技巧和相关资料，希望能对你有所帮助。</p>\n<span id=\"more\"></span>\n\n<h2 id=\"搜索小技巧\"><a href=\"#搜索小技巧\" class=\"headerlink\" title=\"搜索小技巧\"></a>搜索小技巧</h2><p><img src=\"http://qiniu-image.gotojava.cn/blog/2023-12-15-191043.png\" alt=\"Untitled\"></p>\n<p>Watch：表示有多少人关注这个项目；</p>\n<p>Star：表示有多少人给这个项目点赞，如果你给这个项目点赞，这个项目会出现在你的点赞列表中。点赞数越多，代表这个项目在社区的热度就越高；</p>\n<p>Fork：表示有多少人拷贝或者克隆了这个项目。如果我们Fork了这个项目，就可以在Fork的基础上再进行优化，优化后的项目在得到原作者认可的情况下，可以再次提交给作者。</p>\n<h3 id=\"根据项目名称搜索\"><a href=\"#根据项目名称搜索\" class=\"headerlink\" title=\"根据项目名称搜索\"></a>根据项目名称搜索</h3><blockquote>\n<p>语法：in:name</p>\n</blockquote>\n<p><img src=\"http://qiniu-image.gotojava.cn/blog/2023-12-15-191044.png\" alt=\"Untitled\"></p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">pdf2excel in:name</span><br></pre></td></tr></table></figure>\n\n<h3 id=\"根据项目描述搜索\"><a href=\"#根据项目描述搜索\" class=\"headerlink\" title=\"根据项目描述搜索\"></a>根据项目描述搜索</h3><blockquote>\n<p>语法：in:description</p>\n</blockquote>\n<p><img src=\"http://qiniu-image.gotojava.cn/blog/2023-12-15-191044.jpg\" alt=\"Untitled\"></p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">Java教程 in:description</span><br></pre></td></tr></table></figure>\n\n<h3 id=\"根据项目帮助文档搜索\"><a href=\"#根据项目帮助文档搜索\" class=\"headerlink\" title=\"根据项目帮助文档搜索\"></a>根据项目帮助文档搜索</h3><blockquote>\n<p>语法：in:readme</p>\n</blockquote>\n<p><img src=\"http://qiniu-image.gotojava.cn/blog/2023-12-15-191046.png\" alt=\"Untitled\"></p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">Java教程 in:in:readme</span><br></pre></td></tr></table></figure>\n\n<h3 id=\"根据项目描述、项目文档组合搜索\"><a href=\"#根据项目描述、项目文档组合搜索\" class=\"headerlink\" title=\"根据项目描述、项目文档组合搜索\"></a>根据项目描述、项目文档组合搜索</h3><blockquote>\n<p>语法：in:readme,description</p>\n</blockquote>\n<p><img src=\"http://qiniu-image.gotojava.cn/blog/2023-12-15-191047.jpg\" alt=\"Untitled\"></p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">Java教程 in:description,readme</span><br></pre></td></tr></table></figure>\n\n<h3 id=\"根据starts点赞量搜索，点赞量越高代表项目比较收欢迎\"><a href=\"#根据starts点赞量搜索，点赞量越高代表项目比较收欢迎\" class=\"headerlink\" title=\"根据starts点赞量搜索，点赞量越高代表项目比较收欢迎\"></a>根据starts点赞量搜索，点赞量越高代表项目比较收欢迎</h3><blockquote>\n<p>语法：stars:≥100</p>\n</blockquote>\n<p><img src=\"http://qiniu-image.gotojava.cn/blog/2023-12-15-191049.jpg\" alt=\"Untitled\"></p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"># 搜索项目名称，项目说明，项目文档中包含pdf2md，stars数量大于等于100的项目</span><br><span class=\"line\">pdf2md in:name,description,readme stars:&gt;=100</span><br></pre></td></tr></table></figure>\n\n<h3 id=\"根据forks克隆数量搜索，克隆数量越高代表项目比较收欢迎\"><a href=\"#根据forks克隆数量搜索，克隆数量越高代表项目比较收欢迎\" class=\"headerlink\" title=\"根据forks克隆数量搜索，克隆数量越高代表项目比较收欢迎\"></a>根据forks克隆数量搜索，克隆数量越高代表项目比较收欢迎</h3><blockquote>\n<p>语法：forks:数量</p>\n</blockquote>\n<p><img src=\"http://qiniu-image.gotojava.cn/blog/2023-12-15-191050.jpg\" alt=\"Untitled\"></p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"># 搜索项目名称，项目说明，项目文档中包含pdf2doc，forks数量大于等于100的项目</span><br><span class=\"line\">pdf2doc in:name,description,readme forks:&gt;=100</span><br><span class=\"line\"></span><br><span class=\"line\"># 搜索项目名称，项目说明，项目文档中包含pdf2doc，forks数量100到500区间的项目</span><br><span class=\"line\">pdf2doc in:name,description,readme forks:100..500</span><br></pre></td></tr></table></figure>\n\n<h2 id=\"浏览小技巧\"><a href=\"#浏览小技巧\" class=\"headerlink\" title=\"浏览小技巧\"></a>浏览小技巧</h2><ul>\n<li>在线查看项目</li>\n</ul>\n<p>在仓库详情按下【.】键，神奇的事情发生了，当前仓库的内容会被当做资源在一个在线的VSCode中打开，方便我们浏览项目的内容，包括在VSCode中代码搜索、快捷跳转、安装插件增强编辑器功能等。</p>\n<aside>\n💡 实际上github.com的域名会跳转变成”github.dev“。然后当前的仓库就加载到了在线的VSCode中。\n</aside>\n\n<ul>\n<li>在线运行项目</li>\n</ul>\n<p>在项目地址前面加入”gitpod.io&#x2F;”前缀。我们要看的项目就会在gitpod.io项目中运行，使用操作和VSCode是一样的，既然能运行，那么当然也就可以在线阅读项目喽。而且gitpod.io会自动帮我们识别项目类型并处理安装项目的依赖，简直太香了~</p>\n<p><img src=\"http://qiniu-image.gotojava.cn/blog/2023-12-15-191052.jpg\" alt=\"Untitled\"></p>\n<h2 id=\"如何寻找优质项目\"><a href=\"#如何寻找优质项目\" class=\"headerlink\" title=\"如何寻找优质项目\"></a>如何寻找优质项目</h2><h3 id=\"GitHub-Trending\"><a href=\"#GitHub-Trending\" class=\"headerlink\" title=\"GitHub Trending\"></a>GitHub Trending</h3><p><a href=\"https://github.com/trending\">https://github.com/trending</a></p>\n<aside>\n💡 GitHub Trending是<b>一个展示GitHub上当前最受欢迎项目的功能</b>。 每天，GitHub会计算许多项目的活跃度，从而得出一个受欢迎程度排行榜，包括今天、本周和本月的热门项目。\n</aside>\n\n<ul>\n<li><a href=\"https://github.com/521xueweihan/HelloGitHub\">https://github.com/521xueweihan/HelloGitHub</a></li>\n</ul>\n<aside>\n💡 分享 GitHub 上有趣、入门级的开源项目。\n</aside>\n\n<h3 id=\"awesome\"><a href=\"#awesome\" class=\"headerlink\" title=\"awesome\"></a>awesome</h3><p><img src=\"http://qiniu-image.gotojava.cn/blog/2023-12-15-191056.jpg\" alt=\"Untitled\"></p>\n<aside>\n💡 GitHub Awesome 是<b>一个Github 上的一个项目集合，也是一个社区驱动的项目，旨在收集GitHub 上的各种优秀的、值得推荐的项目</b>。 Awesome 通常指令人敬畏的、令人赞叹的事物，所以这个项目的名称取为Awesome XXX，表明它收录的是优秀的、值得推荐的项目。\n</aside>\n\n<h3 id=\"找例子\"><a href=\"#找例子\" class=\"headerlink\" title=\"找例子\"></a>找例子</h3><blockquote>\n<p>语法：关键词 sample</p>\n</blockquote>\n<p><img src=\"http://qiniu-image.gotojava.cn/blog/2023-12-15-191058.jpg\" alt=\"Untitled\"></p>\n<h3 id=\"找模板\"><a href=\"#找模板\" class=\"headerlink\" title=\"找模板\"></a>找模板</h3><blockquote>\n<p>语法：xxx starter&#x2F;boilerplat</p>\n</blockquote>\n<p><img src=\"http://qiniu-image.gotojava.cn/blog/2023-12-15-191101.jpg\" alt=\"Untitled\"></p>\n<h3 id=\"找教程\"><a href=\"#找教程\" class=\"headerlink\" title=\"找教程\"></a>找教程</h3><blockquote>\n<p>语法：xxx tutorial</p>\n</blockquote>\n<p><img src=\"http://qiniu-image.gotojava.cn/blog/2023-12-15-191104.jpg\" alt=\"Untitled\"></p>\n<h2 id=\"指导初学者\"><a href=\"#指导初学者\" class=\"headerlink\" title=\"指导初学者\"></a>指导初学者</h2><h3 id=\"指导初学者做出首次贡献的方式\"><a href=\"#指导初学者做出首次贡献的方式\" class=\"headerlink\" title=\"指导初学者做出首次贡献的方式\"></a>指导初学者做出首次贡献的方式</h3><aside>\n💡 该项目旨在简化和指导初学者做出首次贡献的方式。如果您想做出第一次贡献，请按照以下步骤操作。\n</aside>\n\n<p><a href=\"https://github.com/firstcontributions/first-contributions\">https://github.com/firstcontributions/first-contributions</a></p>\n<h3 id=\"最浅显易懂的Git教程\"><a href=\"#最浅显易懂的Git教程\" class=\"headerlink\" title=\"最浅显易懂的Git教程\"></a>最浅显易懂的Git教程</h3><p><a href=\"https://www.liaoxuefeng.com/wiki/896043488029600\">Git教程-廖雪峰老师的经典教程</a></p>\n","excerpt":"<meta name=\"referrer\" content=\"no-referrer\" />\n\n<p>GitHub是一个全球性的代码托管平台，上面托管了非常多的优秀项目和学习资料。但是对于庞大的资源内容掌握一些搜索方法和技巧来提高搜索效率是十分有必要的。下面是我经过验证的一些不错的技巧和相关资料，希望能对你有所帮助。</p>","more":"<h2 id=\"搜索小技巧\"><a href=\"#搜索小技巧\" class=\"headerlink\" title=\"搜索小技巧\"></a>搜索小技巧</h2><p><img src=\"http://qiniu-image.gotojava.cn/blog/2023-12-15-191043.png\" alt=\"Untitled\"></p>\n<p>Watch：表示有多少人关注这个项目；</p>\n<p>Star：表示有多少人给这个项目点赞，如果你给这个项目点赞，这个项目会出现在你的点赞列表中。点赞数越多，代表这个项目在社区的热度就越高；</p>\n<p>Fork：表示有多少人拷贝或者克隆了这个项目。如果我们Fork了这个项目，就可以在Fork的基础上再进行优化，优化后的项目在得到原作者认可的情况下，可以再次提交给作者。</p>\n<h3 id=\"根据项目名称搜索\"><a href=\"#根据项目名称搜索\" class=\"headerlink\" title=\"根据项目名称搜索\"></a>根据项目名称搜索</h3><blockquote>\n<p>语法：in:name</p>\n</blockquote>\n<p><img src=\"http://qiniu-image.gotojava.cn/blog/2023-12-15-191044.png\" alt=\"Untitled\"></p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">pdf2excel in:name</span><br></pre></td></tr></table></figure>\n\n<h3 id=\"根据项目描述搜索\"><a href=\"#根据项目描述搜索\" class=\"headerlink\" title=\"根据项目描述搜索\"></a>根据项目描述搜索</h3><blockquote>\n<p>语法：in:description</p>\n</blockquote>\n<p><img src=\"http://qiniu-image.gotojava.cn/blog/2023-12-15-191044.jpg\" alt=\"Untitled\"></p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">Java教程 in:description</span><br></pre></td></tr></table></figure>\n\n<h3 id=\"根据项目帮助文档搜索\"><a href=\"#根据项目帮助文档搜索\" class=\"headerlink\" title=\"根据项目帮助文档搜索\"></a>根据项目帮助文档搜索</h3><blockquote>\n<p>语法：in:readme</p>\n</blockquote>\n<p><img src=\"http://qiniu-image.gotojava.cn/blog/2023-12-15-191046.png\" alt=\"Untitled\"></p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">Java教程 in:in:readme</span><br></pre></td></tr></table></figure>\n\n<h3 id=\"根据项目描述、项目文档组合搜索\"><a href=\"#根据项目描述、项目文档组合搜索\" class=\"headerlink\" title=\"根据项目描述、项目文档组合搜索\"></a>根据项目描述、项目文档组合搜索</h3><blockquote>\n<p>语法：in:readme,description</p>\n</blockquote>\n<p><img src=\"http://qiniu-image.gotojava.cn/blog/2023-12-15-191047.jpg\" alt=\"Untitled\"></p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">Java教程 in:description,readme</span><br></pre></td></tr></table></figure>\n\n<h3 id=\"根据starts点赞量搜索，点赞量越高代表项目比较收欢迎\"><a href=\"#根据starts点赞量搜索，点赞量越高代表项目比较收欢迎\" class=\"headerlink\" title=\"根据starts点赞量搜索，点赞量越高代表项目比较收欢迎\"></a>根据starts点赞量搜索，点赞量越高代表项目比较收欢迎</h3><blockquote>\n<p>语法：stars:≥100</p>\n</blockquote>\n<p><img src=\"http://qiniu-image.gotojava.cn/blog/2023-12-15-191049.jpg\" alt=\"Untitled\"></p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"># 搜索项目名称，项目说明，项目文档中包含pdf2md，stars数量大于等于100的项目</span><br><span class=\"line\">pdf2md in:name,description,readme stars:&gt;=100</span><br></pre></td></tr></table></figure>\n\n<h3 id=\"根据forks克隆数量搜索，克隆数量越高代表项目比较收欢迎\"><a href=\"#根据forks克隆数量搜索，克隆数量越高代表项目比较收欢迎\" class=\"headerlink\" title=\"根据forks克隆数量搜索，克隆数量越高代表项目比较收欢迎\"></a>根据forks克隆数量搜索，克隆数量越高代表项目比较收欢迎</h3><blockquote>\n<p>语法：forks:数量</p>\n</blockquote>\n<p><img src=\"http://qiniu-image.gotojava.cn/blog/2023-12-15-191050.jpg\" alt=\"Untitled\"></p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"># 搜索项目名称，项目说明，项目文档中包含pdf2doc，forks数量大于等于100的项目</span><br><span class=\"line\">pdf2doc in:name,description,readme forks:&gt;=100</span><br><span class=\"line\"></span><br><span class=\"line\"># 搜索项目名称，项目说明，项目文档中包含pdf2doc，forks数量100到500区间的项目</span><br><span class=\"line\">pdf2doc in:name,description,readme forks:100..500</span><br></pre></td></tr></table></figure>\n\n<h2 id=\"浏览小技巧\"><a href=\"#浏览小技巧\" class=\"headerlink\" title=\"浏览小技巧\"></a>浏览小技巧</h2><ul>\n<li>在线查看项目</li>\n</ul>\n<p>在仓库详情按下【.】键，神奇的事情发生了，当前仓库的内容会被当做资源在一个在线的VSCode中打开，方便我们浏览项目的内容，包括在VSCode中代码搜索、快捷跳转、安装插件增强编辑器功能等。</p>\n<aside>\n💡 实际上github.com的域名会跳转变成”github.dev“。然后当前的仓库就加载到了在线的VSCode中。\n</aside>\n\n<ul>\n<li>在线运行项目</li>\n</ul>\n<p>在项目地址前面加入”gitpod.io&#x2F;”前缀。我们要看的项目就会在gitpod.io项目中运行，使用操作和VSCode是一样的，既然能运行，那么当然也就可以在线阅读项目喽。而且gitpod.io会自动帮我们识别项目类型并处理安装项目的依赖，简直太香了~</p>\n<p><img src=\"http://qiniu-image.gotojava.cn/blog/2023-12-15-191052.jpg\" alt=\"Untitled\"></p>\n<h2 id=\"如何寻找优质项目\"><a href=\"#如何寻找优质项目\" class=\"headerlink\" title=\"如何寻找优质项目\"></a>如何寻找优质项目</h2><h3 id=\"GitHub-Trending\"><a href=\"#GitHub-Trending\" class=\"headerlink\" title=\"GitHub Trending\"></a>GitHub Trending</h3><p><a href=\"https://github.com/trending\">https://github.com/trending</a></p>\n<aside>\n💡 GitHub Trending是<b>一个展示GitHub上当前最受欢迎项目的功能</b>。 每天，GitHub会计算许多项目的活跃度，从而得出一个受欢迎程度排行榜，包括今天、本周和本月的热门项目。\n</aside>\n\n<ul>\n<li><a href=\"https://github.com/521xueweihan/HelloGitHub\">https://github.com/521xueweihan/HelloGitHub</a></li>\n</ul>\n<aside>\n💡 分享 GitHub 上有趣、入门级的开源项目。\n</aside>\n\n<h3 id=\"awesome\"><a href=\"#awesome\" class=\"headerlink\" title=\"awesome\"></a>awesome</h3><p><img src=\"http://qiniu-image.gotojava.cn/blog/2023-12-15-191056.jpg\" alt=\"Untitled\"></p>\n<aside>\n💡 GitHub Awesome 是<b>一个Github 上的一个项目集合，也是一个社区驱动的项目，旨在收集GitHub 上的各种优秀的、值得推荐的项目</b>。 Awesome 通常指令人敬畏的、令人赞叹的事物，所以这个项目的名称取为Awesome XXX，表明它收录的是优秀的、值得推荐的项目。\n</aside>\n\n<h3 id=\"找例子\"><a href=\"#找例子\" class=\"headerlink\" title=\"找例子\"></a>找例子</h3><blockquote>\n<p>语法：关键词 sample</p>\n</blockquote>\n<p><img src=\"http://qiniu-image.gotojava.cn/blog/2023-12-15-191058.jpg\" alt=\"Untitled\"></p>\n<h3 id=\"找模板\"><a href=\"#找模板\" class=\"headerlink\" title=\"找模板\"></a>找模板</h3><blockquote>\n<p>语法：xxx starter&#x2F;boilerplat</p>\n</blockquote>\n<p><img src=\"http://qiniu-image.gotojava.cn/blog/2023-12-15-191101.jpg\" alt=\"Untitled\"></p>\n<h3 id=\"找教程\"><a href=\"#找教程\" class=\"headerlink\" title=\"找教程\"></a>找教程</h3><blockquote>\n<p>语法：xxx tutorial</p>\n</blockquote>\n<p><img src=\"http://qiniu-image.gotojava.cn/blog/2023-12-15-191104.jpg\" alt=\"Untitled\"></p>\n<h2 id=\"指导初学者\"><a href=\"#指导初学者\" class=\"headerlink\" title=\"指导初学者\"></a>指导初学者</h2><h3 id=\"指导初学者做出首次贡献的方式\"><a href=\"#指导初学者做出首次贡献的方式\" class=\"headerlink\" title=\"指导初学者做出首次贡献的方式\"></a>指导初学者做出首次贡献的方式</h3><aside>\n💡 该项目旨在简化和指导初学者做出首次贡献的方式。如果您想做出第一次贡献，请按照以下步骤操作。\n</aside>\n\n<p><a href=\"https://github.com/firstcontributions/first-contributions\">https://github.com/firstcontributions/first-contributions</a></p>\n<h3 id=\"最浅显易懂的Git教程\"><a href=\"#最浅显易懂的Git教程\" class=\"headerlink\" title=\"最浅显易懂的Git教程\"></a>最浅显易懂的Git教程</h3><p><a href=\"https://www.liaoxuefeng.com/wiki/896043488029600\">Git教程-廖雪峰老师的经典教程</a></p>"},{"title":"Linux环境下的MySQL的安装和配置","abbrlink":"2306cec7","date":"2023-11-13T13:55:23.000Z","toc":true,"_content":"<meta name=\"referrer\" content=\"no-referrer\" />\n\n本文记录MySQL5.7在CentOS7环境下的安装和配置过程。\n\n<!--more-->\n\n## 新特性\n\nMySQL5.7有以下几个方面的新功能\n\n1. 随机root密码\n\nMySQL5.7数据库初始化完成后，会自动生成一个root@localhost的用户，root用户的密码不为空，而是随机产生一个密码。\n\n2. 默认SSL加密\n\nMySQL5.7采用了更加简单的SSL安全访问机制，默认连接使用SSL的加密方式。\n\n3. 密码过期策略\n\nMySQL5.7支持用户设置密码过期策略，要求用户在一定时间过后必须修改密码。\n\n4. 用户锁\n\nMySQL5.7为管理员提供了暂时禁用某个用户的功能，使被锁定的用户无法访问和使用数据库。\n\n5. 全面支持JSON\n\n随着非结构化数据存储需求的持久增长，各种非结构化数据存储的数据应运而生，各大关系型数据库也不甘示弱，纷纷提供对JSON的支持，以应对非结构化数据库的挑战。\n\nMySQL5.7也提供了对JSON的支持，在服务器端提供了一组便于操作JSON的函数。存储的方法是将JOSN编码成BLOB后再由存储引擎进行处理。这样MySQL就同时拥有了关系型数据库和非关系型数据库的优点，并且可以提供完整的事务支持。\n\n1. 支持两类生成列\n\n生成列是通过数据库中的其他列计算得到的一列。当为生成列创建索引时，可以便捷地加快查询速度。MySQL5.7支持虚拟生成列和存储生成列。虚拟生成列只是将数据保存在表的元数据中，作为缺省的生成列类型；存储生成列则是将数据永久保存在磁盘上，需要更多的磁盘空间。\n\n2. 引入系统库\n\n系统库中包含一系列视图、函数和存储过程，通过多线程、多进程、组合事务提交和基于行的优化方式将复制功能提高5倍以上，用户向外扩充其跨商品系统的工作负载时，得以大幅度提升复制的效能和效率。\n\n## 下载\n\nMySQL的版本分为：\n\n- 企业版\n\nMySQL企业版主要面向企业用户，不遵守社区版本的GPL开源协议。享受Oracle公司的7*24h的电话支持服务以及补丁更新服务（企业为此需要支付费用）。\n\n- 社区版\n\n社区版的维护由MySQL的开源社区提供支持，不能像商业版那样获取Oracle的电话支持和补丁服务。社区版是免费获取。MySQL的社区版可通过官网[MySQL Communify Downloads](https://dev.mysql.com/downloads/mysql/)获取。本文也主要针对该版本进行测试。\n\n## 安装\n\n实验使用环境为：\n\n操作系统（虚拟机环境）：CentOS Linux release 7.5.1804 (Core)\n\nMySQL版本：mysql-5.7.41-1.el7.x86_64\n\n```sql\n[root@centos7 ~]# ls\nanaconda-ks.cfg  mysql-5.7.41-1.el7.x86_64.rpm-bundle.tar\n# 解压归档tar包\n[root@centos7 ~]# tar -xf mysql-5.7.41-1.el7.x86_64.rpm-bundle.tar\n\n# 卸载关于mariadb的依赖包文件，一台服务器只能安装一个MySQL/MariaDB软件\n[root@centos7 ~]# rpm -qa | grep mariadb\nmariadb-libs-5.5.56-2.el7.x86_64\n# -e：删除指定的包；--nodeps：在安装时不检查依赖关系\n[root@centos7 ~]# rpm -e --nodeps mariadb-libs-5.5.56-2.el7.x86_64\n\n# 服务器和客户端库的通用文件\n[root@centos7 ~]# rpm -ivh mysql-community-common-5.7.41-1.el7.x86_64.rpm \n警告：mysql-community-common-5.7.41-1.el7.x86_64.rpm: 头V4 RSA/SHA256 Signature, 密钥 ID 3a79bd29: NOKEY\n准备中...                          ################################# [100%]\n正在升级/安装...\n   1:mysql-community-common-5.7.41-1.e################################# [100%]\n\n# MySQL数据库客户端应用程序的共享库\n[root@centos7 ~]# rpm -ivh mysql-community-libs-5.7.41-1.el7.x86_64.rpm \n警告：mysql-community-libs-5.7.41-1.el7.x86_64.rpm: 头V4 RSA/SHA256 Signature, 密钥 ID 3a79bd29: NOKEY\n准备中...                          ################################# [100%]\n正在升级/安装...\n   1:mysql-community-libs-5.7.41-1.el7################################# [100%]\n\n# MySQL客户端应用程序和工具\n[root@centos7 ~]# rpm -ivh mysql-community-client-5.7.41-1.el7.x86_64.rpm \n警告：mysql-community-client-5.7.41-1.el7.x86_64.rpm: 头V4 RSA/SHA256 Signature, 密钥 ID 3a79bd29: NOKEY\n准备中...                          ################################# [100%]\n正在升级/安装...\n   1:mysql-community-client-5.7.41-1.e################################# [100%]\n\n# 数据库服务器和相关工具 \n[root@centos7 ~]# rpm -ivh mysql-community-server-5.7.41-1.el7.x86_64.rpm \n警告：mysql-community-server-5.7.41-1.el7.x86_64.rpm: 头V4 RSA/SHA256 Signature, 密钥 ID 3a79bd29: NOKEY\n准备中...                          ################################# [100%]\n正在升级/安装...\n   1:mysql-community-server-5.7.41-1.e################################# [100%]\n\n# 启动MySQL服务\n[root@centos7 ~]# systemctl start mysqld\n# 查看MySQL服务状态\n[root@centos7 ~]# systemctl status mysqld\n● mysqld.service - MySQL Server\n   Loaded: loaded (/usr/lib/systemd/system/mysqld.service; enabled; vendor preset: disabled)\n   Active: active (running) since 二 2023-11-07 01:08:56 CST; 2s ago\n     Docs: man:mysqld(8)\n           http://dev.mysql.com/doc/refman/en/using-systemd.html\n  Process: 12837 ExecStart=/usr/sbin/mysqld --daemonize --pid-file=/var/run/mysqld/mysqld.pid $MYSQLD_OPTS (code=exited, status=0/SUCCESS)\n  Process: 12722 ExecStartPre=/usr/bin/mysqld_pre_systemd (code=exited, status=0/SUCCESS)\n Main PID: 12840 (mysqld)\n   CGroup: /system.slice/mysqld.service\n           └─12840 /usr/sbin/mysqld --daemonize --pid-file=/var/run/mysqld/mysqld.pid\n\n11月 07 01:08:53 centos7 systemd[1]: Starting MySQL Server...\n11月 07 01:08:56 centos7 systemd[1]: Started MySQL Server.\n```\n\n## 配置\n\n### 修改MySQL密码\n\n> 获取随机密码登陆\n\nMySQL在安装完成后，会生成一个随机密码，我们通过root用户➕随机密码便可以登陆MySQL服务器。随机密码会生成在 `/var/log/mysqld.log`中。我们可以通过 `tail -100f /var/log/mysqld.log | grep -i \"password”`来获取随机密码。\n\n![Untitled](http://qiniu-image.gotojava.cn/blog/2023-12-15-191105.png)\n\n> 使用skip_grant_tables跳过密码验证\n\n也可以通过修改MySQL的配置文件my.cnf，通过跳过密码校验，来免登陆MySQL修改密码。通过在/etc/my.cnf配置文件中，添加 `skip_grant_tables`来实现跳过密码校验。\n\n![Untitled](http://qiniu-image.gotojava.cn/blog/2023-12-15-191107.png)\n\n修改完成后，需要通过 `systemctl restart mysqld`重启MySQL服务，使配置文件的内容生效。\n\n通过mysql  -u root -p来登陆MySQL服务器，因为我们跳过了密码校验，所以在提示：“Enter password”时，回车即可。像下面这样：\n\n![Untitled](http://qiniu-image.gotojava.cn/blog/2023-12-15-191110.png)\n\n<aside>\n⚠️ 如果需要恢复密码验证，则移除”`skip_grant_tables`”这行内容，重启MySQL服务就可以了。\n\n</aside>\n\n> 修改root密码\n\n```sql\n# 修改当前登陆用户的密码为root\nmysql> ALTER USER user() identified by \"root\";\nQuery OK, 0 rows affected (0.00 sec)\n\n# 遇到：MySQL ERROR 1819 (HY000): Your password does not satisfy the current policy requirements 问题参考：https://ostechnix.com/fix-mysql-error-1819-hy000-your-password-does-not-satisfy-the-current-policy-requirements/\n\n# 刷新权限\nmysql> flush privileges;\nQuery OK, 0 rows affected (0.00 sec)\n```\n\n### 开放远程连接\n\n默认情况下MySQL是不允许本地以外的其他服务器远程访问的，这个时候需要我们进行授权操作。\n\n```sql\n# 打开mysql数据库\nmysql> use mysql;\nReading table information for completion of table and column names\nYou can turn off this feature to get a quicker startup with -A\nDatabase changed\n# 修改记录，允许远程访问\nmysql> update user set host = '%' where user ='root';\nQuery OK, 1 row affected (0.00 sec)\nRows matched: 1  Changed: 1  Warnings: 0\n# 刷新权限信息\nmysql> flush privileges;\nQuery OK, 0 rows affected (0.00 sec)\n```\n\n```sql\n# 开放防火墙3306端口\n[root@centos7 ~]# firewall-cmd --zone=public --add-port=3306/tcp --permanent\n# 刷新防火墙规则\n[root@centos7 ~]# firewall-cmd --reload\n# 移除3306端口\n[root@centos7 ~]# firewall-cmd --zone=public --remove-port=3306/tcp --permanent\n# 查看当前防火墙规则列表\n[root@centos7 ~]# firewall-cmd --list-all\n```\n\n### 获取服务器状态信息\n\n```sql\nmysql> status\n--------------\nmysql  Ver 14.14 Distrib 5.7.41, for Linux (x86_64) using  EditLine wrapper\n\nConnection id:          12\nCurrent database:       mysql\nCurrent user:           root@localhost\nSSL:                    Not in use\nCurrent pager:          stdout\nUsing outfile:          ''\nUsing delimiter:        ;\nServer version:         5.7.41 MySQL Community Server (GPL)\nProtocol version:       10\nConnection:             Localhost via UNIX socket\nServer characterset:    latin1\nDb     characterset:    latin1\nClient characterset:    utf8\nConn.  characterset:    utf8\nUNIX socket:            /var/lib/mysql/mysql.sock\nUptime:                 33 min 20 sec\n\nThreads: 1  Questions: 116  Slow queries: 0  Opens: 175  Flush tables: 1  Open tables: 168  Queries per second avg: 0.058\n--------------\n```\n\n### MySQL安装目录说明\n\n| 文件夹             | 文件夹内容                                       |\n| ------------------ | ------------------------------------------------ |\n| /var/bin           | 客户端和脚本（mysqladmin、mysqldump等命令）      |\n| /usr/sbin          | mysqld服务器                                     |\n| /var/lib/mysql     | 日志文件、socket文件和数据库                     |\n| /usr/share/info    | 信息格式的手册                                   |\n| /usr/share/man     | UNIX帮助页                                       |\n| /usr/include/mysql | 头文件                                           |\n| /usr/lib/mysql     | MySQL的依赖库                                    |\n| /usr/share/mysql   | 错误消息、字符集、安装文件和配置文件             |\n| /etc/rc.d/init.d/  | 启动脚本文件的mysql目录，用来启动和停止MySQL服务 |\n\n### MySQL数据目录说明\n\n<aside>\n⚠️ MySQL数据目录的位置可以通过/etc/my.cnf配置文件中的datadir配置获得。\n\n</aside>\n\n![Untitled](http://qiniu-image.gotojava.cn/blog/2023-12-15-191111.png)\n\n| 文件名称                                                                                           | 作用                                                                                           |\n| -------------------------------------------------------------------------------------------------- | ---------------------------------------------------------------------------------------------- |\n| auto.cnf                                                                                           | MySQL服务器的选项文件，用于存储server-uuid的值，server-uuid用于标识MySQL实例在集群中的唯一性。 |\n| ca-key.pem                                                                                         | CA 私钥, 用于生成服务器端/客户端的数字证书                                                     |\n| ca.pem                                                                                             | CA 证书, 用于生成服务器端/客户端的数字证书                                                     |\n| client-cert.pem                                                                                    | 客户端连接时使用的证书                                                                         |\n| client-key.pem                                                                                     | 客户端连接时使用的私钥                                                                         |\n| ib_buffer_pool                                                                                     | InnoDB引擎的缓存数据文件，用于存储缓存                                                         |\n| ibdata1                                                                                            | 共享表空间（系统表空间），如果使用的是InnoDB引擎，默认大小为10M                                |\n| ib_logfile0                                                                                        | 支持事务性引擎的redo日志文件                                                                   |\n| ib_logfile1                                                                                        | 支持事务性引擎的redo日志文件                                                                   |\n| ibtmp1                                                                                             | 存储临时对象的空间，比如临时表对象等                                                           |\n| mysql.sock                                                                                         | Socket连接的文件，用于MySQL客户端和MySQL服务器的本地连接（同一机器）                           |\n| mysql.sock.lock                                                                                    | MySQL的一个文件锁，用于控制并发访问数据库的情况                                                |\n| private_key.pem                                                                                    | 密钥对的私钥                                                                                   |\n| public_key.pem                                                                                     | 密钥对的公钥                                                                                   |\n| server-cert.pem                                                                                    | 服务器端的数字证书                                                                             |\n| server-key.pem                                                                                     | 服务器端的 RSA 私钥                                                                            |\n| mysql、performance_schema、sys                                                                     | 系统的内置数据库：                                                                             |\n| information_schema：存储了数据库对象信息，包括用户表信息、列信息、权限信息、字符集信息、分区信息； |                                                                                                |\n| mysql：负责存储数据库用户、用户访问权限信息；                                                      |                                                                                                |\n| sys：MySQL5.7版本的数据库，提供了一些视图，用于帮助开发者和使用者更方便地查看性能问题。            |                                                                                                |\n\n- test是我们自己创建的测试库，结构如下：\n\n![Untitled](http://qiniu-image.gotojava.cn/blog/2023-12-15-191112.png)\n\ndb.opt：用来保存数据库的配置信息，比如该库的默认字符集编码和字符集排序规则。\n\n> InnoDB引擎\n\n*.frm：用来保存每个数据表的元数据和表结构信息，当数据库崩溃时，可以用.frm文件恢复表结构。\n\n*.ibd：用来存储表的数据。\n\n> MyISAM引擎\n\n*.MYD：存储MyISAM表的数据。\n\n*.MYI：存储MyISAM表的索引及相关信息。\n\n<aside>\n⚠️ 在MySQL中，一个数据库可以使用多个存储引擎。所以该数据库下可能既存在InnoDB引擎的文件，也存在MyISAM引擎的文件。\n\n</aside>\n\n### MySQL配置文件（my.cnf）\n\n> 服务器端参数“[mysqld]”\n\n| 参数名称                       | 说明                                                                                                                                          |\n| ------------------------------ | --------------------------------------------------------------------------------------------------------------------------------------------- |\n| port                           | 表示MySQL服务器的端口号                                                                                                                       |\n| basedir                        | 表示MySQL的安装路径                                                                                                                           |\n| datadir                        | MySQL数据文件的存储位置                                                                                                                       |\n| default_character_set          | 服务端默认的字符集                                                                                                                            |\n| default_storage_engine         | 创建数据表时，默认使用的存储引擎                                                                                                              |\n| sql_mode                       | sql模式的参数，该参数可以检验SQL语句的严格程度。sql_mode的参数参考：http://www.gamecolg.com/program_m_onvideo_m_inkey_m_gta1662479699017.html |\n| max_connections                | 允许同时访问服务器的最大连接数                                                                                                                |\n| query_cache_size               | 查询时的缓存大小                                                                                                                              |\n| table_open_cache               | 表示所有进程打开表的总数                                                                                                                      |\n| tmp_table_size                 | 内存中每个临时表允许的最大大小                                                                                                                |\n| thread_cache_size              | 缓存的最大线程数                                                                                                                              |\n| myisam_max_sort_file_size      | MySQL重建索引时所允许的最大临时文件大小                                                                                                       |\n| myisam_sort_buffer_size        | 重建索引时的缓存大小                                                                                                                          |\n| key_buffer_size                | 关键词的缓存大小                                                                                                                              |\n| read_buffer_size               | MyISAM全表扫描的缓存大小                                                                                                                      |\n| read_rnd_buffer_size           | 表示将排序好的数据存入该缓存中                                                                                                                |\n| sort_buffer_size               | 表示用于排序的缓存大小                                                                                                                        |\n| innodb_log_file_size           | InnoDB日志文件的大小                                                                                                                          |\n| innodb_log_buffer_size         | 用于存储日志数据的缓存区大小                                                                                                                  |\n| innodb_buffer_pool_size        | 缓存的大小，InnoDB使用一个缓冲池保存索引和原始数据                                                                                            |\n| innodb_thread_concurrency      | InnoDB存储引擎允许的线程最大数                                                                                                                |\n| innodb_flush_log_at_trx_commit | 提交日志的时机，为1时会在每次提交后将事务日志写入到磁盘上                                                                                     |\n\n## 问题记录\n\n### CentOS7忘记密码怎么办？\n\n[CentOS7如果忘记密码，密码重置详细步骤_centos修改密码忘记密码-CSDN博客](https://blog.csdn.net/qq_45887180/article/details/115819136)\n\n### ERROR 1820（HY000）\n\n错误提示：You must reset your password using ALTER USER statement before executing this statement.\n\n解决方案：[MySQL 报错：ERROR 1820 (HY000): You must reset your password using ALTER USER statement before-CSDN博客](https://blog.csdn.net/Wing_kin666/article/details/110921440)\n","source":"_posts/Linux环境下的MySQL的安装和配置.md","raw":"---\ntitle: Linux环境下的MySQL的安装和配置\ncategories:\n  - 开发者笔记\ntags:\n  - MySQL\nabbrlink: 2306cec7\ndate: 2023-11-13 13:55:23\ntoc: true\n---\n<meta name=\"referrer\" content=\"no-referrer\" />\n\n本文记录MySQL5.7在CentOS7环境下的安装和配置过程。\n\n<!--more-->\n\n## 新特性\n\nMySQL5.7有以下几个方面的新功能\n\n1. 随机root密码\n\nMySQL5.7数据库初始化完成后，会自动生成一个root@localhost的用户，root用户的密码不为空，而是随机产生一个密码。\n\n2. 默认SSL加密\n\nMySQL5.7采用了更加简单的SSL安全访问机制，默认连接使用SSL的加密方式。\n\n3. 密码过期策略\n\nMySQL5.7支持用户设置密码过期策略，要求用户在一定时间过后必须修改密码。\n\n4. 用户锁\n\nMySQL5.7为管理员提供了暂时禁用某个用户的功能，使被锁定的用户无法访问和使用数据库。\n\n5. 全面支持JSON\n\n随着非结构化数据存储需求的持久增长，各种非结构化数据存储的数据应运而生，各大关系型数据库也不甘示弱，纷纷提供对JSON的支持，以应对非结构化数据库的挑战。\n\nMySQL5.7也提供了对JSON的支持，在服务器端提供了一组便于操作JSON的函数。存储的方法是将JOSN编码成BLOB后再由存储引擎进行处理。这样MySQL就同时拥有了关系型数据库和非关系型数据库的优点，并且可以提供完整的事务支持。\n\n1. 支持两类生成列\n\n生成列是通过数据库中的其他列计算得到的一列。当为生成列创建索引时，可以便捷地加快查询速度。MySQL5.7支持虚拟生成列和存储生成列。虚拟生成列只是将数据保存在表的元数据中，作为缺省的生成列类型；存储生成列则是将数据永久保存在磁盘上，需要更多的磁盘空间。\n\n2. 引入系统库\n\n系统库中包含一系列视图、函数和存储过程，通过多线程、多进程、组合事务提交和基于行的优化方式将复制功能提高5倍以上，用户向外扩充其跨商品系统的工作负载时，得以大幅度提升复制的效能和效率。\n\n## 下载\n\nMySQL的版本分为：\n\n- 企业版\n\nMySQL企业版主要面向企业用户，不遵守社区版本的GPL开源协议。享受Oracle公司的7*24h的电话支持服务以及补丁更新服务（企业为此需要支付费用）。\n\n- 社区版\n\n社区版的维护由MySQL的开源社区提供支持，不能像商业版那样获取Oracle的电话支持和补丁服务。社区版是免费获取。MySQL的社区版可通过官网[MySQL Communify Downloads](https://dev.mysql.com/downloads/mysql/)获取。本文也主要针对该版本进行测试。\n\n## 安装\n\n实验使用环境为：\n\n操作系统（虚拟机环境）：CentOS Linux release 7.5.1804 (Core)\n\nMySQL版本：mysql-5.7.41-1.el7.x86_64\n\n```sql\n[root@centos7 ~]# ls\nanaconda-ks.cfg  mysql-5.7.41-1.el7.x86_64.rpm-bundle.tar\n# 解压归档tar包\n[root@centos7 ~]# tar -xf mysql-5.7.41-1.el7.x86_64.rpm-bundle.tar\n\n# 卸载关于mariadb的依赖包文件，一台服务器只能安装一个MySQL/MariaDB软件\n[root@centos7 ~]# rpm -qa | grep mariadb\nmariadb-libs-5.5.56-2.el7.x86_64\n# -e：删除指定的包；--nodeps：在安装时不检查依赖关系\n[root@centos7 ~]# rpm -e --nodeps mariadb-libs-5.5.56-2.el7.x86_64\n\n# 服务器和客户端库的通用文件\n[root@centos7 ~]# rpm -ivh mysql-community-common-5.7.41-1.el7.x86_64.rpm \n警告：mysql-community-common-5.7.41-1.el7.x86_64.rpm: 头V4 RSA/SHA256 Signature, 密钥 ID 3a79bd29: NOKEY\n准备中...                          ################################# [100%]\n正在升级/安装...\n   1:mysql-community-common-5.7.41-1.e################################# [100%]\n\n# MySQL数据库客户端应用程序的共享库\n[root@centos7 ~]# rpm -ivh mysql-community-libs-5.7.41-1.el7.x86_64.rpm \n警告：mysql-community-libs-5.7.41-1.el7.x86_64.rpm: 头V4 RSA/SHA256 Signature, 密钥 ID 3a79bd29: NOKEY\n准备中...                          ################################# [100%]\n正在升级/安装...\n   1:mysql-community-libs-5.7.41-1.el7################################# [100%]\n\n# MySQL客户端应用程序和工具\n[root@centos7 ~]# rpm -ivh mysql-community-client-5.7.41-1.el7.x86_64.rpm \n警告：mysql-community-client-5.7.41-1.el7.x86_64.rpm: 头V4 RSA/SHA256 Signature, 密钥 ID 3a79bd29: NOKEY\n准备中...                          ################################# [100%]\n正在升级/安装...\n   1:mysql-community-client-5.7.41-1.e################################# [100%]\n\n# 数据库服务器和相关工具 \n[root@centos7 ~]# rpm -ivh mysql-community-server-5.7.41-1.el7.x86_64.rpm \n警告：mysql-community-server-5.7.41-1.el7.x86_64.rpm: 头V4 RSA/SHA256 Signature, 密钥 ID 3a79bd29: NOKEY\n准备中...                          ################################# [100%]\n正在升级/安装...\n   1:mysql-community-server-5.7.41-1.e################################# [100%]\n\n# 启动MySQL服务\n[root@centos7 ~]# systemctl start mysqld\n# 查看MySQL服务状态\n[root@centos7 ~]# systemctl status mysqld\n● mysqld.service - MySQL Server\n   Loaded: loaded (/usr/lib/systemd/system/mysqld.service; enabled; vendor preset: disabled)\n   Active: active (running) since 二 2023-11-07 01:08:56 CST; 2s ago\n     Docs: man:mysqld(8)\n           http://dev.mysql.com/doc/refman/en/using-systemd.html\n  Process: 12837 ExecStart=/usr/sbin/mysqld --daemonize --pid-file=/var/run/mysqld/mysqld.pid $MYSQLD_OPTS (code=exited, status=0/SUCCESS)\n  Process: 12722 ExecStartPre=/usr/bin/mysqld_pre_systemd (code=exited, status=0/SUCCESS)\n Main PID: 12840 (mysqld)\n   CGroup: /system.slice/mysqld.service\n           └─12840 /usr/sbin/mysqld --daemonize --pid-file=/var/run/mysqld/mysqld.pid\n\n11月 07 01:08:53 centos7 systemd[1]: Starting MySQL Server...\n11月 07 01:08:56 centos7 systemd[1]: Started MySQL Server.\n```\n\n## 配置\n\n### 修改MySQL密码\n\n> 获取随机密码登陆\n\nMySQL在安装完成后，会生成一个随机密码，我们通过root用户➕随机密码便可以登陆MySQL服务器。随机密码会生成在 `/var/log/mysqld.log`中。我们可以通过 `tail -100f /var/log/mysqld.log | grep -i \"password”`来获取随机密码。\n\n![Untitled](http://qiniu-image.gotojava.cn/blog/2023-12-15-191105.png)\n\n> 使用skip_grant_tables跳过密码验证\n\n也可以通过修改MySQL的配置文件my.cnf，通过跳过密码校验，来免登陆MySQL修改密码。通过在/etc/my.cnf配置文件中，添加 `skip_grant_tables`来实现跳过密码校验。\n\n![Untitled](http://qiniu-image.gotojava.cn/blog/2023-12-15-191107.png)\n\n修改完成后，需要通过 `systemctl restart mysqld`重启MySQL服务，使配置文件的内容生效。\n\n通过mysql  -u root -p来登陆MySQL服务器，因为我们跳过了密码校验，所以在提示：“Enter password”时，回车即可。像下面这样：\n\n![Untitled](http://qiniu-image.gotojava.cn/blog/2023-12-15-191110.png)\n\n<aside>\n⚠️ 如果需要恢复密码验证，则移除”`skip_grant_tables`”这行内容，重启MySQL服务就可以了。\n\n</aside>\n\n> 修改root密码\n\n```sql\n# 修改当前登陆用户的密码为root\nmysql> ALTER USER user() identified by \"root\";\nQuery OK, 0 rows affected (0.00 sec)\n\n# 遇到：MySQL ERROR 1819 (HY000): Your password does not satisfy the current policy requirements 问题参考：https://ostechnix.com/fix-mysql-error-1819-hy000-your-password-does-not-satisfy-the-current-policy-requirements/\n\n# 刷新权限\nmysql> flush privileges;\nQuery OK, 0 rows affected (0.00 sec)\n```\n\n### 开放远程连接\n\n默认情况下MySQL是不允许本地以外的其他服务器远程访问的，这个时候需要我们进行授权操作。\n\n```sql\n# 打开mysql数据库\nmysql> use mysql;\nReading table information for completion of table and column names\nYou can turn off this feature to get a quicker startup with -A\nDatabase changed\n# 修改记录，允许远程访问\nmysql> update user set host = '%' where user ='root';\nQuery OK, 1 row affected (0.00 sec)\nRows matched: 1  Changed: 1  Warnings: 0\n# 刷新权限信息\nmysql> flush privileges;\nQuery OK, 0 rows affected (0.00 sec)\n```\n\n```sql\n# 开放防火墙3306端口\n[root@centos7 ~]# firewall-cmd --zone=public --add-port=3306/tcp --permanent\n# 刷新防火墙规则\n[root@centos7 ~]# firewall-cmd --reload\n# 移除3306端口\n[root@centos7 ~]# firewall-cmd --zone=public --remove-port=3306/tcp --permanent\n# 查看当前防火墙规则列表\n[root@centos7 ~]# firewall-cmd --list-all\n```\n\n### 获取服务器状态信息\n\n```sql\nmysql> status\n--------------\nmysql  Ver 14.14 Distrib 5.7.41, for Linux (x86_64) using  EditLine wrapper\n\nConnection id:          12\nCurrent database:       mysql\nCurrent user:           root@localhost\nSSL:                    Not in use\nCurrent pager:          stdout\nUsing outfile:          ''\nUsing delimiter:        ;\nServer version:         5.7.41 MySQL Community Server (GPL)\nProtocol version:       10\nConnection:             Localhost via UNIX socket\nServer characterset:    latin1\nDb     characterset:    latin1\nClient characterset:    utf8\nConn.  characterset:    utf8\nUNIX socket:            /var/lib/mysql/mysql.sock\nUptime:                 33 min 20 sec\n\nThreads: 1  Questions: 116  Slow queries: 0  Opens: 175  Flush tables: 1  Open tables: 168  Queries per second avg: 0.058\n--------------\n```\n\n### MySQL安装目录说明\n\n| 文件夹             | 文件夹内容                                       |\n| ------------------ | ------------------------------------------------ |\n| /var/bin           | 客户端和脚本（mysqladmin、mysqldump等命令）      |\n| /usr/sbin          | mysqld服务器                                     |\n| /var/lib/mysql     | 日志文件、socket文件和数据库                     |\n| /usr/share/info    | 信息格式的手册                                   |\n| /usr/share/man     | UNIX帮助页                                       |\n| /usr/include/mysql | 头文件                                           |\n| /usr/lib/mysql     | MySQL的依赖库                                    |\n| /usr/share/mysql   | 错误消息、字符集、安装文件和配置文件             |\n| /etc/rc.d/init.d/  | 启动脚本文件的mysql目录，用来启动和停止MySQL服务 |\n\n### MySQL数据目录说明\n\n<aside>\n⚠️ MySQL数据目录的位置可以通过/etc/my.cnf配置文件中的datadir配置获得。\n\n</aside>\n\n![Untitled](http://qiniu-image.gotojava.cn/blog/2023-12-15-191111.png)\n\n| 文件名称                                                                                           | 作用                                                                                           |\n| -------------------------------------------------------------------------------------------------- | ---------------------------------------------------------------------------------------------- |\n| auto.cnf                                                                                           | MySQL服务器的选项文件，用于存储server-uuid的值，server-uuid用于标识MySQL实例在集群中的唯一性。 |\n| ca-key.pem                                                                                         | CA 私钥, 用于生成服务器端/客户端的数字证书                                                     |\n| ca.pem                                                                                             | CA 证书, 用于生成服务器端/客户端的数字证书                                                     |\n| client-cert.pem                                                                                    | 客户端连接时使用的证书                                                                         |\n| client-key.pem                                                                                     | 客户端连接时使用的私钥                                                                         |\n| ib_buffer_pool                                                                                     | InnoDB引擎的缓存数据文件，用于存储缓存                                                         |\n| ibdata1                                                                                            | 共享表空间（系统表空间），如果使用的是InnoDB引擎，默认大小为10M                                |\n| ib_logfile0                                                                                        | 支持事务性引擎的redo日志文件                                                                   |\n| ib_logfile1                                                                                        | 支持事务性引擎的redo日志文件                                                                   |\n| ibtmp1                                                                                             | 存储临时对象的空间，比如临时表对象等                                                           |\n| mysql.sock                                                                                         | Socket连接的文件，用于MySQL客户端和MySQL服务器的本地连接（同一机器）                           |\n| mysql.sock.lock                                                                                    | MySQL的一个文件锁，用于控制并发访问数据库的情况                                                |\n| private_key.pem                                                                                    | 密钥对的私钥                                                                                   |\n| public_key.pem                                                                                     | 密钥对的公钥                                                                                   |\n| server-cert.pem                                                                                    | 服务器端的数字证书                                                                             |\n| server-key.pem                                                                                     | 服务器端的 RSA 私钥                                                                            |\n| mysql、performance_schema、sys                                                                     | 系统的内置数据库：                                                                             |\n| information_schema：存储了数据库对象信息，包括用户表信息、列信息、权限信息、字符集信息、分区信息； |                                                                                                |\n| mysql：负责存储数据库用户、用户访问权限信息；                                                      |                                                                                                |\n| sys：MySQL5.7版本的数据库，提供了一些视图，用于帮助开发者和使用者更方便地查看性能问题。            |                                                                                                |\n\n- test是我们自己创建的测试库，结构如下：\n\n![Untitled](http://qiniu-image.gotojava.cn/blog/2023-12-15-191112.png)\n\ndb.opt：用来保存数据库的配置信息，比如该库的默认字符集编码和字符集排序规则。\n\n> InnoDB引擎\n\n*.frm：用来保存每个数据表的元数据和表结构信息，当数据库崩溃时，可以用.frm文件恢复表结构。\n\n*.ibd：用来存储表的数据。\n\n> MyISAM引擎\n\n*.MYD：存储MyISAM表的数据。\n\n*.MYI：存储MyISAM表的索引及相关信息。\n\n<aside>\n⚠️ 在MySQL中，一个数据库可以使用多个存储引擎。所以该数据库下可能既存在InnoDB引擎的文件，也存在MyISAM引擎的文件。\n\n</aside>\n\n### MySQL配置文件（my.cnf）\n\n> 服务器端参数“[mysqld]”\n\n| 参数名称                       | 说明                                                                                                                                          |\n| ------------------------------ | --------------------------------------------------------------------------------------------------------------------------------------------- |\n| port                           | 表示MySQL服务器的端口号                                                                                                                       |\n| basedir                        | 表示MySQL的安装路径                                                                                                                           |\n| datadir                        | MySQL数据文件的存储位置                                                                                                                       |\n| default_character_set          | 服务端默认的字符集                                                                                                                            |\n| default_storage_engine         | 创建数据表时，默认使用的存储引擎                                                                                                              |\n| sql_mode                       | sql模式的参数，该参数可以检验SQL语句的严格程度。sql_mode的参数参考：http://www.gamecolg.com/program_m_onvideo_m_inkey_m_gta1662479699017.html |\n| max_connections                | 允许同时访问服务器的最大连接数                                                                                                                |\n| query_cache_size               | 查询时的缓存大小                                                                                                                              |\n| table_open_cache               | 表示所有进程打开表的总数                                                                                                                      |\n| tmp_table_size                 | 内存中每个临时表允许的最大大小                                                                                                                |\n| thread_cache_size              | 缓存的最大线程数                                                                                                                              |\n| myisam_max_sort_file_size      | MySQL重建索引时所允许的最大临时文件大小                                                                                                       |\n| myisam_sort_buffer_size        | 重建索引时的缓存大小                                                                                                                          |\n| key_buffer_size                | 关键词的缓存大小                                                                                                                              |\n| read_buffer_size               | MyISAM全表扫描的缓存大小                                                                                                                      |\n| read_rnd_buffer_size           | 表示将排序好的数据存入该缓存中                                                                                                                |\n| sort_buffer_size               | 表示用于排序的缓存大小                                                                                                                        |\n| innodb_log_file_size           | InnoDB日志文件的大小                                                                                                                          |\n| innodb_log_buffer_size         | 用于存储日志数据的缓存区大小                                                                                                                  |\n| innodb_buffer_pool_size        | 缓存的大小，InnoDB使用一个缓冲池保存索引和原始数据                                                                                            |\n| innodb_thread_concurrency      | InnoDB存储引擎允许的线程最大数                                                                                                                |\n| innodb_flush_log_at_trx_commit | 提交日志的时机，为1时会在每次提交后将事务日志写入到磁盘上                                                                                     |\n\n## 问题记录\n\n### CentOS7忘记密码怎么办？\n\n[CentOS7如果忘记密码，密码重置详细步骤_centos修改密码忘记密码-CSDN博客](https://blog.csdn.net/qq_45887180/article/details/115819136)\n\n### ERROR 1820（HY000）\n\n错误提示：You must reset your password using ALTER USER statement before executing this statement.\n\n解决方案：[MySQL 报错：ERROR 1820 (HY000): You must reset your password using ALTER USER statement before-CSDN博客](https://blog.csdn.net/Wing_kin666/article/details/110921440)\n","slug":"Linux环境下的MySQL的安装和配置","published":1,"updated":"2025-03-28T06:10:16.060Z","comments":1,"layout":"post","photos":[],"_id":"cm8se3td70007bb8l0lrd3fem","content":"<meta name=\"referrer\" content=\"no-referrer\" />\n\n<p>本文记录MySQL5.7在CentOS7环境下的安装和配置过程。</p>\n<span id=\"more\"></span>\n\n<h2 id=\"新特性\"><a href=\"#新特性\" class=\"headerlink\" title=\"新特性\"></a>新特性</h2><p>MySQL5.7有以下几个方面的新功能</p>\n<ol>\n<li>随机root密码</li>\n</ol>\n<p>MySQL5.7数据库初始化完成后，会自动生成一个root@localhost的用户，root用户的密码不为空，而是随机产生一个密码。</p>\n<ol start=\"2\">\n<li>默认SSL加密</li>\n</ol>\n<p>MySQL5.7采用了更加简单的SSL安全访问机制，默认连接使用SSL的加密方式。</p>\n<ol start=\"3\">\n<li>密码过期策略</li>\n</ol>\n<p>MySQL5.7支持用户设置密码过期策略，要求用户在一定时间过后必须修改密码。</p>\n<ol start=\"4\">\n<li>用户锁</li>\n</ol>\n<p>MySQL5.7为管理员提供了暂时禁用某个用户的功能，使被锁定的用户无法访问和使用数据库。</p>\n<ol start=\"5\">\n<li>全面支持JSON</li>\n</ol>\n<p>随着非结构化数据存储需求的持久增长，各种非结构化数据存储的数据应运而生，各大关系型数据库也不甘示弱，纷纷提供对JSON的支持，以应对非结构化数据库的挑战。</p>\n<p>MySQL5.7也提供了对JSON的支持，在服务器端提供了一组便于操作JSON的函数。存储的方法是将JOSN编码成BLOB后再由存储引擎进行处理。这样MySQL就同时拥有了关系型数据库和非关系型数据库的优点，并且可以提供完整的事务支持。</p>\n<ol>\n<li>支持两类生成列</li>\n</ol>\n<p>生成列是通过数据库中的其他列计算得到的一列。当为生成列创建索引时，可以便捷地加快查询速度。MySQL5.7支持虚拟生成列和存储生成列。虚拟生成列只是将数据保存在表的元数据中，作为缺省的生成列类型；存储生成列则是将数据永久保存在磁盘上，需要更多的磁盘空间。</p>\n<ol start=\"2\">\n<li>引入系统库</li>\n</ol>\n<p>系统库中包含一系列视图、函数和存储过程，通过多线程、多进程、组合事务提交和基于行的优化方式将复制功能提高5倍以上，用户向外扩充其跨商品系统的工作负载时，得以大幅度提升复制的效能和效率。</p>\n<h2 id=\"下载\"><a href=\"#下载\" class=\"headerlink\" title=\"下载\"></a>下载</h2><p>MySQL的版本分为：</p>\n<ul>\n<li>企业版</li>\n</ul>\n<p>MySQL企业版主要面向企业用户，不遵守社区版本的GPL开源协议。享受Oracle公司的7*24h的电话支持服务以及补丁更新服务（企业为此需要支付费用）。</p>\n<ul>\n<li>社区版</li>\n</ul>\n<p>社区版的维护由MySQL的开源社区提供支持，不能像商业版那样获取Oracle的电话支持和补丁服务。社区版是免费获取。MySQL的社区版可通过官网<a href=\"https://dev.mysql.com/downloads/mysql/\">MySQL Communify Downloads</a>获取。本文也主要针对该版本进行测试。</p>\n<h2 id=\"安装\"><a href=\"#安装\" class=\"headerlink\" title=\"安装\"></a>安装</h2><p>实验使用环境为：</p>\n<p>操作系统（虚拟机环境）：CentOS Linux release 7.5.1804 (Core)</p>\n<p>MySQL版本：mysql-5.7.41-1.el7.x86_64</p>\n<figure class=\"highlight sql\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br><span class=\"line\">38</span><br><span class=\"line\">39</span><br><span class=\"line\">40</span><br><span class=\"line\">41</span><br><span class=\"line\">42</span><br><span class=\"line\">43</span><br><span class=\"line\">44</span><br><span class=\"line\">45</span><br><span class=\"line\">46</span><br><span class=\"line\">47</span><br><span class=\"line\">48</span><br><span class=\"line\">49</span><br><span class=\"line\">50</span><br><span class=\"line\">51</span><br><span class=\"line\">52</span><br><span class=\"line\">53</span><br><span class=\"line\">54</span><br><span class=\"line\">55</span><br><span class=\"line\">56</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">[root<span class=\"variable\">@centos7</span> <span class=\"operator\">~</span>]# ls</span><br><span class=\"line\">anaconda<span class=\"operator\">-</span>ks.cfg  mysql<span class=\"number\">-5.7</span><span class=\"number\">.41</span><span class=\"number\">-1.</span>el7.x86_64.rpm<span class=\"operator\">-</span>bundle.tar</span><br><span class=\"line\"># 解压归档tar包</span><br><span class=\"line\">[root<span class=\"variable\">@centos7</span> <span class=\"operator\">~</span>]# tar <span class=\"operator\">-</span>xf mysql<span class=\"number\">-5.7</span><span class=\"number\">.41</span><span class=\"number\">-1.</span>el7.x86_64.rpm<span class=\"operator\">-</span>bundle.tar</span><br><span class=\"line\"></span><br><span class=\"line\"># 卸载关于mariadb的依赖包文件，一台服务器只能安装一个MySQL<span class=\"operator\">/</span>MariaDB软件</span><br><span class=\"line\">[root<span class=\"variable\">@centos7</span> <span class=\"operator\">~</span>]# rpm <span class=\"operator\">-</span>qa <span class=\"operator\">|</span> grep mariadb</span><br><span class=\"line\">mariadb<span class=\"operator\">-</span>libs<span class=\"number\">-5.5</span><span class=\"number\">.56</span><span class=\"number\">-2.</span>el7.x86_64</span><br><span class=\"line\"># <span class=\"operator\">-</span>e：删除指定的包；<span class=\"comment\">--nodeps：在安装时不检查依赖关系</span></span><br><span class=\"line\">[root<span class=\"variable\">@centos7</span> <span class=\"operator\">~</span>]# rpm <span class=\"operator\">-</span>e <span class=\"comment\">--nodeps mariadb-libs-5.5.56-2.el7.x86_64</span></span><br><span class=\"line\"></span><br><span class=\"line\"># 服务器和客户端库的通用文件</span><br><span class=\"line\">[root<span class=\"variable\">@centos7</span> <span class=\"operator\">~</span>]# rpm <span class=\"operator\">-</span>ivh mysql<span class=\"operator\">-</span>community<span class=\"operator\">-</span>common<span class=\"number\">-5.7</span><span class=\"number\">.41</span><span class=\"number\">-1.</span>el7.x86_64.rpm </span><br><span class=\"line\">警告：mysql<span class=\"operator\">-</span>community<span class=\"operator\">-</span>common<span class=\"number\">-5.7</span><span class=\"number\">.41</span><span class=\"number\">-1.</span>el7.x86_64.rpm: 头V4 RSA<span class=\"operator\">/</span>SHA256 Signature, 密钥 ID <span class=\"number\">3</span>a79bd29: NOKEY</span><br><span class=\"line\">准备中...                          ################################# [<span class=\"number\">100</span><span class=\"operator\">%</span>]</span><br><span class=\"line\">正在升级<span class=\"operator\">/</span>安装...</span><br><span class=\"line\">   <span class=\"number\">1</span>:mysql<span class=\"operator\">-</span>community<span class=\"operator\">-</span>common<span class=\"number\">-5.7</span><span class=\"number\">.41</span><span class=\"number\">-1.</span>e################################# [<span class=\"number\">100</span><span class=\"operator\">%</span>]</span><br><span class=\"line\"></span><br><span class=\"line\"># MySQL数据库客户端应用程序的共享库</span><br><span class=\"line\">[root<span class=\"variable\">@centos7</span> <span class=\"operator\">~</span>]# rpm <span class=\"operator\">-</span>ivh mysql<span class=\"operator\">-</span>community<span class=\"operator\">-</span>libs<span class=\"number\">-5.7</span><span class=\"number\">.41</span><span class=\"number\">-1.</span>el7.x86_64.rpm </span><br><span class=\"line\">警告：mysql<span class=\"operator\">-</span>community<span class=\"operator\">-</span>libs<span class=\"number\">-5.7</span><span class=\"number\">.41</span><span class=\"number\">-1.</span>el7.x86_64.rpm: 头V4 RSA<span class=\"operator\">/</span>SHA256 Signature, 密钥 ID <span class=\"number\">3</span>a79bd29: NOKEY</span><br><span class=\"line\">准备中...                          ################################# [<span class=\"number\">100</span><span class=\"operator\">%</span>]</span><br><span class=\"line\">正在升级<span class=\"operator\">/</span>安装...</span><br><span class=\"line\">   <span class=\"number\">1</span>:mysql<span class=\"operator\">-</span>community<span class=\"operator\">-</span>libs<span class=\"number\">-5.7</span><span class=\"number\">.41</span><span class=\"number\">-1.</span>el7################################# [<span class=\"number\">100</span><span class=\"operator\">%</span>]</span><br><span class=\"line\"></span><br><span class=\"line\"># MySQL客户端应用程序和工具</span><br><span class=\"line\">[root<span class=\"variable\">@centos7</span> <span class=\"operator\">~</span>]# rpm <span class=\"operator\">-</span>ivh mysql<span class=\"operator\">-</span>community<span class=\"operator\">-</span>client<span class=\"number\">-5.7</span><span class=\"number\">.41</span><span class=\"number\">-1.</span>el7.x86_64.rpm </span><br><span class=\"line\">警告：mysql<span class=\"operator\">-</span>community<span class=\"operator\">-</span>client<span class=\"number\">-5.7</span><span class=\"number\">.41</span><span class=\"number\">-1.</span>el7.x86_64.rpm: 头V4 RSA<span class=\"operator\">/</span>SHA256 Signature, 密钥 ID <span class=\"number\">3</span>a79bd29: NOKEY</span><br><span class=\"line\">准备中...                          ################################# [<span class=\"number\">100</span><span class=\"operator\">%</span>]</span><br><span class=\"line\">正在升级<span class=\"operator\">/</span>安装...</span><br><span class=\"line\">   <span class=\"number\">1</span>:mysql<span class=\"operator\">-</span>community<span class=\"operator\">-</span>client<span class=\"number\">-5.7</span><span class=\"number\">.41</span><span class=\"number\">-1.</span>e################################# [<span class=\"number\">100</span><span class=\"operator\">%</span>]</span><br><span class=\"line\"></span><br><span class=\"line\"># 数据库服务器和相关工具 </span><br><span class=\"line\">[root<span class=\"variable\">@centos7</span> <span class=\"operator\">~</span>]# rpm <span class=\"operator\">-</span>ivh mysql<span class=\"operator\">-</span>community<span class=\"operator\">-</span>server<span class=\"number\">-5.7</span><span class=\"number\">.41</span><span class=\"number\">-1.</span>el7.x86_64.rpm </span><br><span class=\"line\">警告：mysql<span class=\"operator\">-</span>community<span class=\"operator\">-</span>server<span class=\"number\">-5.7</span><span class=\"number\">.41</span><span class=\"number\">-1.</span>el7.x86_64.rpm: 头V4 RSA<span class=\"operator\">/</span>SHA256 Signature, 密钥 ID <span class=\"number\">3</span>a79bd29: NOKEY</span><br><span class=\"line\">准备中...                          ################################# [<span class=\"number\">100</span><span class=\"operator\">%</span>]</span><br><span class=\"line\">正在升级<span class=\"operator\">/</span>安装...</span><br><span class=\"line\">   <span class=\"number\">1</span>:mysql<span class=\"operator\">-</span>community<span class=\"operator\">-</span>server<span class=\"number\">-5.7</span><span class=\"number\">.41</span><span class=\"number\">-1.</span>e################################# [<span class=\"number\">100</span><span class=\"operator\">%</span>]</span><br><span class=\"line\"></span><br><span class=\"line\"># 启动MySQL服务</span><br><span class=\"line\">[root<span class=\"variable\">@centos7</span> <span class=\"operator\">~</span>]# systemctl <span class=\"keyword\">start</span> mysqld</span><br><span class=\"line\"># 查看MySQL服务状态</span><br><span class=\"line\">[root<span class=\"variable\">@centos7</span> <span class=\"operator\">~</span>]# systemctl status mysqld</span><br><span class=\"line\">● mysqld.service <span class=\"operator\">-</span> MySQL Server</span><br><span class=\"line\">   Loaded: loaded (<span class=\"operator\">/</span>usr<span class=\"operator\">/</span>lib<span class=\"operator\">/</span>systemd<span class=\"operator\">/</span><span class=\"keyword\">system</span><span class=\"operator\">/</span>mysqld.service; enabled; vendor preset: disabled)</span><br><span class=\"line\">   Active: active (<span class=\"keyword\">running</span>) since 二 <span class=\"number\">2023</span><span class=\"number\">-11</span><span class=\"number\">-07</span> <span class=\"number\">01</span>:<span class=\"number\">08</span>:<span class=\"number\">56</span> CST; <span class=\"number\">2</span>s ago</span><br><span class=\"line\">     Docs: man:mysqld(<span class=\"number\">8</span>)</span><br><span class=\"line\">           http:<span class=\"operator\">/</span><span class=\"operator\">/</span>dev.mysql.com<span class=\"operator\">/</span>doc<span class=\"operator\">/</span>refman<span class=\"operator\">/</span>en<span class=\"operator\">/</span><span class=\"keyword\">using</span><span class=\"operator\">-</span>systemd.html</span><br><span class=\"line\">  Process: <span class=\"number\">12837</span> ExecStart<span class=\"operator\">=</span><span class=\"operator\">/</span>usr<span class=\"operator\">/</span>sbin<span class=\"operator\">/</span>mysqld <span class=\"comment\">--daemonize --pid-file=/var/run/mysqld/mysqld.pid $MYSQLD_OPTS (code=exited, status=0/SUCCESS)</span></span><br><span class=\"line\">  Process: <span class=\"number\">12722</span> ExecStartPre<span class=\"operator\">=</span><span class=\"operator\">/</span>usr<span class=\"operator\">/</span>bin<span class=\"operator\">/</span>mysqld_pre_systemd (code<span class=\"operator\">=</span>exited, status<span class=\"operator\">=</span><span class=\"number\">0</span><span class=\"operator\">/</span>SUCCESS)</span><br><span class=\"line\"> Main PID: <span class=\"number\">12840</span> (mysqld)</span><br><span class=\"line\">   CGroup: <span class=\"operator\">/</span>system.slice<span class=\"operator\">/</span>mysqld.service</span><br><span class=\"line\">           └─<span class=\"number\">12840</span> <span class=\"operator\">/</span>usr<span class=\"operator\">/</span>sbin<span class=\"operator\">/</span>mysqld <span class=\"comment\">--daemonize --pid-file=/var/run/mysqld/mysqld.pid</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"number\">11</span>月 <span class=\"number\">07</span> <span class=\"number\">01</span>:<span class=\"number\">08</span>:<span class=\"number\">53</span> centos7 systemd[<span class=\"number\">1</span>]: Starting MySQL Server...</span><br><span class=\"line\"><span class=\"number\">11</span>月 <span class=\"number\">07</span> <span class=\"number\">01</span>:<span class=\"number\">08</span>:<span class=\"number\">56</span> centos7 systemd[<span class=\"number\">1</span>]: Started MySQL Server.</span><br></pre></td></tr></table></figure>\n\n<h2 id=\"配置\"><a href=\"#配置\" class=\"headerlink\" title=\"配置\"></a>配置</h2><h3 id=\"修改MySQL密码\"><a href=\"#修改MySQL密码\" class=\"headerlink\" title=\"修改MySQL密码\"></a>修改MySQL密码</h3><blockquote>\n<p>获取随机密码登陆</p>\n</blockquote>\n<p>MySQL在安装完成后，会生成一个随机密码，我们通过root用户➕随机密码便可以登陆MySQL服务器。随机密码会生成在 <code>/var/log/mysqld.log</code>中。我们可以通过 <code>tail -100f /var/log/mysqld.log | grep -i &quot;password”</code>来获取随机密码。</p>\n<p><img src=\"http://qiniu-image.gotojava.cn/blog/2023-12-15-191105.png\" alt=\"Untitled\"></p>\n<blockquote>\n<p>使用skip_grant_tables跳过密码验证</p>\n</blockquote>\n<p>也可以通过修改MySQL的配置文件my.cnf，通过跳过密码校验，来免登陆MySQL修改密码。通过在&#x2F;etc&#x2F;my.cnf配置文件中，添加 <code>skip_grant_tables</code>来实现跳过密码校验。</p>\n<p><img src=\"http://qiniu-image.gotojava.cn/blog/2023-12-15-191107.png\" alt=\"Untitled\"></p>\n<p>修改完成后，需要通过 <code>systemctl restart mysqld</code>重启MySQL服务，使配置文件的内容生效。</p>\n<p>通过mysql  -u root -p来登陆MySQL服务器，因为我们跳过了密码校验，所以在提示：“Enter password”时，回车即可。像下面这样：</p>\n<p><img src=\"http://qiniu-image.gotojava.cn/blog/2023-12-15-191110.png\" alt=\"Untitled\"></p>\n<aside>\n⚠️ 如果需要恢复密码验证，则移除”`skip_grant_tables`”这行内容，重启MySQL服务就可以了。\n\n</aside>\n\n<blockquote>\n<p>修改root密码</p>\n</blockquote>\n<figure class=\"highlight sql\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"># 修改当前登陆用户的密码为root</span><br><span class=\"line\">mysql<span class=\"operator\">&gt;</span> <span class=\"keyword\">ALTER</span> <span class=\"keyword\">USER</span> <span class=\"keyword\">user</span>() identified <span class=\"keyword\">by</span> &quot;root&quot;;</span><br><span class=\"line\">Query OK, <span class=\"number\">0</span> <span class=\"keyword\">rows</span> affected (<span class=\"number\">0.00</span> sec)</span><br><span class=\"line\"></span><br><span class=\"line\"># 遇到：MySQL ERROR <span class=\"number\">1819</span> (HY000): Your password does <span class=\"keyword\">not</span> satisfy the <span class=\"keyword\">current</span> policy requirements 问题参考：https:<span class=\"operator\">/</span><span class=\"operator\">/</span>ostechnix.com<span class=\"operator\">/</span>fix<span class=\"operator\">-</span>mysql<span class=\"operator\">-</span>error<span class=\"number\">-1819</span><span class=\"operator\">-</span>hy000<span class=\"operator\">-</span>your<span class=\"operator\">-</span>password<span class=\"operator\">-</span>does<span class=\"operator\">-</span><span class=\"keyword\">not</span><span class=\"operator\">-</span>satisfy<span class=\"operator\">-</span>the<span class=\"operator\">-</span><span class=\"keyword\">current</span><span class=\"operator\">-</span>policy<span class=\"operator\">-</span>requirements<span class=\"operator\">/</span></span><br><span class=\"line\"></span><br><span class=\"line\"># 刷新权限</span><br><span class=\"line\">mysql<span class=\"operator\">&gt;</span> flush privileges;</span><br><span class=\"line\">Query OK, <span class=\"number\">0</span> <span class=\"keyword\">rows</span> affected (<span class=\"number\">0.00</span> sec)</span><br></pre></td></tr></table></figure>\n\n<h3 id=\"开放远程连接\"><a href=\"#开放远程连接\" class=\"headerlink\" title=\"开放远程连接\"></a>开放远程连接</h3><p>默认情况下MySQL是不允许本地以外的其他服务器远程访问的，这个时候需要我们进行授权操作。</p>\n<figure class=\"highlight sql\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"># 打开mysql数据库</span><br><span class=\"line\">mysql<span class=\"operator\">&gt;</span> use mysql;</span><br><span class=\"line\">Reading <span class=\"keyword\">table</span> information <span class=\"keyword\">for</span> completion <span class=\"keyword\">of</span> <span class=\"keyword\">table</span> <span class=\"keyword\">and</span> <span class=\"keyword\">column</span> names</span><br><span class=\"line\">You can turn off this feature <span class=\"keyword\">to</span> <span class=\"keyword\">get</span> a quicker startup <span class=\"keyword\">with</span> <span class=\"operator\">-</span>A</span><br><span class=\"line\">Database changed</span><br><span class=\"line\"># 修改记录，允许远程访问</span><br><span class=\"line\">mysql<span class=\"operator\">&gt;</span> <span class=\"keyword\">update</span> <span class=\"keyword\">user</span> <span class=\"keyword\">set</span> host <span class=\"operator\">=</span> <span class=\"string\">&#x27;%&#x27;</span> <span class=\"keyword\">where</span> <span class=\"keyword\">user</span> <span class=\"operator\">=</span><span class=\"string\">&#x27;root&#x27;</span>;</span><br><span class=\"line\">Query OK, <span class=\"number\">1</span> <span class=\"type\">row</span> affected (<span class=\"number\">0.00</span> sec)</span><br><span class=\"line\"><span class=\"keyword\">Rows</span> matched: <span class=\"number\">1</span>  Changed: <span class=\"number\">1</span>  Warnings: <span class=\"number\">0</span></span><br><span class=\"line\"># 刷新权限信息</span><br><span class=\"line\">mysql<span class=\"operator\">&gt;</span> flush privileges;</span><br><span class=\"line\">Query OK, <span class=\"number\">0</span> <span class=\"keyword\">rows</span> affected (<span class=\"number\">0.00</span> sec)</span><br></pre></td></tr></table></figure>\n\n<figure class=\"highlight sql\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"># 开放防火墙<span class=\"number\">3306</span>端口</span><br><span class=\"line\">[root<span class=\"variable\">@centos7</span> <span class=\"operator\">~</span>]# firewall<span class=\"operator\">-</span>cmd <span class=\"comment\">--zone=public --add-port=3306/tcp --permanent</span></span><br><span class=\"line\"># 刷新防火墙规则</span><br><span class=\"line\">[root<span class=\"variable\">@centos7</span> <span class=\"operator\">~</span>]# firewall<span class=\"operator\">-</span>cmd <span class=\"comment\">--reload</span></span><br><span class=\"line\"># 移除<span class=\"number\">3306</span>端口</span><br><span class=\"line\">[root<span class=\"variable\">@centos7</span> <span class=\"operator\">~</span>]# firewall<span class=\"operator\">-</span>cmd <span class=\"comment\">--zone=public --remove-port=3306/tcp --permanent</span></span><br><span class=\"line\"># 查看当前防火墙规则列表</span><br><span class=\"line\">[root<span class=\"variable\">@centos7</span> <span class=\"operator\">~</span>]# firewall<span class=\"operator\">-</span>cmd <span class=\"comment\">--list-all</span></span><br></pre></td></tr></table></figure>\n\n<h3 id=\"获取服务器状态信息\"><a href=\"#获取服务器状态信息\" class=\"headerlink\" title=\"获取服务器状态信息\"></a>获取服务器状态信息</h3><figure class=\"highlight sql\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">mysql<span class=\"operator\">&gt;</span> status</span><br><span class=\"line\"><span class=\"comment\">--------------</span></span><br><span class=\"line\">mysql  Ver <span class=\"number\">14.14</span> Distrib <span class=\"number\">5.7</span><span class=\"number\">.41</span>, <span class=\"keyword\">for</span> Linux (x86_64) <span class=\"keyword\">using</span>  EditLine wrapper</span><br><span class=\"line\"></span><br><span class=\"line\">Connection id:          <span class=\"number\">12</span></span><br><span class=\"line\"><span class=\"keyword\">Current</span> database:       mysql</span><br><span class=\"line\"><span class=\"keyword\">Current</span> <span class=\"keyword\">user</span>:           root<span class=\"variable\">@localhost</span></span><br><span class=\"line\">SSL:                    <span class=\"keyword\">Not</span> <span class=\"keyword\">in</span> use</span><br><span class=\"line\"><span class=\"keyword\">Current</span> pager:          stdout</span><br><span class=\"line\"><span class=\"keyword\">Using</span> outfile:          <span class=\"string\">&#x27;&#x27;</span></span><br><span class=\"line\"><span class=\"keyword\">Using</span> delimiter:        ;</span><br><span class=\"line\">Server version:         <span class=\"number\">5.7</span><span class=\"number\">.41</span> MySQL Community Server (GPL)</span><br><span class=\"line\">Protocol version:       <span class=\"number\">10</span></span><br><span class=\"line\">Connection:             Localhost via UNIX socket</span><br><span class=\"line\">Server characterset:    latin1</span><br><span class=\"line\">Db     characterset:    latin1</span><br><span class=\"line\">Client characterset:    utf8</span><br><span class=\"line\">Conn.  characterset:    utf8</span><br><span class=\"line\">UNIX socket:            <span class=\"operator\">/</span>var<span class=\"operator\">/</span>lib<span class=\"operator\">/</span>mysql<span class=\"operator\">/</span>mysql.sock</span><br><span class=\"line\">Uptime:                 <span class=\"number\">33</span> min <span class=\"number\">20</span> sec</span><br><span class=\"line\"></span><br><span class=\"line\">Threads: <span class=\"number\">1</span>  Questions: <span class=\"number\">116</span>  Slow queries: <span class=\"number\">0</span>  Opens: <span class=\"number\">175</span>  Flush tables: <span class=\"number\">1</span>  <span class=\"keyword\">Open</span> tables: <span class=\"number\">168</span>  Queries <span class=\"keyword\">per</span> <span class=\"keyword\">second</span> avg: <span class=\"number\">0.058</span></span><br><span class=\"line\"><span class=\"comment\">--------------</span></span><br></pre></td></tr></table></figure>\n\n<h3 id=\"MySQL安装目录说明\"><a href=\"#MySQL安装目录说明\" class=\"headerlink\" title=\"MySQL安装目录说明\"></a>MySQL安装目录说明</h3><table>\n<thead>\n<tr>\n<th>文件夹</th>\n<th>文件夹内容</th>\n</tr>\n</thead>\n<tbody><tr>\n<td>&#x2F;var&#x2F;bin</td>\n<td>客户端和脚本（mysqladmin、mysqldump等命令）</td>\n</tr>\n<tr>\n<td>&#x2F;usr&#x2F;sbin</td>\n<td>mysqld服务器</td>\n</tr>\n<tr>\n<td>&#x2F;var&#x2F;lib&#x2F;mysql</td>\n<td>日志文件、socket文件和数据库</td>\n</tr>\n<tr>\n<td>&#x2F;usr&#x2F;share&#x2F;info</td>\n<td>信息格式的手册</td>\n</tr>\n<tr>\n<td>&#x2F;usr&#x2F;share&#x2F;man</td>\n<td>UNIX帮助页</td>\n</tr>\n<tr>\n<td>&#x2F;usr&#x2F;include&#x2F;mysql</td>\n<td>头文件</td>\n</tr>\n<tr>\n<td>&#x2F;usr&#x2F;lib&#x2F;mysql</td>\n<td>MySQL的依赖库</td>\n</tr>\n<tr>\n<td>&#x2F;usr&#x2F;share&#x2F;mysql</td>\n<td>错误消息、字符集、安装文件和配置文件</td>\n</tr>\n<tr>\n<td>&#x2F;etc&#x2F;rc.d&#x2F;init.d&#x2F;</td>\n<td>启动脚本文件的mysql目录，用来启动和停止MySQL服务</td>\n</tr>\n</tbody></table>\n<h3 id=\"MySQL数据目录说明\"><a href=\"#MySQL数据目录说明\" class=\"headerlink\" title=\"MySQL数据目录说明\"></a>MySQL数据目录说明</h3><aside>\n⚠️ MySQL数据目录的位置可以通过/etc/my.cnf配置文件中的datadir配置获得。\n\n</aside>\n\n<p><img src=\"http://qiniu-image.gotojava.cn/blog/2023-12-15-191111.png\" alt=\"Untitled\"></p>\n<table>\n<thead>\n<tr>\n<th>文件名称</th>\n<th>作用</th>\n</tr>\n</thead>\n<tbody><tr>\n<td>auto.cnf</td>\n<td>MySQL服务器的选项文件，用于存储server-uuid的值，server-uuid用于标识MySQL实例在集群中的唯一性。</td>\n</tr>\n<tr>\n<td>ca-key.pem</td>\n<td>CA 私钥, 用于生成服务器端&#x2F;客户端的数字证书</td>\n</tr>\n<tr>\n<td>ca.pem</td>\n<td>CA 证书, 用于生成服务器端&#x2F;客户端的数字证书</td>\n</tr>\n<tr>\n<td>client-cert.pem</td>\n<td>客户端连接时使用的证书</td>\n</tr>\n<tr>\n<td>client-key.pem</td>\n<td>客户端连接时使用的私钥</td>\n</tr>\n<tr>\n<td>ib_buffer_pool</td>\n<td>InnoDB引擎的缓存数据文件，用于存储缓存</td>\n</tr>\n<tr>\n<td>ibdata1</td>\n<td>共享表空间（系统表空间），如果使用的是InnoDB引擎，默认大小为10M</td>\n</tr>\n<tr>\n<td>ib_logfile0</td>\n<td>支持事务性引擎的redo日志文件</td>\n</tr>\n<tr>\n<td>ib_logfile1</td>\n<td>支持事务性引擎的redo日志文件</td>\n</tr>\n<tr>\n<td>ibtmp1</td>\n<td>存储临时对象的空间，比如临时表对象等</td>\n</tr>\n<tr>\n<td>mysql.sock</td>\n<td>Socket连接的文件，用于MySQL客户端和MySQL服务器的本地连接（同一机器）</td>\n</tr>\n<tr>\n<td>mysql.sock.lock</td>\n<td>MySQL的一个文件锁，用于控制并发访问数据库的情况</td>\n</tr>\n<tr>\n<td>private_key.pem</td>\n<td>密钥对的私钥</td>\n</tr>\n<tr>\n<td>public_key.pem</td>\n<td>密钥对的公钥</td>\n</tr>\n<tr>\n<td>server-cert.pem</td>\n<td>服务器端的数字证书</td>\n</tr>\n<tr>\n<td>server-key.pem</td>\n<td>服务器端的 RSA 私钥</td>\n</tr>\n<tr>\n<td>mysql、performance_schema、sys</td>\n<td>系统的内置数据库：</td>\n</tr>\n<tr>\n<td>information_schema：存储了数据库对象信息，包括用户表信息、列信息、权限信息、字符集信息、分区信息；</td>\n<td></td>\n</tr>\n<tr>\n<td>mysql：负责存储数据库用户、用户访问权限信息；</td>\n<td></td>\n</tr>\n<tr>\n<td>sys：MySQL5.7版本的数据库，提供了一些视图，用于帮助开发者和使用者更方便地查看性能问题。</td>\n<td></td>\n</tr>\n</tbody></table>\n<ul>\n<li>test是我们自己创建的测试库，结构如下：</li>\n</ul>\n<p><img src=\"http://qiniu-image.gotojava.cn/blog/2023-12-15-191112.png\" alt=\"Untitled\"></p>\n<p>db.opt：用来保存数据库的配置信息，比如该库的默认字符集编码和字符集排序规则。</p>\n<blockquote>\n<p>InnoDB引擎</p>\n</blockquote>\n<p>*.frm：用来保存每个数据表的元数据和表结构信息，当数据库崩溃时，可以用.frm文件恢复表结构。</p>\n<p>*.ibd：用来存储表的数据。</p>\n<blockquote>\n<p>MyISAM引擎</p>\n</blockquote>\n<p>*.MYD：存储MyISAM表的数据。</p>\n<p>*.MYI：存储MyISAM表的索引及相关信息。</p>\n<aside>\n⚠️ 在MySQL中，一个数据库可以使用多个存储引擎。所以该数据库下可能既存在InnoDB引擎的文件，也存在MyISAM引擎的文件。\n\n</aside>\n\n<h3 id=\"MySQL配置文件（my-cnf）\"><a href=\"#MySQL配置文件（my-cnf）\" class=\"headerlink\" title=\"MySQL配置文件（my.cnf）\"></a>MySQL配置文件（my.cnf）</h3><blockquote>\n<p>服务器端参数“[mysqld]”</p>\n</blockquote>\n<table>\n<thead>\n<tr>\n<th>参数名称</th>\n<th>说明</th>\n</tr>\n</thead>\n<tbody><tr>\n<td>port</td>\n<td>表示MySQL服务器的端口号</td>\n</tr>\n<tr>\n<td>basedir</td>\n<td>表示MySQL的安装路径</td>\n</tr>\n<tr>\n<td>datadir</td>\n<td>MySQL数据文件的存储位置</td>\n</tr>\n<tr>\n<td>default_character_set</td>\n<td>服务端默认的字符集</td>\n</tr>\n<tr>\n<td>default_storage_engine</td>\n<td>创建数据表时，默认使用的存储引擎</td>\n</tr>\n<tr>\n<td>sql_mode</td>\n<td>sql模式的参数，该参数可以检验SQL语句的严格程度。sql_mode的参数参考：<a href=\"http://www.gamecolg.com/program_m_onvideo_m_inkey_m_gta1662479699017.html\">http://www.gamecolg.com/program_m_onvideo_m_inkey_m_gta1662479699017.html</a></td>\n</tr>\n<tr>\n<td>max_connections</td>\n<td>允许同时访问服务器的最大连接数</td>\n</tr>\n<tr>\n<td>query_cache_size</td>\n<td>查询时的缓存大小</td>\n</tr>\n<tr>\n<td>table_open_cache</td>\n<td>表示所有进程打开表的总数</td>\n</tr>\n<tr>\n<td>tmp_table_size</td>\n<td>内存中每个临时表允许的最大大小</td>\n</tr>\n<tr>\n<td>thread_cache_size</td>\n<td>缓存的最大线程数</td>\n</tr>\n<tr>\n<td>myisam_max_sort_file_size</td>\n<td>MySQL重建索引时所允许的最大临时文件大小</td>\n</tr>\n<tr>\n<td>myisam_sort_buffer_size</td>\n<td>重建索引时的缓存大小</td>\n</tr>\n<tr>\n<td>key_buffer_size</td>\n<td>关键词的缓存大小</td>\n</tr>\n<tr>\n<td>read_buffer_size</td>\n<td>MyISAM全表扫描的缓存大小</td>\n</tr>\n<tr>\n<td>read_rnd_buffer_size</td>\n<td>表示将排序好的数据存入该缓存中</td>\n</tr>\n<tr>\n<td>sort_buffer_size</td>\n<td>表示用于排序的缓存大小</td>\n</tr>\n<tr>\n<td>innodb_log_file_size</td>\n<td>InnoDB日志文件的大小</td>\n</tr>\n<tr>\n<td>innodb_log_buffer_size</td>\n<td>用于存储日志数据的缓存区大小</td>\n</tr>\n<tr>\n<td>innodb_buffer_pool_size</td>\n<td>缓存的大小，InnoDB使用一个缓冲池保存索引和原始数据</td>\n</tr>\n<tr>\n<td>innodb_thread_concurrency</td>\n<td>InnoDB存储引擎允许的线程最大数</td>\n</tr>\n<tr>\n<td>innodb_flush_log_at_trx_commit</td>\n<td>提交日志的时机，为1时会在每次提交后将事务日志写入到磁盘上</td>\n</tr>\n</tbody></table>\n<h2 id=\"问题记录\"><a href=\"#问题记录\" class=\"headerlink\" title=\"问题记录\"></a>问题记录</h2><h3 id=\"CentOS7忘记密码怎么办？\"><a href=\"#CentOS7忘记密码怎么办？\" class=\"headerlink\" title=\"CentOS7忘记密码怎么办？\"></a>CentOS7忘记密码怎么办？</h3><p><a href=\"https://blog.csdn.net/qq_45887180/article/details/115819136\">CentOS7如果忘记密码，密码重置详细步骤_centos修改密码忘记密码-CSDN博客</a></p>\n<h3 id=\"ERROR-1820（HY000）\"><a href=\"#ERROR-1820（HY000）\" class=\"headerlink\" title=\"ERROR 1820（HY000）\"></a>ERROR 1820（HY000）</h3><p>错误提示：You must reset your password using ALTER USER statement before executing this statement.</p>\n<p>解决方案：<a href=\"https://blog.csdn.net/Wing_kin666/article/details/110921440\">MySQL 报错：ERROR 1820 (HY000): You must reset your password using ALTER USER statement before-CSDN博客</a></p>\n","excerpt":"<meta name=\"referrer\" content=\"no-referrer\" />\n\n<p>本文记录MySQL5.7在CentOS7环境下的安装和配置过程。</p>","more":"<h2 id=\"新特性\"><a href=\"#新特性\" class=\"headerlink\" title=\"新特性\"></a>新特性</h2><p>MySQL5.7有以下几个方面的新功能</p>\n<ol>\n<li>随机root密码</li>\n</ol>\n<p>MySQL5.7数据库初始化完成后，会自动生成一个root@localhost的用户，root用户的密码不为空，而是随机产生一个密码。</p>\n<ol start=\"2\">\n<li>默认SSL加密</li>\n</ol>\n<p>MySQL5.7采用了更加简单的SSL安全访问机制，默认连接使用SSL的加密方式。</p>\n<ol start=\"3\">\n<li>密码过期策略</li>\n</ol>\n<p>MySQL5.7支持用户设置密码过期策略，要求用户在一定时间过后必须修改密码。</p>\n<ol start=\"4\">\n<li>用户锁</li>\n</ol>\n<p>MySQL5.7为管理员提供了暂时禁用某个用户的功能，使被锁定的用户无法访问和使用数据库。</p>\n<ol start=\"5\">\n<li>全面支持JSON</li>\n</ol>\n<p>随着非结构化数据存储需求的持久增长，各种非结构化数据存储的数据应运而生，各大关系型数据库也不甘示弱，纷纷提供对JSON的支持，以应对非结构化数据库的挑战。</p>\n<p>MySQL5.7也提供了对JSON的支持，在服务器端提供了一组便于操作JSON的函数。存储的方法是将JOSN编码成BLOB后再由存储引擎进行处理。这样MySQL就同时拥有了关系型数据库和非关系型数据库的优点，并且可以提供完整的事务支持。</p>\n<ol>\n<li>支持两类生成列</li>\n</ol>\n<p>生成列是通过数据库中的其他列计算得到的一列。当为生成列创建索引时，可以便捷地加快查询速度。MySQL5.7支持虚拟生成列和存储生成列。虚拟生成列只是将数据保存在表的元数据中，作为缺省的生成列类型；存储生成列则是将数据永久保存在磁盘上，需要更多的磁盘空间。</p>\n<ol start=\"2\">\n<li>引入系统库</li>\n</ol>\n<p>系统库中包含一系列视图、函数和存储过程，通过多线程、多进程、组合事务提交和基于行的优化方式将复制功能提高5倍以上，用户向外扩充其跨商品系统的工作负载时，得以大幅度提升复制的效能和效率。</p>\n<h2 id=\"下载\"><a href=\"#下载\" class=\"headerlink\" title=\"下载\"></a>下载</h2><p>MySQL的版本分为：</p>\n<ul>\n<li>企业版</li>\n</ul>\n<p>MySQL企业版主要面向企业用户，不遵守社区版本的GPL开源协议。享受Oracle公司的7*24h的电话支持服务以及补丁更新服务（企业为此需要支付费用）。</p>\n<ul>\n<li>社区版</li>\n</ul>\n<p>社区版的维护由MySQL的开源社区提供支持，不能像商业版那样获取Oracle的电话支持和补丁服务。社区版是免费获取。MySQL的社区版可通过官网<a href=\"https://dev.mysql.com/downloads/mysql/\">MySQL Communify Downloads</a>获取。本文也主要针对该版本进行测试。</p>\n<h2 id=\"安装\"><a href=\"#安装\" class=\"headerlink\" title=\"安装\"></a>安装</h2><p>实验使用环境为：</p>\n<p>操作系统（虚拟机环境）：CentOS Linux release 7.5.1804 (Core)</p>\n<p>MySQL版本：mysql-5.7.41-1.el7.x86_64</p>\n<figure class=\"highlight sql\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br><span class=\"line\">38</span><br><span class=\"line\">39</span><br><span class=\"line\">40</span><br><span class=\"line\">41</span><br><span class=\"line\">42</span><br><span class=\"line\">43</span><br><span class=\"line\">44</span><br><span class=\"line\">45</span><br><span class=\"line\">46</span><br><span class=\"line\">47</span><br><span class=\"line\">48</span><br><span class=\"line\">49</span><br><span class=\"line\">50</span><br><span class=\"line\">51</span><br><span class=\"line\">52</span><br><span class=\"line\">53</span><br><span class=\"line\">54</span><br><span class=\"line\">55</span><br><span class=\"line\">56</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">[root<span class=\"variable\">@centos7</span> <span class=\"operator\">~</span>]# ls</span><br><span class=\"line\">anaconda<span class=\"operator\">-</span>ks.cfg  mysql<span class=\"number\">-5.7</span><span class=\"number\">.41</span><span class=\"number\">-1.</span>el7.x86_64.rpm<span class=\"operator\">-</span>bundle.tar</span><br><span class=\"line\"># 解压归档tar包</span><br><span class=\"line\">[root<span class=\"variable\">@centos7</span> <span class=\"operator\">~</span>]# tar <span class=\"operator\">-</span>xf mysql<span class=\"number\">-5.7</span><span class=\"number\">.41</span><span class=\"number\">-1.</span>el7.x86_64.rpm<span class=\"operator\">-</span>bundle.tar</span><br><span class=\"line\"></span><br><span class=\"line\"># 卸载关于mariadb的依赖包文件，一台服务器只能安装一个MySQL<span class=\"operator\">/</span>MariaDB软件</span><br><span class=\"line\">[root<span class=\"variable\">@centos7</span> <span class=\"operator\">~</span>]# rpm <span class=\"operator\">-</span>qa <span class=\"operator\">|</span> grep mariadb</span><br><span class=\"line\">mariadb<span class=\"operator\">-</span>libs<span class=\"number\">-5.5</span><span class=\"number\">.56</span><span class=\"number\">-2.</span>el7.x86_64</span><br><span class=\"line\"># <span class=\"operator\">-</span>e：删除指定的包；<span class=\"comment\">--nodeps：在安装时不检查依赖关系</span></span><br><span class=\"line\">[root<span class=\"variable\">@centos7</span> <span class=\"operator\">~</span>]# rpm <span class=\"operator\">-</span>e <span class=\"comment\">--nodeps mariadb-libs-5.5.56-2.el7.x86_64</span></span><br><span class=\"line\"></span><br><span class=\"line\"># 服务器和客户端库的通用文件</span><br><span class=\"line\">[root<span class=\"variable\">@centos7</span> <span class=\"operator\">~</span>]# rpm <span class=\"operator\">-</span>ivh mysql<span class=\"operator\">-</span>community<span class=\"operator\">-</span>common<span class=\"number\">-5.7</span><span class=\"number\">.41</span><span class=\"number\">-1.</span>el7.x86_64.rpm </span><br><span class=\"line\">警告：mysql<span class=\"operator\">-</span>community<span class=\"operator\">-</span>common<span class=\"number\">-5.7</span><span class=\"number\">.41</span><span class=\"number\">-1.</span>el7.x86_64.rpm: 头V4 RSA<span class=\"operator\">/</span>SHA256 Signature, 密钥 ID <span class=\"number\">3</span>a79bd29: NOKEY</span><br><span class=\"line\">准备中...                          ################################# [<span class=\"number\">100</span><span class=\"operator\">%</span>]</span><br><span class=\"line\">正在升级<span class=\"operator\">/</span>安装...</span><br><span class=\"line\">   <span class=\"number\">1</span>:mysql<span class=\"operator\">-</span>community<span class=\"operator\">-</span>common<span class=\"number\">-5.7</span><span class=\"number\">.41</span><span class=\"number\">-1.</span>e################################# [<span class=\"number\">100</span><span class=\"operator\">%</span>]</span><br><span class=\"line\"></span><br><span class=\"line\"># MySQL数据库客户端应用程序的共享库</span><br><span class=\"line\">[root<span class=\"variable\">@centos7</span> <span class=\"operator\">~</span>]# rpm <span class=\"operator\">-</span>ivh mysql<span class=\"operator\">-</span>community<span class=\"operator\">-</span>libs<span class=\"number\">-5.7</span><span class=\"number\">.41</span><span class=\"number\">-1.</span>el7.x86_64.rpm </span><br><span class=\"line\">警告：mysql<span class=\"operator\">-</span>community<span class=\"operator\">-</span>libs<span class=\"number\">-5.7</span><span class=\"number\">.41</span><span class=\"number\">-1.</span>el7.x86_64.rpm: 头V4 RSA<span class=\"operator\">/</span>SHA256 Signature, 密钥 ID <span class=\"number\">3</span>a79bd29: NOKEY</span><br><span class=\"line\">准备中...                          ################################# [<span class=\"number\">100</span><span class=\"operator\">%</span>]</span><br><span class=\"line\">正在升级<span class=\"operator\">/</span>安装...</span><br><span class=\"line\">   <span class=\"number\">1</span>:mysql<span class=\"operator\">-</span>community<span class=\"operator\">-</span>libs<span class=\"number\">-5.7</span><span class=\"number\">.41</span><span class=\"number\">-1.</span>el7################################# [<span class=\"number\">100</span><span class=\"operator\">%</span>]</span><br><span class=\"line\"></span><br><span class=\"line\"># MySQL客户端应用程序和工具</span><br><span class=\"line\">[root<span class=\"variable\">@centos7</span> <span class=\"operator\">~</span>]# rpm <span class=\"operator\">-</span>ivh mysql<span class=\"operator\">-</span>community<span class=\"operator\">-</span>client<span class=\"number\">-5.7</span><span class=\"number\">.41</span><span class=\"number\">-1.</span>el7.x86_64.rpm </span><br><span class=\"line\">警告：mysql<span class=\"operator\">-</span>community<span class=\"operator\">-</span>client<span class=\"number\">-5.7</span><span class=\"number\">.41</span><span class=\"number\">-1.</span>el7.x86_64.rpm: 头V4 RSA<span class=\"operator\">/</span>SHA256 Signature, 密钥 ID <span class=\"number\">3</span>a79bd29: NOKEY</span><br><span class=\"line\">准备中...                          ################################# [<span class=\"number\">100</span><span class=\"operator\">%</span>]</span><br><span class=\"line\">正在升级<span class=\"operator\">/</span>安装...</span><br><span class=\"line\">   <span class=\"number\">1</span>:mysql<span class=\"operator\">-</span>community<span class=\"operator\">-</span>client<span class=\"number\">-5.7</span><span class=\"number\">.41</span><span class=\"number\">-1.</span>e################################# [<span class=\"number\">100</span><span class=\"operator\">%</span>]</span><br><span class=\"line\"></span><br><span class=\"line\"># 数据库服务器和相关工具 </span><br><span class=\"line\">[root<span class=\"variable\">@centos7</span> <span class=\"operator\">~</span>]# rpm <span class=\"operator\">-</span>ivh mysql<span class=\"operator\">-</span>community<span class=\"operator\">-</span>server<span class=\"number\">-5.7</span><span class=\"number\">.41</span><span class=\"number\">-1.</span>el7.x86_64.rpm </span><br><span class=\"line\">警告：mysql<span class=\"operator\">-</span>community<span class=\"operator\">-</span>server<span class=\"number\">-5.7</span><span class=\"number\">.41</span><span class=\"number\">-1.</span>el7.x86_64.rpm: 头V4 RSA<span class=\"operator\">/</span>SHA256 Signature, 密钥 ID <span class=\"number\">3</span>a79bd29: NOKEY</span><br><span class=\"line\">准备中...                          ################################# [<span class=\"number\">100</span><span class=\"operator\">%</span>]</span><br><span class=\"line\">正在升级<span class=\"operator\">/</span>安装...</span><br><span class=\"line\">   <span class=\"number\">1</span>:mysql<span class=\"operator\">-</span>community<span class=\"operator\">-</span>server<span class=\"number\">-5.7</span><span class=\"number\">.41</span><span class=\"number\">-1.</span>e################################# [<span class=\"number\">100</span><span class=\"operator\">%</span>]</span><br><span class=\"line\"></span><br><span class=\"line\"># 启动MySQL服务</span><br><span class=\"line\">[root<span class=\"variable\">@centos7</span> <span class=\"operator\">~</span>]# systemctl <span class=\"keyword\">start</span> mysqld</span><br><span class=\"line\"># 查看MySQL服务状态</span><br><span class=\"line\">[root<span class=\"variable\">@centos7</span> <span class=\"operator\">~</span>]# systemctl status mysqld</span><br><span class=\"line\">● mysqld.service <span class=\"operator\">-</span> MySQL Server</span><br><span class=\"line\">   Loaded: loaded (<span class=\"operator\">/</span>usr<span class=\"operator\">/</span>lib<span class=\"operator\">/</span>systemd<span class=\"operator\">/</span><span class=\"keyword\">system</span><span class=\"operator\">/</span>mysqld.service; enabled; vendor preset: disabled)</span><br><span class=\"line\">   Active: active (<span class=\"keyword\">running</span>) since 二 <span class=\"number\">2023</span><span class=\"number\">-11</span><span class=\"number\">-07</span> <span class=\"number\">01</span>:<span class=\"number\">08</span>:<span class=\"number\">56</span> CST; <span class=\"number\">2</span>s ago</span><br><span class=\"line\">     Docs: man:mysqld(<span class=\"number\">8</span>)</span><br><span class=\"line\">           http:<span class=\"operator\">/</span><span class=\"operator\">/</span>dev.mysql.com<span class=\"operator\">/</span>doc<span class=\"operator\">/</span>refman<span class=\"operator\">/</span>en<span class=\"operator\">/</span><span class=\"keyword\">using</span><span class=\"operator\">-</span>systemd.html</span><br><span class=\"line\">  Process: <span class=\"number\">12837</span> ExecStart<span class=\"operator\">=</span><span class=\"operator\">/</span>usr<span class=\"operator\">/</span>sbin<span class=\"operator\">/</span>mysqld <span class=\"comment\">--daemonize --pid-file=/var/run/mysqld/mysqld.pid $MYSQLD_OPTS (code=exited, status=0/SUCCESS)</span></span><br><span class=\"line\">  Process: <span class=\"number\">12722</span> ExecStartPre<span class=\"operator\">=</span><span class=\"operator\">/</span>usr<span class=\"operator\">/</span>bin<span class=\"operator\">/</span>mysqld_pre_systemd (code<span class=\"operator\">=</span>exited, status<span class=\"operator\">=</span><span class=\"number\">0</span><span class=\"operator\">/</span>SUCCESS)</span><br><span class=\"line\"> Main PID: <span class=\"number\">12840</span> (mysqld)</span><br><span class=\"line\">   CGroup: <span class=\"operator\">/</span>system.slice<span class=\"operator\">/</span>mysqld.service</span><br><span class=\"line\">           └─<span class=\"number\">12840</span> <span class=\"operator\">/</span>usr<span class=\"operator\">/</span>sbin<span class=\"operator\">/</span>mysqld <span class=\"comment\">--daemonize --pid-file=/var/run/mysqld/mysqld.pid</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"number\">11</span>月 <span class=\"number\">07</span> <span class=\"number\">01</span>:<span class=\"number\">08</span>:<span class=\"number\">53</span> centos7 systemd[<span class=\"number\">1</span>]: Starting MySQL Server...</span><br><span class=\"line\"><span class=\"number\">11</span>月 <span class=\"number\">07</span> <span class=\"number\">01</span>:<span class=\"number\">08</span>:<span class=\"number\">56</span> centos7 systemd[<span class=\"number\">1</span>]: Started MySQL Server.</span><br></pre></td></tr></table></figure>\n\n<h2 id=\"配置\"><a href=\"#配置\" class=\"headerlink\" title=\"配置\"></a>配置</h2><h3 id=\"修改MySQL密码\"><a href=\"#修改MySQL密码\" class=\"headerlink\" title=\"修改MySQL密码\"></a>修改MySQL密码</h3><blockquote>\n<p>获取随机密码登陆</p>\n</blockquote>\n<p>MySQL在安装完成后，会生成一个随机密码，我们通过root用户➕随机密码便可以登陆MySQL服务器。随机密码会生成在 <code>/var/log/mysqld.log</code>中。我们可以通过 <code>tail -100f /var/log/mysqld.log | grep -i &quot;password”</code>来获取随机密码。</p>\n<p><img src=\"http://qiniu-image.gotojava.cn/blog/2023-12-15-191105.png\" alt=\"Untitled\"></p>\n<blockquote>\n<p>使用skip_grant_tables跳过密码验证</p>\n</blockquote>\n<p>也可以通过修改MySQL的配置文件my.cnf，通过跳过密码校验，来免登陆MySQL修改密码。通过在&#x2F;etc&#x2F;my.cnf配置文件中，添加 <code>skip_grant_tables</code>来实现跳过密码校验。</p>\n<p><img src=\"http://qiniu-image.gotojava.cn/blog/2023-12-15-191107.png\" alt=\"Untitled\"></p>\n<p>修改完成后，需要通过 <code>systemctl restart mysqld</code>重启MySQL服务，使配置文件的内容生效。</p>\n<p>通过mysql  -u root -p来登陆MySQL服务器，因为我们跳过了密码校验，所以在提示：“Enter password”时，回车即可。像下面这样：</p>\n<p><img src=\"http://qiniu-image.gotojava.cn/blog/2023-12-15-191110.png\" alt=\"Untitled\"></p>\n<aside>\n⚠️ 如果需要恢复密码验证，则移除”`skip_grant_tables`”这行内容，重启MySQL服务就可以了。\n\n</aside>\n\n<blockquote>\n<p>修改root密码</p>\n</blockquote>\n<figure class=\"highlight sql\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"># 修改当前登陆用户的密码为root</span><br><span class=\"line\">mysql<span class=\"operator\">&gt;</span> <span class=\"keyword\">ALTER</span> <span class=\"keyword\">USER</span> <span class=\"keyword\">user</span>() identified <span class=\"keyword\">by</span> &quot;root&quot;;</span><br><span class=\"line\">Query OK, <span class=\"number\">0</span> <span class=\"keyword\">rows</span> affected (<span class=\"number\">0.00</span> sec)</span><br><span class=\"line\"></span><br><span class=\"line\"># 遇到：MySQL ERROR <span class=\"number\">1819</span> (HY000): Your password does <span class=\"keyword\">not</span> satisfy the <span class=\"keyword\">current</span> policy requirements 问题参考：https:<span class=\"operator\">/</span><span class=\"operator\">/</span>ostechnix.com<span class=\"operator\">/</span>fix<span class=\"operator\">-</span>mysql<span class=\"operator\">-</span>error<span class=\"number\">-1819</span><span class=\"operator\">-</span>hy000<span class=\"operator\">-</span>your<span class=\"operator\">-</span>password<span class=\"operator\">-</span>does<span class=\"operator\">-</span><span class=\"keyword\">not</span><span class=\"operator\">-</span>satisfy<span class=\"operator\">-</span>the<span class=\"operator\">-</span><span class=\"keyword\">current</span><span class=\"operator\">-</span>policy<span class=\"operator\">-</span>requirements<span class=\"operator\">/</span></span><br><span class=\"line\"></span><br><span class=\"line\"># 刷新权限</span><br><span class=\"line\">mysql<span class=\"operator\">&gt;</span> flush privileges;</span><br><span class=\"line\">Query OK, <span class=\"number\">0</span> <span class=\"keyword\">rows</span> affected (<span class=\"number\">0.00</span> sec)</span><br></pre></td></tr></table></figure>\n\n<h3 id=\"开放远程连接\"><a href=\"#开放远程连接\" class=\"headerlink\" title=\"开放远程连接\"></a>开放远程连接</h3><p>默认情况下MySQL是不允许本地以外的其他服务器远程访问的，这个时候需要我们进行授权操作。</p>\n<figure class=\"highlight sql\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"># 打开mysql数据库</span><br><span class=\"line\">mysql<span class=\"operator\">&gt;</span> use mysql;</span><br><span class=\"line\">Reading <span class=\"keyword\">table</span> information <span class=\"keyword\">for</span> completion <span class=\"keyword\">of</span> <span class=\"keyword\">table</span> <span class=\"keyword\">and</span> <span class=\"keyword\">column</span> names</span><br><span class=\"line\">You can turn off this feature <span class=\"keyword\">to</span> <span class=\"keyword\">get</span> a quicker startup <span class=\"keyword\">with</span> <span class=\"operator\">-</span>A</span><br><span class=\"line\">Database changed</span><br><span class=\"line\"># 修改记录，允许远程访问</span><br><span class=\"line\">mysql<span class=\"operator\">&gt;</span> <span class=\"keyword\">update</span> <span class=\"keyword\">user</span> <span class=\"keyword\">set</span> host <span class=\"operator\">=</span> <span class=\"string\">&#x27;%&#x27;</span> <span class=\"keyword\">where</span> <span class=\"keyword\">user</span> <span class=\"operator\">=</span><span class=\"string\">&#x27;root&#x27;</span>;</span><br><span class=\"line\">Query OK, <span class=\"number\">1</span> <span class=\"type\">row</span> affected (<span class=\"number\">0.00</span> sec)</span><br><span class=\"line\"><span class=\"keyword\">Rows</span> matched: <span class=\"number\">1</span>  Changed: <span class=\"number\">1</span>  Warnings: <span class=\"number\">0</span></span><br><span class=\"line\"># 刷新权限信息</span><br><span class=\"line\">mysql<span class=\"operator\">&gt;</span> flush privileges;</span><br><span class=\"line\">Query OK, <span class=\"number\">0</span> <span class=\"keyword\">rows</span> affected (<span class=\"number\">0.00</span> sec)</span><br></pre></td></tr></table></figure>\n\n<figure class=\"highlight sql\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"># 开放防火墙<span class=\"number\">3306</span>端口</span><br><span class=\"line\">[root<span class=\"variable\">@centos7</span> <span class=\"operator\">~</span>]# firewall<span class=\"operator\">-</span>cmd <span class=\"comment\">--zone=public --add-port=3306/tcp --permanent</span></span><br><span class=\"line\"># 刷新防火墙规则</span><br><span class=\"line\">[root<span class=\"variable\">@centos7</span> <span class=\"operator\">~</span>]# firewall<span class=\"operator\">-</span>cmd <span class=\"comment\">--reload</span></span><br><span class=\"line\"># 移除<span class=\"number\">3306</span>端口</span><br><span class=\"line\">[root<span class=\"variable\">@centos7</span> <span class=\"operator\">~</span>]# firewall<span class=\"operator\">-</span>cmd <span class=\"comment\">--zone=public --remove-port=3306/tcp --permanent</span></span><br><span class=\"line\"># 查看当前防火墙规则列表</span><br><span class=\"line\">[root<span class=\"variable\">@centos7</span> <span class=\"operator\">~</span>]# firewall<span class=\"operator\">-</span>cmd <span class=\"comment\">--list-all</span></span><br></pre></td></tr></table></figure>\n\n<h3 id=\"获取服务器状态信息\"><a href=\"#获取服务器状态信息\" class=\"headerlink\" title=\"获取服务器状态信息\"></a>获取服务器状态信息</h3><figure class=\"highlight sql\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">mysql<span class=\"operator\">&gt;</span> status</span><br><span class=\"line\"><span class=\"comment\">--------------</span></span><br><span class=\"line\">mysql  Ver <span class=\"number\">14.14</span> Distrib <span class=\"number\">5.7</span><span class=\"number\">.41</span>, <span class=\"keyword\">for</span> Linux (x86_64) <span class=\"keyword\">using</span>  EditLine wrapper</span><br><span class=\"line\"></span><br><span class=\"line\">Connection id:          <span class=\"number\">12</span></span><br><span class=\"line\"><span class=\"keyword\">Current</span> database:       mysql</span><br><span class=\"line\"><span class=\"keyword\">Current</span> <span class=\"keyword\">user</span>:           root<span class=\"variable\">@localhost</span></span><br><span class=\"line\">SSL:                    <span class=\"keyword\">Not</span> <span class=\"keyword\">in</span> use</span><br><span class=\"line\"><span class=\"keyword\">Current</span> pager:          stdout</span><br><span class=\"line\"><span class=\"keyword\">Using</span> outfile:          <span class=\"string\">&#x27;&#x27;</span></span><br><span class=\"line\"><span class=\"keyword\">Using</span> delimiter:        ;</span><br><span class=\"line\">Server version:         <span class=\"number\">5.7</span><span class=\"number\">.41</span> MySQL Community Server (GPL)</span><br><span class=\"line\">Protocol version:       <span class=\"number\">10</span></span><br><span class=\"line\">Connection:             Localhost via UNIX socket</span><br><span class=\"line\">Server characterset:    latin1</span><br><span class=\"line\">Db     characterset:    latin1</span><br><span class=\"line\">Client characterset:    utf8</span><br><span class=\"line\">Conn.  characterset:    utf8</span><br><span class=\"line\">UNIX socket:            <span class=\"operator\">/</span>var<span class=\"operator\">/</span>lib<span class=\"operator\">/</span>mysql<span class=\"operator\">/</span>mysql.sock</span><br><span class=\"line\">Uptime:                 <span class=\"number\">33</span> min <span class=\"number\">20</span> sec</span><br><span class=\"line\"></span><br><span class=\"line\">Threads: <span class=\"number\">1</span>  Questions: <span class=\"number\">116</span>  Slow queries: <span class=\"number\">0</span>  Opens: <span class=\"number\">175</span>  Flush tables: <span class=\"number\">1</span>  <span class=\"keyword\">Open</span> tables: <span class=\"number\">168</span>  Queries <span class=\"keyword\">per</span> <span class=\"keyword\">second</span> avg: <span class=\"number\">0.058</span></span><br><span class=\"line\"><span class=\"comment\">--------------</span></span><br></pre></td></tr></table></figure>\n\n<h3 id=\"MySQL安装目录说明\"><a href=\"#MySQL安装目录说明\" class=\"headerlink\" title=\"MySQL安装目录说明\"></a>MySQL安装目录说明</h3><table>\n<thead>\n<tr>\n<th>文件夹</th>\n<th>文件夹内容</th>\n</tr>\n</thead>\n<tbody><tr>\n<td>&#x2F;var&#x2F;bin</td>\n<td>客户端和脚本（mysqladmin、mysqldump等命令）</td>\n</tr>\n<tr>\n<td>&#x2F;usr&#x2F;sbin</td>\n<td>mysqld服务器</td>\n</tr>\n<tr>\n<td>&#x2F;var&#x2F;lib&#x2F;mysql</td>\n<td>日志文件、socket文件和数据库</td>\n</tr>\n<tr>\n<td>&#x2F;usr&#x2F;share&#x2F;info</td>\n<td>信息格式的手册</td>\n</tr>\n<tr>\n<td>&#x2F;usr&#x2F;share&#x2F;man</td>\n<td>UNIX帮助页</td>\n</tr>\n<tr>\n<td>&#x2F;usr&#x2F;include&#x2F;mysql</td>\n<td>头文件</td>\n</tr>\n<tr>\n<td>&#x2F;usr&#x2F;lib&#x2F;mysql</td>\n<td>MySQL的依赖库</td>\n</tr>\n<tr>\n<td>&#x2F;usr&#x2F;share&#x2F;mysql</td>\n<td>错误消息、字符集、安装文件和配置文件</td>\n</tr>\n<tr>\n<td>&#x2F;etc&#x2F;rc.d&#x2F;init.d&#x2F;</td>\n<td>启动脚本文件的mysql目录，用来启动和停止MySQL服务</td>\n</tr>\n</tbody></table>\n<h3 id=\"MySQL数据目录说明\"><a href=\"#MySQL数据目录说明\" class=\"headerlink\" title=\"MySQL数据目录说明\"></a>MySQL数据目录说明</h3><aside>\n⚠️ MySQL数据目录的位置可以通过/etc/my.cnf配置文件中的datadir配置获得。\n\n</aside>\n\n<p><img src=\"http://qiniu-image.gotojava.cn/blog/2023-12-15-191111.png\" alt=\"Untitled\"></p>\n<table>\n<thead>\n<tr>\n<th>文件名称</th>\n<th>作用</th>\n</tr>\n</thead>\n<tbody><tr>\n<td>auto.cnf</td>\n<td>MySQL服务器的选项文件，用于存储server-uuid的值，server-uuid用于标识MySQL实例在集群中的唯一性。</td>\n</tr>\n<tr>\n<td>ca-key.pem</td>\n<td>CA 私钥, 用于生成服务器端&#x2F;客户端的数字证书</td>\n</tr>\n<tr>\n<td>ca.pem</td>\n<td>CA 证书, 用于生成服务器端&#x2F;客户端的数字证书</td>\n</tr>\n<tr>\n<td>client-cert.pem</td>\n<td>客户端连接时使用的证书</td>\n</tr>\n<tr>\n<td>client-key.pem</td>\n<td>客户端连接时使用的私钥</td>\n</tr>\n<tr>\n<td>ib_buffer_pool</td>\n<td>InnoDB引擎的缓存数据文件，用于存储缓存</td>\n</tr>\n<tr>\n<td>ibdata1</td>\n<td>共享表空间（系统表空间），如果使用的是InnoDB引擎，默认大小为10M</td>\n</tr>\n<tr>\n<td>ib_logfile0</td>\n<td>支持事务性引擎的redo日志文件</td>\n</tr>\n<tr>\n<td>ib_logfile1</td>\n<td>支持事务性引擎的redo日志文件</td>\n</tr>\n<tr>\n<td>ibtmp1</td>\n<td>存储临时对象的空间，比如临时表对象等</td>\n</tr>\n<tr>\n<td>mysql.sock</td>\n<td>Socket连接的文件，用于MySQL客户端和MySQL服务器的本地连接（同一机器）</td>\n</tr>\n<tr>\n<td>mysql.sock.lock</td>\n<td>MySQL的一个文件锁，用于控制并发访问数据库的情况</td>\n</tr>\n<tr>\n<td>private_key.pem</td>\n<td>密钥对的私钥</td>\n</tr>\n<tr>\n<td>public_key.pem</td>\n<td>密钥对的公钥</td>\n</tr>\n<tr>\n<td>server-cert.pem</td>\n<td>服务器端的数字证书</td>\n</tr>\n<tr>\n<td>server-key.pem</td>\n<td>服务器端的 RSA 私钥</td>\n</tr>\n<tr>\n<td>mysql、performance_schema、sys</td>\n<td>系统的内置数据库：</td>\n</tr>\n<tr>\n<td>information_schema：存储了数据库对象信息，包括用户表信息、列信息、权限信息、字符集信息、分区信息；</td>\n<td></td>\n</tr>\n<tr>\n<td>mysql：负责存储数据库用户、用户访问权限信息；</td>\n<td></td>\n</tr>\n<tr>\n<td>sys：MySQL5.7版本的数据库，提供了一些视图，用于帮助开发者和使用者更方便地查看性能问题。</td>\n<td></td>\n</tr>\n</tbody></table>\n<ul>\n<li>test是我们自己创建的测试库，结构如下：</li>\n</ul>\n<p><img src=\"http://qiniu-image.gotojava.cn/blog/2023-12-15-191112.png\" alt=\"Untitled\"></p>\n<p>db.opt：用来保存数据库的配置信息，比如该库的默认字符集编码和字符集排序规则。</p>\n<blockquote>\n<p>InnoDB引擎</p>\n</blockquote>\n<p>*.frm：用来保存每个数据表的元数据和表结构信息，当数据库崩溃时，可以用.frm文件恢复表结构。</p>\n<p>*.ibd：用来存储表的数据。</p>\n<blockquote>\n<p>MyISAM引擎</p>\n</blockquote>\n<p>*.MYD：存储MyISAM表的数据。</p>\n<p>*.MYI：存储MyISAM表的索引及相关信息。</p>\n<aside>\n⚠️ 在MySQL中，一个数据库可以使用多个存储引擎。所以该数据库下可能既存在InnoDB引擎的文件，也存在MyISAM引擎的文件。\n\n</aside>\n\n<h3 id=\"MySQL配置文件（my-cnf）\"><a href=\"#MySQL配置文件（my-cnf）\" class=\"headerlink\" title=\"MySQL配置文件（my.cnf）\"></a>MySQL配置文件（my.cnf）</h3><blockquote>\n<p>服务器端参数“[mysqld]”</p>\n</blockquote>\n<table>\n<thead>\n<tr>\n<th>参数名称</th>\n<th>说明</th>\n</tr>\n</thead>\n<tbody><tr>\n<td>port</td>\n<td>表示MySQL服务器的端口号</td>\n</tr>\n<tr>\n<td>basedir</td>\n<td>表示MySQL的安装路径</td>\n</tr>\n<tr>\n<td>datadir</td>\n<td>MySQL数据文件的存储位置</td>\n</tr>\n<tr>\n<td>default_character_set</td>\n<td>服务端默认的字符集</td>\n</tr>\n<tr>\n<td>default_storage_engine</td>\n<td>创建数据表时，默认使用的存储引擎</td>\n</tr>\n<tr>\n<td>sql_mode</td>\n<td>sql模式的参数，该参数可以检验SQL语句的严格程度。sql_mode的参数参考：<a href=\"http://www.gamecolg.com/program_m_onvideo_m_inkey_m_gta1662479699017.html\">http://www.gamecolg.com/program_m_onvideo_m_inkey_m_gta1662479699017.html</a></td>\n</tr>\n<tr>\n<td>max_connections</td>\n<td>允许同时访问服务器的最大连接数</td>\n</tr>\n<tr>\n<td>query_cache_size</td>\n<td>查询时的缓存大小</td>\n</tr>\n<tr>\n<td>table_open_cache</td>\n<td>表示所有进程打开表的总数</td>\n</tr>\n<tr>\n<td>tmp_table_size</td>\n<td>内存中每个临时表允许的最大大小</td>\n</tr>\n<tr>\n<td>thread_cache_size</td>\n<td>缓存的最大线程数</td>\n</tr>\n<tr>\n<td>myisam_max_sort_file_size</td>\n<td>MySQL重建索引时所允许的最大临时文件大小</td>\n</tr>\n<tr>\n<td>myisam_sort_buffer_size</td>\n<td>重建索引时的缓存大小</td>\n</tr>\n<tr>\n<td>key_buffer_size</td>\n<td>关键词的缓存大小</td>\n</tr>\n<tr>\n<td>read_buffer_size</td>\n<td>MyISAM全表扫描的缓存大小</td>\n</tr>\n<tr>\n<td>read_rnd_buffer_size</td>\n<td>表示将排序好的数据存入该缓存中</td>\n</tr>\n<tr>\n<td>sort_buffer_size</td>\n<td>表示用于排序的缓存大小</td>\n</tr>\n<tr>\n<td>innodb_log_file_size</td>\n<td>InnoDB日志文件的大小</td>\n</tr>\n<tr>\n<td>innodb_log_buffer_size</td>\n<td>用于存储日志数据的缓存区大小</td>\n</tr>\n<tr>\n<td>innodb_buffer_pool_size</td>\n<td>缓存的大小，InnoDB使用一个缓冲池保存索引和原始数据</td>\n</tr>\n<tr>\n<td>innodb_thread_concurrency</td>\n<td>InnoDB存储引擎允许的线程最大数</td>\n</tr>\n<tr>\n<td>innodb_flush_log_at_trx_commit</td>\n<td>提交日志的时机，为1时会在每次提交后将事务日志写入到磁盘上</td>\n</tr>\n</tbody></table>\n<h2 id=\"问题记录\"><a href=\"#问题记录\" class=\"headerlink\" title=\"问题记录\"></a>问题记录</h2><h3 id=\"CentOS7忘记密码怎么办？\"><a href=\"#CentOS7忘记密码怎么办？\" class=\"headerlink\" title=\"CentOS7忘记密码怎么办？\"></a>CentOS7忘记密码怎么办？</h3><p><a href=\"https://blog.csdn.net/qq_45887180/article/details/115819136\">CentOS7如果忘记密码，密码重置详细步骤_centos修改密码忘记密码-CSDN博客</a></p>\n<h3 id=\"ERROR-1820（HY000）\"><a href=\"#ERROR-1820（HY000）\" class=\"headerlink\" title=\"ERROR 1820（HY000）\"></a>ERROR 1820（HY000）</h3><p>错误提示：You must reset your password using ALTER USER statement before executing this statement.</p>\n<p>解决方案：<a href=\"https://blog.csdn.net/Wing_kin666/article/details/110921440\">MySQL 报错：ERROR 1820 (HY000): You must reset your password using ALTER USER statement before-CSDN博客</a></p>"},{"title":"MacOS修改文件时间属性","abbrlink":"43757ee8","date":"2023-10-08T21:50:38.000Z","toc":true,"_content":"<meta name=\"referrer\" content=\"no-referrer\" />\n\n记录在MacOS下修改文件的时间属性。\n\n<!--more-->\n\n> 修改文件创建时间：\n\n```bash\ntouch -t 201209160330.00 /Users/name/Desktop/somefile.jpg\n```\n\n> 修改文件修改时间：\n\n```bash\ntouch -mt 201209160330.00 /Users/name/Desktop/somefile.jpg\n```\n\n> 批量修改文件修改时间：\n\n```bash\ntouch -mt 200801120000 /Volumes/Mac\\ HD/Pictures/Album/*\n```\n","source":"_posts/MacOS修改文件时间.md","raw":"---\ntitle: MacOS修改文件时间属性\ncategories:\n  - 开发者笔记\ntags:\n  - MacOS\nabbrlink: 43757ee8\ndate: 2023-10-08 21:50:38\ntoc: true\n---\n<meta name=\"referrer\" content=\"no-referrer\" />\n\n记录在MacOS下修改文件的时间属性。\n\n<!--more-->\n\n> 修改文件创建时间：\n\n```bash\ntouch -t 201209160330.00 /Users/name/Desktop/somefile.jpg\n```\n\n> 修改文件修改时间：\n\n```bash\ntouch -mt 201209160330.00 /Users/name/Desktop/somefile.jpg\n```\n\n> 批量修改文件修改时间：\n\n```bash\ntouch -mt 200801120000 /Volumes/Mac\\ HD/Pictures/Album/*\n```\n","slug":"MacOS修改文件时间","published":1,"updated":"2025-03-28T06:10:19.482Z","comments":1,"layout":"post","photos":[],"_id":"cm8se3tdb0009bb8lh3zr5mcy","content":"<meta name=\"referrer\" content=\"no-referrer\" />\n\n<p>记录在MacOS下修改文件的时间属性。</p>\n<span id=\"more\"></span>\n\n<blockquote>\n<p>修改文件创建时间：</p>\n</blockquote>\n<figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"built_in\">touch</span> -t 201209160330.00 /Users/name/Desktop/somefile.jpg</span><br></pre></td></tr></table></figure>\n\n<blockquote>\n<p>修改文件修改时间：</p>\n</blockquote>\n<figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"built_in\">touch</span> -mt 201209160330.00 /Users/name/Desktop/somefile.jpg</span><br></pre></td></tr></table></figure>\n\n<blockquote>\n<p>批量修改文件修改时间：</p>\n</blockquote>\n<figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"built_in\">touch</span> -mt 200801120000 /Volumes/Mac\\ HD/Pictures/Album/*</span><br></pre></td></tr></table></figure>\n","excerpt":"<meta name=\"referrer\" content=\"no-referrer\" />\n\n<p>记录在MacOS下修改文件的时间属性。</p>","more":"<blockquote>\n<p>修改文件创建时间：</p>\n</blockquote>\n<figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"built_in\">touch</span> -t 201209160330.00 /Users/name/Desktop/somefile.jpg</span><br></pre></td></tr></table></figure>\n\n<blockquote>\n<p>修改文件修改时间：</p>\n</blockquote>\n<figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"built_in\">touch</span> -mt 201209160330.00 /Users/name/Desktop/somefile.jpg</span><br></pre></td></tr></table></figure>\n\n<blockquote>\n<p>批量修改文件修改时间：</p>\n</blockquote>\n<figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"built_in\">touch</span> -mt 200801120000 /Volumes/Mac\\ HD/Pictures/Album/*</span><br></pre></td></tr></table></figure>"},{"title":"Redis7的单实例安装与基本配置","abbrlink":"242fe420","date":"2024-06-05T19:31:21.000Z","toc":true,"_content":"\n<meta name=\"referrer\" content=\"no-referrer\" />\n\n<!--more-->\n\n## Redis是什么\n\nRedis的全称是 <u>Remote Dictionary Server</u> 是一个开源的基于内存的高性能键值对（Key - Value）存储系统。可以用作数据库、缓存和消息代理。\n\n## 为什么需要\n\n- 作为缓存使用\n\nRedis 是基于内存做数据存储的，对于关系型数据库来说数据是保存在硬盘上，在读取方面Redis会更快，适合作为缓存使用。所以对于需要频繁查询的操作可以将数据存入Redis中，这样可以极大的减轻数据库服务的压力，提高系统的性能。\n\n![image-20240603032509698](https://qiniu-image.gotojava.cn/blog/202406030325885.png)\n\n- 完成一些特定场景的功能\n\n基于Redis一些数据结构的特性，完成一些类似于排行榜、用户点赞数、访问数、限流、Session会话共享、共同的社交关系、简单消息队列、分布式锁等等，这些功能虽然关系型数据库也能做，但是频繁的访问和修改操作会增加数据库访问压力，但对于Redis来说就非常适合、实现也更方便。\n\n### 注意\n\n> ⚠️注意：需要注意的是，Redis虽然性能很好，但也不是万能的，对于频繁访问的数据，Redis的缓存功能可以极大的减轻数据库的压力。但对于存储一些访问不太频繁的数据，虽然也不是不可以，但是会导致内存资源的浪费。\n\n> Redis 不适合作为业务数据库使用，虽然 Redis 自身也有一些持久化的机制能将数据保存到硬盘，但是无法保证数据的可靠型，所以不要将 Redis 作为业务数据库使用，避免业务数据的丢失。\n\n## 安装\n\n### 说明\n\n- 本次所有的测试验证都是使用[Redis 7.0.0](https://github.com/redis/redis/releases/tag/7.0.0)来进行。获取和相关的变更信息可以通过 [GitHub](https://github.com/redis/redis/releases) 获取。\n- 操作系统使用<u>CentOS 7</u>，使用 Parallels Desktop 来模拟主从复制、哨兵、和集群的验证。\n\n- Redis 可视化客户端可以使用 AnotherRedisDesktopManager，通过 [GitHub](https://github.com/qishibo/AnotherRedisDesktopManager/releases) 获取。\n- 版本号：Redis 使用标准的做法进行版本管理: <u>主版本号.副版本号.补丁号</u>。 偶数 <u>副版本号</u> 表示一个 <u>稳定的</u> 发布，像 1.2, 2.0, 2.2, 2.4, 2.6, 2.8。奇数副版本号表示 <u>不稳定的</u> 发布，例如 2.9.x 发布是一个不稳定版本，下一个稳定版本将会是Redis 3.0。\n- CentOS 7保证可以正常访问网络，修改 [yum 源为阿里云源](https://blog.csdn.net/weixin_38924500/article/details/109555882)、安装 [GCC、GCC-C++](https://gotojava.cn/article/aba7d07)，以方便 Redis 的安装部署。\n\n### 安装\n\n> 生产环境的建议安装方式，使安装符合 Linux 文件系统的规范\n\n- 获取7.0.0安装包\n\n```bash\n# /usr/local/src 可以用来放自己安装的第三方源码文件\nwget -P /usr/local/src/ https://download.redis.io/releases/redis-7.0.0.tar.gz\n```\n\n- 解压\n\n```bash\ncd /usr/local/src/\ntar -zxf redis-7.0.0.tar.gz\n```\n\n- 安装\n\n```bash\ncd /usr/local/src/redis-7.0.0/\nmake && make install\n```\n\n- /usr/local/bin下的Redis工具\n\n![Redis 工具说明](https://qiniu-image.gotojava.cn/blog/202406030459591.png)\n\n- 创建redis的配置和数据放置目录\n\n```bash\n# 配置文件目录\nmkdir -p /etc/redis/\n\n# 数据文件目录\nmkdir -p /var/lib/redis/6379\n\n# 日志文件目录\nmkdir -p /var/log/redis\n```\n\n- 必要配置\n\n> 拷贝原始配置文件到配置文件目录中\n\n```bash\ncp /usr/local/src/redis-7.0.0/redis.conf /etc/redis/6379.conf\n```\n\n> 修改6379.conf配置文件\n\n```bash\ndaemonize yes #允许Redis在后台运行，默认为no\nprotected-mode no #关闭保护模式，允许远程客户端连接，默认为yes\nbind 127.0.0.1 ::1 #默认只允许本地机器连接，注释掉该行或者改成机器IP，否则影响远程机器连接\nrequirepass 111111 #设置Redis连接密码，远程客户端连接需要\ndir /var/lib/redis/6379 # 设置Redis数据文件目录，用于存放持久化文件RDB和AOF文件，默认为配置文件的所在目录（即安装目录）\nloglevel notice # 设置日志级别（根据需要设置，默认:notice）\nlogfile \"/var/log/redis/6379.log\" # 设置日志文件位置\nport 6379 # 设置Redis运行端口，默认：6379\nsave 3600 1 300 100 60 10000 # 开启RDB持久化，默认注释掉，需要打开，如果作为缓存使用，可以不开启\n```\n\n### 设置服务自启动\n\n#### 修改启动脚本\n\n因为redis脚本中默认是无密码的，但我们设置了Redis的密码，导致通过服务停止的时候，没有权限访问。为了解决这个问题，需要修改启动脚本，以实现我们的需求。\n\n```bash\nREDIS_PASS=111111\n$CLIEXEC -p $REDISPORT -a $REDIS_PASS shutdown\n```\n\n![image-20240605191616643](https://qiniu-image.gotojava.cn/blog/202406051916738.png)\n\n#### 配置服务自启动\n\n```bash\ncp /usr/local/src/redis-7.0.0/utils/redis_init_script /etc/init.d/redis_6379\ncd /etc/init.d/ && chkconfig --level 35 redis_6379 on\n```\n\n![image-20240603061328082](https://qiniu-image.gotojava.cn/blog/202406030613228.png)\n\n### 服务启停\n\n- 启动\n\n```bash\n# redis-server 配置文件位置\nredis-server /etc/redis/6379.conf\n或\nservice redis_6379 start\n```\n\n- 停止\n\n```bash\n# redis-cli -a 连接密码 -p 端口号(默认：6379)  shutdown\nredis-cli -a 111111 -p 6379 shutdown\n或\nservice redis_6379 stop\n```\n\n## 卸载\n\n> 如果需要卸载Redis，可以删除/usr/local/bin目录下与redis相关的文件\n\n```bash\nrm -rf /usr/local/bin/redis-*\n```\n\n## 参考\n\n- https://www.cnblogs.com/ggjucheng/archive/2012/08/20/2647788.html\n- https://redis.com.cn/topics/why-use-redis.html","source":"_posts/Redis7的单实例安装与基本配置.md","raw":"---\ntitle: Redis7的单实例安装与基本配置\ncategories:\n  - 开发者笔记\ntags:\n  - Redis7\nabbrlink: 242fe420\ndate: 2024-06-05 19:31:21\ntoc: true\n---\n\n<meta name=\"referrer\" content=\"no-referrer\" />\n\n<!--more-->\n\n## Redis是什么\n\nRedis的全称是 <u>Remote Dictionary Server</u> 是一个开源的基于内存的高性能键值对（Key - Value）存储系统。可以用作数据库、缓存和消息代理。\n\n## 为什么需要\n\n- 作为缓存使用\n\nRedis 是基于内存做数据存储的，对于关系型数据库来说数据是保存在硬盘上，在读取方面Redis会更快，适合作为缓存使用。所以对于需要频繁查询的操作可以将数据存入Redis中，这样可以极大的减轻数据库服务的压力，提高系统的性能。\n\n![image-20240603032509698](https://qiniu-image.gotojava.cn/blog/202406030325885.png)\n\n- 完成一些特定场景的功能\n\n基于Redis一些数据结构的特性，完成一些类似于排行榜、用户点赞数、访问数、限流、Session会话共享、共同的社交关系、简单消息队列、分布式锁等等，这些功能虽然关系型数据库也能做，但是频繁的访问和修改操作会增加数据库访问压力，但对于Redis来说就非常适合、实现也更方便。\n\n### 注意\n\n> ⚠️注意：需要注意的是，Redis虽然性能很好，但也不是万能的，对于频繁访问的数据，Redis的缓存功能可以极大的减轻数据库的压力。但对于存储一些访问不太频繁的数据，虽然也不是不可以，但是会导致内存资源的浪费。\n\n> Redis 不适合作为业务数据库使用，虽然 Redis 自身也有一些持久化的机制能将数据保存到硬盘，但是无法保证数据的可靠型，所以不要将 Redis 作为业务数据库使用，避免业务数据的丢失。\n\n## 安装\n\n### 说明\n\n- 本次所有的测试验证都是使用[Redis 7.0.0](https://github.com/redis/redis/releases/tag/7.0.0)来进行。获取和相关的变更信息可以通过 [GitHub](https://github.com/redis/redis/releases) 获取。\n- 操作系统使用<u>CentOS 7</u>，使用 Parallels Desktop 来模拟主从复制、哨兵、和集群的验证。\n\n- Redis 可视化客户端可以使用 AnotherRedisDesktopManager，通过 [GitHub](https://github.com/qishibo/AnotherRedisDesktopManager/releases) 获取。\n- 版本号：Redis 使用标准的做法进行版本管理: <u>主版本号.副版本号.补丁号</u>。 偶数 <u>副版本号</u> 表示一个 <u>稳定的</u> 发布，像 1.2, 2.0, 2.2, 2.4, 2.6, 2.8。奇数副版本号表示 <u>不稳定的</u> 发布，例如 2.9.x 发布是一个不稳定版本，下一个稳定版本将会是Redis 3.0。\n- CentOS 7保证可以正常访问网络，修改 [yum 源为阿里云源](https://blog.csdn.net/weixin_38924500/article/details/109555882)、安装 [GCC、GCC-C++](https://gotojava.cn/article/aba7d07)，以方便 Redis 的安装部署。\n\n### 安装\n\n> 生产环境的建议安装方式，使安装符合 Linux 文件系统的规范\n\n- 获取7.0.0安装包\n\n```bash\n# /usr/local/src 可以用来放自己安装的第三方源码文件\nwget -P /usr/local/src/ https://download.redis.io/releases/redis-7.0.0.tar.gz\n```\n\n- 解压\n\n```bash\ncd /usr/local/src/\ntar -zxf redis-7.0.0.tar.gz\n```\n\n- 安装\n\n```bash\ncd /usr/local/src/redis-7.0.0/\nmake && make install\n```\n\n- /usr/local/bin下的Redis工具\n\n![Redis 工具说明](https://qiniu-image.gotojava.cn/blog/202406030459591.png)\n\n- 创建redis的配置和数据放置目录\n\n```bash\n# 配置文件目录\nmkdir -p /etc/redis/\n\n# 数据文件目录\nmkdir -p /var/lib/redis/6379\n\n# 日志文件目录\nmkdir -p /var/log/redis\n```\n\n- 必要配置\n\n> 拷贝原始配置文件到配置文件目录中\n\n```bash\ncp /usr/local/src/redis-7.0.0/redis.conf /etc/redis/6379.conf\n```\n\n> 修改6379.conf配置文件\n\n```bash\ndaemonize yes #允许Redis在后台运行，默认为no\nprotected-mode no #关闭保护模式，允许远程客户端连接，默认为yes\nbind 127.0.0.1 ::1 #默认只允许本地机器连接，注释掉该行或者改成机器IP，否则影响远程机器连接\nrequirepass 111111 #设置Redis连接密码，远程客户端连接需要\ndir /var/lib/redis/6379 # 设置Redis数据文件目录，用于存放持久化文件RDB和AOF文件，默认为配置文件的所在目录（即安装目录）\nloglevel notice # 设置日志级别（根据需要设置，默认:notice）\nlogfile \"/var/log/redis/6379.log\" # 设置日志文件位置\nport 6379 # 设置Redis运行端口，默认：6379\nsave 3600 1 300 100 60 10000 # 开启RDB持久化，默认注释掉，需要打开，如果作为缓存使用，可以不开启\n```\n\n### 设置服务自启动\n\n#### 修改启动脚本\n\n因为redis脚本中默认是无密码的，但我们设置了Redis的密码，导致通过服务停止的时候，没有权限访问。为了解决这个问题，需要修改启动脚本，以实现我们的需求。\n\n```bash\nREDIS_PASS=111111\n$CLIEXEC -p $REDISPORT -a $REDIS_PASS shutdown\n```\n\n![image-20240605191616643](https://qiniu-image.gotojava.cn/blog/202406051916738.png)\n\n#### 配置服务自启动\n\n```bash\ncp /usr/local/src/redis-7.0.0/utils/redis_init_script /etc/init.d/redis_6379\ncd /etc/init.d/ && chkconfig --level 35 redis_6379 on\n```\n\n![image-20240603061328082](https://qiniu-image.gotojava.cn/blog/202406030613228.png)\n\n### 服务启停\n\n- 启动\n\n```bash\n# redis-server 配置文件位置\nredis-server /etc/redis/6379.conf\n或\nservice redis_6379 start\n```\n\n- 停止\n\n```bash\n# redis-cli -a 连接密码 -p 端口号(默认：6379)  shutdown\nredis-cli -a 111111 -p 6379 shutdown\n或\nservice redis_6379 stop\n```\n\n## 卸载\n\n> 如果需要卸载Redis，可以删除/usr/local/bin目录下与redis相关的文件\n\n```bash\nrm -rf /usr/local/bin/redis-*\n```\n\n## 参考\n\n- https://www.cnblogs.com/ggjucheng/archive/2012/08/20/2647788.html\n- https://redis.com.cn/topics/why-use-redis.html","slug":"Redis7的单实例安装与基本配置","published":1,"updated":"2025-03-28T06:10:22.153Z","comments":1,"layout":"post","photos":[],"_id":"cm8se3tdc000abb8lalv5hcty","content":"<meta name=\"referrer\" content=\"no-referrer\" />\n\n<span id=\"more\"></span>\n\n<h2 id=\"Redis是什么\"><a href=\"#Redis是什么\" class=\"headerlink\" title=\"Redis是什么\"></a>Redis是什么</h2><p>Redis的全称是 <u>Remote Dictionary Server</u> 是一个开源的基于内存的高性能键值对（Key - Value）存储系统。可以用作数据库、缓存和消息代理。</p>\n<h2 id=\"为什么需要\"><a href=\"#为什么需要\" class=\"headerlink\" title=\"为什么需要\"></a>为什么需要</h2><ul>\n<li>作为缓存使用</li>\n</ul>\n<p>Redis 是基于内存做数据存储的，对于关系型数据库来说数据是保存在硬盘上，在读取方面Redis会更快，适合作为缓存使用。所以对于需要频繁查询的操作可以将数据存入Redis中，这样可以极大的减轻数据库服务的压力，提高系统的性能。</p>\n<p><img src=\"https://qiniu-image.gotojava.cn/blog/202406030325885.png\" alt=\"image-20240603032509698\"></p>\n<ul>\n<li>完成一些特定场景的功能</li>\n</ul>\n<p>基于Redis一些数据结构的特性，完成一些类似于排行榜、用户点赞数、访问数、限流、Session会话共享、共同的社交关系、简单消息队列、分布式锁等等，这些功能虽然关系型数据库也能做，但是频繁的访问和修改操作会增加数据库访问压力，但对于Redis来说就非常适合、实现也更方便。</p>\n<h3 id=\"注意\"><a href=\"#注意\" class=\"headerlink\" title=\"注意\"></a>注意</h3><blockquote>\n<p>⚠️注意：需要注意的是，Redis虽然性能很好，但也不是万能的，对于频繁访问的数据，Redis的缓存功能可以极大的减轻数据库的压力。但对于存储一些访问不太频繁的数据，虽然也不是不可以，但是会导致内存资源的浪费。</p>\n</blockquote>\n<blockquote>\n<p>Redis 不适合作为业务数据库使用，虽然 Redis 自身也有一些持久化的机制能将数据保存到硬盘，但是无法保证数据的可靠型，所以不要将 Redis 作为业务数据库使用，避免业务数据的丢失。</p>\n</blockquote>\n<h2 id=\"安装\"><a href=\"#安装\" class=\"headerlink\" title=\"安装\"></a>安装</h2><h3 id=\"说明\"><a href=\"#说明\" class=\"headerlink\" title=\"说明\"></a>说明</h3><ul>\n<li><p>本次所有的测试验证都是使用<a href=\"https://github.com/redis/redis/releases/tag/7.0.0\">Redis 7.0.0</a>来进行。获取和相关的变更信息可以通过 <a href=\"https://github.com/redis/redis/releases\">GitHub</a> 获取。</p>\n</li>\n<li><p>操作系统使用<u>CentOS 7</u>，使用 Parallels Desktop 来模拟主从复制、哨兵、和集群的验证。</p>\n</li>\n<li><p>Redis 可视化客户端可以使用 AnotherRedisDesktopManager，通过 <a href=\"https://github.com/qishibo/AnotherRedisDesktopManager/releases\">GitHub</a> 获取。</p>\n</li>\n<li><p>版本号：Redis 使用标准的做法进行版本管理: <u>主版本号.副版本号.补丁号</u>。 偶数 <u>副版本号</u> 表示一个 <u>稳定的</u> 发布，像 1.2, 2.0, 2.2, 2.4, 2.6, 2.8。奇数副版本号表示 <u>不稳定的</u> 发布，例如 2.9.x 发布是一个不稳定版本，下一个稳定版本将会是Redis 3.0。</p>\n</li>\n<li><p>CentOS 7保证可以正常访问网络，修改 <a href=\"https://blog.csdn.net/weixin_38924500/article/details/109555882\">yum 源为阿里云源</a>、安装 <a href=\"https://gotojava.cn/article/aba7d07\">GCC、GCC-C++</a>，以方便 Redis 的安装部署。</p>\n</li>\n</ul>\n<h3 id=\"安装-1\"><a href=\"#安装-1\" class=\"headerlink\" title=\"安装\"></a>安装</h3><blockquote>\n<p>生产环境的建议安装方式，使安装符合 Linux 文件系统的规范</p>\n</blockquote>\n<ul>\n<li>获取7.0.0安装包</li>\n</ul>\n<figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\"># /usr/local/src 可以用来放自己安装的第三方源码文件</span></span><br><span class=\"line\">wget -P /usr/local/src/ https://download.redis.io/releases/redis-7.0.0.tar.gz</span><br></pre></td></tr></table></figure>\n\n<ul>\n<li>解压</li>\n</ul>\n<figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"built_in\">cd</span> /usr/local/src/</span><br><span class=\"line\">tar -zxf redis-7.0.0.tar.gz</span><br></pre></td></tr></table></figure>\n\n<ul>\n<li>安装</li>\n</ul>\n<figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"built_in\">cd</span> /usr/local/src/redis-7.0.0/</span><br><span class=\"line\">make &amp;&amp; make install</span><br></pre></td></tr></table></figure>\n\n<ul>\n<li>&#x2F;usr&#x2F;local&#x2F;bin下的Redis工具</li>\n</ul>\n<p><img src=\"https://qiniu-image.gotojava.cn/blog/202406030459591.png\" alt=\"Redis 工具说明\"></p>\n<ul>\n<li>创建redis的配置和数据放置目录</li>\n</ul>\n<figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\"># 配置文件目录</span></span><br><span class=\"line\"><span class=\"built_in\">mkdir</span> -p /etc/redis/</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\"># 数据文件目录</span></span><br><span class=\"line\"><span class=\"built_in\">mkdir</span> -p /var/lib/redis/6379</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\"># 日志文件目录</span></span><br><span class=\"line\"><span class=\"built_in\">mkdir</span> -p /var/log/redis</span><br></pre></td></tr></table></figure>\n\n<ul>\n<li>必要配置</li>\n</ul>\n<blockquote>\n<p>拷贝原始配置文件到配置文件目录中</p>\n</blockquote>\n<figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"built_in\">cp</span> /usr/local/src/redis-7.0.0/redis.conf /etc/redis/6379.conf</span><br></pre></td></tr></table></figure>\n\n<blockquote>\n<p>修改6379.conf配置文件</p>\n</blockquote>\n<figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">daemonize <span class=\"built_in\">yes</span> <span class=\"comment\">#允许Redis在后台运行，默认为no</span></span><br><span class=\"line\">protected-mode no <span class=\"comment\">#关闭保护模式，允许远程客户端连接，默认为yes</span></span><br><span class=\"line\"><span class=\"built_in\">bind</span> 127.0.0.1 ::1 <span class=\"comment\">#默认只允许本地机器连接，注释掉该行或者改成机器IP，否则影响远程机器连接</span></span><br><span class=\"line\">requirepass 111111 <span class=\"comment\">#设置Redis连接密码，远程客户端连接需要</span></span><br><span class=\"line\"><span class=\"built_in\">dir</span> /var/lib/redis/6379 <span class=\"comment\"># 设置Redis数据文件目录，用于存放持久化文件RDB和AOF文件，默认为配置文件的所在目录（即安装目录）</span></span><br><span class=\"line\">loglevel notice <span class=\"comment\"># 设置日志级别（根据需要设置，默认:notice）</span></span><br><span class=\"line\">logfile <span class=\"string\">&quot;/var/log/redis/6379.log&quot;</span> <span class=\"comment\"># 设置日志文件位置</span></span><br><span class=\"line\">port 6379 <span class=\"comment\"># 设置Redis运行端口，默认：6379</span></span><br><span class=\"line\">save 3600 1 300 100 60 10000 <span class=\"comment\"># 开启RDB持久化，默认注释掉，需要打开，如果作为缓存使用，可以不开启</span></span><br></pre></td></tr></table></figure>\n\n<h3 id=\"设置服务自启动\"><a href=\"#设置服务自启动\" class=\"headerlink\" title=\"设置服务自启动\"></a>设置服务自启动</h3><h4 id=\"修改启动脚本\"><a href=\"#修改启动脚本\" class=\"headerlink\" title=\"修改启动脚本\"></a>修改启动脚本</h4><p>因为redis脚本中默认是无密码的，但我们设置了Redis的密码，导致通过服务停止的时候，没有权限访问。为了解决这个问题，需要修改启动脚本，以实现我们的需求。</p>\n<figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">REDIS_PASS=111111</span><br><span class=\"line\"><span class=\"variable\">$CLIEXEC</span> -p <span class=\"variable\">$REDISPORT</span> -a <span class=\"variable\">$REDIS_PASS</span> shutdown</span><br></pre></td></tr></table></figure>\n\n<p><img src=\"https://qiniu-image.gotojava.cn/blog/202406051916738.png\" alt=\"image-20240605191616643\"></p>\n<h4 id=\"配置服务自启动\"><a href=\"#配置服务自启动\" class=\"headerlink\" title=\"配置服务自启动\"></a>配置服务自启动</h4><figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"built_in\">cp</span> /usr/local/src/redis-7.0.0/utils/redis_init_script /etc/init.d/redis_6379</span><br><span class=\"line\"><span class=\"built_in\">cd</span> /etc/init.d/ &amp;&amp; chkconfig --level 35 redis_6379 on</span><br></pre></td></tr></table></figure>\n\n<p><img src=\"https://qiniu-image.gotojava.cn/blog/202406030613228.png\" alt=\"image-20240603061328082\"></p>\n<h3 id=\"服务启停\"><a href=\"#服务启停\" class=\"headerlink\" title=\"服务启停\"></a>服务启停</h3><ul>\n<li>启动</li>\n</ul>\n<figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\"># redis-server 配置文件位置</span></span><br><span class=\"line\">redis-server /etc/redis/6379.conf</span><br><span class=\"line\">或</span><br><span class=\"line\">service redis_6379 start</span><br></pre></td></tr></table></figure>\n\n<ul>\n<li>停止</li>\n</ul>\n<figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\"># redis-cli -a 连接密码 -p 端口号(默认：6379)  shutdown</span></span><br><span class=\"line\">redis-cli -a 111111 -p 6379 shutdown</span><br><span class=\"line\">或</span><br><span class=\"line\">service redis_6379 stop</span><br></pre></td></tr></table></figure>\n\n<h2 id=\"卸载\"><a href=\"#卸载\" class=\"headerlink\" title=\"卸载\"></a>卸载</h2><blockquote>\n<p>如果需要卸载Redis，可以删除&#x2F;usr&#x2F;local&#x2F;bin目录下与redis相关的文件</p>\n</blockquote>\n<figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"built_in\">rm</span> -rf /usr/local/bin/redis-*</span><br></pre></td></tr></table></figure>\n\n<h2 id=\"参考\"><a href=\"#参考\" class=\"headerlink\" title=\"参考\"></a>参考</h2><ul>\n<li><a href=\"https://www.cnblogs.com/ggjucheng/archive/2012/08/20/2647788.html\">https://www.cnblogs.com/ggjucheng/archive/2012/08/20/2647788.html</a></li>\n<li><a href=\"https://redis.com.cn/topics/why-use-redis.html\">https://redis.com.cn/topics/why-use-redis.html</a></li>\n</ul>\n","excerpt":"<meta name=\"referrer\" content=\"no-referrer\" />","more":"<h2 id=\"Redis是什么\"><a href=\"#Redis是什么\" class=\"headerlink\" title=\"Redis是什么\"></a>Redis是什么</h2><p>Redis的全称是 <u>Remote Dictionary Server</u> 是一个开源的基于内存的高性能键值对（Key - Value）存储系统。可以用作数据库、缓存和消息代理。</p>\n<h2 id=\"为什么需要\"><a href=\"#为什么需要\" class=\"headerlink\" title=\"为什么需要\"></a>为什么需要</h2><ul>\n<li>作为缓存使用</li>\n</ul>\n<p>Redis 是基于内存做数据存储的，对于关系型数据库来说数据是保存在硬盘上，在读取方面Redis会更快，适合作为缓存使用。所以对于需要频繁查询的操作可以将数据存入Redis中，这样可以极大的减轻数据库服务的压力，提高系统的性能。</p>\n<p><img src=\"https://qiniu-image.gotojava.cn/blog/202406030325885.png\" alt=\"image-20240603032509698\"></p>\n<ul>\n<li>完成一些特定场景的功能</li>\n</ul>\n<p>基于Redis一些数据结构的特性，完成一些类似于排行榜、用户点赞数、访问数、限流、Session会话共享、共同的社交关系、简单消息队列、分布式锁等等，这些功能虽然关系型数据库也能做，但是频繁的访问和修改操作会增加数据库访问压力，但对于Redis来说就非常适合、实现也更方便。</p>\n<h3 id=\"注意\"><a href=\"#注意\" class=\"headerlink\" title=\"注意\"></a>注意</h3><blockquote>\n<p>⚠️注意：需要注意的是，Redis虽然性能很好，但也不是万能的，对于频繁访问的数据，Redis的缓存功能可以极大的减轻数据库的压力。但对于存储一些访问不太频繁的数据，虽然也不是不可以，但是会导致内存资源的浪费。</p>\n</blockquote>\n<blockquote>\n<p>Redis 不适合作为业务数据库使用，虽然 Redis 自身也有一些持久化的机制能将数据保存到硬盘，但是无法保证数据的可靠型，所以不要将 Redis 作为业务数据库使用，避免业务数据的丢失。</p>\n</blockquote>\n<h2 id=\"安装\"><a href=\"#安装\" class=\"headerlink\" title=\"安装\"></a>安装</h2><h3 id=\"说明\"><a href=\"#说明\" class=\"headerlink\" title=\"说明\"></a>说明</h3><ul>\n<li><p>本次所有的测试验证都是使用<a href=\"https://github.com/redis/redis/releases/tag/7.0.0\">Redis 7.0.0</a>来进行。获取和相关的变更信息可以通过 <a href=\"https://github.com/redis/redis/releases\">GitHub</a> 获取。</p>\n</li>\n<li><p>操作系统使用<u>CentOS 7</u>，使用 Parallels Desktop 来模拟主从复制、哨兵、和集群的验证。</p>\n</li>\n<li><p>Redis 可视化客户端可以使用 AnotherRedisDesktopManager，通过 <a href=\"https://github.com/qishibo/AnotherRedisDesktopManager/releases\">GitHub</a> 获取。</p>\n</li>\n<li><p>版本号：Redis 使用标准的做法进行版本管理: <u>主版本号.副版本号.补丁号</u>。 偶数 <u>副版本号</u> 表示一个 <u>稳定的</u> 发布，像 1.2, 2.0, 2.2, 2.4, 2.6, 2.8。奇数副版本号表示 <u>不稳定的</u> 发布，例如 2.9.x 发布是一个不稳定版本，下一个稳定版本将会是Redis 3.0。</p>\n</li>\n<li><p>CentOS 7保证可以正常访问网络，修改 <a href=\"https://blog.csdn.net/weixin_38924500/article/details/109555882\">yum 源为阿里云源</a>、安装 <a href=\"https://gotojava.cn/article/aba7d07\">GCC、GCC-C++</a>，以方便 Redis 的安装部署。</p>\n</li>\n</ul>\n<h3 id=\"安装-1\"><a href=\"#安装-1\" class=\"headerlink\" title=\"安装\"></a>安装</h3><blockquote>\n<p>生产环境的建议安装方式，使安装符合 Linux 文件系统的规范</p>\n</blockquote>\n<ul>\n<li>获取7.0.0安装包</li>\n</ul>\n<figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\"># /usr/local/src 可以用来放自己安装的第三方源码文件</span></span><br><span class=\"line\">wget -P /usr/local/src/ https://download.redis.io/releases/redis-7.0.0.tar.gz</span><br></pre></td></tr></table></figure>\n\n<ul>\n<li>解压</li>\n</ul>\n<figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"built_in\">cd</span> /usr/local/src/</span><br><span class=\"line\">tar -zxf redis-7.0.0.tar.gz</span><br></pre></td></tr></table></figure>\n\n<ul>\n<li>安装</li>\n</ul>\n<figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"built_in\">cd</span> /usr/local/src/redis-7.0.0/</span><br><span class=\"line\">make &amp;&amp; make install</span><br></pre></td></tr></table></figure>\n\n<ul>\n<li>&#x2F;usr&#x2F;local&#x2F;bin下的Redis工具</li>\n</ul>\n<p><img src=\"https://qiniu-image.gotojava.cn/blog/202406030459591.png\" alt=\"Redis 工具说明\"></p>\n<ul>\n<li>创建redis的配置和数据放置目录</li>\n</ul>\n<figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\"># 配置文件目录</span></span><br><span class=\"line\"><span class=\"built_in\">mkdir</span> -p /etc/redis/</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\"># 数据文件目录</span></span><br><span class=\"line\"><span class=\"built_in\">mkdir</span> -p /var/lib/redis/6379</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\"># 日志文件目录</span></span><br><span class=\"line\"><span class=\"built_in\">mkdir</span> -p /var/log/redis</span><br></pre></td></tr></table></figure>\n\n<ul>\n<li>必要配置</li>\n</ul>\n<blockquote>\n<p>拷贝原始配置文件到配置文件目录中</p>\n</blockquote>\n<figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"built_in\">cp</span> /usr/local/src/redis-7.0.0/redis.conf /etc/redis/6379.conf</span><br></pre></td></tr></table></figure>\n\n<blockquote>\n<p>修改6379.conf配置文件</p>\n</blockquote>\n<figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">daemonize <span class=\"built_in\">yes</span> <span class=\"comment\">#允许Redis在后台运行，默认为no</span></span><br><span class=\"line\">protected-mode no <span class=\"comment\">#关闭保护模式，允许远程客户端连接，默认为yes</span></span><br><span class=\"line\"><span class=\"built_in\">bind</span> 127.0.0.1 ::1 <span class=\"comment\">#默认只允许本地机器连接，注释掉该行或者改成机器IP，否则影响远程机器连接</span></span><br><span class=\"line\">requirepass 111111 <span class=\"comment\">#设置Redis连接密码，远程客户端连接需要</span></span><br><span class=\"line\"><span class=\"built_in\">dir</span> /var/lib/redis/6379 <span class=\"comment\"># 设置Redis数据文件目录，用于存放持久化文件RDB和AOF文件，默认为配置文件的所在目录（即安装目录）</span></span><br><span class=\"line\">loglevel notice <span class=\"comment\"># 设置日志级别（根据需要设置，默认:notice）</span></span><br><span class=\"line\">logfile <span class=\"string\">&quot;/var/log/redis/6379.log&quot;</span> <span class=\"comment\"># 设置日志文件位置</span></span><br><span class=\"line\">port 6379 <span class=\"comment\"># 设置Redis运行端口，默认：6379</span></span><br><span class=\"line\">save 3600 1 300 100 60 10000 <span class=\"comment\"># 开启RDB持久化，默认注释掉，需要打开，如果作为缓存使用，可以不开启</span></span><br></pre></td></tr></table></figure>\n\n<h3 id=\"设置服务自启动\"><a href=\"#设置服务自启动\" class=\"headerlink\" title=\"设置服务自启动\"></a>设置服务自启动</h3><h4 id=\"修改启动脚本\"><a href=\"#修改启动脚本\" class=\"headerlink\" title=\"修改启动脚本\"></a>修改启动脚本</h4><p>因为redis脚本中默认是无密码的，但我们设置了Redis的密码，导致通过服务停止的时候，没有权限访问。为了解决这个问题，需要修改启动脚本，以实现我们的需求。</p>\n<figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">REDIS_PASS=111111</span><br><span class=\"line\"><span class=\"variable\">$CLIEXEC</span> -p <span class=\"variable\">$REDISPORT</span> -a <span class=\"variable\">$REDIS_PASS</span> shutdown</span><br></pre></td></tr></table></figure>\n\n<p><img src=\"https://qiniu-image.gotojava.cn/blog/202406051916738.png\" alt=\"image-20240605191616643\"></p>\n<h4 id=\"配置服务自启动\"><a href=\"#配置服务自启动\" class=\"headerlink\" title=\"配置服务自启动\"></a>配置服务自启动</h4><figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"built_in\">cp</span> /usr/local/src/redis-7.0.0/utils/redis_init_script /etc/init.d/redis_6379</span><br><span class=\"line\"><span class=\"built_in\">cd</span> /etc/init.d/ &amp;&amp; chkconfig --level 35 redis_6379 on</span><br></pre></td></tr></table></figure>\n\n<p><img src=\"https://qiniu-image.gotojava.cn/blog/202406030613228.png\" alt=\"image-20240603061328082\"></p>\n<h3 id=\"服务启停\"><a href=\"#服务启停\" class=\"headerlink\" title=\"服务启停\"></a>服务启停</h3><ul>\n<li>启动</li>\n</ul>\n<figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\"># redis-server 配置文件位置</span></span><br><span class=\"line\">redis-server /etc/redis/6379.conf</span><br><span class=\"line\">或</span><br><span class=\"line\">service redis_6379 start</span><br></pre></td></tr></table></figure>\n\n<ul>\n<li>停止</li>\n</ul>\n<figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\"># redis-cli -a 连接密码 -p 端口号(默认：6379)  shutdown</span></span><br><span class=\"line\">redis-cli -a 111111 -p 6379 shutdown</span><br><span class=\"line\">或</span><br><span class=\"line\">service redis_6379 stop</span><br></pre></td></tr></table></figure>\n\n<h2 id=\"卸载\"><a href=\"#卸载\" class=\"headerlink\" title=\"卸载\"></a>卸载</h2><blockquote>\n<p>如果需要卸载Redis，可以删除&#x2F;usr&#x2F;local&#x2F;bin目录下与redis相关的文件</p>\n</blockquote>\n<figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"built_in\">rm</span> -rf /usr/local/bin/redis-*</span><br></pre></td></tr></table></figure>\n\n<h2 id=\"参考\"><a href=\"#参考\" class=\"headerlink\" title=\"参考\"></a>参考</h2><ul>\n<li><a href=\"https://www.cnblogs.com/ggjucheng/archive/2012/08/20/2647788.html\">https://www.cnblogs.com/ggjucheng/archive/2012/08/20/2647788.html</a></li>\n<li><a href=\"https://redis.com.cn/topics/why-use-redis.html\">https://redis.com.cn/topics/why-use-redis.html</a></li>\n</ul>"},{"title":"SSH 连接不到 EC2 Linux 实例原因排查","abbrlink":"306847ba","date":"2024-01-19T03:56:12.000Z","toc":true,"_content":"<meta name=\"referrer\" content=\"no-referrer\" />\n\nAmazon Elastic Compute Cloud (EC2) 是一个在 AWS 云平台上提供可扩展计算能力的按需计算服务。本文用于记录MacOS环境下连接EC2实例的排查过程。\n\n<!--more-->\n\n当时由于第一次接触AWS的EC2产品，对AWS除了知道它和阿里云一样都属于云计算公司以外，并没有过多的了解。但在之前已经使用过腾讯云、阿里云的相关云服务产品，有一定的云上使用经验。\n\n网上的大多数方案都是基于Windows的方法，对于MacOS的平台的资料并不多或者没法通过验证。因对AWS产品的不熟，在困扰许久的情况下，我联系了AWS的中国区的官方支持人员。在与亚马逊的小姐姐沟通后，她们针对我的问题与技术进行了沟通并对我的问题进行了邮件回复和文档支持。\n\n以下是邮件回复的的文档资料（部分内容）\n\n1. 在 Linux 或者 mac 环境下，常见的ssh的命令：\n\n```shell\n ssh -i /path/<替换为您自己的秘钥名称>.pem ec2-user@publicdns-hostname-or-ipv4-address\n```\n\n2. 在 windows 下，请参考使用 [putty 从 windows 连接到 linux 实例](https://docs.aws.amazon.com/zh_cn/AWSEC2/latest/UserGuide/putty.html)。通常分为两步，秘钥格式的转换，以及连接。\n\n连接时，请使用 `ec2-user`账户进行登陆，对于 `publicdns-hostname-or-ipv4-address` 的获取可以通过 AWS 控制台的 EC2 实例列表中获取。但是公共的DNS地址会比较长，我们使用公有的 `Ipv4` 同样是可以去连接的。\n\n![image-20240119043653371](https://qiniu-image.gotojava.cn/blog/image-20240119043653371.png)\n\n在连接之前，首先要确定，我们的实例地址是可以连接的。这个可以通过 `ping` 来确认。\n\n![image-20240119044001526](https://qiniu-image.gotojava.cn/blog/image-20240119044001526.png)\n\n如果发现连接可达，但是SSH连接无法建立的时候，可以通过配置AWS的配置安全组来解决。配置一条SSH的安全组规则就可以了。（这种情况通常是最常见的）\n\n![image-20240119044450513](https://qiniu-image.gotojava.cn/blog/image-20240119044450513.png)\n\n虽然上面使用命令解决了SSH连接实例的问题，但是每次连接还是很麻烦的，最后找到了一个比较友好的MacOS下的一个开源工具 [Tabby](https://tabby.sh/) ，可以很好解决秘钥连接的问题。国产的 FinalShell 工具也是支持的，但是我没有验证成功。下图是 Tabby的截图，颜值还是不错的~\n\n![image-20240119050926033](https://qiniu-image.gotojava.cn/blog/image-20240119050926033.png)\n\n参考文档：\n\n- [启动&amp;连接EC2指导-新版](https://pan.baidu.com/s/1VIGY-7oBVbdyUeBWQUhWUg?pwd=8888)（pdf）\n- [SSH 连接不到 EC2 Linux 实例原因排查](https://pan.baidu.com/s/1VIGY-7oBVbdyUeBWQUhWUg?pwd=8888)（pdf）\n","source":"_posts/SSH连接不到EC2-Linux实例原因排查.md","raw":"---\ntitle: SSH 连接不到 EC2 Linux 实例原因排查\ncategories:\n  - 开发者笔记\ntags:\n  - Linux\nabbrlink: 306847ba\ndate: 2024-01-19 03:56:12\ntoc: true\n---\n<meta name=\"referrer\" content=\"no-referrer\" />\n\nAmazon Elastic Compute Cloud (EC2) 是一个在 AWS 云平台上提供可扩展计算能力的按需计算服务。本文用于记录MacOS环境下连接EC2实例的排查过程。\n\n<!--more-->\n\n当时由于第一次接触AWS的EC2产品，对AWS除了知道它和阿里云一样都属于云计算公司以外，并没有过多的了解。但在之前已经使用过腾讯云、阿里云的相关云服务产品，有一定的云上使用经验。\n\n网上的大多数方案都是基于Windows的方法，对于MacOS的平台的资料并不多或者没法通过验证。因对AWS产品的不熟，在困扰许久的情况下，我联系了AWS的中国区的官方支持人员。在与亚马逊的小姐姐沟通后，她们针对我的问题与技术进行了沟通并对我的问题进行了邮件回复和文档支持。\n\n以下是邮件回复的的文档资料（部分内容）\n\n1. 在 Linux 或者 mac 环境下，常见的ssh的命令：\n\n```shell\n ssh -i /path/<替换为您自己的秘钥名称>.pem ec2-user@publicdns-hostname-or-ipv4-address\n```\n\n2. 在 windows 下，请参考使用 [putty 从 windows 连接到 linux 实例](https://docs.aws.amazon.com/zh_cn/AWSEC2/latest/UserGuide/putty.html)。通常分为两步，秘钥格式的转换，以及连接。\n\n连接时，请使用 `ec2-user`账户进行登陆，对于 `publicdns-hostname-or-ipv4-address` 的获取可以通过 AWS 控制台的 EC2 实例列表中获取。但是公共的DNS地址会比较长，我们使用公有的 `Ipv4` 同样是可以去连接的。\n\n![image-20240119043653371](https://qiniu-image.gotojava.cn/blog/image-20240119043653371.png)\n\n在连接之前，首先要确定，我们的实例地址是可以连接的。这个可以通过 `ping` 来确认。\n\n![image-20240119044001526](https://qiniu-image.gotojava.cn/blog/image-20240119044001526.png)\n\n如果发现连接可达，但是SSH连接无法建立的时候，可以通过配置AWS的配置安全组来解决。配置一条SSH的安全组规则就可以了。（这种情况通常是最常见的）\n\n![image-20240119044450513](https://qiniu-image.gotojava.cn/blog/image-20240119044450513.png)\n\n虽然上面使用命令解决了SSH连接实例的问题，但是每次连接还是很麻烦的，最后找到了一个比较友好的MacOS下的一个开源工具 [Tabby](https://tabby.sh/) ，可以很好解决秘钥连接的问题。国产的 FinalShell 工具也是支持的，但是我没有验证成功。下图是 Tabby的截图，颜值还是不错的~\n\n![image-20240119050926033](https://qiniu-image.gotojava.cn/blog/image-20240119050926033.png)\n\n参考文档：\n\n- [启动&amp;连接EC2指导-新版](https://pan.baidu.com/s/1VIGY-7oBVbdyUeBWQUhWUg?pwd=8888)（pdf）\n- [SSH 连接不到 EC2 Linux 实例原因排查](https://pan.baidu.com/s/1VIGY-7oBVbdyUeBWQUhWUg?pwd=8888)（pdf）\n","slug":"SSH连接不到EC2-Linux实例原因排查","published":1,"updated":"2025-03-28T06:10:29.179Z","comments":1,"layout":"post","photos":[],"_id":"cm8se3tdf000ebb8lagkb4iih","content":"<meta name=\"referrer\" content=\"no-referrer\" />\n\n<p>Amazon Elastic Compute Cloud (EC2) 是一个在 AWS 云平台上提供可扩展计算能力的按需计算服务。本文用于记录MacOS环境下连接EC2实例的排查过程。</p>\n<span id=\"more\"></span>\n\n<p>当时由于第一次接触AWS的EC2产品，对AWS除了知道它和阿里云一样都属于云计算公司以外，并没有过多的了解。但在之前已经使用过腾讯云、阿里云的相关云服务产品，有一定的云上使用经验。</p>\n<p>网上的大多数方案都是基于Windows的方法，对于MacOS的平台的资料并不多或者没法通过验证。因对AWS产品的不熟，在困扰许久的情况下，我联系了AWS的中国区的官方支持人员。在与亚马逊的小姐姐沟通后，她们针对我的问题与技术进行了沟通并对我的问题进行了邮件回复和文档支持。</p>\n<p>以下是邮件回复的的文档资料（部分内容）</p>\n<ol>\n<li>在 Linux 或者 mac 环境下，常见的ssh的命令：</li>\n</ol>\n<figure class=\"highlight shell\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">ssh -i /path/&lt;替换为您自己的秘钥名称&gt;.pem ec2-user@publicdns-hostname-or-ipv4-address</span><br></pre></td></tr></table></figure>\n\n<ol start=\"2\">\n<li>在 windows 下，请参考使用 <a href=\"https://docs.aws.amazon.com/zh_cn/AWSEC2/latest/UserGuide/putty.html\">putty 从 windows 连接到 linux 实例</a>。通常分为两步，秘钥格式的转换，以及连接。</li>\n</ol>\n<p>连接时，请使用 <code>ec2-user</code>账户进行登陆，对于 <code>publicdns-hostname-or-ipv4-address</code> 的获取可以通过 AWS 控制台的 EC2 实例列表中获取。但是公共的DNS地址会比较长，我们使用公有的 <code>Ipv4</code> 同样是可以去连接的。</p>\n<p><img src=\"https://qiniu-image.gotojava.cn/blog/image-20240119043653371.png\" alt=\"image-20240119043653371\"></p>\n<p>在连接之前，首先要确定，我们的实例地址是可以连接的。这个可以通过 <code>ping</code> 来确认。</p>\n<p><img src=\"https://qiniu-image.gotojava.cn/blog/image-20240119044001526.png\" alt=\"image-20240119044001526\"></p>\n<p>如果发现连接可达，但是SSH连接无法建立的时候，可以通过配置AWS的配置安全组来解决。配置一条SSH的安全组规则就可以了。（这种情况通常是最常见的）</p>\n<p><img src=\"https://qiniu-image.gotojava.cn/blog/image-20240119044450513.png\" alt=\"image-20240119044450513\"></p>\n<p>虽然上面使用命令解决了SSH连接实例的问题，但是每次连接还是很麻烦的，最后找到了一个比较友好的MacOS下的一个开源工具 <a href=\"https://tabby.sh/\">Tabby</a> ，可以很好解决秘钥连接的问题。国产的 FinalShell 工具也是支持的，但是我没有验证成功。下图是 Tabby的截图，颜值还是不错的~</p>\n<p><img src=\"https://qiniu-image.gotojava.cn/blog/image-20240119050926033.png\" alt=\"image-20240119050926033\"></p>\n<p>参考文档：</p>\n<ul>\n<li><a href=\"https://pan.baidu.com/s/1VIGY-7oBVbdyUeBWQUhWUg?pwd=8888\">启动&amp;连接EC2指导-新版</a>（pdf）</li>\n<li><a href=\"https://pan.baidu.com/s/1VIGY-7oBVbdyUeBWQUhWUg?pwd=8888\">SSH 连接不到 EC2 Linux 实例原因排查</a>（pdf）</li>\n</ul>\n","excerpt":"<meta name=\"referrer\" content=\"no-referrer\" />\n\n<p>Amazon Elastic Compute Cloud (EC2) 是一个在 AWS 云平台上提供可扩展计算能力的按需计算服务。本文用于记录MacOS环境下连接EC2实例的排查过程。</p>","more":"<p>当时由于第一次接触AWS的EC2产品，对AWS除了知道它和阿里云一样都属于云计算公司以外，并没有过多的了解。但在之前已经使用过腾讯云、阿里云的相关云服务产品，有一定的云上使用经验。</p>\n<p>网上的大多数方案都是基于Windows的方法，对于MacOS的平台的资料并不多或者没法通过验证。因对AWS产品的不熟，在困扰许久的情况下，我联系了AWS的中国区的官方支持人员。在与亚马逊的小姐姐沟通后，她们针对我的问题与技术进行了沟通并对我的问题进行了邮件回复和文档支持。</p>\n<p>以下是邮件回复的的文档资料（部分内容）</p>\n<ol>\n<li>在 Linux 或者 mac 环境下，常见的ssh的命令：</li>\n</ol>\n<figure class=\"highlight shell\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">ssh -i /path/&lt;替换为您自己的秘钥名称&gt;.pem ec2-user@publicdns-hostname-or-ipv4-address</span><br></pre></td></tr></table></figure>\n\n<ol start=\"2\">\n<li>在 windows 下，请参考使用 <a href=\"https://docs.aws.amazon.com/zh_cn/AWSEC2/latest/UserGuide/putty.html\">putty 从 windows 连接到 linux 实例</a>。通常分为两步，秘钥格式的转换，以及连接。</li>\n</ol>\n<p>连接时，请使用 <code>ec2-user</code>账户进行登陆，对于 <code>publicdns-hostname-or-ipv4-address</code> 的获取可以通过 AWS 控制台的 EC2 实例列表中获取。但是公共的DNS地址会比较长，我们使用公有的 <code>Ipv4</code> 同样是可以去连接的。</p>\n<p><img src=\"https://qiniu-image.gotojava.cn/blog/image-20240119043653371.png\" alt=\"image-20240119043653371\"></p>\n<p>在连接之前，首先要确定，我们的实例地址是可以连接的。这个可以通过 <code>ping</code> 来确认。</p>\n<p><img src=\"https://qiniu-image.gotojava.cn/blog/image-20240119044001526.png\" alt=\"image-20240119044001526\"></p>\n<p>如果发现连接可达，但是SSH连接无法建立的时候，可以通过配置AWS的配置安全组来解决。配置一条SSH的安全组规则就可以了。（这种情况通常是最常见的）</p>\n<p><img src=\"https://qiniu-image.gotojava.cn/blog/image-20240119044450513.png\" alt=\"image-20240119044450513\"></p>\n<p>虽然上面使用命令解决了SSH连接实例的问题，但是每次连接还是很麻烦的，最后找到了一个比较友好的MacOS下的一个开源工具 <a href=\"https://tabby.sh/\">Tabby</a> ，可以很好解决秘钥连接的问题。国产的 FinalShell 工具也是支持的，但是我没有验证成功。下图是 Tabby的截图，颜值还是不错的~</p>\n<p><img src=\"https://qiniu-image.gotojava.cn/blog/image-20240119050926033.png\" alt=\"image-20240119050926033\"></p>\n<p>参考文档：</p>\n<ul>\n<li><a href=\"https://pan.baidu.com/s/1VIGY-7oBVbdyUeBWQUhWUg?pwd=8888\">启动&amp;连接EC2指导-新版</a>（pdf）</li>\n<li><a href=\"https://pan.baidu.com/s/1VIGY-7oBVbdyUeBWQUhWUg?pwd=8888\">SSH 连接不到 EC2 Linux 实例原因排查</a>（pdf）</li>\n</ul>"},{"title":"SpringBoot2.5适配TongWeb7示例","toc":true,"abbrlink":"7e65becb","date":"2024-10-30T12:39:07.000Z","_content":"\n\n本文用于记录 SpringBoot 嵌入 东方通 Web 应用服务器的过程。\n\n<!-- more -->\n\n## 背景\n\n[TongWeb](https://www.tongtech.com/pctype/25.html) 是国内开发的一款高性能应用服务器软件，可以替代 Tomcat。因项目的国产化要求，需要使用 TongWeb 来替代默认的 Tomcat 容器。\n\n## 版本说明\n\n项目使用的 Spring Boot 版本为`2.5.5`。TongWeb 的版本为`7.0.E.6_P11`。\n\n## 项目结构\n\n ![image-20241030121505174](https://qiniu-image.gotojava.cn/blog/202410301219116.png)\n\n## Maven配置\n\n```\n<parent>\n    <groupId>org.springframework.boot</groupId>\n    <artifactId>spring-boot-starter-parent</artifactId>\n    <version>2.5.5</version>\n    <relativePath/>\n</parent>\n\n<properties>\n    <maven.compiler.source>8</maven.compiler.source>\n    <maven.compiler.target>8</maven.compiler.target>\n    <project.build.sourceEncoding>UTF-8</project.build.sourceEncoding>\n</properties>\n\n<dependencies>\n    <dependency>\n        <groupId>org.springframework.boot</groupId>\n        <artifactId>spring-boot-starter-web</artifactId>\n        <exclusions>\n            <!--排除tomcat依赖-->\n            <exclusion>\n                <groupId>org.springframework.boot</groupId>\n                <artifactId>spring-boot-starter-tomcat</artifactId>\n            </exclusion>\n        </exclusions>\n    </dependency>\n\n    <dependency>\n        <groupId>com.tongweb.springboot</groupId>\n        <artifactId>tongweb-spring-boot-starter-2.x</artifactId>\n        <version>7.0.E.6_P11</version>\n    </dependency>\n    <dependency>\n        <groupId>org.springframework.boot</groupId>\n        <artifactId>spring-boot-starter-test</artifactId>\n        <scope>test</scope>\n    </dependency>\n\n    <dependency>\n        <groupId>org.springframework.boot</groupId>\n        <artifactId>spring-boot-starter-test</artifactId>\n        <scope>test</scope>\n        <exclusions>\n            <exclusion>\n                <groupId>org.junit.vintage</groupId>\n                <artifactId>junit-vintage-engine</artifactId>\n            </exclusion>\n        </exclusions>\n    </dependency>\n</dependencies>\n\n<build>\n    <plugins>\n        <plugin>\n            <groupId>org.springframework.boot</groupId>\n            <artifactId>spring-boot-maven-plugin</artifactId>\n            <configuration>\n                <mainClass>com.tong.App</mainClass>\n            </configuration>\n        </plugin>\n    </plugins>\n</build>\n\n<dependencyManagement>\n    <dependencies>\n        <dependency>\n            <groupId>com.tongweb</groupId>\n            <artifactId>tongweb-embed-dependencies</artifactId>\n            <version>7.0.E.6_P11</version>\n            <type>pom</type>\n            <scope>import</scope>\n        </dependency>\n    </dependencies>\n</dependencyManagement>\n```\n\n## 配置License\n\n- application.yaml\n\n```yaml\nserver:\n  tongweb:\n    uri-encoding: UTF-8\n    license:\n      type: file\n      path: classpath:tongweb/license.dat\n```\n\n## 测试\n\n![image-20241030122241509](https://qiniu-image.gotojava.cn/blog/202410301222638.png)\n\n## 参考\n\n- 源码：https://github.com/yangzhao917/springboot2-adapter-tongweb7-example\n","source":"_posts/SpringBoot2.5适配TongWeb7示例.md","raw":"---\ntitle: SpringBoot2.5适配TongWeb7示例\ntags: [SpringBoot,东方通]\ntoc: true\nabbrlink: 7e65becb\ndate: 2024-10-30 12:39:07\n---\n\n\n本文用于记录 SpringBoot 嵌入 东方通 Web 应用服务器的过程。\n\n<!-- more -->\n\n## 背景\n\n[TongWeb](https://www.tongtech.com/pctype/25.html) 是国内开发的一款高性能应用服务器软件，可以替代 Tomcat。因项目的国产化要求，需要使用 TongWeb 来替代默认的 Tomcat 容器。\n\n## 版本说明\n\n项目使用的 Spring Boot 版本为`2.5.5`。TongWeb 的版本为`7.0.E.6_P11`。\n\n## 项目结构\n\n ![image-20241030121505174](https://qiniu-image.gotojava.cn/blog/202410301219116.png)\n\n## Maven配置\n\n```\n<parent>\n    <groupId>org.springframework.boot</groupId>\n    <artifactId>spring-boot-starter-parent</artifactId>\n    <version>2.5.5</version>\n    <relativePath/>\n</parent>\n\n<properties>\n    <maven.compiler.source>8</maven.compiler.source>\n    <maven.compiler.target>8</maven.compiler.target>\n    <project.build.sourceEncoding>UTF-8</project.build.sourceEncoding>\n</properties>\n\n<dependencies>\n    <dependency>\n        <groupId>org.springframework.boot</groupId>\n        <artifactId>spring-boot-starter-web</artifactId>\n        <exclusions>\n            <!--排除tomcat依赖-->\n            <exclusion>\n                <groupId>org.springframework.boot</groupId>\n                <artifactId>spring-boot-starter-tomcat</artifactId>\n            </exclusion>\n        </exclusions>\n    </dependency>\n\n    <dependency>\n        <groupId>com.tongweb.springboot</groupId>\n        <artifactId>tongweb-spring-boot-starter-2.x</artifactId>\n        <version>7.0.E.6_P11</version>\n    </dependency>\n    <dependency>\n        <groupId>org.springframework.boot</groupId>\n        <artifactId>spring-boot-starter-test</artifactId>\n        <scope>test</scope>\n    </dependency>\n\n    <dependency>\n        <groupId>org.springframework.boot</groupId>\n        <artifactId>spring-boot-starter-test</artifactId>\n        <scope>test</scope>\n        <exclusions>\n            <exclusion>\n                <groupId>org.junit.vintage</groupId>\n                <artifactId>junit-vintage-engine</artifactId>\n            </exclusion>\n        </exclusions>\n    </dependency>\n</dependencies>\n\n<build>\n    <plugins>\n        <plugin>\n            <groupId>org.springframework.boot</groupId>\n            <artifactId>spring-boot-maven-plugin</artifactId>\n            <configuration>\n                <mainClass>com.tong.App</mainClass>\n            </configuration>\n        </plugin>\n    </plugins>\n</build>\n\n<dependencyManagement>\n    <dependencies>\n        <dependency>\n            <groupId>com.tongweb</groupId>\n            <artifactId>tongweb-embed-dependencies</artifactId>\n            <version>7.0.E.6_P11</version>\n            <type>pom</type>\n            <scope>import</scope>\n        </dependency>\n    </dependencies>\n</dependencyManagement>\n```\n\n## 配置License\n\n- application.yaml\n\n```yaml\nserver:\n  tongweb:\n    uri-encoding: UTF-8\n    license:\n      type: file\n      path: classpath:tongweb/license.dat\n```\n\n## 测试\n\n![image-20241030122241509](https://qiniu-image.gotojava.cn/blog/202410301222638.png)\n\n## 参考\n\n- 源码：https://github.com/yangzhao917/springboot2-adapter-tongweb7-example\n","slug":"SpringBoot2.5适配TongWeb7示例","published":1,"updated":"2025-03-28T06:10:25.294Z","comments":1,"layout":"post","photos":[],"_id":"cm8se3tdg000fbb8lg6s37aki","content":"<p>本文用于记录 SpringBoot 嵌入 东方通 Web 应用服务器的过程。</p>\n<span id=\"more\"></span>\n\n<h2 id=\"背景\"><a href=\"#背景\" class=\"headerlink\" title=\"背景\"></a>背景</h2><p><a href=\"https://www.tongtech.com/pctype/25.html\">TongWeb</a> 是国内开发的一款高性能应用服务器软件，可以替代 Tomcat。因项目的国产化要求，需要使用 TongWeb 来替代默认的 Tomcat 容器。</p>\n<h2 id=\"版本说明\"><a href=\"#版本说明\" class=\"headerlink\" title=\"版本说明\"></a>版本说明</h2><p>项目使用的 Spring Boot 版本为<code>2.5.5</code>。TongWeb 的版本为<code>7.0.E.6_P11</code>。</p>\n<h2 id=\"项目结构\"><a href=\"#项目结构\" class=\"headerlink\" title=\"项目结构\"></a>项目结构</h2><p> <img src=\"https://qiniu-image.gotojava.cn/blog/202410301219116.png\" alt=\"image-20241030121505174\"></p>\n<h2 id=\"Maven配置\"><a href=\"#Maven配置\" class=\"headerlink\" title=\"Maven配置\"></a>Maven配置</h2><figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br><span class=\"line\">38</span><br><span class=\"line\">39</span><br><span class=\"line\">40</span><br><span class=\"line\">41</span><br><span class=\"line\">42</span><br><span class=\"line\">43</span><br><span class=\"line\">44</span><br><span class=\"line\">45</span><br><span class=\"line\">46</span><br><span class=\"line\">47</span><br><span class=\"line\">48</span><br><span class=\"line\">49</span><br><span class=\"line\">50</span><br><span class=\"line\">51</span><br><span class=\"line\">52</span><br><span class=\"line\">53</span><br><span class=\"line\">54</span><br><span class=\"line\">55</span><br><span class=\"line\">56</span><br><span class=\"line\">57</span><br><span class=\"line\">58</span><br><span class=\"line\">59</span><br><span class=\"line\">60</span><br><span class=\"line\">61</span><br><span class=\"line\">62</span><br><span class=\"line\">63</span><br><span class=\"line\">64</span><br><span class=\"line\">65</span><br><span class=\"line\">66</span><br><span class=\"line\">67</span><br><span class=\"line\">68</span><br><span class=\"line\">69</span><br><span class=\"line\">70</span><br><span class=\"line\">71</span><br><span class=\"line\">72</span><br><span class=\"line\">73</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">&lt;parent&gt;</span><br><span class=\"line\">    &lt;groupId&gt;org.springframework.boot&lt;/groupId&gt;</span><br><span class=\"line\">    &lt;artifactId&gt;spring-boot-starter-parent&lt;/artifactId&gt;</span><br><span class=\"line\">    &lt;version&gt;2.5.5&lt;/version&gt;</span><br><span class=\"line\">    &lt;relativePath/&gt;</span><br><span class=\"line\">&lt;/parent&gt;</span><br><span class=\"line\"></span><br><span class=\"line\">&lt;properties&gt;</span><br><span class=\"line\">    &lt;maven.compiler.source&gt;8&lt;/maven.compiler.source&gt;</span><br><span class=\"line\">    &lt;maven.compiler.target&gt;8&lt;/maven.compiler.target&gt;</span><br><span class=\"line\">    &lt;project.build.sourceEncoding&gt;UTF-8&lt;/project.build.sourceEncoding&gt;</span><br><span class=\"line\">&lt;/properties&gt;</span><br><span class=\"line\"></span><br><span class=\"line\">&lt;dependencies&gt;</span><br><span class=\"line\">    &lt;dependency&gt;</span><br><span class=\"line\">        &lt;groupId&gt;org.springframework.boot&lt;/groupId&gt;</span><br><span class=\"line\">        &lt;artifactId&gt;spring-boot-starter-web&lt;/artifactId&gt;</span><br><span class=\"line\">        &lt;exclusions&gt;</span><br><span class=\"line\">            &lt;!--排除tomcat依赖--&gt;</span><br><span class=\"line\">            &lt;exclusion&gt;</span><br><span class=\"line\">                &lt;groupId&gt;org.springframework.boot&lt;/groupId&gt;</span><br><span class=\"line\">                &lt;artifactId&gt;spring-boot-starter-tomcat&lt;/artifactId&gt;</span><br><span class=\"line\">            &lt;/exclusion&gt;</span><br><span class=\"line\">        &lt;/exclusions&gt;</span><br><span class=\"line\">    &lt;/dependency&gt;</span><br><span class=\"line\"></span><br><span class=\"line\">    &lt;dependency&gt;</span><br><span class=\"line\">        &lt;groupId&gt;com.tongweb.springboot&lt;/groupId&gt;</span><br><span class=\"line\">        &lt;artifactId&gt;tongweb-spring-boot-starter-2.x&lt;/artifactId&gt;</span><br><span class=\"line\">        &lt;version&gt;7.0.E.6_P11&lt;/version&gt;</span><br><span class=\"line\">    &lt;/dependency&gt;</span><br><span class=\"line\">    &lt;dependency&gt;</span><br><span class=\"line\">        &lt;groupId&gt;org.springframework.boot&lt;/groupId&gt;</span><br><span class=\"line\">        &lt;artifactId&gt;spring-boot-starter-test&lt;/artifactId&gt;</span><br><span class=\"line\">        &lt;scope&gt;test&lt;/scope&gt;</span><br><span class=\"line\">    &lt;/dependency&gt;</span><br><span class=\"line\"></span><br><span class=\"line\">    &lt;dependency&gt;</span><br><span class=\"line\">        &lt;groupId&gt;org.springframework.boot&lt;/groupId&gt;</span><br><span class=\"line\">        &lt;artifactId&gt;spring-boot-starter-test&lt;/artifactId&gt;</span><br><span class=\"line\">        &lt;scope&gt;test&lt;/scope&gt;</span><br><span class=\"line\">        &lt;exclusions&gt;</span><br><span class=\"line\">            &lt;exclusion&gt;</span><br><span class=\"line\">                &lt;groupId&gt;org.junit.vintage&lt;/groupId&gt;</span><br><span class=\"line\">                &lt;artifactId&gt;junit-vintage-engine&lt;/artifactId&gt;</span><br><span class=\"line\">            &lt;/exclusion&gt;</span><br><span class=\"line\">        &lt;/exclusions&gt;</span><br><span class=\"line\">    &lt;/dependency&gt;</span><br><span class=\"line\">&lt;/dependencies&gt;</span><br><span class=\"line\"></span><br><span class=\"line\">&lt;build&gt;</span><br><span class=\"line\">    &lt;plugins&gt;</span><br><span class=\"line\">        &lt;plugin&gt;</span><br><span class=\"line\">            &lt;groupId&gt;org.springframework.boot&lt;/groupId&gt;</span><br><span class=\"line\">            &lt;artifactId&gt;spring-boot-maven-plugin&lt;/artifactId&gt;</span><br><span class=\"line\">            &lt;configuration&gt;</span><br><span class=\"line\">                &lt;mainClass&gt;com.tong.App&lt;/mainClass&gt;</span><br><span class=\"line\">            &lt;/configuration&gt;</span><br><span class=\"line\">        &lt;/plugin&gt;</span><br><span class=\"line\">    &lt;/plugins&gt;</span><br><span class=\"line\">&lt;/build&gt;</span><br><span class=\"line\"></span><br><span class=\"line\">&lt;dependencyManagement&gt;</span><br><span class=\"line\">    &lt;dependencies&gt;</span><br><span class=\"line\">        &lt;dependency&gt;</span><br><span class=\"line\">            &lt;groupId&gt;com.tongweb&lt;/groupId&gt;</span><br><span class=\"line\">            &lt;artifactId&gt;tongweb-embed-dependencies&lt;/artifactId&gt;</span><br><span class=\"line\">            &lt;version&gt;7.0.E.6_P11&lt;/version&gt;</span><br><span class=\"line\">            &lt;type&gt;pom&lt;/type&gt;</span><br><span class=\"line\">            &lt;scope&gt;import&lt;/scope&gt;</span><br><span class=\"line\">        &lt;/dependency&gt;</span><br><span class=\"line\">    &lt;/dependencies&gt;</span><br><span class=\"line\">&lt;/dependencyManagement&gt;</span><br></pre></td></tr></table></figure>\n\n<h2 id=\"配置License\"><a href=\"#配置License\" class=\"headerlink\" title=\"配置License\"></a>配置License</h2><ul>\n<li>application.yaml</li>\n</ul>\n<figure class=\"highlight yaml\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"attr\">server:</span></span><br><span class=\"line\">  <span class=\"attr\">tongweb:</span></span><br><span class=\"line\">    <span class=\"attr\">uri-encoding:</span> <span class=\"string\">UTF-8</span></span><br><span class=\"line\">    <span class=\"attr\">license:</span></span><br><span class=\"line\">      <span class=\"attr\">type:</span> <span class=\"string\">file</span></span><br><span class=\"line\">      <span class=\"attr\">path:</span> <span class=\"string\">classpath:tongweb/license.dat</span></span><br></pre></td></tr></table></figure>\n\n<h2 id=\"测试\"><a href=\"#测试\" class=\"headerlink\" title=\"测试\"></a>测试</h2><p><img src=\"https://qiniu-image.gotojava.cn/blog/202410301222638.png\" alt=\"image-20241030122241509\"></p>\n<h2 id=\"参考\"><a href=\"#参考\" class=\"headerlink\" title=\"参考\"></a>参考</h2><ul>\n<li>源码：<a href=\"https://github.com/yangzhao917/springboot2-adapter-tongweb7-example\">https://github.com/yangzhao917/springboot2-adapter-tongweb7-example</a></li>\n</ul>\n","excerpt":"<p>本文用于记录 SpringBoot 嵌入 东方通 Web 应用服务器的过程。</p>","more":"<h2 id=\"背景\"><a href=\"#背景\" class=\"headerlink\" title=\"背景\"></a>背景</h2><p><a href=\"https://www.tongtech.com/pctype/25.html\">TongWeb</a> 是国内开发的一款高性能应用服务器软件，可以替代 Tomcat。因项目的国产化要求，需要使用 TongWeb 来替代默认的 Tomcat 容器。</p>\n<h2 id=\"版本说明\"><a href=\"#版本说明\" class=\"headerlink\" title=\"版本说明\"></a>版本说明</h2><p>项目使用的 Spring Boot 版本为<code>2.5.5</code>。TongWeb 的版本为<code>7.0.E.6_P11</code>。</p>\n<h2 id=\"项目结构\"><a href=\"#项目结构\" class=\"headerlink\" title=\"项目结构\"></a>项目结构</h2><p> <img src=\"https://qiniu-image.gotojava.cn/blog/202410301219116.png\" alt=\"image-20241030121505174\"></p>\n<h2 id=\"Maven配置\"><a href=\"#Maven配置\" class=\"headerlink\" title=\"Maven配置\"></a>Maven配置</h2><figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br><span class=\"line\">38</span><br><span class=\"line\">39</span><br><span class=\"line\">40</span><br><span class=\"line\">41</span><br><span class=\"line\">42</span><br><span class=\"line\">43</span><br><span class=\"line\">44</span><br><span class=\"line\">45</span><br><span class=\"line\">46</span><br><span class=\"line\">47</span><br><span class=\"line\">48</span><br><span class=\"line\">49</span><br><span class=\"line\">50</span><br><span class=\"line\">51</span><br><span class=\"line\">52</span><br><span class=\"line\">53</span><br><span class=\"line\">54</span><br><span class=\"line\">55</span><br><span class=\"line\">56</span><br><span class=\"line\">57</span><br><span class=\"line\">58</span><br><span class=\"line\">59</span><br><span class=\"line\">60</span><br><span class=\"line\">61</span><br><span class=\"line\">62</span><br><span class=\"line\">63</span><br><span class=\"line\">64</span><br><span class=\"line\">65</span><br><span class=\"line\">66</span><br><span class=\"line\">67</span><br><span class=\"line\">68</span><br><span class=\"line\">69</span><br><span class=\"line\">70</span><br><span class=\"line\">71</span><br><span class=\"line\">72</span><br><span class=\"line\">73</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">&lt;parent&gt;</span><br><span class=\"line\">    &lt;groupId&gt;org.springframework.boot&lt;/groupId&gt;</span><br><span class=\"line\">    &lt;artifactId&gt;spring-boot-starter-parent&lt;/artifactId&gt;</span><br><span class=\"line\">    &lt;version&gt;2.5.5&lt;/version&gt;</span><br><span class=\"line\">    &lt;relativePath/&gt;</span><br><span class=\"line\">&lt;/parent&gt;</span><br><span class=\"line\"></span><br><span class=\"line\">&lt;properties&gt;</span><br><span class=\"line\">    &lt;maven.compiler.source&gt;8&lt;/maven.compiler.source&gt;</span><br><span class=\"line\">    &lt;maven.compiler.target&gt;8&lt;/maven.compiler.target&gt;</span><br><span class=\"line\">    &lt;project.build.sourceEncoding&gt;UTF-8&lt;/project.build.sourceEncoding&gt;</span><br><span class=\"line\">&lt;/properties&gt;</span><br><span class=\"line\"></span><br><span class=\"line\">&lt;dependencies&gt;</span><br><span class=\"line\">    &lt;dependency&gt;</span><br><span class=\"line\">        &lt;groupId&gt;org.springframework.boot&lt;/groupId&gt;</span><br><span class=\"line\">        &lt;artifactId&gt;spring-boot-starter-web&lt;/artifactId&gt;</span><br><span class=\"line\">        &lt;exclusions&gt;</span><br><span class=\"line\">            &lt;!--排除tomcat依赖--&gt;</span><br><span class=\"line\">            &lt;exclusion&gt;</span><br><span class=\"line\">                &lt;groupId&gt;org.springframework.boot&lt;/groupId&gt;</span><br><span class=\"line\">                &lt;artifactId&gt;spring-boot-starter-tomcat&lt;/artifactId&gt;</span><br><span class=\"line\">            &lt;/exclusion&gt;</span><br><span class=\"line\">        &lt;/exclusions&gt;</span><br><span class=\"line\">    &lt;/dependency&gt;</span><br><span class=\"line\"></span><br><span class=\"line\">    &lt;dependency&gt;</span><br><span class=\"line\">        &lt;groupId&gt;com.tongweb.springboot&lt;/groupId&gt;</span><br><span class=\"line\">        &lt;artifactId&gt;tongweb-spring-boot-starter-2.x&lt;/artifactId&gt;</span><br><span class=\"line\">        &lt;version&gt;7.0.E.6_P11&lt;/version&gt;</span><br><span class=\"line\">    &lt;/dependency&gt;</span><br><span class=\"line\">    &lt;dependency&gt;</span><br><span class=\"line\">        &lt;groupId&gt;org.springframework.boot&lt;/groupId&gt;</span><br><span class=\"line\">        &lt;artifactId&gt;spring-boot-starter-test&lt;/artifactId&gt;</span><br><span class=\"line\">        &lt;scope&gt;test&lt;/scope&gt;</span><br><span class=\"line\">    &lt;/dependency&gt;</span><br><span class=\"line\"></span><br><span class=\"line\">    &lt;dependency&gt;</span><br><span class=\"line\">        &lt;groupId&gt;org.springframework.boot&lt;/groupId&gt;</span><br><span class=\"line\">        &lt;artifactId&gt;spring-boot-starter-test&lt;/artifactId&gt;</span><br><span class=\"line\">        &lt;scope&gt;test&lt;/scope&gt;</span><br><span class=\"line\">        &lt;exclusions&gt;</span><br><span class=\"line\">            &lt;exclusion&gt;</span><br><span class=\"line\">                &lt;groupId&gt;org.junit.vintage&lt;/groupId&gt;</span><br><span class=\"line\">                &lt;artifactId&gt;junit-vintage-engine&lt;/artifactId&gt;</span><br><span class=\"line\">            &lt;/exclusion&gt;</span><br><span class=\"line\">        &lt;/exclusions&gt;</span><br><span class=\"line\">    &lt;/dependency&gt;</span><br><span class=\"line\">&lt;/dependencies&gt;</span><br><span class=\"line\"></span><br><span class=\"line\">&lt;build&gt;</span><br><span class=\"line\">    &lt;plugins&gt;</span><br><span class=\"line\">        &lt;plugin&gt;</span><br><span class=\"line\">            &lt;groupId&gt;org.springframework.boot&lt;/groupId&gt;</span><br><span class=\"line\">            &lt;artifactId&gt;spring-boot-maven-plugin&lt;/artifactId&gt;</span><br><span class=\"line\">            &lt;configuration&gt;</span><br><span class=\"line\">                &lt;mainClass&gt;com.tong.App&lt;/mainClass&gt;</span><br><span class=\"line\">            &lt;/configuration&gt;</span><br><span class=\"line\">        &lt;/plugin&gt;</span><br><span class=\"line\">    &lt;/plugins&gt;</span><br><span class=\"line\">&lt;/build&gt;</span><br><span class=\"line\"></span><br><span class=\"line\">&lt;dependencyManagement&gt;</span><br><span class=\"line\">    &lt;dependencies&gt;</span><br><span class=\"line\">        &lt;dependency&gt;</span><br><span class=\"line\">            &lt;groupId&gt;com.tongweb&lt;/groupId&gt;</span><br><span class=\"line\">            &lt;artifactId&gt;tongweb-embed-dependencies&lt;/artifactId&gt;</span><br><span class=\"line\">            &lt;version&gt;7.0.E.6_P11&lt;/version&gt;</span><br><span class=\"line\">            &lt;type&gt;pom&lt;/type&gt;</span><br><span class=\"line\">            &lt;scope&gt;import&lt;/scope&gt;</span><br><span class=\"line\">        &lt;/dependency&gt;</span><br><span class=\"line\">    &lt;/dependencies&gt;</span><br><span class=\"line\">&lt;/dependencyManagement&gt;</span><br></pre></td></tr></table></figure>\n\n<h2 id=\"配置License\"><a href=\"#配置License\" class=\"headerlink\" title=\"配置License\"></a>配置License</h2><ul>\n<li>application.yaml</li>\n</ul>\n<figure class=\"highlight yaml\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"attr\">server:</span></span><br><span class=\"line\">  <span class=\"attr\">tongweb:</span></span><br><span class=\"line\">    <span class=\"attr\">uri-encoding:</span> <span class=\"string\">UTF-8</span></span><br><span class=\"line\">    <span class=\"attr\">license:</span></span><br><span class=\"line\">      <span class=\"attr\">type:</span> <span class=\"string\">file</span></span><br><span class=\"line\">      <span class=\"attr\">path:</span> <span class=\"string\">classpath:tongweb/license.dat</span></span><br></pre></td></tr></table></figure>\n\n<h2 id=\"测试\"><a href=\"#测试\" class=\"headerlink\" title=\"测试\"></a>测试</h2><p><img src=\"https://qiniu-image.gotojava.cn/blog/202410301222638.png\" alt=\"image-20241030122241509\"></p>\n<h2 id=\"参考\"><a href=\"#参考\" class=\"headerlink\" title=\"参考\"></a>参考</h2><ul>\n<li>源码：<a href=\"https://github.com/yangzhao917/springboot2-adapter-tongweb7-example\">https://github.com/yangzhao917/springboot2-adapter-tongweb7-example</a></li>\n</ul>"},{"title":"UOS升级OpenSSH","abbrlink":"947b9fd7","toc":true,"date":"2023-09-14T14:46:11.000Z","_content":"\n<meta name=\"referrer\" content=\"no-referrer\" />\n\n因密码测评的整改要求，需要对线上服务器进行OpenSSH的升级，遂在此记录一下升级过程\n\n<!--more-->\n\n服务器使用的是统信的UOS，使用方式和Ubuntu的使用方式很像。\n\n- 操作系统版本\n\n```shell\nwsupport@wsupport-PC:~$ lsb_release -a\nNo LSB modules are available.\nDistributor ID:\tUos\nDescription:\tUnionTech OS Server 20 Enterprise\nRelease:\t20\nCodename:\tfou\n```\n\n- 升级前的OpenSSH版本\n\n```shell\nwsupport@wsupport-PC:~$ ssh -V\nOpenSSH_7.9p1 Debian-10+deb10u1, OpenSSL 1.1.1d  10 Sep 2019\n```\n\n## 更新apt源\n\n1. 使用root用户修改 `/etc/apt/sources.list`文件\n\n> vi /etc/apt/sources.list\n\n- 政务网\n\n```shell\ndeb [by-hash=force] http://172.23.1.32/enterprise-packages.chinauos.com/server-enterprise/  fou/sp3  main contrib non-free\n```\n\n- 互联网\n\n```shell\ndeb [trusted=yes] http://172.22.1.32/enterprise-packages.chinauos.com/server-enterprise/  fou/sp3  main contrib non-free\n```\n\n2. 更新源\n\n```shell\n# apt update\n命中:1 http://172.23.1.32/enterprise-packages.chinauos.com/server-enterprise fou/sp3 InRelease\n正在读取软件包列表... 完成\n正在分析软件包的依赖关系树   \n正在读取状态信息... 完成   \n有 140 个软件包可以升级。请执行 ‘apt list --upgradable’ 来查看它们。\n```\n\n## 更新OpenSSH\n\n1. 安装 `libssl-dev`\n\n```shell\n# apt install libssl-dev -y\n```\n\n2. 上传 `openssh`和 `zlib`\n\n| [ICloud获取](https://www.icloud.com.cn/iclouddrive/0a6Z5YjRTUOVDwyyjh69fLAoQ) | [百度网盘获取](https://pan.baidu.com/s/1N74CdsrofonJvyEmS87voA?pwd=ges3) |\n| :------------------------------------------------------------------------: | :-------------------------------------------------------------------: |\n\n```shell\nroot@wsupport-PC:/home/wsupport/Downloads# ls\ninstall_package  openssh-9.4p1.tar.gz  zlib-1.2.13.tar.gz\n\n# 解压源码包\nroot@wsupport-PC:/home/wsupport/Downloads# tar -zxf openssh-9.4p1.tar.gz \nroot@wsupport-PC:/home/wsupport/Downloads# tar -zxf zlib-1.2.13.tar.gz \nroot@wsupport-PC:/home/wsupport/Downloads# \nroot@wsupport-PC:/home/wsupport/Downloads# ls\ninstall_package  openssh-9.4p1\topenssh-9.4p1.tar.gz  zlib-1.2.13  zlib-1.2.13.tar.gz\n```\n\n3. 编译安装\n\n- 安装zlib\n\n```shell\nroot@wsupport-PC:/home/wsupport/Downloads/zlib-1.2.13# ./configure\nroot@wsupport-PC:/home/wsupport/Downloads/zlib-1.2.13# make && make install\n```\n\n- 安装open-ssh\n\n```shell\nroot@wsupport-PC:/home/wsupport/Downloads# cd openssh-9.4p1\nroot@wsupport-PC:/home/wsupport/Downloads/openssh-9.4p1# ./configure\nroot@wsupport-PC:/home/wsupport/Downloads/openssh-9.4p1# make && make install\n```\n\n## 升级验证\n\n再次查看OpenSSH的版本，发现已经升级成功，由原来的 `7.9p1 Debian-10+deb10u1`升级到了 `9.4p1`\n\n```\nroot@wsupport-PC:~# ssh -V\nOpenSSH_9.4p1, OpenSSL 1.1.1d  10 Sep 2019\n```\n","source":"_posts/UOS升级OpenSSH.md","raw":"---\ntitle: UOS升级OpenSSH\ncategories:\n  - 开发者笔记\ntags:\n  - Linux\nabbrlink: 947b9fd7\ntoc: true\ndate: 2023-09-14 14:46:11\n---\n\n<meta name=\"referrer\" content=\"no-referrer\" />\n\n因密码测评的整改要求，需要对线上服务器进行OpenSSH的升级，遂在此记录一下升级过程\n\n<!--more-->\n\n服务器使用的是统信的UOS，使用方式和Ubuntu的使用方式很像。\n\n- 操作系统版本\n\n```shell\nwsupport@wsupport-PC:~$ lsb_release -a\nNo LSB modules are available.\nDistributor ID:\tUos\nDescription:\tUnionTech OS Server 20 Enterprise\nRelease:\t20\nCodename:\tfou\n```\n\n- 升级前的OpenSSH版本\n\n```shell\nwsupport@wsupport-PC:~$ ssh -V\nOpenSSH_7.9p1 Debian-10+deb10u1, OpenSSL 1.1.1d  10 Sep 2019\n```\n\n## 更新apt源\n\n1. 使用root用户修改 `/etc/apt/sources.list`文件\n\n> vi /etc/apt/sources.list\n\n- 政务网\n\n```shell\ndeb [by-hash=force] http://172.23.1.32/enterprise-packages.chinauos.com/server-enterprise/  fou/sp3  main contrib non-free\n```\n\n- 互联网\n\n```shell\ndeb [trusted=yes] http://172.22.1.32/enterprise-packages.chinauos.com/server-enterprise/  fou/sp3  main contrib non-free\n```\n\n2. 更新源\n\n```shell\n# apt update\n命中:1 http://172.23.1.32/enterprise-packages.chinauos.com/server-enterprise fou/sp3 InRelease\n正在读取软件包列表... 完成\n正在分析软件包的依赖关系树   \n正在读取状态信息... 完成   \n有 140 个软件包可以升级。请执行 ‘apt list --upgradable’ 来查看它们。\n```\n\n## 更新OpenSSH\n\n1. 安装 `libssl-dev`\n\n```shell\n# apt install libssl-dev -y\n```\n\n2. 上传 `openssh`和 `zlib`\n\n| [ICloud获取](https://www.icloud.com.cn/iclouddrive/0a6Z5YjRTUOVDwyyjh69fLAoQ) | [百度网盘获取](https://pan.baidu.com/s/1N74CdsrofonJvyEmS87voA?pwd=ges3) |\n| :------------------------------------------------------------------------: | :-------------------------------------------------------------------: |\n\n```shell\nroot@wsupport-PC:/home/wsupport/Downloads# ls\ninstall_package  openssh-9.4p1.tar.gz  zlib-1.2.13.tar.gz\n\n# 解压源码包\nroot@wsupport-PC:/home/wsupport/Downloads# tar -zxf openssh-9.4p1.tar.gz \nroot@wsupport-PC:/home/wsupport/Downloads# tar -zxf zlib-1.2.13.tar.gz \nroot@wsupport-PC:/home/wsupport/Downloads# \nroot@wsupport-PC:/home/wsupport/Downloads# ls\ninstall_package  openssh-9.4p1\topenssh-9.4p1.tar.gz  zlib-1.2.13  zlib-1.2.13.tar.gz\n```\n\n3. 编译安装\n\n- 安装zlib\n\n```shell\nroot@wsupport-PC:/home/wsupport/Downloads/zlib-1.2.13# ./configure\nroot@wsupport-PC:/home/wsupport/Downloads/zlib-1.2.13# make && make install\n```\n\n- 安装open-ssh\n\n```shell\nroot@wsupport-PC:/home/wsupport/Downloads# cd openssh-9.4p1\nroot@wsupport-PC:/home/wsupport/Downloads/openssh-9.4p1# ./configure\nroot@wsupport-PC:/home/wsupport/Downloads/openssh-9.4p1# make && make install\n```\n\n## 升级验证\n\n再次查看OpenSSH的版本，发现已经升级成功，由原来的 `7.9p1 Debian-10+deb10u1`升级到了 `9.4p1`\n\n```\nroot@wsupport-PC:~# ssh -V\nOpenSSH_9.4p1, OpenSSL 1.1.1d  10 Sep 2019\n```\n","slug":"UOS升级OpenSSH","published":1,"updated":"2025-03-28T06:19:14.047Z","_id":"cm8se3tdh000jbb8l46lefoiu","comments":1,"layout":"post","photos":[],"content":"<meta name=\"referrer\" content=\"no-referrer\" />\n\n<p>因密码测评的整改要求，需要对线上服务器进行OpenSSH的升级，遂在此记录一下升级过程</p>\n<span id=\"more\"></span>\n\n<p>服务器使用的是统信的UOS，使用方式和Ubuntu的使用方式很像。</p>\n<ul>\n<li>操作系统版本</li>\n</ul>\n<figure class=\"highlight shell\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">wsupport@wsupport-PC:~$ lsb_release -a</span><br><span class=\"line\">No LSB modules are available.</span><br><span class=\"line\">Distributor ID:\tUos</span><br><span class=\"line\">Description:\tUnionTech OS Server 20 Enterprise</span><br><span class=\"line\">Release:\t20</span><br><span class=\"line\">Codename:\tfou</span><br></pre></td></tr></table></figure>\n\n<ul>\n<li>升级前的OpenSSH版本</li>\n</ul>\n<figure class=\"highlight shell\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">wsupport@wsupport-PC:~$ ssh -V</span><br><span class=\"line\">OpenSSH_7.9p1 Debian-10+deb10u1, OpenSSL 1.1.1d  10 Sep 2019</span><br></pre></td></tr></table></figure>\n\n<h2 id=\"更新apt源\"><a href=\"#更新apt源\" class=\"headerlink\" title=\"更新apt源\"></a>更新apt源</h2><ol>\n<li>使用root用户修改 <code>/etc/apt/sources.list</code>文件</li>\n</ol>\n<blockquote>\n<p>vi &#x2F;etc&#x2F;apt&#x2F;sources.list</p>\n</blockquote>\n<ul>\n<li>政务网</li>\n</ul>\n<figure class=\"highlight shell\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">deb [by-hash=force] http://172.23.1.32/enterprise-packages.chinauos.com/server-enterprise/  fou/sp3  main contrib non-free</span><br></pre></td></tr></table></figure>\n\n<ul>\n<li>互联网</li>\n</ul>\n<figure class=\"highlight shell\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">deb [trusted=yes] http://172.22.1.32/enterprise-packages.chinauos.com/server-enterprise/  fou/sp3  main contrib non-free</span><br></pre></td></tr></table></figure>\n\n<ol start=\"2\">\n<li>更新源</li>\n</ol>\n<figure class=\"highlight shell\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"meta prompt_\"># </span><span class=\"language-bash\">apt update</span></span><br><span class=\"line\">命中:1 http://172.23.1.32/enterprise-packages.chinauos.com/server-enterprise fou/sp3 InRelease</span><br><span class=\"line\">正在读取软件包列表... 完成</span><br><span class=\"line\">正在分析软件包的依赖关系树   </span><br><span class=\"line\">正在读取状态信息... 完成   </span><br><span class=\"line\">有 140 个软件包可以升级。请执行 ‘apt list --upgradable’ 来查看它们。</span><br></pre></td></tr></table></figure>\n\n<h2 id=\"更新OpenSSH\"><a href=\"#更新OpenSSH\" class=\"headerlink\" title=\"更新OpenSSH\"></a>更新OpenSSH</h2><ol>\n<li>安装 <code>libssl-dev</code></li>\n</ol>\n<figure class=\"highlight shell\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"meta prompt_\"># </span><span class=\"language-bash\">apt install libssl-dev -y</span></span><br></pre></td></tr></table></figure>\n\n<ol start=\"2\">\n<li>上传 <code>openssh</code>和 <code>zlib</code></li>\n</ol>\n<table>\n<thead>\n<tr>\n<th align=\"center\"><a href=\"https://www.icloud.com.cn/iclouddrive/0a6Z5YjRTUOVDwyyjh69fLAoQ\">ICloud获取</a></th>\n<th align=\"center\"><a href=\"https://pan.baidu.com/s/1N74CdsrofonJvyEmS87voA?pwd=ges3\">百度网盘获取</a></th>\n</tr>\n</thead>\n</table>\n<figure class=\"highlight shell\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">root@wsupport-PC:/home/wsupport/Downloads# ls</span><br><span class=\"line\">install_package  openssh-9.4p1.tar.gz  zlib-1.2.13.tar.gz</span><br><span class=\"line\"><span class=\"meta prompt_\"></span></span><br><span class=\"line\"><span class=\"meta prompt_\"># </span><span class=\"language-bash\">解压源码包</span></span><br><span class=\"line\">root@wsupport-PC:/home/wsupport/Downloads# tar -zxf openssh-9.4p1.tar.gz </span><br><span class=\"line\">root@wsupport-PC:/home/wsupport/Downloads# tar -zxf zlib-1.2.13.tar.gz </span><br><span class=\"line\">root@wsupport-PC:/home/wsupport/Downloads# </span><br><span class=\"line\">root@wsupport-PC:/home/wsupport/Downloads# ls</span><br><span class=\"line\">install_package  openssh-9.4p1\topenssh-9.4p1.tar.gz  zlib-1.2.13  zlib-1.2.13.tar.gz</span><br></pre></td></tr></table></figure>\n\n<ol start=\"3\">\n<li>编译安装</li>\n</ol>\n<ul>\n<li>安装zlib</li>\n</ul>\n<figure class=\"highlight shell\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">root@wsupport-PC:/home/wsupport/Downloads/zlib-1.2.13# ./configure</span><br><span class=\"line\">root@wsupport-PC:/home/wsupport/Downloads/zlib-1.2.13# make &amp;&amp; make install</span><br></pre></td></tr></table></figure>\n\n<ul>\n<li>安装open-ssh</li>\n</ul>\n<figure class=\"highlight shell\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">root@wsupport-PC:/home/wsupport/Downloads# cd openssh-9.4p1</span><br><span class=\"line\">root@wsupport-PC:/home/wsupport/Downloads/openssh-9.4p1# ./configure</span><br><span class=\"line\">root@wsupport-PC:/home/wsupport/Downloads/openssh-9.4p1# make &amp;&amp; make install</span><br></pre></td></tr></table></figure>\n\n<h2 id=\"升级验证\"><a href=\"#升级验证\" class=\"headerlink\" title=\"升级验证\"></a>升级验证</h2><p>再次查看OpenSSH的版本，发现已经升级成功，由原来的 <code>7.9p1 Debian-10+deb10u1</code>升级到了 <code>9.4p1</code></p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">root@wsupport-PC:~# ssh -V</span><br><span class=\"line\">OpenSSH_9.4p1, OpenSSL 1.1.1d  10 Sep 2019</span><br></pre></td></tr></table></figure>\n","excerpt":"<meta name=\"referrer\" content=\"no-referrer\" />\n\n<p>因密码测评的整改要求，需要对线上服务器进行OpenSSH的升级，遂在此记录一下升级过程</p>","more":"<p>服务器使用的是统信的UOS，使用方式和Ubuntu的使用方式很像。</p>\n<ul>\n<li>操作系统版本</li>\n</ul>\n<figure class=\"highlight shell\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">wsupport@wsupport-PC:~$ lsb_release -a</span><br><span class=\"line\">No LSB modules are available.</span><br><span class=\"line\">Distributor ID:\tUos</span><br><span class=\"line\">Description:\tUnionTech OS Server 20 Enterprise</span><br><span class=\"line\">Release:\t20</span><br><span class=\"line\">Codename:\tfou</span><br></pre></td></tr></table></figure>\n\n<ul>\n<li>升级前的OpenSSH版本</li>\n</ul>\n<figure class=\"highlight shell\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">wsupport@wsupport-PC:~$ ssh -V</span><br><span class=\"line\">OpenSSH_7.9p1 Debian-10+deb10u1, OpenSSL 1.1.1d  10 Sep 2019</span><br></pre></td></tr></table></figure>\n\n<h2 id=\"更新apt源\"><a href=\"#更新apt源\" class=\"headerlink\" title=\"更新apt源\"></a>更新apt源</h2><ol>\n<li>使用root用户修改 <code>/etc/apt/sources.list</code>文件</li>\n</ol>\n<blockquote>\n<p>vi &#x2F;etc&#x2F;apt&#x2F;sources.list</p>\n</blockquote>\n<ul>\n<li>政务网</li>\n</ul>\n<figure class=\"highlight shell\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">deb [by-hash=force] http://172.23.1.32/enterprise-packages.chinauos.com/server-enterprise/  fou/sp3  main contrib non-free</span><br></pre></td></tr></table></figure>\n\n<ul>\n<li>互联网</li>\n</ul>\n<figure class=\"highlight shell\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">deb [trusted=yes] http://172.22.1.32/enterprise-packages.chinauos.com/server-enterprise/  fou/sp3  main contrib non-free</span><br></pre></td></tr></table></figure>\n\n<ol start=\"2\">\n<li>更新源</li>\n</ol>\n<figure class=\"highlight shell\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"meta prompt_\"># </span><span class=\"language-bash\">apt update</span></span><br><span class=\"line\">命中:1 http://172.23.1.32/enterprise-packages.chinauos.com/server-enterprise fou/sp3 InRelease</span><br><span class=\"line\">正在读取软件包列表... 完成</span><br><span class=\"line\">正在分析软件包的依赖关系树   </span><br><span class=\"line\">正在读取状态信息... 完成   </span><br><span class=\"line\">有 140 个软件包可以升级。请执行 ‘apt list --upgradable’ 来查看它们。</span><br></pre></td></tr></table></figure>\n\n<h2 id=\"更新OpenSSH\"><a href=\"#更新OpenSSH\" class=\"headerlink\" title=\"更新OpenSSH\"></a>更新OpenSSH</h2><ol>\n<li>安装 <code>libssl-dev</code></li>\n</ol>\n<figure class=\"highlight shell\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"meta prompt_\"># </span><span class=\"language-bash\">apt install libssl-dev -y</span></span><br></pre></td></tr></table></figure>\n\n<ol start=\"2\">\n<li>上传 <code>openssh</code>和 <code>zlib</code></li>\n</ol>\n<table>\n<thead>\n<tr>\n<th align=\"center\"><a href=\"https://www.icloud.com.cn/iclouddrive/0a6Z5YjRTUOVDwyyjh69fLAoQ\">ICloud获取</a></th>\n<th align=\"center\"><a href=\"https://pan.baidu.com/s/1N74CdsrofonJvyEmS87voA?pwd=ges3\">百度网盘获取</a></th>\n</tr>\n</thead>\n</table>\n<figure class=\"highlight shell\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">root@wsupport-PC:/home/wsupport/Downloads# ls</span><br><span class=\"line\">install_package  openssh-9.4p1.tar.gz  zlib-1.2.13.tar.gz</span><br><span class=\"line\"><span class=\"meta prompt_\"></span></span><br><span class=\"line\"><span class=\"meta prompt_\"># </span><span class=\"language-bash\">解压源码包</span></span><br><span class=\"line\">root@wsupport-PC:/home/wsupport/Downloads# tar -zxf openssh-9.4p1.tar.gz </span><br><span class=\"line\">root@wsupport-PC:/home/wsupport/Downloads# tar -zxf zlib-1.2.13.tar.gz </span><br><span class=\"line\">root@wsupport-PC:/home/wsupport/Downloads# </span><br><span class=\"line\">root@wsupport-PC:/home/wsupport/Downloads# ls</span><br><span class=\"line\">install_package  openssh-9.4p1\topenssh-9.4p1.tar.gz  zlib-1.2.13  zlib-1.2.13.tar.gz</span><br></pre></td></tr></table></figure>\n\n<ol start=\"3\">\n<li>编译安装</li>\n</ol>\n<ul>\n<li>安装zlib</li>\n</ul>\n<figure class=\"highlight shell\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">root@wsupport-PC:/home/wsupport/Downloads/zlib-1.2.13# ./configure</span><br><span class=\"line\">root@wsupport-PC:/home/wsupport/Downloads/zlib-1.2.13# make &amp;&amp; make install</span><br></pre></td></tr></table></figure>\n\n<ul>\n<li>安装open-ssh</li>\n</ul>\n<figure class=\"highlight shell\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">root@wsupport-PC:/home/wsupport/Downloads# cd openssh-9.4p1</span><br><span class=\"line\">root@wsupport-PC:/home/wsupport/Downloads/openssh-9.4p1# ./configure</span><br><span class=\"line\">root@wsupport-PC:/home/wsupport/Downloads/openssh-9.4p1# make &amp;&amp; make install</span><br></pre></td></tr></table></figure>\n\n<h2 id=\"升级验证\"><a href=\"#升级验证\" class=\"headerlink\" title=\"升级验证\"></a>升级验证</h2><p>再次查看OpenSSH的版本，发现已经升级成功，由原来的 <code>7.9p1 Debian-10+deb10u1</code>升级到了 <code>9.4p1</code></p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">root@wsupport-PC:~# ssh -V</span><br><span class=\"line\">OpenSSH_9.4p1, OpenSSL 1.1.1d  10 Sep 2019</span><br></pre></td></tr></table></figure>"},{"title":"Windows环境Oracle数据库自动备份的实现","abbrlink":"a639d743","date":"2023-06-08T14:05:15.000Z","toc":true,"_content":"<meta name=\"referrer\" content=\"no-referrer\" />\n\n<!--more-->\n\n## 1.创建批处理文件（.bat）\n\n```bash\n@echo off   \necho ================================================   \necho  Windows环境下Oracle数据库的自动备份脚本  \necho  1. 使用当前日期命名备份文件。  \necho  2. 自动删除7天前的备份。  \necho ================================================  \n::以“YYYYMMDD”格式取出当前时间。  \nset BACKUPDATE=%date:~0,4%%date:~5,2%%date:~8,2%  \n::设置用户名、密码和要备份的数据库。  \nset USER=xxx  \nset PASSWORD=123456  \nset DATABASE=dbtest  \n::创建备份目录。  \nif not exist \"D:\\backup\\data\"       mkdir D:\\backup\\data  \nif not exist \"D:\\backup\\log\"        mkdir D:\\backup\\log  \nset DATADIR=D:\\backup\\data  \nset LOGDIR=D:\\backup\\log  \nexp %USER%/%PASSWORD%@%DATABASE%  file=%DATADIR%\\data_%BACKUPDATE%.dmp log=%LOGDIR%\\log_%BACKUPDATE%.log  \n::删除7天前的备份。  \nforfiles /p \"%DATADIR%\" /s /m *.* /d -7 /c \"cmd /c del @path\"  \nforfiles /p \"%LOGDIR%\" /s /m *.* /d -7 /c \"cmd /c del @path\"  \nexit\n```\n\n## 2.添加定时任务执行计划\n\n### 2.1打开任务计划程序\n\n【控制面板】-【管理工具】-【任务计划程序】\n\n### 2.2创建计划任务\n\n![](http://qiniu-image.gotojava.cn/blog/2023-12-15-191139.jpg)\n\n### 2.3选择计划任务的执行循环周期\n\n![](http://qiniu-image.gotojava.cn/blog/2023-12-15-191142.jpg)\n\n### 2.4选择计划任务的执行时间\n\n![](http://qiniu-image.gotojava.cn/blog/2023-12-15-191144.jpg)\n\n### 2.5选择程序位置\n\n![](http://qiniu-image.gotojava.cn/blog/2023-12-15-191147.jpg)\n\n![](http://qiniu-image.gotojava.cn/blog/2023-12-15-191149.jpg)\n\n### 2.6确认任务摘要\n\n![](http://qiniu-image.gotojava.cn/blog/2023-12-15-191152.jpg)\n\n> 点击“完成”，完成定时任务的创建。\n\n## 参考\n\n- <a href=\"https://www.cnblogs.com/johnhery/p/9941963.html\">%date~0,4%和 %time~0,2%等用法详解 </a>\n- <a href=\"https://www.cnblogs.com/login2012/p/5794572.html\">Windows环境下Oracle数据库的自动备份脚本 </a>\n- <a href=\"https://blog.csdn.net/YBaog/article/details/100023073\">Windows Server 2012 / 2016 定时任务设置和无法执行的解决方法 </a>\n","source":"_posts/Windows环境下Oracle数据库的自动备份脚本.md","raw":"---\ntitle: Windows环境Oracle数据库自动备份的实现\ncategories:\n  - 开发者笔记\ntags:\n  - Oracle\nabbrlink: a639d743\ndate: 2023-06-08 14:05:15\ntoc: true\n---\n<meta name=\"referrer\" content=\"no-referrer\" />\n\n<!--more-->\n\n## 1.创建批处理文件（.bat）\n\n```bash\n@echo off   \necho ================================================   \necho  Windows环境下Oracle数据库的自动备份脚本  \necho  1. 使用当前日期命名备份文件。  \necho  2. 自动删除7天前的备份。  \necho ================================================  \n::以“YYYYMMDD”格式取出当前时间。  \nset BACKUPDATE=%date:~0,4%%date:~5,2%%date:~8,2%  \n::设置用户名、密码和要备份的数据库。  \nset USER=xxx  \nset PASSWORD=123456  \nset DATABASE=dbtest  \n::创建备份目录。  \nif not exist \"D:\\backup\\data\"       mkdir D:\\backup\\data  \nif not exist \"D:\\backup\\log\"        mkdir D:\\backup\\log  \nset DATADIR=D:\\backup\\data  \nset LOGDIR=D:\\backup\\log  \nexp %USER%/%PASSWORD%@%DATABASE%  file=%DATADIR%\\data_%BACKUPDATE%.dmp log=%LOGDIR%\\log_%BACKUPDATE%.log  \n::删除7天前的备份。  \nforfiles /p \"%DATADIR%\" /s /m *.* /d -7 /c \"cmd /c del @path\"  \nforfiles /p \"%LOGDIR%\" /s /m *.* /d -7 /c \"cmd /c del @path\"  \nexit\n```\n\n## 2.添加定时任务执行计划\n\n### 2.1打开任务计划程序\n\n【控制面板】-【管理工具】-【任务计划程序】\n\n### 2.2创建计划任务\n\n![](http://qiniu-image.gotojava.cn/blog/2023-12-15-191139.jpg)\n\n### 2.3选择计划任务的执行循环周期\n\n![](http://qiniu-image.gotojava.cn/blog/2023-12-15-191142.jpg)\n\n### 2.4选择计划任务的执行时间\n\n![](http://qiniu-image.gotojava.cn/blog/2023-12-15-191144.jpg)\n\n### 2.5选择程序位置\n\n![](http://qiniu-image.gotojava.cn/blog/2023-12-15-191147.jpg)\n\n![](http://qiniu-image.gotojava.cn/blog/2023-12-15-191149.jpg)\n\n### 2.6确认任务摘要\n\n![](http://qiniu-image.gotojava.cn/blog/2023-12-15-191152.jpg)\n\n> 点击“完成”，完成定时任务的创建。\n\n## 参考\n\n- <a href=\"https://www.cnblogs.com/johnhery/p/9941963.html\">%date~0,4%和 %time~0,2%等用法详解 </a>\n- <a href=\"https://www.cnblogs.com/login2012/p/5794572.html\">Windows环境下Oracle数据库的自动备份脚本 </a>\n- <a href=\"https://blog.csdn.net/YBaog/article/details/100023073\">Windows Server 2012 / 2016 定时任务设置和无法执行的解决方法 </a>\n","slug":"Windows环境下Oracle数据库的自动备份脚本","published":1,"updated":"2025-03-28T06:10:44.239Z","comments":1,"layout":"post","photos":[],"_id":"cm8se3tdj000mbb8le3mubqxt","content":"<meta name=\"referrer\" content=\"no-referrer\" />\n\n<span id=\"more\"></span>\n\n<h2 id=\"1-创建批处理文件（-bat）\"><a href=\"#1-创建批处理文件（-bat）\" class=\"headerlink\" title=\"1.创建批处理文件（.bat）\"></a>1.创建批处理文件（.bat）</h2><figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">@<span class=\"built_in\">echo</span> off   </span><br><span class=\"line\"><span class=\"built_in\">echo</span> ================================================   </span><br><span class=\"line\"><span class=\"built_in\">echo</span>  Windows环境下Oracle数据库的自动备份脚本  </span><br><span class=\"line\"><span class=\"built_in\">echo</span>  1. 使用当前日期命名备份文件。  </span><br><span class=\"line\"><span class=\"built_in\">echo</span>  2. 自动删除7天前的备份。  </span><br><span class=\"line\"><span class=\"built_in\">echo</span> ================================================  </span><br><span class=\"line\">::以“YYYYMMDD”格式取出当前时间。  </span><br><span class=\"line\"><span class=\"built_in\">set</span> BACKUPDATE=%<span class=\"built_in\">date</span>:~0,4%%<span class=\"built_in\">date</span>:~5,2%%<span class=\"built_in\">date</span>:~8,2%  </span><br><span class=\"line\">::设置用户名、密码和要备份的数据库。  </span><br><span class=\"line\"><span class=\"built_in\">set</span> USER=xxx  </span><br><span class=\"line\"><span class=\"built_in\">set</span> PASSWORD=123456  </span><br><span class=\"line\"><span class=\"built_in\">set</span> DATABASE=dbtest  </span><br><span class=\"line\">::创建备份目录。  </span><br><span class=\"line\"><span class=\"keyword\">if</span> not exist <span class=\"string\">&quot;D:\\backup\\data&quot;</span>       <span class=\"built_in\">mkdir</span> D:\\backup\\data  </span><br><span class=\"line\"><span class=\"keyword\">if</span> not exist <span class=\"string\">&quot;D:\\backup\\log&quot;</span>        <span class=\"built_in\">mkdir</span> D:\\backup\\<span class=\"built_in\">log</span>  </span><br><span class=\"line\"><span class=\"built_in\">set</span> DATADIR=D:\\backup\\data  </span><br><span class=\"line\"><span class=\"built_in\">set</span> LOGDIR=D:\\backup\\<span class=\"built_in\">log</span>  </span><br><span class=\"line\">exp %USER%/%PASSWORD%@%DATABASE%  file=%DATADIR%\\data_%BACKUPDATE%.dmp <span class=\"built_in\">log</span>=%LOGDIR%\\log_%BACKUPDATE%.<span class=\"built_in\">log</span>  </span><br><span class=\"line\">::删除7天前的备份。  </span><br><span class=\"line\">forfiles /p <span class=\"string\">&quot;%DATADIR%&quot;</span> /s /m *.* /d -7 /c <span class=\"string\">&quot;cmd /c del @path&quot;</span>  </span><br><span class=\"line\">forfiles /p <span class=\"string\">&quot;%LOGDIR%&quot;</span> /s /m *.* /d -7 /c <span class=\"string\">&quot;cmd /c del @path&quot;</span>  </span><br><span class=\"line\"><span class=\"built_in\">exit</span></span><br></pre></td></tr></table></figure>\n\n<h2 id=\"2-添加定时任务执行计划\"><a href=\"#2-添加定时任务执行计划\" class=\"headerlink\" title=\"2.添加定时任务执行计划\"></a>2.添加定时任务执行计划</h2><h3 id=\"2-1打开任务计划程序\"><a href=\"#2-1打开任务计划程序\" class=\"headerlink\" title=\"2.1打开任务计划程序\"></a>2.1打开任务计划程序</h3><p>【控制面板】-【管理工具】-【任务计划程序】</p>\n<h3 id=\"2-2创建计划任务\"><a href=\"#2-2创建计划任务\" class=\"headerlink\" title=\"2.2创建计划任务\"></a>2.2创建计划任务</h3><p><img src=\"http://qiniu-image.gotojava.cn/blog/2023-12-15-191139.jpg\"></p>\n<h3 id=\"2-3选择计划任务的执行循环周期\"><a href=\"#2-3选择计划任务的执行循环周期\" class=\"headerlink\" title=\"2.3选择计划任务的执行循环周期\"></a>2.3选择计划任务的执行循环周期</h3><p><img src=\"http://qiniu-image.gotojava.cn/blog/2023-12-15-191142.jpg\"></p>\n<h3 id=\"2-4选择计划任务的执行时间\"><a href=\"#2-4选择计划任务的执行时间\" class=\"headerlink\" title=\"2.4选择计划任务的执行时间\"></a>2.4选择计划任务的执行时间</h3><p><img src=\"http://qiniu-image.gotojava.cn/blog/2023-12-15-191144.jpg\"></p>\n<h3 id=\"2-5选择程序位置\"><a href=\"#2-5选择程序位置\" class=\"headerlink\" title=\"2.5选择程序位置\"></a>2.5选择程序位置</h3><p><img src=\"http://qiniu-image.gotojava.cn/blog/2023-12-15-191147.jpg\"></p>\n<p><img src=\"http://qiniu-image.gotojava.cn/blog/2023-12-15-191149.jpg\"></p>\n<h3 id=\"2-6确认任务摘要\"><a href=\"#2-6确认任务摘要\" class=\"headerlink\" title=\"2.6确认任务摘要\"></a>2.6确认任务摘要</h3><p><img src=\"http://qiniu-image.gotojava.cn/blog/2023-12-15-191152.jpg\"></p>\n<blockquote>\n<p>点击“完成”，完成定时任务的创建。</p>\n</blockquote>\n<h2 id=\"参考\"><a href=\"#参考\" class=\"headerlink\" title=\"参考\"></a>参考</h2><ul>\n<li><a href=\"https://www.cnblogs.com/johnhery/p/9941963.html\">%date<del>0,4%和 %time</del>0,2%等用法详解 </a></li>\n<li><a href=\"https://www.cnblogs.com/login2012/p/5794572.html\">Windows环境下Oracle数据库的自动备份脚本 </a></li>\n<li><a href=\"https://blog.csdn.net/YBaog/article/details/100023073\">Windows Server 2012 &#x2F; 2016 定时任务设置和无法执行的解决方法 </a></li>\n</ul>\n","excerpt":"<meta name=\"referrer\" content=\"no-referrer\" />","more":"<h2 id=\"1-创建批处理文件（-bat）\"><a href=\"#1-创建批处理文件（-bat）\" class=\"headerlink\" title=\"1.创建批处理文件（.bat）\"></a>1.创建批处理文件（.bat）</h2><figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">@<span class=\"built_in\">echo</span> off   </span><br><span class=\"line\"><span class=\"built_in\">echo</span> ================================================   </span><br><span class=\"line\"><span class=\"built_in\">echo</span>  Windows环境下Oracle数据库的自动备份脚本  </span><br><span class=\"line\"><span class=\"built_in\">echo</span>  1. 使用当前日期命名备份文件。  </span><br><span class=\"line\"><span class=\"built_in\">echo</span>  2. 自动删除7天前的备份。  </span><br><span class=\"line\"><span class=\"built_in\">echo</span> ================================================  </span><br><span class=\"line\">::以“YYYYMMDD”格式取出当前时间。  </span><br><span class=\"line\"><span class=\"built_in\">set</span> BACKUPDATE=%<span class=\"built_in\">date</span>:~0,4%%<span class=\"built_in\">date</span>:~5,2%%<span class=\"built_in\">date</span>:~8,2%  </span><br><span class=\"line\">::设置用户名、密码和要备份的数据库。  </span><br><span class=\"line\"><span class=\"built_in\">set</span> USER=xxx  </span><br><span class=\"line\"><span class=\"built_in\">set</span> PASSWORD=123456  </span><br><span class=\"line\"><span class=\"built_in\">set</span> DATABASE=dbtest  </span><br><span class=\"line\">::创建备份目录。  </span><br><span class=\"line\"><span class=\"keyword\">if</span> not exist <span class=\"string\">&quot;D:\\backup\\data&quot;</span>       <span class=\"built_in\">mkdir</span> D:\\backup\\data  </span><br><span class=\"line\"><span class=\"keyword\">if</span> not exist <span class=\"string\">&quot;D:\\backup\\log&quot;</span>        <span class=\"built_in\">mkdir</span> D:\\backup\\<span class=\"built_in\">log</span>  </span><br><span class=\"line\"><span class=\"built_in\">set</span> DATADIR=D:\\backup\\data  </span><br><span class=\"line\"><span class=\"built_in\">set</span> LOGDIR=D:\\backup\\<span class=\"built_in\">log</span>  </span><br><span class=\"line\">exp %USER%/%PASSWORD%@%DATABASE%  file=%DATADIR%\\data_%BACKUPDATE%.dmp <span class=\"built_in\">log</span>=%LOGDIR%\\log_%BACKUPDATE%.<span class=\"built_in\">log</span>  </span><br><span class=\"line\">::删除7天前的备份。  </span><br><span class=\"line\">forfiles /p <span class=\"string\">&quot;%DATADIR%&quot;</span> /s /m *.* /d -7 /c <span class=\"string\">&quot;cmd /c del @path&quot;</span>  </span><br><span class=\"line\">forfiles /p <span class=\"string\">&quot;%LOGDIR%&quot;</span> /s /m *.* /d -7 /c <span class=\"string\">&quot;cmd /c del @path&quot;</span>  </span><br><span class=\"line\"><span class=\"built_in\">exit</span></span><br></pre></td></tr></table></figure>\n\n<h2 id=\"2-添加定时任务执行计划\"><a href=\"#2-添加定时任务执行计划\" class=\"headerlink\" title=\"2.添加定时任务执行计划\"></a>2.添加定时任务执行计划</h2><h3 id=\"2-1打开任务计划程序\"><a href=\"#2-1打开任务计划程序\" class=\"headerlink\" title=\"2.1打开任务计划程序\"></a>2.1打开任务计划程序</h3><p>【控制面板】-【管理工具】-【任务计划程序】</p>\n<h3 id=\"2-2创建计划任务\"><a href=\"#2-2创建计划任务\" class=\"headerlink\" title=\"2.2创建计划任务\"></a>2.2创建计划任务</h3><p><img src=\"http://qiniu-image.gotojava.cn/blog/2023-12-15-191139.jpg\"></p>\n<h3 id=\"2-3选择计划任务的执行循环周期\"><a href=\"#2-3选择计划任务的执行循环周期\" class=\"headerlink\" title=\"2.3选择计划任务的执行循环周期\"></a>2.3选择计划任务的执行循环周期</h3><p><img src=\"http://qiniu-image.gotojava.cn/blog/2023-12-15-191142.jpg\"></p>\n<h3 id=\"2-4选择计划任务的执行时间\"><a href=\"#2-4选择计划任务的执行时间\" class=\"headerlink\" title=\"2.4选择计划任务的执行时间\"></a>2.4选择计划任务的执行时间</h3><p><img src=\"http://qiniu-image.gotojava.cn/blog/2023-12-15-191144.jpg\"></p>\n<h3 id=\"2-5选择程序位置\"><a href=\"#2-5选择程序位置\" class=\"headerlink\" title=\"2.5选择程序位置\"></a>2.5选择程序位置</h3><p><img src=\"http://qiniu-image.gotojava.cn/blog/2023-12-15-191147.jpg\"></p>\n<p><img src=\"http://qiniu-image.gotojava.cn/blog/2023-12-15-191149.jpg\"></p>\n<h3 id=\"2-6确认任务摘要\"><a href=\"#2-6确认任务摘要\" class=\"headerlink\" title=\"2.6确认任务摘要\"></a>2.6确认任务摘要</h3><p><img src=\"http://qiniu-image.gotojava.cn/blog/2023-12-15-191152.jpg\"></p>\n<blockquote>\n<p>点击“完成”，完成定时任务的创建。</p>\n</blockquote>\n<h2 id=\"参考\"><a href=\"#参考\" class=\"headerlink\" title=\"参考\"></a>参考</h2><ul>\n<li><a href=\"https://www.cnblogs.com/johnhery/p/9941963.html\">%date<del>0,4%和 %time</del>0,2%等用法详解 </a></li>\n<li><a href=\"https://www.cnblogs.com/login2012/p/5794572.html\">Windows环境下Oracle数据库的自动备份脚本 </a></li>\n<li><a href=\"https://blog.csdn.net/YBaog/article/details/100023073\">Windows Server 2012 &#x2F; 2016 定时任务设置和无法执行的解决方法 </a></li>\n</ul>"},{"title":"Windows环境下的MySQL安装与配置","abbrlink":"8df25a04","date":"2023-07-27T21:35:31.000Z","toc":true,"_content":"<meta name=\"referrer\" content=\"no-referrer\" />\n\n💡MySQL 是最流行的开源 SQL 数据库管理系统，由 Oracle 公司开发、分发和支持。本文将记录在Window7环境下安装MySQL的过程，用于快速查阅、验证和备忘。\n\n<!--more-->\n\n## 获取\n\n本文使用的版本是 `MySQL 5.7.43`，可通过🔗[官网](https://downloads.mysql.com/archives/installer/)获取最新版本，也可以直接通过我的网盘获取。\n\n🔗[ICloud的网盘](https://www.icloud.com.cn/iclouddrive/0fdMqhG1ZbQzXTa-xT6Gq4jyQ#MySQL)：\n\n- 基于32位的 `mysql-installer-community-5.7.42.0`安装版\n- 基于64位的 `mysql-5.7.43-winx64`\n- RPM版本的 `mysql-5.7.41-1.el7.x86_64.rpm-bundle.tar`\n\n## Windows的安装\n\n> Windows环境：Windows7旗舰版Service Pack 1\n\n- 将MySQL放到安装目录中\n\n此系统为了我的虚拟机，只有一个盘符 `C:`，所以我会放到 `C:\\Program Files`目录下。对于MySQL的图形化 `.msi`的安装版本，会默认将安装到 `C:\\Program Files\\MySQL`目录下。\n\n### 设置环境变量\n\n- 添加系统环境变量 `MYSQL57_HOME`\n\n![image-20230727220925088](http://qiniu-image.gotojava.cn/blog/2023-12-15-191133.png)\n\n> 变量名：MYSQL57_HOME\n>\n> 变量值：C:\\Program Files\\mysql-5.7.43-winx64\n\n- 修改系统环境变量 `Path`\n\n![image-20230727221424288](http://qiniu-image.gotojava.cn/blog/2023-12-15-191134.png)\n\n修改Path系统变量，在末尾添加 `;%MYSQL57_HOME%\\bin;`\n\n> %环境变量名%表示引用一个已定义的环境变量\n>\n> “;”号表示分割符，用于分隔上一个环境变量的值\n\n- 测试环境变量\n\n![image-20230727222026852](http://qiniu-image.gotojava.cn/blog/2023-12-15-191135.png)\n\n看到这个说明环境变量配置成功\n\n### 创建配置文件\n\n在MySQL安装目录创建MySQL配置文件 `my.ini`\n\n```\n[mysql]\n\n# 设置mysql客户端默认字符集\ndefault-character-set=utf8\n\n[mysqld]\n# 设置3306端口\nport=3306\n\n# 设置mysql的安装目录\nbasedir=C:\\\\Program Files\\mysql-5.7.43-winx64\n\n# 设置mysql数据库的数据的存放目录\ndatadir=C:\\\\Program Files\\mysql-5.7.43-winx64\\data\n\n# 允许最大连接数\nmax_connections=200\n\n# 服务端使用的字符集默认为8比特编码的latin1字符集\ncharacter-set-server=utf8\n\n# 创建新表时将使用的默认存储引擎\ndefault-storage-engine=INNODB\n```\n\n从 MySQL 5.7.6 开始，ZIP存档的MySQL不再包含 `data`目录，这个目录需要我们自己创建和通过MySQL初始化。\n\n如果您想在不同位置使用数据目录，则应将该 `data`目录的全部内容复制到新位置。例如，如果您想用作 `E:\\mydata`数据目录，则必须做两件事：\n\n1. 将整个 `data`目录及其所有内容从默认位置（例如 `C:\\Program Files\\MySQL\\MySQL Server 5.7\\data`）移动到 `E:\\mydata`；\n2. 每次启动服务器时，使用[`--datadir`](https://dev.mysql.com/doc/refman/5.7/en/server-system-variables.html#sysvar_datadir)选项指定新的数据目录位置。\n\n### 初始化和安装\n\n❗以下命令都需要cmd以**管理员身份运行**\n\n1. 初始化数据库\n\n```\n# 初始化时生成随机密码，且密码将被标记为已过期，在首次登陆后需要进行密码的修改\nC:\\Program Files\\mysql-5.7.43-winx64\\bin>mysqld --initialize\n\n# 初始化时不会生成随机密码，在第一次登陆时使用回车确认即可\nC:\\Program Files\\mysql-5.7.43-winx64\\bin>mysqld --initialize-insecure\n```\n\n2. 启动服务器/停止服务器\n\n- 启动服务器\n\n> C:\\Program Files\\mysql-5.7.43-winx64\\bin>mysqld --console\n>\n> 或 mysqld，因为已经配置了环境变量所以这里可以简写为mysqld\n\n![image-20230727230811586](http://qiniu-image.gotojava.cn/blog/2023-12-15-191136.png)\n\n如果省略该[`--console`](https://dev.mysql.com/doc/refman/5.7/en/server-options.html#option_mysqld_console)选项，服务器会将诊断输出写入数据目录中的错误日志（`C:\\Program Files\\MySQL\\MySQL Server 5.7\\data`默认情况下）。错误日志是带有扩展名的文件 `.err`，可以使用[`--log-error`](https://dev.mysql.com/doc/refman/5.7/en/server-options.html#option_mysqld_log-error) 选项进行设置。\n\n3. 安装为服务\n\n- 类型为自动启动，服务名默认MySQL(推荐)\n\n```\nC:\\Program Files\\mysql-5.7.43-winx64>mysqld --install\nService successfully installed.\n```\n\n- 类型为手动启动，服务名为MySQLServer57\n\n```\nC:\\Program Files\\mysql-5.7.43-winx64>mysqld --install-manual MySQLServer57\n```\n\n4. 启动服务\n\n```\nC:\\Program Files\\mysql-5.7.43-winx64>sc start mysql\n\nSERVICE_NAME: mysql\n        TYPE               : 10  WIN32_OWN_PROCESS\n        STATE              : 2  START_PENDING\n                                (NOT_STOPPABLE, NOT_PAUSABLE, IGNORES_SHUTDOWN)\n        WIN32_EXIT_CODE    : 0  (0x0)\n        SERVICE_EXIT_CODE  : 0  (0x0)\n        CHECKPOINT         : 0x1\n        WAIT_HINT          : 0x1f40\n        PID                : 2192\n        FLAGS              :\n```\n\n查看服务状态\n\n```\nC:\\Program Files\\mysql-5.7.43-winx64>sc query mysql\n\nSERVICE_NAME: mysql\n        TYPE               : 10  WIN32_OWN_PROCESS\n        STATE              : 1  STOPPED\n        WIN32_EXIT_CODE    : 1077  (0x435)\n        SERVICE_EXIT_CODE  : 0  (0x0)\n        CHECKPOINT         : 0x0\n        WAIT_HINT          : 0x0\n```\n\n### 安装后配置\n\n在进行MySQL的初始化操作后，会在MySQL的配置的 `datadir`目录下生成一个以 `主机名.err`的日志文件，在日志文件中查找 `password`关键字来获取MySQL的初始密码。\n\n![image-20230728005557780](http://qiniu-image.gotojava.cn/blog/2023-12-15-191137.png)\n\n```\nC:\\Windows\\system32>mysql -u root -p\nEnter password: ************\nWelcome to the MySQL monitor.  Commands end with ; or \\g.\nYour MySQL connection id is 2\nServer version: 5.7.43\n\nCopyright (c) 2000, 2023, Oracle and/or its affiliates.\n\nOracle is a registered trademark of Oracle Corporation and/or its\naffiliates. Other names may be trademarks of their respective\nowners.\n\nType 'help;' or '\\h' for help. Type '\\c' to clear the current input statement.\n\nmysql>\n```\n\n可通过mysql本地客户端工具连接mysql后，修改初始密码。\n\n#### 修改root密码\n\n```\nmysql> alter user root@localhost identified by '123456';\nQuery OK, 0 rows affected (0.00 sec)\n```\n\n#### 允许远程访问\n\n用户默认会有登陆的授权访问限制，只有允许的IP才能访问。所以可以通过修改用户的host字段来修改IP访问限制。\n\n```\n# 打开mysql数据库\nmysql> use mysql;\nDatabase changed\nmysql> update user set host='%' where user = 'root';\nQuery OK, 1 row affected (0.00 sec)\nRows matched: 1  Changed: 1  Warnings: 0\n\n# 刷新权限表\nmysql> flush privileges;\nQuery OK, 0 rows affected (0.00 sec)\n```\n\n### 番外篇\n\n#### 卸载MySQL\n\n1. 停止MySQL\n\n```\nC:\\Program Files\\mysql-5.7.43-winx64>mysqladmin shutdown\n```\n\n2. 停止服务\n\n> 可先通过sc query mysql来查询服务状态\n\n```\nC:\\Program Files\\mysql-5.7.43-winx64>sc stop mysql\n\nSERVICE_NAME: mysql\n        TYPE               : 10  WIN32_OWN_PROCESS\n        STATE              : 3  STOP_PENDING\n                                (STOPPABLE, PAUSABLE, ACCEPTS_SHUTDOWN)\n        WIN32_EXIT_CODE    : 0  (0x0)\n        SERVICE_EXIT_CODE  : 0  (0x0)\n        CHECKPOINT         : 0x1\n        WAIT_HINT          : 0x5265c00\n```\n\n3. 删除服务\n\n```\nC:\\Program Files\\mysql-5.7.43-winx64>sc delete mysql\n[SC] DeleteService 成功\n```\n\n4. 删除MySQL相关目录文件及环境变量等信息\n\n本文中MySQL安装在C:\\Program Files\\mysql-5.7.43-winx64目录下，那么在做完上述操作后，我只需要将 `mysql-5.7.43-winx64`目录删除即可。然后再到系统环境变量中删除MySQL的相关环境变量就行。\n\n#### 常用命令\n\n| 命令            | 描述         |\n| :-------------- | :----------- |\n| sc query mysql  | 查看服务状态 |\n| sc delete mysql | 删除服务     |\n| sc stop mysql   | 停止服务     |\n| sc start mysql  | 启动服务     |\n\n## 总结\n\nMySQL是一个跨平台的关系型数据库，以上记录了Windows7下的安装方式，对于Windows10、WindowsServer、CentOS和其他Linux操作系统来说，方法和思路都是类似的。在具体的操作上会略有不同。\n\n## 参考\n\n- [在 Microsoft Windows 上安装 MySQL](https://dev.mysql.com/doc/refman/5.7/en/windows-installation.html)\n","source":"_posts/Windows环境下的MySQL安装与配置.md","raw":"---\ntitle: Windows环境下的MySQL安装与配置\ncategories:\n  - 开发者笔记\ntags:\n  - MySQL\nabbrlink: 8df25a04\ndate: 2023-07-27 21:35:31\ntoc: true\n---\n<meta name=\"referrer\" content=\"no-referrer\" />\n\n💡MySQL 是最流行的开源 SQL 数据库管理系统，由 Oracle 公司开发、分发和支持。本文将记录在Window7环境下安装MySQL的过程，用于快速查阅、验证和备忘。\n\n<!--more-->\n\n## 获取\n\n本文使用的版本是 `MySQL 5.7.43`，可通过🔗[官网](https://downloads.mysql.com/archives/installer/)获取最新版本，也可以直接通过我的网盘获取。\n\n🔗[ICloud的网盘](https://www.icloud.com.cn/iclouddrive/0fdMqhG1ZbQzXTa-xT6Gq4jyQ#MySQL)：\n\n- 基于32位的 `mysql-installer-community-5.7.42.0`安装版\n- 基于64位的 `mysql-5.7.43-winx64`\n- RPM版本的 `mysql-5.7.41-1.el7.x86_64.rpm-bundle.tar`\n\n## Windows的安装\n\n> Windows环境：Windows7旗舰版Service Pack 1\n\n- 将MySQL放到安装目录中\n\n此系统为了我的虚拟机，只有一个盘符 `C:`，所以我会放到 `C:\\Program Files`目录下。对于MySQL的图形化 `.msi`的安装版本，会默认将安装到 `C:\\Program Files\\MySQL`目录下。\n\n### 设置环境变量\n\n- 添加系统环境变量 `MYSQL57_HOME`\n\n![image-20230727220925088](http://qiniu-image.gotojava.cn/blog/2023-12-15-191133.png)\n\n> 变量名：MYSQL57_HOME\n>\n> 变量值：C:\\Program Files\\mysql-5.7.43-winx64\n\n- 修改系统环境变量 `Path`\n\n![image-20230727221424288](http://qiniu-image.gotojava.cn/blog/2023-12-15-191134.png)\n\n修改Path系统变量，在末尾添加 `;%MYSQL57_HOME%\\bin;`\n\n> %环境变量名%表示引用一个已定义的环境变量\n>\n> “;”号表示分割符，用于分隔上一个环境变量的值\n\n- 测试环境变量\n\n![image-20230727222026852](http://qiniu-image.gotojava.cn/blog/2023-12-15-191135.png)\n\n看到这个说明环境变量配置成功\n\n### 创建配置文件\n\n在MySQL安装目录创建MySQL配置文件 `my.ini`\n\n```\n[mysql]\n\n# 设置mysql客户端默认字符集\ndefault-character-set=utf8\n\n[mysqld]\n# 设置3306端口\nport=3306\n\n# 设置mysql的安装目录\nbasedir=C:\\\\Program Files\\mysql-5.7.43-winx64\n\n# 设置mysql数据库的数据的存放目录\ndatadir=C:\\\\Program Files\\mysql-5.7.43-winx64\\data\n\n# 允许最大连接数\nmax_connections=200\n\n# 服务端使用的字符集默认为8比特编码的latin1字符集\ncharacter-set-server=utf8\n\n# 创建新表时将使用的默认存储引擎\ndefault-storage-engine=INNODB\n```\n\n从 MySQL 5.7.6 开始，ZIP存档的MySQL不再包含 `data`目录，这个目录需要我们自己创建和通过MySQL初始化。\n\n如果您想在不同位置使用数据目录，则应将该 `data`目录的全部内容复制到新位置。例如，如果您想用作 `E:\\mydata`数据目录，则必须做两件事：\n\n1. 将整个 `data`目录及其所有内容从默认位置（例如 `C:\\Program Files\\MySQL\\MySQL Server 5.7\\data`）移动到 `E:\\mydata`；\n2. 每次启动服务器时，使用[`--datadir`](https://dev.mysql.com/doc/refman/5.7/en/server-system-variables.html#sysvar_datadir)选项指定新的数据目录位置。\n\n### 初始化和安装\n\n❗以下命令都需要cmd以**管理员身份运行**\n\n1. 初始化数据库\n\n```\n# 初始化时生成随机密码，且密码将被标记为已过期，在首次登陆后需要进行密码的修改\nC:\\Program Files\\mysql-5.7.43-winx64\\bin>mysqld --initialize\n\n# 初始化时不会生成随机密码，在第一次登陆时使用回车确认即可\nC:\\Program Files\\mysql-5.7.43-winx64\\bin>mysqld --initialize-insecure\n```\n\n2. 启动服务器/停止服务器\n\n- 启动服务器\n\n> C:\\Program Files\\mysql-5.7.43-winx64\\bin>mysqld --console\n>\n> 或 mysqld，因为已经配置了环境变量所以这里可以简写为mysqld\n\n![image-20230727230811586](http://qiniu-image.gotojava.cn/blog/2023-12-15-191136.png)\n\n如果省略该[`--console`](https://dev.mysql.com/doc/refman/5.7/en/server-options.html#option_mysqld_console)选项，服务器会将诊断输出写入数据目录中的错误日志（`C:\\Program Files\\MySQL\\MySQL Server 5.7\\data`默认情况下）。错误日志是带有扩展名的文件 `.err`，可以使用[`--log-error`](https://dev.mysql.com/doc/refman/5.7/en/server-options.html#option_mysqld_log-error) 选项进行设置。\n\n3. 安装为服务\n\n- 类型为自动启动，服务名默认MySQL(推荐)\n\n```\nC:\\Program Files\\mysql-5.7.43-winx64>mysqld --install\nService successfully installed.\n```\n\n- 类型为手动启动，服务名为MySQLServer57\n\n```\nC:\\Program Files\\mysql-5.7.43-winx64>mysqld --install-manual MySQLServer57\n```\n\n4. 启动服务\n\n```\nC:\\Program Files\\mysql-5.7.43-winx64>sc start mysql\n\nSERVICE_NAME: mysql\n        TYPE               : 10  WIN32_OWN_PROCESS\n        STATE              : 2  START_PENDING\n                                (NOT_STOPPABLE, NOT_PAUSABLE, IGNORES_SHUTDOWN)\n        WIN32_EXIT_CODE    : 0  (0x0)\n        SERVICE_EXIT_CODE  : 0  (0x0)\n        CHECKPOINT         : 0x1\n        WAIT_HINT          : 0x1f40\n        PID                : 2192\n        FLAGS              :\n```\n\n查看服务状态\n\n```\nC:\\Program Files\\mysql-5.7.43-winx64>sc query mysql\n\nSERVICE_NAME: mysql\n        TYPE               : 10  WIN32_OWN_PROCESS\n        STATE              : 1  STOPPED\n        WIN32_EXIT_CODE    : 1077  (0x435)\n        SERVICE_EXIT_CODE  : 0  (0x0)\n        CHECKPOINT         : 0x0\n        WAIT_HINT          : 0x0\n```\n\n### 安装后配置\n\n在进行MySQL的初始化操作后，会在MySQL的配置的 `datadir`目录下生成一个以 `主机名.err`的日志文件，在日志文件中查找 `password`关键字来获取MySQL的初始密码。\n\n![image-20230728005557780](http://qiniu-image.gotojava.cn/blog/2023-12-15-191137.png)\n\n```\nC:\\Windows\\system32>mysql -u root -p\nEnter password: ************\nWelcome to the MySQL monitor.  Commands end with ; or \\g.\nYour MySQL connection id is 2\nServer version: 5.7.43\n\nCopyright (c) 2000, 2023, Oracle and/or its affiliates.\n\nOracle is a registered trademark of Oracle Corporation and/or its\naffiliates. Other names may be trademarks of their respective\nowners.\n\nType 'help;' or '\\h' for help. Type '\\c' to clear the current input statement.\n\nmysql>\n```\n\n可通过mysql本地客户端工具连接mysql后，修改初始密码。\n\n#### 修改root密码\n\n```\nmysql> alter user root@localhost identified by '123456';\nQuery OK, 0 rows affected (0.00 sec)\n```\n\n#### 允许远程访问\n\n用户默认会有登陆的授权访问限制，只有允许的IP才能访问。所以可以通过修改用户的host字段来修改IP访问限制。\n\n```\n# 打开mysql数据库\nmysql> use mysql;\nDatabase changed\nmysql> update user set host='%' where user = 'root';\nQuery OK, 1 row affected (0.00 sec)\nRows matched: 1  Changed: 1  Warnings: 0\n\n# 刷新权限表\nmysql> flush privileges;\nQuery OK, 0 rows affected (0.00 sec)\n```\n\n### 番外篇\n\n#### 卸载MySQL\n\n1. 停止MySQL\n\n```\nC:\\Program Files\\mysql-5.7.43-winx64>mysqladmin shutdown\n```\n\n2. 停止服务\n\n> 可先通过sc query mysql来查询服务状态\n\n```\nC:\\Program Files\\mysql-5.7.43-winx64>sc stop mysql\n\nSERVICE_NAME: mysql\n        TYPE               : 10  WIN32_OWN_PROCESS\n        STATE              : 3  STOP_PENDING\n                                (STOPPABLE, PAUSABLE, ACCEPTS_SHUTDOWN)\n        WIN32_EXIT_CODE    : 0  (0x0)\n        SERVICE_EXIT_CODE  : 0  (0x0)\n        CHECKPOINT         : 0x1\n        WAIT_HINT          : 0x5265c00\n```\n\n3. 删除服务\n\n```\nC:\\Program Files\\mysql-5.7.43-winx64>sc delete mysql\n[SC] DeleteService 成功\n```\n\n4. 删除MySQL相关目录文件及环境变量等信息\n\n本文中MySQL安装在C:\\Program Files\\mysql-5.7.43-winx64目录下，那么在做完上述操作后，我只需要将 `mysql-5.7.43-winx64`目录删除即可。然后再到系统环境变量中删除MySQL的相关环境变量就行。\n\n#### 常用命令\n\n| 命令            | 描述         |\n| :-------------- | :----------- |\n| sc query mysql  | 查看服务状态 |\n| sc delete mysql | 删除服务     |\n| sc stop mysql   | 停止服务     |\n| sc start mysql  | 启动服务     |\n\n## 总结\n\nMySQL是一个跨平台的关系型数据库，以上记录了Windows7下的安装方式，对于Windows10、WindowsServer、CentOS和其他Linux操作系统来说，方法和思路都是类似的。在具体的操作上会略有不同。\n\n## 参考\n\n- [在 Microsoft Windows 上安装 MySQL](https://dev.mysql.com/doc/refman/5.7/en/windows-installation.html)\n","slug":"Windows环境下的MySQL安装与配置","published":1,"updated":"2025-03-28T06:10:40.124Z","comments":1,"layout":"post","photos":[],"_id":"cm8se3tdk000pbb8l4mx8gqx4","content":"<meta name=\"referrer\" content=\"no-referrer\" />\n\n<p>💡MySQL 是最流行的开源 SQL 数据库管理系统，由 Oracle 公司开发、分发和支持。本文将记录在Window7环境下安装MySQL的过程，用于快速查阅、验证和备忘。</p>\n<span id=\"more\"></span>\n\n<h2 id=\"获取\"><a href=\"#获取\" class=\"headerlink\" title=\"获取\"></a>获取</h2><p>本文使用的版本是 <code>MySQL 5.7.43</code>，可通过🔗<a href=\"https://downloads.mysql.com/archives/installer/\">官网</a>获取最新版本，也可以直接通过我的网盘获取。</p>\n<p>🔗<a href=\"https://www.icloud.com.cn/iclouddrive/0fdMqhG1ZbQzXTa-xT6Gq4jyQ#MySQL\">ICloud的网盘</a>：</p>\n<ul>\n<li>基于32位的 <code>mysql-installer-community-5.7.42.0</code>安装版</li>\n<li>基于64位的 <code>mysql-5.7.43-winx64</code></li>\n<li>RPM版本的 <code>mysql-5.7.41-1.el7.x86_64.rpm-bundle.tar</code></li>\n</ul>\n<h2 id=\"Windows的安装\"><a href=\"#Windows的安装\" class=\"headerlink\" title=\"Windows的安装\"></a>Windows的安装</h2><blockquote>\n<p>Windows环境：Windows7旗舰版Service Pack 1</p>\n</blockquote>\n<ul>\n<li>将MySQL放到安装目录中</li>\n</ul>\n<p>此系统为了我的虚拟机，只有一个盘符 <code>C:</code>，所以我会放到 <code>C:\\Program Files</code>目录下。对于MySQL的图形化 <code>.msi</code>的安装版本，会默认将安装到 <code>C:\\Program Files\\MySQL</code>目录下。</p>\n<h3 id=\"设置环境变量\"><a href=\"#设置环境变量\" class=\"headerlink\" title=\"设置环境变量\"></a>设置环境变量</h3><ul>\n<li>添加系统环境变量 <code>MYSQL57_HOME</code></li>\n</ul>\n<p><img src=\"http://qiniu-image.gotojava.cn/blog/2023-12-15-191133.png\" alt=\"image-20230727220925088\"></p>\n<blockquote>\n<p>变量名：MYSQL57_HOME</p>\n<p>变量值：C:\\Program Files\\mysql-5.7.43-winx64</p>\n</blockquote>\n<ul>\n<li>修改系统环境变量 <code>Path</code></li>\n</ul>\n<p><img src=\"http://qiniu-image.gotojava.cn/blog/2023-12-15-191134.png\" alt=\"image-20230727221424288\"></p>\n<p>修改Path系统变量，在末尾添加 <code>;%MYSQL57_HOME%\\bin;</code></p>\n<blockquote>\n<p>%环境变量名%表示引用一个已定义的环境变量</p>\n<p>“;”号表示分割符，用于分隔上一个环境变量的值</p>\n</blockquote>\n<ul>\n<li>测试环境变量</li>\n</ul>\n<p><img src=\"http://qiniu-image.gotojava.cn/blog/2023-12-15-191135.png\" alt=\"image-20230727222026852\"></p>\n<p>看到这个说明环境变量配置成功</p>\n<h3 id=\"创建配置文件\"><a href=\"#创建配置文件\" class=\"headerlink\" title=\"创建配置文件\"></a>创建配置文件</h3><p>在MySQL安装目录创建MySQL配置文件 <code>my.ini</code></p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">[mysql]</span><br><span class=\"line\"></span><br><span class=\"line\"># 设置mysql客户端默认字符集</span><br><span class=\"line\">default-character-set=utf8</span><br><span class=\"line\"></span><br><span class=\"line\">[mysqld]</span><br><span class=\"line\"># 设置3306端口</span><br><span class=\"line\">port=3306</span><br><span class=\"line\"></span><br><span class=\"line\"># 设置mysql的安装目录</span><br><span class=\"line\">basedir=C:\\\\Program Files\\mysql-5.7.43-winx64</span><br><span class=\"line\"></span><br><span class=\"line\"># 设置mysql数据库的数据的存放目录</span><br><span class=\"line\">datadir=C:\\\\Program Files\\mysql-5.7.43-winx64\\data</span><br><span class=\"line\"></span><br><span class=\"line\"># 允许最大连接数</span><br><span class=\"line\">max_connections=200</span><br><span class=\"line\"></span><br><span class=\"line\"># 服务端使用的字符集默认为8比特编码的latin1字符集</span><br><span class=\"line\">character-set-server=utf8</span><br><span class=\"line\"></span><br><span class=\"line\"># 创建新表时将使用的默认存储引擎</span><br><span class=\"line\">default-storage-engine=INNODB</span><br></pre></td></tr></table></figure>\n\n<p>从 MySQL 5.7.6 开始，ZIP存档的MySQL不再包含 <code>data</code>目录，这个目录需要我们自己创建和通过MySQL初始化。</p>\n<p>如果您想在不同位置使用数据目录，则应将该 <code>data</code>目录的全部内容复制到新位置。例如，如果您想用作 <code>E:\\mydata</code>数据目录，则必须做两件事：</p>\n<ol>\n<li>将整个 <code>data</code>目录及其所有内容从默认位置（例如 <code>C:\\Program Files\\MySQL\\MySQL Server 5.7\\data</code>）移动到 <code>E:\\mydata</code>；</li>\n<li>每次启动服务器时，使用<a href=\"https://dev.mysql.com/doc/refman/5.7/en/server-system-variables.html#sysvar_datadir\"><code>--datadir</code></a>选项指定新的数据目录位置。</li>\n</ol>\n<h3 id=\"初始化和安装\"><a href=\"#初始化和安装\" class=\"headerlink\" title=\"初始化和安装\"></a>初始化和安装</h3><p>❗以下命令都需要cmd以<strong>管理员身份运行</strong></p>\n<ol>\n<li>初始化数据库</li>\n</ol>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"># 初始化时生成随机密码，且密码将被标记为已过期，在首次登陆后需要进行密码的修改</span><br><span class=\"line\">C:\\Program Files\\mysql-5.7.43-winx64\\bin&gt;mysqld --initialize</span><br><span class=\"line\"></span><br><span class=\"line\"># 初始化时不会生成随机密码，在第一次登陆时使用回车确认即可</span><br><span class=\"line\">C:\\Program Files\\mysql-5.7.43-winx64\\bin&gt;mysqld --initialize-insecure</span><br></pre></td></tr></table></figure>\n\n<ol start=\"2\">\n<li>启动服务器&#x2F;停止服务器</li>\n</ol>\n<ul>\n<li>启动服务器</li>\n</ul>\n<blockquote>\n<p>C:\\Program Files\\mysql-5.7.43-winx64\\bin&gt;mysqld –console</p>\n<p>或 mysqld，因为已经配置了环境变量所以这里可以简写为mysqld</p>\n</blockquote>\n<p><img src=\"http://qiniu-image.gotojava.cn/blog/2023-12-15-191136.png\" alt=\"image-20230727230811586\"></p>\n<p>如果省略该<a href=\"https://dev.mysql.com/doc/refman/5.7/en/server-options.html#option_mysqld_console\"><code>--console</code></a>选项，服务器会将诊断输出写入数据目录中的错误日志（<code>C:\\Program Files\\MySQL\\MySQL Server 5.7\\data</code>默认情况下）。错误日志是带有扩展名的文件 <code>.err</code>，可以使用<a href=\"https://dev.mysql.com/doc/refman/5.7/en/server-options.html#option_mysqld_log-error\"><code>--log-error</code></a> 选项进行设置。</p>\n<ol start=\"3\">\n<li>安装为服务</li>\n</ol>\n<ul>\n<li>类型为自动启动，服务名默认MySQL(推荐)</li>\n</ul>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">C:\\Program Files\\mysql-5.7.43-winx64&gt;mysqld --install</span><br><span class=\"line\">Service successfully installed.</span><br></pre></td></tr></table></figure>\n\n<ul>\n<li>类型为手动启动，服务名为MySQLServer57</li>\n</ul>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">C:\\Program Files\\mysql-5.7.43-winx64&gt;mysqld --install-manual MySQLServer57</span><br></pre></td></tr></table></figure>\n\n<ol start=\"4\">\n<li>启动服务</li>\n</ol>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">C:\\Program Files\\mysql-5.7.43-winx64&gt;sc start mysql</span><br><span class=\"line\"></span><br><span class=\"line\">SERVICE_NAME: mysql</span><br><span class=\"line\">        TYPE               : 10  WIN32_OWN_PROCESS</span><br><span class=\"line\">        STATE              : 2  START_PENDING</span><br><span class=\"line\">                                (NOT_STOPPABLE, NOT_PAUSABLE, IGNORES_SHUTDOWN)</span><br><span class=\"line\">        WIN32_EXIT_CODE    : 0  (0x0)</span><br><span class=\"line\">        SERVICE_EXIT_CODE  : 0  (0x0)</span><br><span class=\"line\">        CHECKPOINT         : 0x1</span><br><span class=\"line\">        WAIT_HINT          : 0x1f40</span><br><span class=\"line\">        PID                : 2192</span><br><span class=\"line\">        FLAGS              :</span><br></pre></td></tr></table></figure>\n\n<p>查看服务状态</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">C:\\Program Files\\mysql-5.7.43-winx64&gt;sc query mysql</span><br><span class=\"line\"></span><br><span class=\"line\">SERVICE_NAME: mysql</span><br><span class=\"line\">        TYPE               : 10  WIN32_OWN_PROCESS</span><br><span class=\"line\">        STATE              : 1  STOPPED</span><br><span class=\"line\">        WIN32_EXIT_CODE    : 1077  (0x435)</span><br><span class=\"line\">        SERVICE_EXIT_CODE  : 0  (0x0)</span><br><span class=\"line\">        CHECKPOINT         : 0x0</span><br><span class=\"line\">        WAIT_HINT          : 0x0</span><br></pre></td></tr></table></figure>\n\n<h3 id=\"安装后配置\"><a href=\"#安装后配置\" class=\"headerlink\" title=\"安装后配置\"></a>安装后配置</h3><p>在进行MySQL的初始化操作后，会在MySQL的配置的 <code>datadir</code>目录下生成一个以 <code>主机名.err</code>的日志文件，在日志文件中查找 <code>password</code>关键字来获取MySQL的初始密码。</p>\n<p><img src=\"http://qiniu-image.gotojava.cn/blog/2023-12-15-191137.png\" alt=\"image-20230728005557780\"></p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">C:\\Windows\\system32&gt;mysql -u root -p</span><br><span class=\"line\">Enter password: ************</span><br><span class=\"line\">Welcome to the MySQL monitor.  Commands end with ; or \\g.</span><br><span class=\"line\">Your MySQL connection id is 2</span><br><span class=\"line\">Server version: 5.7.43</span><br><span class=\"line\"></span><br><span class=\"line\">Copyright (c) 2000, 2023, Oracle and/or its affiliates.</span><br><span class=\"line\"></span><br><span class=\"line\">Oracle is a registered trademark of Oracle Corporation and/or its</span><br><span class=\"line\">affiliates. Other names may be trademarks of their respective</span><br><span class=\"line\">owners.</span><br><span class=\"line\"></span><br><span class=\"line\">Type &#x27;help;&#x27; or &#x27;\\h&#x27; for help. Type &#x27;\\c&#x27; to clear the current input statement.</span><br><span class=\"line\"></span><br><span class=\"line\">mysql&gt;</span><br></pre></td></tr></table></figure>\n\n<p>可通过mysql本地客户端工具连接mysql后，修改初始密码。</p>\n<h4 id=\"修改root密码\"><a href=\"#修改root密码\" class=\"headerlink\" title=\"修改root密码\"></a>修改root密码</h4><figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">mysql&gt; alter user root@localhost identified by &#x27;123456&#x27;;</span><br><span class=\"line\">Query OK, 0 rows affected (0.00 sec)</span><br></pre></td></tr></table></figure>\n\n<h4 id=\"允许远程访问\"><a href=\"#允许远程访问\" class=\"headerlink\" title=\"允许远程访问\"></a>允许远程访问</h4><p>用户默认会有登陆的授权访问限制，只有允许的IP才能访问。所以可以通过修改用户的host字段来修改IP访问限制。</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"># 打开mysql数据库</span><br><span class=\"line\">mysql&gt; use mysql;</span><br><span class=\"line\">Database changed</span><br><span class=\"line\">mysql&gt; update user set host=&#x27;%&#x27; where user = &#x27;root&#x27;;</span><br><span class=\"line\">Query OK, 1 row affected (0.00 sec)</span><br><span class=\"line\">Rows matched: 1  Changed: 1  Warnings: 0</span><br><span class=\"line\"></span><br><span class=\"line\"># 刷新权限表</span><br><span class=\"line\">mysql&gt; flush privileges;</span><br><span class=\"line\">Query OK, 0 rows affected (0.00 sec)</span><br></pre></td></tr></table></figure>\n\n<h3 id=\"番外篇\"><a href=\"#番外篇\" class=\"headerlink\" title=\"番外篇\"></a>番外篇</h3><h4 id=\"卸载MySQL\"><a href=\"#卸载MySQL\" class=\"headerlink\" title=\"卸载MySQL\"></a>卸载MySQL</h4><ol>\n<li>停止MySQL</li>\n</ol>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">C:\\Program Files\\mysql-5.7.43-winx64&gt;mysqladmin shutdown</span><br></pre></td></tr></table></figure>\n\n<ol start=\"2\">\n<li>停止服务</li>\n</ol>\n<blockquote>\n<p>可先通过sc query mysql来查询服务状态</p>\n</blockquote>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">C:\\Program Files\\mysql-5.7.43-winx64&gt;sc stop mysql</span><br><span class=\"line\"></span><br><span class=\"line\">SERVICE_NAME: mysql</span><br><span class=\"line\">        TYPE               : 10  WIN32_OWN_PROCESS</span><br><span class=\"line\">        STATE              : 3  STOP_PENDING</span><br><span class=\"line\">                                (STOPPABLE, PAUSABLE, ACCEPTS_SHUTDOWN)</span><br><span class=\"line\">        WIN32_EXIT_CODE    : 0  (0x0)</span><br><span class=\"line\">        SERVICE_EXIT_CODE  : 0  (0x0)</span><br><span class=\"line\">        CHECKPOINT         : 0x1</span><br><span class=\"line\">        WAIT_HINT          : 0x5265c00</span><br></pre></td></tr></table></figure>\n\n<ol start=\"3\">\n<li>删除服务</li>\n</ol>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">C:\\Program Files\\mysql-5.7.43-winx64&gt;sc delete mysql</span><br><span class=\"line\">[SC] DeleteService 成功</span><br></pre></td></tr></table></figure>\n\n<ol start=\"4\">\n<li>删除MySQL相关目录文件及环境变量等信息</li>\n</ol>\n<p>本文中MySQL安装在C:\\Program Files\\mysql-5.7.43-winx64目录下，那么在做完上述操作后，我只需要将 <code>mysql-5.7.43-winx64</code>目录删除即可。然后再到系统环境变量中删除MySQL的相关环境变量就行。</p>\n<h4 id=\"常用命令\"><a href=\"#常用命令\" class=\"headerlink\" title=\"常用命令\"></a>常用命令</h4><table>\n<thead>\n<tr>\n<th align=\"left\">命令</th>\n<th align=\"left\">描述</th>\n</tr>\n</thead>\n<tbody><tr>\n<td align=\"left\">sc query mysql</td>\n<td align=\"left\">查看服务状态</td>\n</tr>\n<tr>\n<td align=\"left\">sc delete mysql</td>\n<td align=\"left\">删除服务</td>\n</tr>\n<tr>\n<td align=\"left\">sc stop mysql</td>\n<td align=\"left\">停止服务</td>\n</tr>\n<tr>\n<td align=\"left\">sc start mysql</td>\n<td align=\"left\">启动服务</td>\n</tr>\n</tbody></table>\n<h2 id=\"总结\"><a href=\"#总结\" class=\"headerlink\" title=\"总结\"></a>总结</h2><p>MySQL是一个跨平台的关系型数据库，以上记录了Windows7下的安装方式，对于Windows10、WindowsServer、CentOS和其他Linux操作系统来说，方法和思路都是类似的。在具体的操作上会略有不同。</p>\n<h2 id=\"参考\"><a href=\"#参考\" class=\"headerlink\" title=\"参考\"></a>参考</h2><ul>\n<li><a href=\"https://dev.mysql.com/doc/refman/5.7/en/windows-installation.html\">在 Microsoft Windows 上安装 MySQL</a></li>\n</ul>\n","excerpt":"<meta name=\"referrer\" content=\"no-referrer\" />\n\n<p>💡MySQL 是最流行的开源 SQL 数据库管理系统，由 Oracle 公司开发、分发和支持。本文将记录在Window7环境下安装MySQL的过程，用于快速查阅、验证和备忘。</p>","more":"<h2 id=\"获取\"><a href=\"#获取\" class=\"headerlink\" title=\"获取\"></a>获取</h2><p>本文使用的版本是 <code>MySQL 5.7.43</code>，可通过🔗<a href=\"https://downloads.mysql.com/archives/installer/\">官网</a>获取最新版本，也可以直接通过我的网盘获取。</p>\n<p>🔗<a href=\"https://www.icloud.com.cn/iclouddrive/0fdMqhG1ZbQzXTa-xT6Gq4jyQ#MySQL\">ICloud的网盘</a>：</p>\n<ul>\n<li>基于32位的 <code>mysql-installer-community-5.7.42.0</code>安装版</li>\n<li>基于64位的 <code>mysql-5.7.43-winx64</code></li>\n<li>RPM版本的 <code>mysql-5.7.41-1.el7.x86_64.rpm-bundle.tar</code></li>\n</ul>\n<h2 id=\"Windows的安装\"><a href=\"#Windows的安装\" class=\"headerlink\" title=\"Windows的安装\"></a>Windows的安装</h2><blockquote>\n<p>Windows环境：Windows7旗舰版Service Pack 1</p>\n</blockquote>\n<ul>\n<li>将MySQL放到安装目录中</li>\n</ul>\n<p>此系统为了我的虚拟机，只有一个盘符 <code>C:</code>，所以我会放到 <code>C:\\Program Files</code>目录下。对于MySQL的图形化 <code>.msi</code>的安装版本，会默认将安装到 <code>C:\\Program Files\\MySQL</code>目录下。</p>\n<h3 id=\"设置环境变量\"><a href=\"#设置环境变量\" class=\"headerlink\" title=\"设置环境变量\"></a>设置环境变量</h3><ul>\n<li>添加系统环境变量 <code>MYSQL57_HOME</code></li>\n</ul>\n<p><img src=\"http://qiniu-image.gotojava.cn/blog/2023-12-15-191133.png\" alt=\"image-20230727220925088\"></p>\n<blockquote>\n<p>变量名：MYSQL57_HOME</p>\n<p>变量值：C:\\Program Files\\mysql-5.7.43-winx64</p>\n</blockquote>\n<ul>\n<li>修改系统环境变量 <code>Path</code></li>\n</ul>\n<p><img src=\"http://qiniu-image.gotojava.cn/blog/2023-12-15-191134.png\" alt=\"image-20230727221424288\"></p>\n<p>修改Path系统变量，在末尾添加 <code>;%MYSQL57_HOME%\\bin;</code></p>\n<blockquote>\n<p>%环境变量名%表示引用一个已定义的环境变量</p>\n<p>“;”号表示分割符，用于分隔上一个环境变量的值</p>\n</blockquote>\n<ul>\n<li>测试环境变量</li>\n</ul>\n<p><img src=\"http://qiniu-image.gotojava.cn/blog/2023-12-15-191135.png\" alt=\"image-20230727222026852\"></p>\n<p>看到这个说明环境变量配置成功</p>\n<h3 id=\"创建配置文件\"><a href=\"#创建配置文件\" class=\"headerlink\" title=\"创建配置文件\"></a>创建配置文件</h3><p>在MySQL安装目录创建MySQL配置文件 <code>my.ini</code></p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">[mysql]</span><br><span class=\"line\"></span><br><span class=\"line\"># 设置mysql客户端默认字符集</span><br><span class=\"line\">default-character-set=utf8</span><br><span class=\"line\"></span><br><span class=\"line\">[mysqld]</span><br><span class=\"line\"># 设置3306端口</span><br><span class=\"line\">port=3306</span><br><span class=\"line\"></span><br><span class=\"line\"># 设置mysql的安装目录</span><br><span class=\"line\">basedir=C:\\\\Program Files\\mysql-5.7.43-winx64</span><br><span class=\"line\"></span><br><span class=\"line\"># 设置mysql数据库的数据的存放目录</span><br><span class=\"line\">datadir=C:\\\\Program Files\\mysql-5.7.43-winx64\\data</span><br><span class=\"line\"></span><br><span class=\"line\"># 允许最大连接数</span><br><span class=\"line\">max_connections=200</span><br><span class=\"line\"></span><br><span class=\"line\"># 服务端使用的字符集默认为8比特编码的latin1字符集</span><br><span class=\"line\">character-set-server=utf8</span><br><span class=\"line\"></span><br><span class=\"line\"># 创建新表时将使用的默认存储引擎</span><br><span class=\"line\">default-storage-engine=INNODB</span><br></pre></td></tr></table></figure>\n\n<p>从 MySQL 5.7.6 开始，ZIP存档的MySQL不再包含 <code>data</code>目录，这个目录需要我们自己创建和通过MySQL初始化。</p>\n<p>如果您想在不同位置使用数据目录，则应将该 <code>data</code>目录的全部内容复制到新位置。例如，如果您想用作 <code>E:\\mydata</code>数据目录，则必须做两件事：</p>\n<ol>\n<li>将整个 <code>data</code>目录及其所有内容从默认位置（例如 <code>C:\\Program Files\\MySQL\\MySQL Server 5.7\\data</code>）移动到 <code>E:\\mydata</code>；</li>\n<li>每次启动服务器时，使用<a href=\"https://dev.mysql.com/doc/refman/5.7/en/server-system-variables.html#sysvar_datadir\"><code>--datadir</code></a>选项指定新的数据目录位置。</li>\n</ol>\n<h3 id=\"初始化和安装\"><a href=\"#初始化和安装\" class=\"headerlink\" title=\"初始化和安装\"></a>初始化和安装</h3><p>❗以下命令都需要cmd以<strong>管理员身份运行</strong></p>\n<ol>\n<li>初始化数据库</li>\n</ol>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"># 初始化时生成随机密码，且密码将被标记为已过期，在首次登陆后需要进行密码的修改</span><br><span class=\"line\">C:\\Program Files\\mysql-5.7.43-winx64\\bin&gt;mysqld --initialize</span><br><span class=\"line\"></span><br><span class=\"line\"># 初始化时不会生成随机密码，在第一次登陆时使用回车确认即可</span><br><span class=\"line\">C:\\Program Files\\mysql-5.7.43-winx64\\bin&gt;mysqld --initialize-insecure</span><br></pre></td></tr></table></figure>\n\n<ol start=\"2\">\n<li>启动服务器&#x2F;停止服务器</li>\n</ol>\n<ul>\n<li>启动服务器</li>\n</ul>\n<blockquote>\n<p>C:\\Program Files\\mysql-5.7.43-winx64\\bin&gt;mysqld –console</p>\n<p>或 mysqld，因为已经配置了环境变量所以这里可以简写为mysqld</p>\n</blockquote>\n<p><img src=\"http://qiniu-image.gotojava.cn/blog/2023-12-15-191136.png\" alt=\"image-20230727230811586\"></p>\n<p>如果省略该<a href=\"https://dev.mysql.com/doc/refman/5.7/en/server-options.html#option_mysqld_console\"><code>--console</code></a>选项，服务器会将诊断输出写入数据目录中的错误日志（<code>C:\\Program Files\\MySQL\\MySQL Server 5.7\\data</code>默认情况下）。错误日志是带有扩展名的文件 <code>.err</code>，可以使用<a href=\"https://dev.mysql.com/doc/refman/5.7/en/server-options.html#option_mysqld_log-error\"><code>--log-error</code></a> 选项进行设置。</p>\n<ol start=\"3\">\n<li>安装为服务</li>\n</ol>\n<ul>\n<li>类型为自动启动，服务名默认MySQL(推荐)</li>\n</ul>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">C:\\Program Files\\mysql-5.7.43-winx64&gt;mysqld --install</span><br><span class=\"line\">Service successfully installed.</span><br></pre></td></tr></table></figure>\n\n<ul>\n<li>类型为手动启动，服务名为MySQLServer57</li>\n</ul>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">C:\\Program Files\\mysql-5.7.43-winx64&gt;mysqld --install-manual MySQLServer57</span><br></pre></td></tr></table></figure>\n\n<ol start=\"4\">\n<li>启动服务</li>\n</ol>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">C:\\Program Files\\mysql-5.7.43-winx64&gt;sc start mysql</span><br><span class=\"line\"></span><br><span class=\"line\">SERVICE_NAME: mysql</span><br><span class=\"line\">        TYPE               : 10  WIN32_OWN_PROCESS</span><br><span class=\"line\">        STATE              : 2  START_PENDING</span><br><span class=\"line\">                                (NOT_STOPPABLE, NOT_PAUSABLE, IGNORES_SHUTDOWN)</span><br><span class=\"line\">        WIN32_EXIT_CODE    : 0  (0x0)</span><br><span class=\"line\">        SERVICE_EXIT_CODE  : 0  (0x0)</span><br><span class=\"line\">        CHECKPOINT         : 0x1</span><br><span class=\"line\">        WAIT_HINT          : 0x1f40</span><br><span class=\"line\">        PID                : 2192</span><br><span class=\"line\">        FLAGS              :</span><br></pre></td></tr></table></figure>\n\n<p>查看服务状态</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">C:\\Program Files\\mysql-5.7.43-winx64&gt;sc query mysql</span><br><span class=\"line\"></span><br><span class=\"line\">SERVICE_NAME: mysql</span><br><span class=\"line\">        TYPE               : 10  WIN32_OWN_PROCESS</span><br><span class=\"line\">        STATE              : 1  STOPPED</span><br><span class=\"line\">        WIN32_EXIT_CODE    : 1077  (0x435)</span><br><span class=\"line\">        SERVICE_EXIT_CODE  : 0  (0x0)</span><br><span class=\"line\">        CHECKPOINT         : 0x0</span><br><span class=\"line\">        WAIT_HINT          : 0x0</span><br></pre></td></tr></table></figure>\n\n<h3 id=\"安装后配置\"><a href=\"#安装后配置\" class=\"headerlink\" title=\"安装后配置\"></a>安装后配置</h3><p>在进行MySQL的初始化操作后，会在MySQL的配置的 <code>datadir</code>目录下生成一个以 <code>主机名.err</code>的日志文件，在日志文件中查找 <code>password</code>关键字来获取MySQL的初始密码。</p>\n<p><img src=\"http://qiniu-image.gotojava.cn/blog/2023-12-15-191137.png\" alt=\"image-20230728005557780\"></p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">C:\\Windows\\system32&gt;mysql -u root -p</span><br><span class=\"line\">Enter password: ************</span><br><span class=\"line\">Welcome to the MySQL monitor.  Commands end with ; or \\g.</span><br><span class=\"line\">Your MySQL connection id is 2</span><br><span class=\"line\">Server version: 5.7.43</span><br><span class=\"line\"></span><br><span class=\"line\">Copyright (c) 2000, 2023, Oracle and/or its affiliates.</span><br><span class=\"line\"></span><br><span class=\"line\">Oracle is a registered trademark of Oracle Corporation and/or its</span><br><span class=\"line\">affiliates. Other names may be trademarks of their respective</span><br><span class=\"line\">owners.</span><br><span class=\"line\"></span><br><span class=\"line\">Type &#x27;help;&#x27; or &#x27;\\h&#x27; for help. Type &#x27;\\c&#x27; to clear the current input statement.</span><br><span class=\"line\"></span><br><span class=\"line\">mysql&gt;</span><br></pre></td></tr></table></figure>\n\n<p>可通过mysql本地客户端工具连接mysql后，修改初始密码。</p>\n<h4 id=\"修改root密码\"><a href=\"#修改root密码\" class=\"headerlink\" title=\"修改root密码\"></a>修改root密码</h4><figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">mysql&gt; alter user root@localhost identified by &#x27;123456&#x27;;</span><br><span class=\"line\">Query OK, 0 rows affected (0.00 sec)</span><br></pre></td></tr></table></figure>\n\n<h4 id=\"允许远程访问\"><a href=\"#允许远程访问\" class=\"headerlink\" title=\"允许远程访问\"></a>允许远程访问</h4><p>用户默认会有登陆的授权访问限制，只有允许的IP才能访问。所以可以通过修改用户的host字段来修改IP访问限制。</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"># 打开mysql数据库</span><br><span class=\"line\">mysql&gt; use mysql;</span><br><span class=\"line\">Database changed</span><br><span class=\"line\">mysql&gt; update user set host=&#x27;%&#x27; where user = &#x27;root&#x27;;</span><br><span class=\"line\">Query OK, 1 row affected (0.00 sec)</span><br><span class=\"line\">Rows matched: 1  Changed: 1  Warnings: 0</span><br><span class=\"line\"></span><br><span class=\"line\"># 刷新权限表</span><br><span class=\"line\">mysql&gt; flush privileges;</span><br><span class=\"line\">Query OK, 0 rows affected (0.00 sec)</span><br></pre></td></tr></table></figure>\n\n<h3 id=\"番外篇\"><a href=\"#番外篇\" class=\"headerlink\" title=\"番外篇\"></a>番外篇</h3><h4 id=\"卸载MySQL\"><a href=\"#卸载MySQL\" class=\"headerlink\" title=\"卸载MySQL\"></a>卸载MySQL</h4><ol>\n<li>停止MySQL</li>\n</ol>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">C:\\Program Files\\mysql-5.7.43-winx64&gt;mysqladmin shutdown</span><br></pre></td></tr></table></figure>\n\n<ol start=\"2\">\n<li>停止服务</li>\n</ol>\n<blockquote>\n<p>可先通过sc query mysql来查询服务状态</p>\n</blockquote>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">C:\\Program Files\\mysql-5.7.43-winx64&gt;sc stop mysql</span><br><span class=\"line\"></span><br><span class=\"line\">SERVICE_NAME: mysql</span><br><span class=\"line\">        TYPE               : 10  WIN32_OWN_PROCESS</span><br><span class=\"line\">        STATE              : 3  STOP_PENDING</span><br><span class=\"line\">                                (STOPPABLE, PAUSABLE, ACCEPTS_SHUTDOWN)</span><br><span class=\"line\">        WIN32_EXIT_CODE    : 0  (0x0)</span><br><span class=\"line\">        SERVICE_EXIT_CODE  : 0  (0x0)</span><br><span class=\"line\">        CHECKPOINT         : 0x1</span><br><span class=\"line\">        WAIT_HINT          : 0x5265c00</span><br></pre></td></tr></table></figure>\n\n<ol start=\"3\">\n<li>删除服务</li>\n</ol>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">C:\\Program Files\\mysql-5.7.43-winx64&gt;sc delete mysql</span><br><span class=\"line\">[SC] DeleteService 成功</span><br></pre></td></tr></table></figure>\n\n<ol start=\"4\">\n<li>删除MySQL相关目录文件及环境变量等信息</li>\n</ol>\n<p>本文中MySQL安装在C:\\Program Files\\mysql-5.7.43-winx64目录下，那么在做完上述操作后，我只需要将 <code>mysql-5.7.43-winx64</code>目录删除即可。然后再到系统环境变量中删除MySQL的相关环境变量就行。</p>\n<h4 id=\"常用命令\"><a href=\"#常用命令\" class=\"headerlink\" title=\"常用命令\"></a>常用命令</h4><table>\n<thead>\n<tr>\n<th align=\"left\">命令</th>\n<th align=\"left\">描述</th>\n</tr>\n</thead>\n<tbody><tr>\n<td align=\"left\">sc query mysql</td>\n<td align=\"left\">查看服务状态</td>\n</tr>\n<tr>\n<td align=\"left\">sc delete mysql</td>\n<td align=\"left\">删除服务</td>\n</tr>\n<tr>\n<td align=\"left\">sc stop mysql</td>\n<td align=\"left\">停止服务</td>\n</tr>\n<tr>\n<td align=\"left\">sc start mysql</td>\n<td align=\"left\">启动服务</td>\n</tr>\n</tbody></table>\n<h2 id=\"总结\"><a href=\"#总结\" class=\"headerlink\" title=\"总结\"></a>总结</h2><p>MySQL是一个跨平台的关系型数据库，以上记录了Windows7下的安装方式，对于Windows10、WindowsServer、CentOS和其他Linux操作系统来说，方法和思路都是类似的。在具体的操作上会略有不同。</p>\n<h2 id=\"参考\"><a href=\"#参考\" class=\"headerlink\" title=\"参考\"></a>参考</h2><ul>\n<li><a href=\"https://dev.mysql.com/doc/refman/5.7/en/windows-installation.html\">在 Microsoft Windows 上安装 MySQL</a></li>\n</ul>"},{"title":"【MySQL 实战 45 讲：第六章节（全局锁和表锁）】学习小节","toc":true,"abbrlink":"fee476b9","date":"2025-03-27T18:15:40.000Z","_content":"\n<meta name=\"referrer\" content=\"no-referrer\" />\n\n<!-- more -->\n\n数据库锁的设计初衷是用于解决并发问题的，因为当多个用户访问或修改同一资源的时候就会产生资源的互斥性。如果不对资源的访问进行并发限制，会导致大家都在争抢同一个资源，谁都没办法用了。为了解决这个问题就需要系统层面去合理的控制资源的访问顺序和规则，锁就是用于实现这种并发访问的一种机制。想象一下你去 ATM 机取钱，ATM 机一次只能允许一个用户去操作，如果你和别人争抢同一 ATM 机器，在谁都不避让的情况下那大家都没法去用了，如果排队去操作的话，大家遵守规则就都可以高效的完成，而 ATM 的大门就像是一把锁，进去的人通过给大门上锁来杜绝外面的人进来，等自己弄完了出去的时候再把门解锁，其他的人才能进来。\n\nMySQL 的锁，根据锁的范围分为全局锁、表级锁、行级锁三种。\n\n全局锁就是对整个数据库实例加上一把锁，如果需要加全局锁可以通过 flush tables with read lock（缩写就是FTWRL），这个命令可以让整个MySQL 的实例库处于只读状态，当其他用户线程去修改实例中的表和修改数据的时候都会被阻塞，导致不能提交事务操作。全局锁的这个特性可以让实例处于只读状态，此时可以通过 select 查询进行备份的操作。但是这种方式在主从集群的环境下就可能会产生问题，主从的设计是提高数据库的高可用性和数据库冗余同时提高数据库的吞吐量，如果一台数据库实例挂了，此时另一台数据库可以通过某些机制切换为主库正常的提供服务，同时通过数据库冗余进行数据的备份处理。但是如果让整个数据库都处于只读模式就可能导致以下的两种情况：\n1. 如果只在主库上进行备份的操作，那么在备份的时候主库都不能执行更新的操作，因为此时其他用户的修改操作都会被阻塞，导致事务不能正常的提交，那么此时业务系统的新数据就无法写入。\n2. 如果在从库上做备份，备份的操作在执行期间就不能执行主库同步过来的 binlog，会导致主从的同步出现延迟，同步出现延迟就会导致主从的数据不一致。\n那如果备份的时候不加锁会怎么样呢？首先如果备份期间不加锁，也就意味着在执行备份操作的时候，其他用户还是可以正常修改和提交事务的操作，那么可能会导致数据出现不一致的问题，因为有些业务可能要同时修改多个表，但事务的提交和备份的时间点可能是不同的，此时的数据备份也是无意义的。所以为了保证数据的完整性，必须加锁。\n\nMySQL 的 mysqldump 工具是官方自带的逻辑备份工具，在使用的时候可以通过—single-transaction 的参数在导出数据之前就启动一个事务，因为MySQL 的 InnoDB 引擎是支持事务，但是 MyISAM 是不支持的。所以当数据库引擎是 InnoDB 的时候，可以通过 mysqldump 工具的 —single-transaction 参数启动一个事务来给数据库拍一个快照，此时所有的备份操作都是在这个事务中完成的，就不会影响其他用户的修改操作了。对于只支持MyISAM 的表就只能通过 fluash tables with read lcok 命令来进行锁库备份了。\n\n使全库只读还有一种方式也能实现，就是设置 readonly 的全局属性值为 true，也可以让全库进入只读的状态。但是 readonly 的参数在主从环境下可能会被用来判断这个库是主库还是从库，影响的面积会比较大，遇到问题也不好排查。其次 flush tables with read lock 命令执行后如果客户发生异常断开后全局锁也会主动进行释放，但是如果通过设置 readonly 参数，在客户端断开后如果没有及时改变状态值，会导致全局依旧处于只读状态，风险会高很多。\n\n表级锁有两种：表锁、元数据锁。\n\n表锁的语法是 lock tables table_name 锁类型，锁类型有两种：read（共享锁，允许其他事务读取，但不允许修改），write（排他锁，禁止其他事务读取和修改），解锁的话可以通过unlock tables 完成，也可以在客户断开的时候自动释放。如果对 t1 进行了 read 锁，t2 进行了 write 锁，那么其他用户线程写t1 时会被阻塞掉，读写 t2 的时候也会被阻塞掉，直到客户端断开或者手动执行了unlock tables 释放锁后其他用户才可以进行读写。在unlock tables 解锁之前，也不能访问其他的表。\n\n元数据锁（metadata lock，mdl）会在访问一个表的时候自动加上，作用是保证读写的正确性，通过对表做增、删、改、查操作的时候加读锁，对表结构做变更的时候加写锁。读锁时允许其他的用户线程读取但禁止写入，写锁时不允许其他的用户线程读和写。读锁之间不互斥，可以同时有多个用户线程对一张表增删改查。写锁互斥，如果有两个线程同时要改一张表的表结构，必须等到另一个线程执行完才能开始执行。所以如果需要给表加字段的情况下可以通过查询information_schema 库中的innodb_trx 表中有没有正在执行的事务，如果有事务正在执行，就要先考虑晚点再加，或者 kill 掉这个长事务。或者在 alter table 语句里面设定等待时间，如果在等待时间能拿到写锁最好，如果拿不到也不要阻塞后面的业务语句的执行，否则一旦阻塞就会导致整张表不能读写。\n\n问题：在实际操作中，如何判断一个表是否适合使用 NOWAIT 或 WAIT N 语法？\n","source":"_posts/【MySQL-实战-45-讲：第六章节（全局锁和表锁）】学习小节.md","raw":"---\ntitle: 【MySQL 实战 45 讲：第六章节（全局锁和表锁）】学习小节\ntoc: true\nabbrlink: fee476b9\ndate: 2025-03-27 18:15:40\ntags: [MySQL]\n---\n\n<meta name=\"referrer\" content=\"no-referrer\" />\n\n<!-- more -->\n\n数据库锁的设计初衷是用于解决并发问题的，因为当多个用户访问或修改同一资源的时候就会产生资源的互斥性。如果不对资源的访问进行并发限制，会导致大家都在争抢同一个资源，谁都没办法用了。为了解决这个问题就需要系统层面去合理的控制资源的访问顺序和规则，锁就是用于实现这种并发访问的一种机制。想象一下你去 ATM 机取钱，ATM 机一次只能允许一个用户去操作，如果你和别人争抢同一 ATM 机器，在谁都不避让的情况下那大家都没法去用了，如果排队去操作的话，大家遵守规则就都可以高效的完成，而 ATM 的大门就像是一把锁，进去的人通过给大门上锁来杜绝外面的人进来，等自己弄完了出去的时候再把门解锁，其他的人才能进来。\n\nMySQL 的锁，根据锁的范围分为全局锁、表级锁、行级锁三种。\n\n全局锁就是对整个数据库实例加上一把锁，如果需要加全局锁可以通过 flush tables with read lock（缩写就是FTWRL），这个命令可以让整个MySQL 的实例库处于只读状态，当其他用户线程去修改实例中的表和修改数据的时候都会被阻塞，导致不能提交事务操作。全局锁的这个特性可以让实例处于只读状态，此时可以通过 select 查询进行备份的操作。但是这种方式在主从集群的环境下就可能会产生问题，主从的设计是提高数据库的高可用性和数据库冗余同时提高数据库的吞吐量，如果一台数据库实例挂了，此时另一台数据库可以通过某些机制切换为主库正常的提供服务，同时通过数据库冗余进行数据的备份处理。但是如果让整个数据库都处于只读模式就可能导致以下的两种情况：\n1. 如果只在主库上进行备份的操作，那么在备份的时候主库都不能执行更新的操作，因为此时其他用户的修改操作都会被阻塞，导致事务不能正常的提交，那么此时业务系统的新数据就无法写入。\n2. 如果在从库上做备份，备份的操作在执行期间就不能执行主库同步过来的 binlog，会导致主从的同步出现延迟，同步出现延迟就会导致主从的数据不一致。\n那如果备份的时候不加锁会怎么样呢？首先如果备份期间不加锁，也就意味着在执行备份操作的时候，其他用户还是可以正常修改和提交事务的操作，那么可能会导致数据出现不一致的问题，因为有些业务可能要同时修改多个表，但事务的提交和备份的时间点可能是不同的，此时的数据备份也是无意义的。所以为了保证数据的完整性，必须加锁。\n\nMySQL 的 mysqldump 工具是官方自带的逻辑备份工具，在使用的时候可以通过—single-transaction 的参数在导出数据之前就启动一个事务，因为MySQL 的 InnoDB 引擎是支持事务，但是 MyISAM 是不支持的。所以当数据库引擎是 InnoDB 的时候，可以通过 mysqldump 工具的 —single-transaction 参数启动一个事务来给数据库拍一个快照，此时所有的备份操作都是在这个事务中完成的，就不会影响其他用户的修改操作了。对于只支持MyISAM 的表就只能通过 fluash tables with read lcok 命令来进行锁库备份了。\n\n使全库只读还有一种方式也能实现，就是设置 readonly 的全局属性值为 true，也可以让全库进入只读的状态。但是 readonly 的参数在主从环境下可能会被用来判断这个库是主库还是从库，影响的面积会比较大，遇到问题也不好排查。其次 flush tables with read lock 命令执行后如果客户发生异常断开后全局锁也会主动进行释放，但是如果通过设置 readonly 参数，在客户端断开后如果没有及时改变状态值，会导致全局依旧处于只读状态，风险会高很多。\n\n表级锁有两种：表锁、元数据锁。\n\n表锁的语法是 lock tables table_name 锁类型，锁类型有两种：read（共享锁，允许其他事务读取，但不允许修改），write（排他锁，禁止其他事务读取和修改），解锁的话可以通过unlock tables 完成，也可以在客户断开的时候自动释放。如果对 t1 进行了 read 锁，t2 进行了 write 锁，那么其他用户线程写t1 时会被阻塞掉，读写 t2 的时候也会被阻塞掉，直到客户端断开或者手动执行了unlock tables 释放锁后其他用户才可以进行读写。在unlock tables 解锁之前，也不能访问其他的表。\n\n元数据锁（metadata lock，mdl）会在访问一个表的时候自动加上，作用是保证读写的正确性，通过对表做增、删、改、查操作的时候加读锁，对表结构做变更的时候加写锁。读锁时允许其他的用户线程读取但禁止写入，写锁时不允许其他的用户线程读和写。读锁之间不互斥，可以同时有多个用户线程对一张表增删改查。写锁互斥，如果有两个线程同时要改一张表的表结构，必须等到另一个线程执行完才能开始执行。所以如果需要给表加字段的情况下可以通过查询information_schema 库中的innodb_trx 表中有没有正在执行的事务，如果有事务正在执行，就要先考虑晚点再加，或者 kill 掉这个长事务。或者在 alter table 语句里面设定等待时间，如果在等待时间能拿到写锁最好，如果拿不到也不要阻塞后面的业务语句的执行，否则一旦阻塞就会导致整张表不能读写。\n\n问题：在实际操作中，如何判断一个表是否适合使用 NOWAIT 或 WAIT N 语法？\n","slug":"【MySQL-实战-45-讲：第六章节（全局锁和表锁）】学习小节","published":1,"updated":"2025-03-28T05:44:31.114Z","comments":1,"layout":"post","photos":[],"_id":"cm8se3tdk000sbb8ld6px90cg","content":"<meta name=\"referrer\" content=\"no-referrer\" />\n\n<span id=\"more\"></span>\n\n<p>数据库锁的设计初衷是用于解决并发问题的，因为当多个用户访问或修改同一资源的时候就会产生资源的互斥性。如果不对资源的访问进行并发限制，会导致大家都在争抢同一个资源，谁都没办法用了。为了解决这个问题就需要系统层面去合理的控制资源的访问顺序和规则，锁就是用于实现这种并发访问的一种机制。想象一下你去 ATM 机取钱，ATM 机一次只能允许一个用户去操作，如果你和别人争抢同一 ATM 机器，在谁都不避让的情况下那大家都没法去用了，如果排队去操作的话，大家遵守规则就都可以高效的完成，而 ATM 的大门就像是一把锁，进去的人通过给大门上锁来杜绝外面的人进来，等自己弄完了出去的时候再把门解锁，其他的人才能进来。</p>\n<p>MySQL 的锁，根据锁的范围分为全局锁、表级锁、行级锁三种。</p>\n<p>全局锁就是对整个数据库实例加上一把锁，如果需要加全局锁可以通过 flush tables with read lock（缩写就是FTWRL），这个命令可以让整个MySQL 的实例库处于只读状态，当其他用户线程去修改实例中的表和修改数据的时候都会被阻塞，导致不能提交事务操作。全局锁的这个特性可以让实例处于只读状态，此时可以通过 select 查询进行备份的操作。但是这种方式在主从集群的环境下就可能会产生问题，主从的设计是提高数据库的高可用性和数据库冗余同时提高数据库的吞吐量，如果一台数据库实例挂了，此时另一台数据库可以通过某些机制切换为主库正常的提供服务，同时通过数据库冗余进行数据的备份处理。但是如果让整个数据库都处于只读模式就可能导致以下的两种情况：</p>\n<ol>\n<li>如果只在主库上进行备份的操作，那么在备份的时候主库都不能执行更新的操作，因为此时其他用户的修改操作都会被阻塞，导致事务不能正常的提交，那么此时业务系统的新数据就无法写入。</li>\n<li>如果在从库上做备份，备份的操作在执行期间就不能执行主库同步过来的 binlog，会导致主从的同步出现延迟，同步出现延迟就会导致主从的数据不一致。<br>那如果备份的时候不加锁会怎么样呢？首先如果备份期间不加锁，也就意味着在执行备份操作的时候，其他用户还是可以正常修改和提交事务的操作，那么可能会导致数据出现不一致的问题，因为有些业务可能要同时修改多个表，但事务的提交和备份的时间点可能是不同的，此时的数据备份也是无意义的。所以为了保证数据的完整性，必须加锁。</li>\n</ol>\n<p>MySQL 的 mysqldump 工具是官方自带的逻辑备份工具，在使用的时候可以通过—single-transaction 的参数在导出数据之前就启动一个事务，因为MySQL 的 InnoDB 引擎是支持事务，但是 MyISAM 是不支持的。所以当数据库引擎是 InnoDB 的时候，可以通过 mysqldump 工具的 —single-transaction 参数启动一个事务来给数据库拍一个快照，此时所有的备份操作都是在这个事务中完成的，就不会影响其他用户的修改操作了。对于只支持MyISAM 的表就只能通过 fluash tables with read lcok 命令来进行锁库备份了。</p>\n<p>使全库只读还有一种方式也能实现，就是设置 readonly 的全局属性值为 true，也可以让全库进入只读的状态。但是 readonly 的参数在主从环境下可能会被用来判断这个库是主库还是从库，影响的面积会比较大，遇到问题也不好排查。其次 flush tables with read lock 命令执行后如果客户发生异常断开后全局锁也会主动进行释放，但是如果通过设置 readonly 参数，在客户端断开后如果没有及时改变状态值，会导致全局依旧处于只读状态，风险会高很多。</p>\n<p>表级锁有两种：表锁、元数据锁。</p>\n<p>表锁的语法是 lock tables table_name 锁类型，锁类型有两种：read（共享锁，允许其他事务读取，但不允许修改），write（排他锁，禁止其他事务读取和修改），解锁的话可以通过unlock tables 完成，也可以在客户断开的时候自动释放。如果对 t1 进行了 read 锁，t2 进行了 write 锁，那么其他用户线程写t1 时会被阻塞掉，读写 t2 的时候也会被阻塞掉，直到客户端断开或者手动执行了unlock tables 释放锁后其他用户才可以进行读写。在unlock tables 解锁之前，也不能访问其他的表。</p>\n<p>元数据锁（metadata lock，mdl）会在访问一个表的时候自动加上，作用是保证读写的正确性，通过对表做增、删、改、查操作的时候加读锁，对表结构做变更的时候加写锁。读锁时允许其他的用户线程读取但禁止写入，写锁时不允许其他的用户线程读和写。读锁之间不互斥，可以同时有多个用户线程对一张表增删改查。写锁互斥，如果有两个线程同时要改一张表的表结构，必须等到另一个线程执行完才能开始执行。所以如果需要给表加字段的情况下可以通过查询information_schema 库中的innodb_trx 表中有没有正在执行的事务，如果有事务正在执行，就要先考虑晚点再加，或者 kill 掉这个长事务。或者在 alter table 语句里面设定等待时间，如果在等待时间能拿到写锁最好，如果拿不到也不要阻塞后面的业务语句的执行，否则一旦阻塞就会导致整张表不能读写。</p>\n<p>问题：在实际操作中，如何判断一个表是否适合使用 NOWAIT 或 WAIT N 语法？</p>\n","excerpt":"<meta name=\"referrer\" content=\"no-referrer\" />","more":"<p>数据库锁的设计初衷是用于解决并发问题的，因为当多个用户访问或修改同一资源的时候就会产生资源的互斥性。如果不对资源的访问进行并发限制，会导致大家都在争抢同一个资源，谁都没办法用了。为了解决这个问题就需要系统层面去合理的控制资源的访问顺序和规则，锁就是用于实现这种并发访问的一种机制。想象一下你去 ATM 机取钱，ATM 机一次只能允许一个用户去操作，如果你和别人争抢同一 ATM 机器，在谁都不避让的情况下那大家都没法去用了，如果排队去操作的话，大家遵守规则就都可以高效的完成，而 ATM 的大门就像是一把锁，进去的人通过给大门上锁来杜绝外面的人进来，等自己弄完了出去的时候再把门解锁，其他的人才能进来。</p>\n<p>MySQL 的锁，根据锁的范围分为全局锁、表级锁、行级锁三种。</p>\n<p>全局锁就是对整个数据库实例加上一把锁，如果需要加全局锁可以通过 flush tables with read lock（缩写就是FTWRL），这个命令可以让整个MySQL 的实例库处于只读状态，当其他用户线程去修改实例中的表和修改数据的时候都会被阻塞，导致不能提交事务操作。全局锁的这个特性可以让实例处于只读状态，此时可以通过 select 查询进行备份的操作。但是这种方式在主从集群的环境下就可能会产生问题，主从的设计是提高数据库的高可用性和数据库冗余同时提高数据库的吞吐量，如果一台数据库实例挂了，此时另一台数据库可以通过某些机制切换为主库正常的提供服务，同时通过数据库冗余进行数据的备份处理。但是如果让整个数据库都处于只读模式就可能导致以下的两种情况：</p>\n<ol>\n<li>如果只在主库上进行备份的操作，那么在备份的时候主库都不能执行更新的操作，因为此时其他用户的修改操作都会被阻塞，导致事务不能正常的提交，那么此时业务系统的新数据就无法写入。</li>\n<li>如果在从库上做备份，备份的操作在执行期间就不能执行主库同步过来的 binlog，会导致主从的同步出现延迟，同步出现延迟就会导致主从的数据不一致。<br>那如果备份的时候不加锁会怎么样呢？首先如果备份期间不加锁，也就意味着在执行备份操作的时候，其他用户还是可以正常修改和提交事务的操作，那么可能会导致数据出现不一致的问题，因为有些业务可能要同时修改多个表，但事务的提交和备份的时间点可能是不同的，此时的数据备份也是无意义的。所以为了保证数据的完整性，必须加锁。</li>\n</ol>\n<p>MySQL 的 mysqldump 工具是官方自带的逻辑备份工具，在使用的时候可以通过—single-transaction 的参数在导出数据之前就启动一个事务，因为MySQL 的 InnoDB 引擎是支持事务，但是 MyISAM 是不支持的。所以当数据库引擎是 InnoDB 的时候，可以通过 mysqldump 工具的 —single-transaction 参数启动一个事务来给数据库拍一个快照，此时所有的备份操作都是在这个事务中完成的，就不会影响其他用户的修改操作了。对于只支持MyISAM 的表就只能通过 fluash tables with read lcok 命令来进行锁库备份了。</p>\n<p>使全库只读还有一种方式也能实现，就是设置 readonly 的全局属性值为 true，也可以让全库进入只读的状态。但是 readonly 的参数在主从环境下可能会被用来判断这个库是主库还是从库，影响的面积会比较大，遇到问题也不好排查。其次 flush tables with read lock 命令执行后如果客户发生异常断开后全局锁也会主动进行释放，但是如果通过设置 readonly 参数，在客户端断开后如果没有及时改变状态值，会导致全局依旧处于只读状态，风险会高很多。</p>\n<p>表级锁有两种：表锁、元数据锁。</p>\n<p>表锁的语法是 lock tables table_name 锁类型，锁类型有两种：read（共享锁，允许其他事务读取，但不允许修改），write（排他锁，禁止其他事务读取和修改），解锁的话可以通过unlock tables 完成，也可以在客户断开的时候自动释放。如果对 t1 进行了 read 锁，t2 进行了 write 锁，那么其他用户线程写t1 时会被阻塞掉，读写 t2 的时候也会被阻塞掉，直到客户端断开或者手动执行了unlock tables 释放锁后其他用户才可以进行读写。在unlock tables 解锁之前，也不能访问其他的表。</p>\n<p>元数据锁（metadata lock，mdl）会在访问一个表的时候自动加上，作用是保证读写的正确性，通过对表做增、删、改、查操作的时候加读锁，对表结构做变更的时候加写锁。读锁时允许其他的用户线程读取但禁止写入，写锁时不允许其他的用户线程读和写。读锁之间不互斥，可以同时有多个用户线程对一张表增删改查。写锁互斥，如果有两个线程同时要改一张表的表结构，必须等到另一个线程执行完才能开始执行。所以如果需要给表加字段的情况下可以通过查询information_schema 库中的innodb_trx 表中有没有正在执行的事务，如果有事务正在执行，就要先考虑晚点再加，或者 kill 掉这个长事务。或者在 alter table 语句里面设定等待时间，如果在等待时间能拿到写锁最好，如果拿不到也不要阻塞后面的业务语句的执行，否则一旦阻塞就会导致整张表不能读写。</p>\n<p>问题：在实际操作中，如何判断一个表是否适合使用 NOWAIT 或 WAIT N 语法？</p>"},{"title":"【MySQL 实战 45 讲：第四、五章节（深入浅出索引）】学习小节","toc":true,"abbrlink":"c0cb477","date":"2025-03-27T18:14:27.000Z","_content":"\n<meta name=\"referrer\" content=\"no-referrer\" />\n\n<!--more-->\n\n索引的意义：索引的出现就是为了提高数据的查询效率，就像书的目录一样，通过目录能够快速的知道这本书讲了什么以及如何快速翻到对应的知识章节。\n\n在计算机中为了实现索引数据的存储有三种比较常见的数据结构：Hash 表、有序数组、搜索树；\n\nHash 表是一种以键 - 值存储的数据结构，其核心思想是把键和值以指定的方式进行存储，在存储时把键通过 hash 函数进行计算来确定在数组上的某个位置，然后把对应的值放到这个位置上。查询时将指定的键通过 Hash 函数进行计算获取键在数组中的位置，以获取数据中存放的值。当多个 Hash 函数计算同一个键时容易产生 Hash 冲突。这样就会存在多个键出现在同一个位置的情况，所以 Hash 表只适合于等值查询的场景，不适合于区间查询的场景。\n\n有序数组是一种按顺序排列的数据，其特点是按照从小到大或从大到小的顺序排列，这种排列方式的好处是找东西特别快，方便查找和处理。但缺点是更新数据比较麻烦，你往中间插入数据的时候就必须挪动该数组位置后面所有的数组记录，成本太高。\n\n搜索树是一种数据结构，像一颗倒挂的树，用来快速查找、插入和删除数据。每个节点有一个值和最多两个子节点（左和右）。左边的子节点值比父节点小，右边的子节点值比父节点大。但特殊情况下该树可能会成为一个链表，比如新的节点一直比父节点大或一直比父节点小。此时为了保证树的层级不能太深，就需要保证这个树是平衡二叉树。\n树既然可以有二叉，那就可以有多叉，多叉指得是在子节点上有多个儿子，儿子之间的大小保证从左到右递增。二叉树是搜索效率目前最高的，但是实际的数据库存储并不会去用二叉树，原因是数据不止需要存储在内存中，还需要最终持久化保存到磁盘上。其次是二叉树过高时会导致 IO 的次数过多，导致性能低下。\n\nInnoDB 的索引存储使用的是 B+树。这个树和搜索树的结构很像。不同的是只有最底层的叶子节点才存储数据。非叶子节点存储是叶子节点的位置指针。\n从类型上来说分为聚簇索引和非聚簇索引。所谓聚簇索引就是数据和索引保存在一起。\n聚簇索引一般指的就是主键索引，叶子节点存放的是整条行记录，非叶子节点存储是叶子节点的指针。\n非聚簇索引存放的是索引字段和索引的主键字段，当查询条件根据最左前缀原则匹配到索引树时，根据索引字段去搜索，当搜索到符合条件的节点时，得到该节点的ID 值，此时会拿到 ID 再去聚簇索引中根据ID 再搜索一遍，通过 ID 拿到整行的记录，这个过程称之为回表。因为回表多一次查询操作，所以能直接走聚簇索引时应尽可能走聚簇索引，避免一次查询的开销。\n最左前缀原则指的按照索引字段的从左边其第 N 个字段，或者符合索引字段顺序的从左起 N 个字符。对于不符合最左前缀的部分，InnoDB 会使用索引下推的机制在索引遍历的过程中，对索引包含的字段先左判断，直接过滤掉不符合条件的记录，减少回表次数。\n\n因为 B+树的存储特性，叶子节点时链表存储的，所以为了提高索引的插入效率，会建议主键使用自增主键进行插入，目的是利用索引的存储结构提高插入效率，如果使用 UUID 存储会产生两个问题，第一 UUID 是 128位长度，就算去除所谓的“-”字符也需要 32 位的存储空间，空间的问题对于现在的大容量存储来说已经不再是什么问题了，但 UUID 为了避免冲突会产生随机分布的问题，这就导致了插入时不是顺序插入的。这种情况下可能会产生为了保证顺序存储进而产生拆分原有的数据页以解决顺序存储的问题，一旦产生所谓的页分裂，性能就会下降很多。所以应该建议使用bigint unsigned AUTO_INCREMENT 的方式存储，占用 64 位。\n\n当查询的条件刚好符合非聚簇索引的索引字段，那么非聚簇索引就可以直接返回符合条件的查询结果了，就不需要再去聚簇索引上查询了，这个过程称之为覆盖索引。\n\n\n问题一：产生页分裂后，后面的数据会不会继续页分裂？\n问题二：当查询条件符合非聚簇索引的索引字段，但 select 字段超出了非聚簇索引的索引字段，那么这个查询可以使用覆盖索引吗？\n问题三：当索引的最多前缀顺序不一致时，会不会自动根据索引下推机制去做索引的查询优化？\n","source":"_posts/【MySQL-实战-45-讲：第四、五章节（深入浅出索引）】学习小节.md","raw":"---\ntitle: 【MySQL 实战 45 讲：第四、五章节（深入浅出索引）】学习小节\ntoc: true\nabbrlink: c0cb477\ndate: 2025-03-27 18:14:27\ntags: MySQL\n---\n\n<meta name=\"referrer\" content=\"no-referrer\" />\n\n<!--more-->\n\n索引的意义：索引的出现就是为了提高数据的查询效率，就像书的目录一样，通过目录能够快速的知道这本书讲了什么以及如何快速翻到对应的知识章节。\n\n在计算机中为了实现索引数据的存储有三种比较常见的数据结构：Hash 表、有序数组、搜索树；\n\nHash 表是一种以键 - 值存储的数据结构，其核心思想是把键和值以指定的方式进行存储，在存储时把键通过 hash 函数进行计算来确定在数组上的某个位置，然后把对应的值放到这个位置上。查询时将指定的键通过 Hash 函数进行计算获取键在数组中的位置，以获取数据中存放的值。当多个 Hash 函数计算同一个键时容易产生 Hash 冲突。这样就会存在多个键出现在同一个位置的情况，所以 Hash 表只适合于等值查询的场景，不适合于区间查询的场景。\n\n有序数组是一种按顺序排列的数据，其特点是按照从小到大或从大到小的顺序排列，这种排列方式的好处是找东西特别快，方便查找和处理。但缺点是更新数据比较麻烦，你往中间插入数据的时候就必须挪动该数组位置后面所有的数组记录，成本太高。\n\n搜索树是一种数据结构，像一颗倒挂的树，用来快速查找、插入和删除数据。每个节点有一个值和最多两个子节点（左和右）。左边的子节点值比父节点小，右边的子节点值比父节点大。但特殊情况下该树可能会成为一个链表，比如新的节点一直比父节点大或一直比父节点小。此时为了保证树的层级不能太深，就需要保证这个树是平衡二叉树。\n树既然可以有二叉，那就可以有多叉，多叉指得是在子节点上有多个儿子，儿子之间的大小保证从左到右递增。二叉树是搜索效率目前最高的，但是实际的数据库存储并不会去用二叉树，原因是数据不止需要存储在内存中，还需要最终持久化保存到磁盘上。其次是二叉树过高时会导致 IO 的次数过多，导致性能低下。\n\nInnoDB 的索引存储使用的是 B+树。这个树和搜索树的结构很像。不同的是只有最底层的叶子节点才存储数据。非叶子节点存储是叶子节点的位置指针。\n从类型上来说分为聚簇索引和非聚簇索引。所谓聚簇索引就是数据和索引保存在一起。\n聚簇索引一般指的就是主键索引，叶子节点存放的是整条行记录，非叶子节点存储是叶子节点的指针。\n非聚簇索引存放的是索引字段和索引的主键字段，当查询条件根据最左前缀原则匹配到索引树时，根据索引字段去搜索，当搜索到符合条件的节点时，得到该节点的ID 值，此时会拿到 ID 再去聚簇索引中根据ID 再搜索一遍，通过 ID 拿到整行的记录，这个过程称之为回表。因为回表多一次查询操作，所以能直接走聚簇索引时应尽可能走聚簇索引，避免一次查询的开销。\n最左前缀原则指的按照索引字段的从左边其第 N 个字段，或者符合索引字段顺序的从左起 N 个字符。对于不符合最左前缀的部分，InnoDB 会使用索引下推的机制在索引遍历的过程中，对索引包含的字段先左判断，直接过滤掉不符合条件的记录，减少回表次数。\n\n因为 B+树的存储特性，叶子节点时链表存储的，所以为了提高索引的插入效率，会建议主键使用自增主键进行插入，目的是利用索引的存储结构提高插入效率，如果使用 UUID 存储会产生两个问题，第一 UUID 是 128位长度，就算去除所谓的“-”字符也需要 32 位的存储空间，空间的问题对于现在的大容量存储来说已经不再是什么问题了，但 UUID 为了避免冲突会产生随机分布的问题，这就导致了插入时不是顺序插入的。这种情况下可能会产生为了保证顺序存储进而产生拆分原有的数据页以解决顺序存储的问题，一旦产生所谓的页分裂，性能就会下降很多。所以应该建议使用bigint unsigned AUTO_INCREMENT 的方式存储，占用 64 位。\n\n当查询的条件刚好符合非聚簇索引的索引字段，那么非聚簇索引就可以直接返回符合条件的查询结果了，就不需要再去聚簇索引上查询了，这个过程称之为覆盖索引。\n\n\n问题一：产生页分裂后，后面的数据会不会继续页分裂？\n问题二：当查询条件符合非聚簇索引的索引字段，但 select 字段超出了非聚簇索引的索引字段，那么这个查询可以使用覆盖索引吗？\n问题三：当索引的最多前缀顺序不一致时，会不会自动根据索引下推机制去做索引的查询优化？\n","slug":"【MySQL-实战-45-讲：第四、五章节（深入浅出索引）】学习小节","published":1,"updated":"2025-03-28T05:44:31.114Z","comments":1,"layout":"post","photos":[],"_id":"cm8se3tdm000wbb8lgemjalkb","content":"<meta name=\"referrer\" content=\"no-referrer\" />\n\n<span id=\"more\"></span>\n\n<p>索引的意义：索引的出现就是为了提高数据的查询效率，就像书的目录一样，通过目录能够快速的知道这本书讲了什么以及如何快速翻到对应的知识章节。</p>\n<p>在计算机中为了实现索引数据的存储有三种比较常见的数据结构：Hash 表、有序数组、搜索树；</p>\n<p>Hash 表是一种以键 - 值存储的数据结构，其核心思想是把键和值以指定的方式进行存储，在存储时把键通过 hash 函数进行计算来确定在数组上的某个位置，然后把对应的值放到这个位置上。查询时将指定的键通过 Hash 函数进行计算获取键在数组中的位置，以获取数据中存放的值。当多个 Hash 函数计算同一个键时容易产生 Hash 冲突。这样就会存在多个键出现在同一个位置的情况，所以 Hash 表只适合于等值查询的场景，不适合于区间查询的场景。</p>\n<p>有序数组是一种按顺序排列的数据，其特点是按照从小到大或从大到小的顺序排列，这种排列方式的好处是找东西特别快，方便查找和处理。但缺点是更新数据比较麻烦，你往中间插入数据的时候就必须挪动该数组位置后面所有的数组记录，成本太高。</p>\n<p>搜索树是一种数据结构，像一颗倒挂的树，用来快速查找、插入和删除数据。每个节点有一个值和最多两个子节点（左和右）。左边的子节点值比父节点小，右边的子节点值比父节点大。但特殊情况下该树可能会成为一个链表，比如新的节点一直比父节点大或一直比父节点小。此时为了保证树的层级不能太深，就需要保证这个树是平衡二叉树。<br>树既然可以有二叉，那就可以有多叉，多叉指得是在子节点上有多个儿子，儿子之间的大小保证从左到右递增。二叉树是搜索效率目前最高的，但是实际的数据库存储并不会去用二叉树，原因是数据不止需要存储在内存中，还需要最终持久化保存到磁盘上。其次是二叉树过高时会导致 IO 的次数过多，导致性能低下。</p>\n<p>InnoDB 的索引存储使用的是 B+树。这个树和搜索树的结构很像。不同的是只有最底层的叶子节点才存储数据。非叶子节点存储是叶子节点的位置指针。<br>从类型上来说分为聚簇索引和非聚簇索引。所谓聚簇索引就是数据和索引保存在一起。<br>聚簇索引一般指的就是主键索引，叶子节点存放的是整条行记录，非叶子节点存储是叶子节点的指针。<br>非聚簇索引存放的是索引字段和索引的主键字段，当查询条件根据最左前缀原则匹配到索引树时，根据索引字段去搜索，当搜索到符合条件的节点时，得到该节点的ID 值，此时会拿到 ID 再去聚簇索引中根据ID 再搜索一遍，通过 ID 拿到整行的记录，这个过程称之为回表。因为回表多一次查询操作，所以能直接走聚簇索引时应尽可能走聚簇索引，避免一次查询的开销。<br>最左前缀原则指的按照索引字段的从左边其第 N 个字段，或者符合索引字段顺序的从左起 N 个字符。对于不符合最左前缀的部分，InnoDB 会使用索引下推的机制在索引遍历的过程中，对索引包含的字段先左判断，直接过滤掉不符合条件的记录，减少回表次数。</p>\n<p>因为 B+树的存储特性，叶子节点时链表存储的，所以为了提高索引的插入效率，会建议主键使用自增主键进行插入，目的是利用索引的存储结构提高插入效率，如果使用 UUID 存储会产生两个问题，第一 UUID 是 128位长度，就算去除所谓的“-”字符也需要 32 位的存储空间，空间的问题对于现在的大容量存储来说已经不再是什么问题了，但 UUID 为了避免冲突会产生随机分布的问题，这就导致了插入时不是顺序插入的。这种情况下可能会产生为了保证顺序存储进而产生拆分原有的数据页以解决顺序存储的问题，一旦产生所谓的页分裂，性能就会下降很多。所以应该建议使用bigint unsigned AUTO_INCREMENT 的方式存储，占用 64 位。</p>\n<p>当查询的条件刚好符合非聚簇索引的索引字段，那么非聚簇索引就可以直接返回符合条件的查询结果了，就不需要再去聚簇索引上查询了，这个过程称之为覆盖索引。</p>\n<p>问题一：产生页分裂后，后面的数据会不会继续页分裂？<br>问题二：当查询条件符合非聚簇索引的索引字段，但 select 字段超出了非聚簇索引的索引字段，那么这个查询可以使用覆盖索引吗？<br>问题三：当索引的最多前缀顺序不一致时，会不会自动根据索引下推机制去做索引的查询优化？</p>\n","excerpt":"<meta name=\"referrer\" content=\"no-referrer\" />","more":"<p>索引的意义：索引的出现就是为了提高数据的查询效率，就像书的目录一样，通过目录能够快速的知道这本书讲了什么以及如何快速翻到对应的知识章节。</p>\n<p>在计算机中为了实现索引数据的存储有三种比较常见的数据结构：Hash 表、有序数组、搜索树；</p>\n<p>Hash 表是一种以键 - 值存储的数据结构，其核心思想是把键和值以指定的方式进行存储，在存储时把键通过 hash 函数进行计算来确定在数组上的某个位置，然后把对应的值放到这个位置上。查询时将指定的键通过 Hash 函数进行计算获取键在数组中的位置，以获取数据中存放的值。当多个 Hash 函数计算同一个键时容易产生 Hash 冲突。这样就会存在多个键出现在同一个位置的情况，所以 Hash 表只适合于等值查询的场景，不适合于区间查询的场景。</p>\n<p>有序数组是一种按顺序排列的数据，其特点是按照从小到大或从大到小的顺序排列，这种排列方式的好处是找东西特别快，方便查找和处理。但缺点是更新数据比较麻烦，你往中间插入数据的时候就必须挪动该数组位置后面所有的数组记录，成本太高。</p>\n<p>搜索树是一种数据结构，像一颗倒挂的树，用来快速查找、插入和删除数据。每个节点有一个值和最多两个子节点（左和右）。左边的子节点值比父节点小，右边的子节点值比父节点大。但特殊情况下该树可能会成为一个链表，比如新的节点一直比父节点大或一直比父节点小。此时为了保证树的层级不能太深，就需要保证这个树是平衡二叉树。<br>树既然可以有二叉，那就可以有多叉，多叉指得是在子节点上有多个儿子，儿子之间的大小保证从左到右递增。二叉树是搜索效率目前最高的，但是实际的数据库存储并不会去用二叉树，原因是数据不止需要存储在内存中，还需要最终持久化保存到磁盘上。其次是二叉树过高时会导致 IO 的次数过多，导致性能低下。</p>\n<p>InnoDB 的索引存储使用的是 B+树。这个树和搜索树的结构很像。不同的是只有最底层的叶子节点才存储数据。非叶子节点存储是叶子节点的位置指针。<br>从类型上来说分为聚簇索引和非聚簇索引。所谓聚簇索引就是数据和索引保存在一起。<br>聚簇索引一般指的就是主键索引，叶子节点存放的是整条行记录，非叶子节点存储是叶子节点的指针。<br>非聚簇索引存放的是索引字段和索引的主键字段，当查询条件根据最左前缀原则匹配到索引树时，根据索引字段去搜索，当搜索到符合条件的节点时，得到该节点的ID 值，此时会拿到 ID 再去聚簇索引中根据ID 再搜索一遍，通过 ID 拿到整行的记录，这个过程称之为回表。因为回表多一次查询操作，所以能直接走聚簇索引时应尽可能走聚簇索引，避免一次查询的开销。<br>最左前缀原则指的按照索引字段的从左边其第 N 个字段，或者符合索引字段顺序的从左起 N 个字符。对于不符合最左前缀的部分，InnoDB 会使用索引下推的机制在索引遍历的过程中，对索引包含的字段先左判断，直接过滤掉不符合条件的记录，减少回表次数。</p>\n<p>因为 B+树的存储特性，叶子节点时链表存储的，所以为了提高索引的插入效率，会建议主键使用自增主键进行插入，目的是利用索引的存储结构提高插入效率，如果使用 UUID 存储会产生两个问题，第一 UUID 是 128位长度，就算去除所谓的“-”字符也需要 32 位的存储空间，空间的问题对于现在的大容量存储来说已经不再是什么问题了，但 UUID 为了避免冲突会产生随机分布的问题，这就导致了插入时不是顺序插入的。这种情况下可能会产生为了保证顺序存储进而产生拆分原有的数据页以解决顺序存储的问题，一旦产生所谓的页分裂，性能就会下降很多。所以应该建议使用bigint unsigned AUTO_INCREMENT 的方式存储，占用 64 位。</p>\n<p>当查询的条件刚好符合非聚簇索引的索引字段，那么非聚簇索引就可以直接返回符合条件的查询结果了，就不需要再去聚簇索引上查询了，这个过程称之为覆盖索引。</p>\n<p>问题一：产生页分裂后，后面的数据会不会继续页分裂？<br>问题二：当查询条件符合非聚簇索引的索引字段，但 select 字段超出了非聚簇索引的索引字段，那么这个查询可以使用覆盖索引吗？<br>问题三：当索引的最多前缀顺序不一致时，会不会自动根据索引下推机制去做索引的查询优化？</p>"},{"title":"【MySQL实战45讲：第七章节（行锁功过：怎么减少行锁对性能的影响？）】学习小结","toc":true,"abbrlink":"d6c36d88","date":"2025-03-27T18:16:51.000Z","_content":"<meta name=\"referrer\" content=\"no-referrer\" />\n\n<!-- more -->\n\nMyISAM引擎为什么不支持行锁？Mysql的行锁是由存储引擎自己去实现的，在 MySQL中主流的存储引擎由两种：MyISAM和InnoDB，在新版本的 MySQL 中InnoDB 是作为默认的存储引擎的，MyISAM 的存储引擎就没有了。原因是MyISAM的存储引擎是不支持事务的，但行级锁需要有事务隔离级别的支持。对于使用MyISAM作为存储引擎的表，一般会使用metadata lock（MDL）来进行锁表，MDL 的特性在修改数据时允许其他的线程去读数据但允许改数据，同一张表任何时刻只能有一个更新在执行，这会影响业务表的并发性，也正是因为MyISAM不支持事务和并发性的问题，但InnoDB是支持事务和行级锁的，这也就导致新版本中MyISAM引擎被 InnoDB 所替代。\n\n什么是行级锁？为什么行级锁会比表级锁更好呢？行级锁即行锁，是针对关系型数据表中行记录的锁。行锁的影响范围比表锁更小，影响的数据范围更小意味着业务的并发性会更高，业务并发性好系统的性能就会更好，能承载的数据处理能力就会更快、更高。比如张三此时更新了一条where id=1的数据，此时李四也更新了这条数据，如果没有行锁这个东西，张三、李四就会对ID=1的这条数据进行数据竞争，到底是谁先提交这个修改的事务不一定、修改数据结果更不好确定了，其次后修改的事务可能会覆盖先提交事务的更新，导致先提交事务的更新被覆盖了。\n\n什么是两阶段锁协议？为什么需要两阶段锁协议？如果没有这个协议会怎么样？在 InnoDB 事务中，行锁是在需要的时候才加上的，但并不是不需要了就立刻释放，而是要等到事务结束时才释放。也就是锁是有两个阶段的：一个是访问行记录前的加锁阶段；一个是事务提交后的解锁阶段，这就是所谓的“两阶段锁”协议。那为什么需要“两阶段锁”呢？两阶段锁可以保证事务的一致性，在修改数据时其他用户线程不能修改这个记录，以保证事务的原子性。比如电影票在线交易的业务，顾客 A 和顾客 B 都需要同时在影院 C 买票看电影，同时记录一条交易日志。那么流程如下：\n顾客 A：\n1. 顾客 A（ID=10） 发起下单扣款流程，从账户中扣除电影票价；\n2. 给影院 C 的账户余额增加电影票价；\n3. 记录一条顾客 A 购买影院某电影票的交易记录；\n顾客 B：\n1. 顾客 A（ID=20） 发起下单扣款流程，从账户中扣除电影票价；\n2. 给影院 C 的账户余额增加电影票价；\n3. 记录一条顾客 B 购买影院某电影票的交易记录；\n为了完成这个业务操作，需要同时更新两次影院 C 的账户余额，同时向交易表新增两条交易记录。为了保证业务操作的原子性都会把操作 1,2,3 放到一个事务里，这样如果某个步骤发生异常就会自动回滚，不会影响事务的一致性问题。但因为是同时提交的，都涉及到步骤 2 的修改操作，update 在修改时会对该条数据加读锁，此时其他的事务可以读但不能写，在事务 commit 后，改读锁释放，其他的用户线程才能改这条数据，不然会一直等待获取锁。所以当顾客 A 操作到第二步时因为已经拿到了读锁，会导致顾客 B 执行到这步时没有拿到读锁而一直等待，如果等待过长就会比较耗时，影响并发。如果调整顺序为 3,1,2 的情况下，步骤 3 的新增不会产生问题，访问到步骤 2 时拿到锁修改完成数据后，提交事务立即释放，从而减少了使用锁的时间，其他用户线程获取锁的等待时间也就变短了，那么访问并发性也就提高了。\n\n行级锁又会产生哪些问题，以及如何避免这些问题呢？行级锁在业务处理的时候，多个用户线程对同一数据访问的时候因为加锁问题产生锁的互斥，导致不同线程之间为了获取锁而出现循环资源依赖，涉及的线程都在等待别的线程释放锁，就会导致这几个线程都进入无限等待的状态。这个过程称之为“死锁”。避免这个死锁的问题可以下面的三种方式：\n1. 通过调整修改语句的顺序，让获取锁的数据都是一样的，这样就不会产生死锁的问题。\n3. 在修改语句的后面加入 for update 参数，这个参数可以让修改语句加读锁，让其他线程只能读取、不能修改。\n5. 在业务系统层面使用乐观锁，其核心思想就是在数据库中添加一个版本号字段（存储的是时间戳或者数字），更新数据时，版本号会自动递增，修改前读取一下这条记录的版本号，并在提交时检查版本号是否发生变化，版本号没有变化则更新并将版本号+1；如果版本号发生变化，说明数据被修改，事务需要回滚。\n如果已经出现了死锁，有两种策略可以解决：\n1. 进入等待，直到锁的超时，超时时间可以通过参数innodb_lock_wait_timeout 来设置，这个值的默认值是50s，如果采用这个策略，被锁住的线程要超过 50s 才会自动退出，其他的线程才会继续执行，对于在线实时系统来说超过 3s 就算是慢的，50s 的等待时间更是无法接受的，因为可能还有有业务处理和网络传输的耗时。如果参数值设置的太短也不合适，会导致需要获取锁而等待的线程被误伤，从而自动释放锁。\n2. 死锁检测，主动回顾死锁链中的某一个事务，让其他的事务得以继续执行，innodb_deadlock_detect 参数为on时表示开始这个逻辑，其默认状态就是on。但如果并发量大的情况下会导致大量的线程进行死锁检测，从而消耗大量的CPU资源，导致 CPU 利用率飙升。解决方式：\n    1. 如果确保不会死锁可以设置 innodb_deadlock_detect = off来关闭死锁检测，但关掉死锁检测如果出现死锁进行锁等待，导致出现大量的超时问题，这会对业务系统产生影响。所以一般不会使用这种方式；\n    2. 控制并发度。并发检测是有必要的，这可以避免大量的锁等待。通过排队机制比如消息队列来控制服务端的并发数，通过“排队取号”的机制也可以化解这个问题；\n","source":"_posts/【MySQL实战45讲：第七章节（行锁功过：怎么减少行锁对性能的影响？）】学习小结.md","raw":"---\ntitle: 【MySQL实战45讲：第七章节（行锁功过：怎么减少行锁对性能的影响？）】学习小结\ntoc: true\nabbrlink: d6c36d88\ndate: 2025-03-27 18:16:51\ntags: MySQL\n---\n<meta name=\"referrer\" content=\"no-referrer\" />\n\n<!-- more -->\n\nMyISAM引擎为什么不支持行锁？Mysql的行锁是由存储引擎自己去实现的，在 MySQL中主流的存储引擎由两种：MyISAM和InnoDB，在新版本的 MySQL 中InnoDB 是作为默认的存储引擎的，MyISAM 的存储引擎就没有了。原因是MyISAM的存储引擎是不支持事务的，但行级锁需要有事务隔离级别的支持。对于使用MyISAM作为存储引擎的表，一般会使用metadata lock（MDL）来进行锁表，MDL 的特性在修改数据时允许其他的线程去读数据但允许改数据，同一张表任何时刻只能有一个更新在执行，这会影响业务表的并发性，也正是因为MyISAM不支持事务和并发性的问题，但InnoDB是支持事务和行级锁的，这也就导致新版本中MyISAM引擎被 InnoDB 所替代。\n\n什么是行级锁？为什么行级锁会比表级锁更好呢？行级锁即行锁，是针对关系型数据表中行记录的锁。行锁的影响范围比表锁更小，影响的数据范围更小意味着业务的并发性会更高，业务并发性好系统的性能就会更好，能承载的数据处理能力就会更快、更高。比如张三此时更新了一条where id=1的数据，此时李四也更新了这条数据，如果没有行锁这个东西，张三、李四就会对ID=1的这条数据进行数据竞争，到底是谁先提交这个修改的事务不一定、修改数据结果更不好确定了，其次后修改的事务可能会覆盖先提交事务的更新，导致先提交事务的更新被覆盖了。\n\n什么是两阶段锁协议？为什么需要两阶段锁协议？如果没有这个协议会怎么样？在 InnoDB 事务中，行锁是在需要的时候才加上的，但并不是不需要了就立刻释放，而是要等到事务结束时才释放。也就是锁是有两个阶段的：一个是访问行记录前的加锁阶段；一个是事务提交后的解锁阶段，这就是所谓的“两阶段锁”协议。那为什么需要“两阶段锁”呢？两阶段锁可以保证事务的一致性，在修改数据时其他用户线程不能修改这个记录，以保证事务的原子性。比如电影票在线交易的业务，顾客 A 和顾客 B 都需要同时在影院 C 买票看电影，同时记录一条交易日志。那么流程如下：\n顾客 A：\n1. 顾客 A（ID=10） 发起下单扣款流程，从账户中扣除电影票价；\n2. 给影院 C 的账户余额增加电影票价；\n3. 记录一条顾客 A 购买影院某电影票的交易记录；\n顾客 B：\n1. 顾客 A（ID=20） 发起下单扣款流程，从账户中扣除电影票价；\n2. 给影院 C 的账户余额增加电影票价；\n3. 记录一条顾客 B 购买影院某电影票的交易记录；\n为了完成这个业务操作，需要同时更新两次影院 C 的账户余额，同时向交易表新增两条交易记录。为了保证业务操作的原子性都会把操作 1,2,3 放到一个事务里，这样如果某个步骤发生异常就会自动回滚，不会影响事务的一致性问题。但因为是同时提交的，都涉及到步骤 2 的修改操作，update 在修改时会对该条数据加读锁，此时其他的事务可以读但不能写，在事务 commit 后，改读锁释放，其他的用户线程才能改这条数据，不然会一直等待获取锁。所以当顾客 A 操作到第二步时因为已经拿到了读锁，会导致顾客 B 执行到这步时没有拿到读锁而一直等待，如果等待过长就会比较耗时，影响并发。如果调整顺序为 3,1,2 的情况下，步骤 3 的新增不会产生问题，访问到步骤 2 时拿到锁修改完成数据后，提交事务立即释放，从而减少了使用锁的时间，其他用户线程获取锁的等待时间也就变短了，那么访问并发性也就提高了。\n\n行级锁又会产生哪些问题，以及如何避免这些问题呢？行级锁在业务处理的时候，多个用户线程对同一数据访问的时候因为加锁问题产生锁的互斥，导致不同线程之间为了获取锁而出现循环资源依赖，涉及的线程都在等待别的线程释放锁，就会导致这几个线程都进入无限等待的状态。这个过程称之为“死锁”。避免这个死锁的问题可以下面的三种方式：\n1. 通过调整修改语句的顺序，让获取锁的数据都是一样的，这样就不会产生死锁的问题。\n3. 在修改语句的后面加入 for update 参数，这个参数可以让修改语句加读锁，让其他线程只能读取、不能修改。\n5. 在业务系统层面使用乐观锁，其核心思想就是在数据库中添加一个版本号字段（存储的是时间戳或者数字），更新数据时，版本号会自动递增，修改前读取一下这条记录的版本号，并在提交时检查版本号是否发生变化，版本号没有变化则更新并将版本号+1；如果版本号发生变化，说明数据被修改，事务需要回滚。\n如果已经出现了死锁，有两种策略可以解决：\n1. 进入等待，直到锁的超时，超时时间可以通过参数innodb_lock_wait_timeout 来设置，这个值的默认值是50s，如果采用这个策略，被锁住的线程要超过 50s 才会自动退出，其他的线程才会继续执行，对于在线实时系统来说超过 3s 就算是慢的，50s 的等待时间更是无法接受的，因为可能还有有业务处理和网络传输的耗时。如果参数值设置的太短也不合适，会导致需要获取锁而等待的线程被误伤，从而自动释放锁。\n2. 死锁检测，主动回顾死锁链中的某一个事务，让其他的事务得以继续执行，innodb_deadlock_detect 参数为on时表示开始这个逻辑，其默认状态就是on。但如果并发量大的情况下会导致大量的线程进行死锁检测，从而消耗大量的CPU资源，导致 CPU 利用率飙升。解决方式：\n    1. 如果确保不会死锁可以设置 innodb_deadlock_detect = off来关闭死锁检测，但关掉死锁检测如果出现死锁进行锁等待，导致出现大量的超时问题，这会对业务系统产生影响。所以一般不会使用这种方式；\n    2. 控制并发度。并发检测是有必要的，这可以避免大量的锁等待。通过排队机制比如消息队列来控制服务端的并发数，通过“排队取号”的机制也可以化解这个问题；\n","slug":"【MySQL实战45讲：第七章节（行锁功过：怎么减少行锁对性能的影响？）】学习小结","published":1,"updated":"2025-03-28T05:44:31.114Z","comments":1,"layout":"post","photos":[],"_id":"cm8se3tdn000zbb8l71ih55b3","content":"<meta name=\"referrer\" content=\"no-referrer\" />\n\n<span id=\"more\"></span>\n\n<p>MyISAM引擎为什么不支持行锁？Mysql的行锁是由存储引擎自己去实现的，在 MySQL中主流的存储引擎由两种：MyISAM和InnoDB，在新版本的 MySQL 中InnoDB 是作为默认的存储引擎的，MyISAM 的存储引擎就没有了。原因是MyISAM的存储引擎是不支持事务的，但行级锁需要有事务隔离级别的支持。对于使用MyISAM作为存储引擎的表，一般会使用metadata lock（MDL）来进行锁表，MDL 的特性在修改数据时允许其他的线程去读数据但允许改数据，同一张表任何时刻只能有一个更新在执行，这会影响业务表的并发性，也正是因为MyISAM不支持事务和并发性的问题，但InnoDB是支持事务和行级锁的，这也就导致新版本中MyISAM引擎被 InnoDB 所替代。</p>\n<p>什么是行级锁？为什么行级锁会比表级锁更好呢？行级锁即行锁，是针对关系型数据表中行记录的锁。行锁的影响范围比表锁更小，影响的数据范围更小意味着业务的并发性会更高，业务并发性好系统的性能就会更好，能承载的数据处理能力就会更快、更高。比如张三此时更新了一条where id&#x3D;1的数据，此时李四也更新了这条数据，如果没有行锁这个东西，张三、李四就会对ID&#x3D;1的这条数据进行数据竞争，到底是谁先提交这个修改的事务不一定、修改数据结果更不好确定了，其次后修改的事务可能会覆盖先提交事务的更新，导致先提交事务的更新被覆盖了。</p>\n<p>什么是两阶段锁协议？为什么需要两阶段锁协议？如果没有这个协议会怎么样？在 InnoDB 事务中，行锁是在需要的时候才加上的，但并不是不需要了就立刻释放，而是要等到事务结束时才释放。也就是锁是有两个阶段的：一个是访问行记录前的加锁阶段；一个是事务提交后的解锁阶段，这就是所谓的“两阶段锁”协议。那为什么需要“两阶段锁”呢？两阶段锁可以保证事务的一致性，在修改数据时其他用户线程不能修改这个记录，以保证事务的原子性。比如电影票在线交易的业务，顾客 A 和顾客 B 都需要同时在影院 C 买票看电影，同时记录一条交易日志。那么流程如下：<br>顾客 A：</p>\n<ol>\n<li>顾客 A（ID&#x3D;10） 发起下单扣款流程，从账户中扣除电影票价；</li>\n<li>给影院 C 的账户余额增加电影票价；</li>\n<li>记录一条顾客 A 购买影院某电影票的交易记录；<br>顾客 B：</li>\n<li>顾客 A（ID&#x3D;20） 发起下单扣款流程，从账户中扣除电影票价；</li>\n<li>给影院 C 的账户余额增加电影票价；</li>\n<li>记录一条顾客 B 购买影院某电影票的交易记录；<br>为了完成这个业务操作，需要同时更新两次影院 C 的账户余额，同时向交易表新增两条交易记录。为了保证业务操作的原子性都会把操作 1,2,3 放到一个事务里，这样如果某个步骤发生异常就会自动回滚，不会影响事务的一致性问题。但因为是同时提交的，都涉及到步骤 2 的修改操作，update 在修改时会对该条数据加读锁，此时其他的事务可以读但不能写，在事务 commit 后，改读锁释放，其他的用户线程才能改这条数据，不然会一直等待获取锁。所以当顾客 A 操作到第二步时因为已经拿到了读锁，会导致顾客 B 执行到这步时没有拿到读锁而一直等待，如果等待过长就会比较耗时，影响并发。如果调整顺序为 3,1,2 的情况下，步骤 3 的新增不会产生问题，访问到步骤 2 时拿到锁修改完成数据后，提交事务立即释放，从而减少了使用锁的时间，其他用户线程获取锁的等待时间也就变短了，那么访问并发性也就提高了。</li>\n</ol>\n<p>行级锁又会产生哪些问题，以及如何避免这些问题呢？行级锁在业务处理的时候，多个用户线程对同一数据访问的时候因为加锁问题产生锁的互斥，导致不同线程之间为了获取锁而出现循环资源依赖，涉及的线程都在等待别的线程释放锁，就会导致这几个线程都进入无限等待的状态。这个过程称之为“死锁”。避免这个死锁的问题可以下面的三种方式：</p>\n<ol>\n<li>通过调整修改语句的顺序，让获取锁的数据都是一样的，这样就不会产生死锁的问题。</li>\n<li>在修改语句的后面加入 for update 参数，这个参数可以让修改语句加读锁，让其他线程只能读取、不能修改。</li>\n<li>在业务系统层面使用乐观锁，其核心思想就是在数据库中添加一个版本号字段（存储的是时间戳或者数字），更新数据时，版本号会自动递增，修改前读取一下这条记录的版本号，并在提交时检查版本号是否发生变化，版本号没有变化则更新并将版本号+1；如果版本号发生变化，说明数据被修改，事务需要回滚。<br>如果已经出现了死锁，有两种策略可以解决：</li>\n<li>进入等待，直到锁的超时，超时时间可以通过参数innodb_lock_wait_timeout 来设置，这个值的默认值是50s，如果采用这个策略，被锁住的线程要超过 50s 才会自动退出，其他的线程才会继续执行，对于在线实时系统来说超过 3s 就算是慢的，50s 的等待时间更是无法接受的，因为可能还有有业务处理和网络传输的耗时。如果参数值设置的太短也不合适，会导致需要获取锁而等待的线程被误伤，从而自动释放锁。</li>\n<li>死锁检测，主动回顾死锁链中的某一个事务，让其他的事务得以继续执行，innodb_deadlock_detect 参数为on时表示开始这个逻辑，其默认状态就是on。但如果并发量大的情况下会导致大量的线程进行死锁检测，从而消耗大量的CPU资源，导致 CPU 利用率飙升。解决方式：<ol>\n<li>如果确保不会死锁可以设置 innodb_deadlock_detect &#x3D; off来关闭死锁检测，但关掉死锁检测如果出现死锁进行锁等待，导致出现大量的超时问题，这会对业务系统产生影响。所以一般不会使用这种方式；</li>\n<li>控制并发度。并发检测是有必要的，这可以避免大量的锁等待。通过排队机制比如消息队列来控制服务端的并发数，通过“排队取号”的机制也可以化解这个问题；</li>\n</ol>\n</li>\n</ol>\n","excerpt":"<meta name=\"referrer\" content=\"no-referrer\" />","more":"<p>MyISAM引擎为什么不支持行锁？Mysql的行锁是由存储引擎自己去实现的，在 MySQL中主流的存储引擎由两种：MyISAM和InnoDB，在新版本的 MySQL 中InnoDB 是作为默认的存储引擎的，MyISAM 的存储引擎就没有了。原因是MyISAM的存储引擎是不支持事务的，但行级锁需要有事务隔离级别的支持。对于使用MyISAM作为存储引擎的表，一般会使用metadata lock（MDL）来进行锁表，MDL 的特性在修改数据时允许其他的线程去读数据但允许改数据，同一张表任何时刻只能有一个更新在执行，这会影响业务表的并发性，也正是因为MyISAM不支持事务和并发性的问题，但InnoDB是支持事务和行级锁的，这也就导致新版本中MyISAM引擎被 InnoDB 所替代。</p>\n<p>什么是行级锁？为什么行级锁会比表级锁更好呢？行级锁即行锁，是针对关系型数据表中行记录的锁。行锁的影响范围比表锁更小，影响的数据范围更小意味着业务的并发性会更高，业务并发性好系统的性能就会更好，能承载的数据处理能力就会更快、更高。比如张三此时更新了一条where id&#x3D;1的数据，此时李四也更新了这条数据，如果没有行锁这个东西，张三、李四就会对ID&#x3D;1的这条数据进行数据竞争，到底是谁先提交这个修改的事务不一定、修改数据结果更不好确定了，其次后修改的事务可能会覆盖先提交事务的更新，导致先提交事务的更新被覆盖了。</p>\n<p>什么是两阶段锁协议？为什么需要两阶段锁协议？如果没有这个协议会怎么样？在 InnoDB 事务中，行锁是在需要的时候才加上的，但并不是不需要了就立刻释放，而是要等到事务结束时才释放。也就是锁是有两个阶段的：一个是访问行记录前的加锁阶段；一个是事务提交后的解锁阶段，这就是所谓的“两阶段锁”协议。那为什么需要“两阶段锁”呢？两阶段锁可以保证事务的一致性，在修改数据时其他用户线程不能修改这个记录，以保证事务的原子性。比如电影票在线交易的业务，顾客 A 和顾客 B 都需要同时在影院 C 买票看电影，同时记录一条交易日志。那么流程如下：<br>顾客 A：</p>\n<ol>\n<li>顾客 A（ID&#x3D;10） 发起下单扣款流程，从账户中扣除电影票价；</li>\n<li>给影院 C 的账户余额增加电影票价；</li>\n<li>记录一条顾客 A 购买影院某电影票的交易记录；<br>顾客 B：</li>\n<li>顾客 A（ID&#x3D;20） 发起下单扣款流程，从账户中扣除电影票价；</li>\n<li>给影院 C 的账户余额增加电影票价；</li>\n<li>记录一条顾客 B 购买影院某电影票的交易记录；<br>为了完成这个业务操作，需要同时更新两次影院 C 的账户余额，同时向交易表新增两条交易记录。为了保证业务操作的原子性都会把操作 1,2,3 放到一个事务里，这样如果某个步骤发生异常就会自动回滚，不会影响事务的一致性问题。但因为是同时提交的，都涉及到步骤 2 的修改操作，update 在修改时会对该条数据加读锁，此时其他的事务可以读但不能写，在事务 commit 后，改读锁释放，其他的用户线程才能改这条数据，不然会一直等待获取锁。所以当顾客 A 操作到第二步时因为已经拿到了读锁，会导致顾客 B 执行到这步时没有拿到读锁而一直等待，如果等待过长就会比较耗时，影响并发。如果调整顺序为 3,1,2 的情况下，步骤 3 的新增不会产生问题，访问到步骤 2 时拿到锁修改完成数据后，提交事务立即释放，从而减少了使用锁的时间，其他用户线程获取锁的等待时间也就变短了，那么访问并发性也就提高了。</li>\n</ol>\n<p>行级锁又会产生哪些问题，以及如何避免这些问题呢？行级锁在业务处理的时候，多个用户线程对同一数据访问的时候因为加锁问题产生锁的互斥，导致不同线程之间为了获取锁而出现循环资源依赖，涉及的线程都在等待别的线程释放锁，就会导致这几个线程都进入无限等待的状态。这个过程称之为“死锁”。避免这个死锁的问题可以下面的三种方式：</p>\n<ol>\n<li>通过调整修改语句的顺序，让获取锁的数据都是一样的，这样就不会产生死锁的问题。</li>\n<li>在修改语句的后面加入 for update 参数，这个参数可以让修改语句加读锁，让其他线程只能读取、不能修改。</li>\n<li>在业务系统层面使用乐观锁，其核心思想就是在数据库中添加一个版本号字段（存储的是时间戳或者数字），更新数据时，版本号会自动递增，修改前读取一下这条记录的版本号，并在提交时检查版本号是否发生变化，版本号没有变化则更新并将版本号+1；如果版本号发生变化，说明数据被修改，事务需要回滚。<br>如果已经出现了死锁，有两种策略可以解决：</li>\n<li>进入等待，直到锁的超时，超时时间可以通过参数innodb_lock_wait_timeout 来设置，这个值的默认值是50s，如果采用这个策略，被锁住的线程要超过 50s 才会自动退出，其他的线程才会继续执行，对于在线实时系统来说超过 3s 就算是慢的，50s 的等待时间更是无法接受的，因为可能还有有业务处理和网络传输的耗时。如果参数值设置的太短也不合适，会导致需要获取锁而等待的线程被误伤，从而自动释放锁。</li>\n<li>死锁检测，主动回顾死锁链中的某一个事务，让其他的事务得以继续执行，innodb_deadlock_detect 参数为on时表示开始这个逻辑，其默认状态就是on。但如果并发量大的情况下会导致大量的线程进行死锁检测，从而消耗大量的CPU资源，导致 CPU 利用率飙升。解决方式：<ol>\n<li>如果确保不会死锁可以设置 innodb_deadlock_detect &#x3D; off来关闭死锁检测，但关掉死锁检测如果出现死锁进行锁等待，导致出现大量的超时问题，这会对业务系统产生影响。所以一般不会使用这种方式；</li>\n<li>控制并发度。并发检测是有必要的，这可以避免大量的锁等待。通过排队机制比如消息队列来控制服务端的并发数，通过“排队取号”的机制也可以化解这个问题；</li>\n</ol>\n</li>\n</ol>"},{"title":"【高性能MySQL：第一章节（MySQL架构与历史）】学习小节","toc":true,"abbrlink":"a2be5ae4","date":"2025-03-27T18:09:28.000Z","_content":"\n本章解释了MySQL的架构及其存储引擎的关键设计，也介绍一点MySQL的历史背景、版本演进、开发模式等信息。\n\n<!--more-->\n\n问题一：为什么已经有了这么多的数据库，还会有MySQL这个产物出现？\nMySQL 遵循 GPL 开源协议意味着每个用户可以自由的使用 MySQL 源代码，通过这种方式可以促进开源社区的生态，推动代码持续开放和社区协作，每个用户都可以获取其他人的贡献也可以向其他人提供帮助，以此形成正向循环。开发者也可以向 GPL 项目贡献代码，提高自己的个人影响力其劳动成果受制于 GPL 的约束也不会被商业公司独占。大厂可以通过 GPL 源码来研发适合自己业务的数据库系统，降低研发成本，因为从头开发写一个数据库成本是巨大的，但如果有现成且很不错的轮子再去根据需要去改的话，成本就会降低太多。但需要注意是大厂修改的这部分 MySQL 源码也需要开源，否则可能会带来一些不必要的法律问题。\n\n问题二：MySQL 的架构思想是什么样的？\nMySQL 通过分层架构的思想，将查询处理及其他系统任务和数据存取相分离，使得各层的内部组件可以协同工作、各司其职，这样可以显著提高处理效率，也有利于架构的整洁性、可维护性和可扩展性。\nMySQL 的架构从总体上看分为三个层面：客户端、服务器层、存储引擎。\n客户端负责面向客户的连接处理、授权认证、安全访问等功能。\n服务器层是 MySQL 的一个核心服务，包含查询解析器、词法分析器、语法分析器、优化器、查询缓存、执行器、以及 MySQL相关的内置函数、存储过程、触发器、视图等。服务器层主要目的是解决与存储引擎之间的交互。因为 MySQL 支持不同的存储引擎，比如支持事务处理的 InnoDB 引擎，和非事务的 MyISAM 引擎。以及基于内存处理的 Memory 引擎，所以跨存储引擎的功能都在服务器层进行处理。\n存储引擎负责数据的存储和提取，管理数据以什么方式持久化到硬盘上并且不会丢失的问题，以及如何管理数据的可靠性问题。存储引擎不会去解析 SQL ，也不会去和其他的存储引擎进行通信，只会处理和响应来自服务器层的 API 请求。\n从查询过程上来看，整个过程应该是这样的：\n1. 当一个客户端与 MySQL 服务器通过 TCP 的三次握手建立连接时，一次会话就开始了，客户端首先需要通过正确的用户名、密码来通过 MySQL 的连接检查和授权认证，以此来证明我是有许可授权的。\n2. 当连接成功并鉴权通过时，用户就获得了会话授权，此时用户就可以发送 SQL 指令来给 MySQL 服务器下达指令我要干什么。\n3. 当 MySQL 服务器层获取用户下达的 SQL 指令时服务层就需要通过内部的机制来去理解指令的意图。那么就需要对 SQL 指令进行解读，通过词法分析来对关键词进行拆解判断指令要做的动作、通过语法分析器来判断指令有没有不能被理解的部分、通过优化器来判断应该怎么执行会更高效，再去查询缓存中以 SQL 指令为key 去判断是否有执行过的记录，如果有就把缓存过的查询结果返回，如果没有就去走执行器跟存储引擎进行 API 交互来获取符合条件的数据并将查询结果缓存到查询缓存中并将查询结果返回给客户端，一次整个的查询过程就结束掉了。\n\n问题三：MySQL 是如何解决多个会话同时访问同一数据的问题的？\n多个会话在同一时间访问同一数据的问题不单单是指查询的操作，也可能是修改、删除、新增等业务场景。就像一个门同时只能允许一个人通过，但此时如果两个人都要通过这个门，如果两个人都不谦让的情况在，那么最终的结果就是大家都只能耗着谁都过不去，这个过程称之为“死锁”。如果此时有一个人主动避让这个循环就将被打破，大家也都能高效率的通过门。\n但当多个用户在同一时刻去操作同一资源，尤其是一个是查询，一个是删除或者更新操作的时候就会出现非幂等性的问题进而产生脏读和幻读问题。MySQL 的查询操作本身就是幂等性的，因为不论查询多少次，在数据不被修改的前提下数据返回的最终结果都是一致的。幻读和脏读问题的本质其实就是数据的并发控制问题和数据的隔离问题。MySQL 在服务器层面通过锁机制来解决数据的并发控制问题，在存储引擎层面通过锁机制和事务的隔离级别和 MVCC 事务版本号机制来解决数据脏读和幻读问题。\n锁机制的实现跟银行柜台窗口的排队机制是很像的，在银行柜台窗口都有空闲且无人排队时，那么你到哪个窗口办理业务都是可以的，因为不存在柜台窗口的资源竞争性问题。但如果当人多了超过柜台所接待的最大人数，就需要通过取号系统来排队等号。当柜台窗口的用户在办业务时，后面的用户都需要排队等待。当柜台用户办理完业务时，用户所取的号码就会从独占状态释放，柜台用户号码的下一个用户才能到窗口办理业务并独占柜台资源，此时号码会转换为独占状态，下一个编号就进入等待状态，如果下一个编号被连续叫号 3 次没有用户应答，该编号就会被释放，延续到下个编号的用户。那么这个锁其实就是排他锁。只不过银行通过队列 + 锁解决了柜台资源的竞争性问题。\nMySQL 通过表锁来实现数据竞争性的管理。一个用户在对表进行写操作前，需要先获取写锁，这会阻塞其他用户对该表的所有读写操作，也就是此时用户在释放锁前对该表是独占的。当没有写锁时，其他读锁的用户才能获取读锁，在当前用户获取读锁的同时，其他用户也是可以获取的。\n行级锁的优点是其锁粒度更小，因为只需要锁定需要的数据航，锁粒度更小意味着影响的数据量会小很多，也会支持更大的并发量，但缺点是维护的成本也会更高，比如：检查锁、获取锁、判断锁的状态、释放锁。但这些都是存储引擎自身去管理和维护的。\n锁机制在一定程度上确实解决了数据访问的竞争问题，但是在某些特定的场景下锁机制也不是万能的，比如张三从银行账户转账 1000 元给李四，就需要这几个步骤：\n1. 首先张三的账户上有没有 1000 元，如果没有则余额不足没办法转账；\n2. 从张三的账户中扣减 1000 元；\n3. 李四的账户中增加 1000 元；\n此时只有当三个操作都成功的情况下整个的转账流程才算完成，但如果有一步不满足要求都不能算成功，此时单纯的通过锁机制很难实现这个逻辑，为了解决这个问题就需要事务来完成，只有当整个事务都成功时转账的操作才算完成。事务通过隔离级别的控制以达到隔离访问的目的，这样的好处是通过隔离级别的控制让其他事务能在什么情况下看到数据的更改。比如说当处于“未提交读”的情况下，即使事务没有提交，其他事务也是可以看到的，此时其他事务如果读到没有提交或者撤掉提交前的事务数据，因为读取的是无效数据，这个情况被称之为“脏读”，通过调整隔离级别为“可重复读”就可以解决该问题。还有种情况是事务读取了某个范围的数据记录时，其他事务又在这个范围内插入或修改了记录，之前的事务再次查询这个范围的数据记录时，就会产生幻读的问题，MySQL 通过 MVCC 来解决了幻读的问题，也就是通过创建时间的事务版本号和过期时间的事务版本号来判断的。\n\n问题四：在“提交读“的事务隔离级别下，因为两次执行同样的查询，可能会得到不一样的结果，为什么？\n\n问题五：为什么大多数数据库系统的默认级别是“提交读”，而 MySQL 的默认级别是“可重复读”？\n\n问题六：为什么 MySQL 使用 InnoDB 来作为默认的存储引擎？\n数据存储的可靠性以及数据的完整性是存储问题的重要难题，InnoDB 引擎支持事务，性能和自动崩溃恢复特性也在众多环境下得到良好的验证。使用 MVCC 来支持高并发，通过间隙锁策略来解决幻读的问题。通过聚簇索引存储数据结构来提高查询的效率和性能。InnoDB 的内部也做了很多的优化来提高插入性能。","source":"_posts/【高性能MySQL：第一章节（MySQL架构与历史）】学习小节.md","raw":"---\ntitle: 【高性能MySQL：第一章节（MySQL架构与历史）】学习小节\ntoc: true\ntags:\n  - MySQL\nabbrlink: a2be5ae4\ndate: 2025-03-27 18:09:28\n---\n\n本章解释了MySQL的架构及其存储引擎的关键设计，也介绍一点MySQL的历史背景、版本演进、开发模式等信息。\n\n<!--more-->\n\n问题一：为什么已经有了这么多的数据库，还会有MySQL这个产物出现？\nMySQL 遵循 GPL 开源协议意味着每个用户可以自由的使用 MySQL 源代码，通过这种方式可以促进开源社区的生态，推动代码持续开放和社区协作，每个用户都可以获取其他人的贡献也可以向其他人提供帮助，以此形成正向循环。开发者也可以向 GPL 项目贡献代码，提高自己的个人影响力其劳动成果受制于 GPL 的约束也不会被商业公司独占。大厂可以通过 GPL 源码来研发适合自己业务的数据库系统，降低研发成本，因为从头开发写一个数据库成本是巨大的，但如果有现成且很不错的轮子再去根据需要去改的话，成本就会降低太多。但需要注意是大厂修改的这部分 MySQL 源码也需要开源，否则可能会带来一些不必要的法律问题。\n\n问题二：MySQL 的架构思想是什么样的？\nMySQL 通过分层架构的思想，将查询处理及其他系统任务和数据存取相分离，使得各层的内部组件可以协同工作、各司其职，这样可以显著提高处理效率，也有利于架构的整洁性、可维护性和可扩展性。\nMySQL 的架构从总体上看分为三个层面：客户端、服务器层、存储引擎。\n客户端负责面向客户的连接处理、授权认证、安全访问等功能。\n服务器层是 MySQL 的一个核心服务，包含查询解析器、词法分析器、语法分析器、优化器、查询缓存、执行器、以及 MySQL相关的内置函数、存储过程、触发器、视图等。服务器层主要目的是解决与存储引擎之间的交互。因为 MySQL 支持不同的存储引擎，比如支持事务处理的 InnoDB 引擎，和非事务的 MyISAM 引擎。以及基于内存处理的 Memory 引擎，所以跨存储引擎的功能都在服务器层进行处理。\n存储引擎负责数据的存储和提取，管理数据以什么方式持久化到硬盘上并且不会丢失的问题，以及如何管理数据的可靠性问题。存储引擎不会去解析 SQL ，也不会去和其他的存储引擎进行通信，只会处理和响应来自服务器层的 API 请求。\n从查询过程上来看，整个过程应该是这样的：\n1. 当一个客户端与 MySQL 服务器通过 TCP 的三次握手建立连接时，一次会话就开始了，客户端首先需要通过正确的用户名、密码来通过 MySQL 的连接检查和授权认证，以此来证明我是有许可授权的。\n2. 当连接成功并鉴权通过时，用户就获得了会话授权，此时用户就可以发送 SQL 指令来给 MySQL 服务器下达指令我要干什么。\n3. 当 MySQL 服务器层获取用户下达的 SQL 指令时服务层就需要通过内部的机制来去理解指令的意图。那么就需要对 SQL 指令进行解读，通过词法分析来对关键词进行拆解判断指令要做的动作、通过语法分析器来判断指令有没有不能被理解的部分、通过优化器来判断应该怎么执行会更高效，再去查询缓存中以 SQL 指令为key 去判断是否有执行过的记录，如果有就把缓存过的查询结果返回，如果没有就去走执行器跟存储引擎进行 API 交互来获取符合条件的数据并将查询结果缓存到查询缓存中并将查询结果返回给客户端，一次整个的查询过程就结束掉了。\n\n问题三：MySQL 是如何解决多个会话同时访问同一数据的问题的？\n多个会话在同一时间访问同一数据的问题不单单是指查询的操作，也可能是修改、删除、新增等业务场景。就像一个门同时只能允许一个人通过，但此时如果两个人都要通过这个门，如果两个人都不谦让的情况在，那么最终的结果就是大家都只能耗着谁都过不去，这个过程称之为“死锁”。如果此时有一个人主动避让这个循环就将被打破，大家也都能高效率的通过门。\n但当多个用户在同一时刻去操作同一资源，尤其是一个是查询，一个是删除或者更新操作的时候就会出现非幂等性的问题进而产生脏读和幻读问题。MySQL 的查询操作本身就是幂等性的，因为不论查询多少次，在数据不被修改的前提下数据返回的最终结果都是一致的。幻读和脏读问题的本质其实就是数据的并发控制问题和数据的隔离问题。MySQL 在服务器层面通过锁机制来解决数据的并发控制问题，在存储引擎层面通过锁机制和事务的隔离级别和 MVCC 事务版本号机制来解决数据脏读和幻读问题。\n锁机制的实现跟银行柜台窗口的排队机制是很像的，在银行柜台窗口都有空闲且无人排队时，那么你到哪个窗口办理业务都是可以的，因为不存在柜台窗口的资源竞争性问题。但如果当人多了超过柜台所接待的最大人数，就需要通过取号系统来排队等号。当柜台窗口的用户在办业务时，后面的用户都需要排队等待。当柜台用户办理完业务时，用户所取的号码就会从独占状态释放，柜台用户号码的下一个用户才能到窗口办理业务并独占柜台资源，此时号码会转换为独占状态，下一个编号就进入等待状态，如果下一个编号被连续叫号 3 次没有用户应答，该编号就会被释放，延续到下个编号的用户。那么这个锁其实就是排他锁。只不过银行通过队列 + 锁解决了柜台资源的竞争性问题。\nMySQL 通过表锁来实现数据竞争性的管理。一个用户在对表进行写操作前，需要先获取写锁，这会阻塞其他用户对该表的所有读写操作，也就是此时用户在释放锁前对该表是独占的。当没有写锁时，其他读锁的用户才能获取读锁，在当前用户获取读锁的同时，其他用户也是可以获取的。\n行级锁的优点是其锁粒度更小，因为只需要锁定需要的数据航，锁粒度更小意味着影响的数据量会小很多，也会支持更大的并发量，但缺点是维护的成本也会更高，比如：检查锁、获取锁、判断锁的状态、释放锁。但这些都是存储引擎自身去管理和维护的。\n锁机制在一定程度上确实解决了数据访问的竞争问题，但是在某些特定的场景下锁机制也不是万能的，比如张三从银行账户转账 1000 元给李四，就需要这几个步骤：\n1. 首先张三的账户上有没有 1000 元，如果没有则余额不足没办法转账；\n2. 从张三的账户中扣减 1000 元；\n3. 李四的账户中增加 1000 元；\n此时只有当三个操作都成功的情况下整个的转账流程才算完成，但如果有一步不满足要求都不能算成功，此时单纯的通过锁机制很难实现这个逻辑，为了解决这个问题就需要事务来完成，只有当整个事务都成功时转账的操作才算完成。事务通过隔离级别的控制以达到隔离访问的目的，这样的好处是通过隔离级别的控制让其他事务能在什么情况下看到数据的更改。比如说当处于“未提交读”的情况下，即使事务没有提交，其他事务也是可以看到的，此时其他事务如果读到没有提交或者撤掉提交前的事务数据，因为读取的是无效数据，这个情况被称之为“脏读”，通过调整隔离级别为“可重复读”就可以解决该问题。还有种情况是事务读取了某个范围的数据记录时，其他事务又在这个范围内插入或修改了记录，之前的事务再次查询这个范围的数据记录时，就会产生幻读的问题，MySQL 通过 MVCC 来解决了幻读的问题，也就是通过创建时间的事务版本号和过期时间的事务版本号来判断的。\n\n问题四：在“提交读“的事务隔离级别下，因为两次执行同样的查询，可能会得到不一样的结果，为什么？\n\n问题五：为什么大多数数据库系统的默认级别是“提交读”，而 MySQL 的默认级别是“可重复读”？\n\n问题六：为什么 MySQL 使用 InnoDB 来作为默认的存储引擎？\n数据存储的可靠性以及数据的完整性是存储问题的重要难题，InnoDB 引擎支持事务，性能和自动崩溃恢复特性也在众多环境下得到良好的验证。使用 MVCC 来支持高并发，通过间隙锁策略来解决幻读的问题。通过聚簇索引存储数据结构来提高查询的效率和性能。InnoDB 的内部也做了很多的优化来提高插入性能。","slug":"【高性能MySQL：第一章节（MySQL架构与历史）】学习小节","published":1,"updated":"2025-03-28T05:44:31.114Z","comments":1,"layout":"post","photos":[],"_id":"cm8se3tdo0012bb8l5kpz2l8k","content":"<p>本章解释了MySQL的架构及其存储引擎的关键设计，也介绍一点MySQL的历史背景、版本演进、开发模式等信息。</p>\n<span id=\"more\"></span>\n\n<p>问题一：为什么已经有了这么多的数据库，还会有MySQL这个产物出现？<br>MySQL 遵循 GPL 开源协议意味着每个用户可以自由的使用 MySQL 源代码，通过这种方式可以促进开源社区的生态，推动代码持续开放和社区协作，每个用户都可以获取其他人的贡献也可以向其他人提供帮助，以此形成正向循环。开发者也可以向 GPL 项目贡献代码，提高自己的个人影响力其劳动成果受制于 GPL 的约束也不会被商业公司独占。大厂可以通过 GPL 源码来研发适合自己业务的数据库系统，降低研发成本，因为从头开发写一个数据库成本是巨大的，但如果有现成且很不错的轮子再去根据需要去改的话，成本就会降低太多。但需要注意是大厂修改的这部分 MySQL 源码也需要开源，否则可能会带来一些不必要的法律问题。</p>\n<p>问题二：MySQL 的架构思想是什么样的？<br>MySQL 通过分层架构的思想，将查询处理及其他系统任务和数据存取相分离，使得各层的内部组件可以协同工作、各司其职，这样可以显著提高处理效率，也有利于架构的整洁性、可维护性和可扩展性。<br>MySQL 的架构从总体上看分为三个层面：客户端、服务器层、存储引擎。<br>客户端负责面向客户的连接处理、授权认证、安全访问等功能。<br>服务器层是 MySQL 的一个核心服务，包含查询解析器、词法分析器、语法分析器、优化器、查询缓存、执行器、以及 MySQL相关的内置函数、存储过程、触发器、视图等。服务器层主要目的是解决与存储引擎之间的交互。因为 MySQL 支持不同的存储引擎，比如支持事务处理的 InnoDB 引擎，和非事务的 MyISAM 引擎。以及基于内存处理的 Memory 引擎，所以跨存储引擎的功能都在服务器层进行处理。<br>存储引擎负责数据的存储和提取，管理数据以什么方式持久化到硬盘上并且不会丢失的问题，以及如何管理数据的可靠性问题。存储引擎不会去解析 SQL ，也不会去和其他的存储引擎进行通信，只会处理和响应来自服务器层的 API 请求。<br>从查询过程上来看，整个过程应该是这样的：</p>\n<ol>\n<li>当一个客户端与 MySQL 服务器通过 TCP 的三次握手建立连接时，一次会话就开始了，客户端首先需要通过正确的用户名、密码来通过 MySQL 的连接检查和授权认证，以此来证明我是有许可授权的。</li>\n<li>当连接成功并鉴权通过时，用户就获得了会话授权，此时用户就可以发送 SQL 指令来给 MySQL 服务器下达指令我要干什么。</li>\n<li>当 MySQL 服务器层获取用户下达的 SQL 指令时服务层就需要通过内部的机制来去理解指令的意图。那么就需要对 SQL 指令进行解读，通过词法分析来对关键词进行拆解判断指令要做的动作、通过语法分析器来判断指令有没有不能被理解的部分、通过优化器来判断应该怎么执行会更高效，再去查询缓存中以 SQL 指令为key 去判断是否有执行过的记录，如果有就把缓存过的查询结果返回，如果没有就去走执行器跟存储引擎进行 API 交互来获取符合条件的数据并将查询结果缓存到查询缓存中并将查询结果返回给客户端，一次整个的查询过程就结束掉了。</li>\n</ol>\n<p>问题三：MySQL 是如何解决多个会话同时访问同一数据的问题的？<br>多个会话在同一时间访问同一数据的问题不单单是指查询的操作，也可能是修改、删除、新增等业务场景。就像一个门同时只能允许一个人通过，但此时如果两个人都要通过这个门，如果两个人都不谦让的情况在，那么最终的结果就是大家都只能耗着谁都过不去，这个过程称之为“死锁”。如果此时有一个人主动避让这个循环就将被打破，大家也都能高效率的通过门。<br>但当多个用户在同一时刻去操作同一资源，尤其是一个是查询，一个是删除或者更新操作的时候就会出现非幂等性的问题进而产生脏读和幻读问题。MySQL 的查询操作本身就是幂等性的，因为不论查询多少次，在数据不被修改的前提下数据返回的最终结果都是一致的。幻读和脏读问题的本质其实就是数据的并发控制问题和数据的隔离问题。MySQL 在服务器层面通过锁机制来解决数据的并发控制问题，在存储引擎层面通过锁机制和事务的隔离级别和 MVCC 事务版本号机制来解决数据脏读和幻读问题。<br>锁机制的实现跟银行柜台窗口的排队机制是很像的，在银行柜台窗口都有空闲且无人排队时，那么你到哪个窗口办理业务都是可以的，因为不存在柜台窗口的资源竞争性问题。但如果当人多了超过柜台所接待的最大人数，就需要通过取号系统来排队等号。当柜台窗口的用户在办业务时，后面的用户都需要排队等待。当柜台用户办理完业务时，用户所取的号码就会从独占状态释放，柜台用户号码的下一个用户才能到窗口办理业务并独占柜台资源，此时号码会转换为独占状态，下一个编号就进入等待状态，如果下一个编号被连续叫号 3 次没有用户应答，该编号就会被释放，延续到下个编号的用户。那么这个锁其实就是排他锁。只不过银行通过队列 + 锁解决了柜台资源的竞争性问题。<br>MySQL 通过表锁来实现数据竞争性的管理。一个用户在对表进行写操作前，需要先获取写锁，这会阻塞其他用户对该表的所有读写操作，也就是此时用户在释放锁前对该表是独占的。当没有写锁时，其他读锁的用户才能获取读锁，在当前用户获取读锁的同时，其他用户也是可以获取的。<br>行级锁的优点是其锁粒度更小，因为只需要锁定需要的数据航，锁粒度更小意味着影响的数据量会小很多，也会支持更大的并发量，但缺点是维护的成本也会更高，比如：检查锁、获取锁、判断锁的状态、释放锁。但这些都是存储引擎自身去管理和维护的。<br>锁机制在一定程度上确实解决了数据访问的竞争问题，但是在某些特定的场景下锁机制也不是万能的，比如张三从银行账户转账 1000 元给李四，就需要这几个步骤：</p>\n<ol>\n<li>首先张三的账户上有没有 1000 元，如果没有则余额不足没办法转账；</li>\n<li>从张三的账户中扣减 1000 元；</li>\n<li>李四的账户中增加 1000 元；<br>此时只有当三个操作都成功的情况下整个的转账流程才算完成，但如果有一步不满足要求都不能算成功，此时单纯的通过锁机制很难实现这个逻辑，为了解决这个问题就需要事务来完成，只有当整个事务都成功时转账的操作才算完成。事务通过隔离级别的控制以达到隔离访问的目的，这样的好处是通过隔离级别的控制让其他事务能在什么情况下看到数据的更改。比如说当处于“未提交读”的情况下，即使事务没有提交，其他事务也是可以看到的，此时其他事务如果读到没有提交或者撤掉提交前的事务数据，因为读取的是无效数据，这个情况被称之为“脏读”，通过调整隔离级别为“可重复读”就可以解决该问题。还有种情况是事务读取了某个范围的数据记录时，其他事务又在这个范围内插入或修改了记录，之前的事务再次查询这个范围的数据记录时，就会产生幻读的问题，MySQL 通过 MVCC 来解决了幻读的问题，也就是通过创建时间的事务版本号和过期时间的事务版本号来判断的。</li>\n</ol>\n<p>问题四：在“提交读“的事务隔离级别下，因为两次执行同样的查询，可能会得到不一样的结果，为什么？</p>\n<p>问题五：为什么大多数数据库系统的默认级别是“提交读”，而 MySQL 的默认级别是“可重复读”？</p>\n<p>问题六：为什么 MySQL 使用 InnoDB 来作为默认的存储引擎？<br>数据存储的可靠性以及数据的完整性是存储问题的重要难题，InnoDB 引擎支持事务，性能和自动崩溃恢复特性也在众多环境下得到良好的验证。使用 MVCC 来支持高并发，通过间隙锁策略来解决幻读的问题。通过聚簇索引存储数据结构来提高查询的效率和性能。InnoDB 的内部也做了很多的优化来提高插入性能。</p>\n","excerpt":"<p>本章解释了MySQL的架构及其存储引擎的关键设计，也介绍一点MySQL的历史背景、版本演进、开发模式等信息。</p>","more":"<p>问题一：为什么已经有了这么多的数据库，还会有MySQL这个产物出现？<br>MySQL 遵循 GPL 开源协议意味着每个用户可以自由的使用 MySQL 源代码，通过这种方式可以促进开源社区的生态，推动代码持续开放和社区协作，每个用户都可以获取其他人的贡献也可以向其他人提供帮助，以此形成正向循环。开发者也可以向 GPL 项目贡献代码，提高自己的个人影响力其劳动成果受制于 GPL 的约束也不会被商业公司独占。大厂可以通过 GPL 源码来研发适合自己业务的数据库系统，降低研发成本，因为从头开发写一个数据库成本是巨大的，但如果有现成且很不错的轮子再去根据需要去改的话，成本就会降低太多。但需要注意是大厂修改的这部分 MySQL 源码也需要开源，否则可能会带来一些不必要的法律问题。</p>\n<p>问题二：MySQL 的架构思想是什么样的？<br>MySQL 通过分层架构的思想，将查询处理及其他系统任务和数据存取相分离，使得各层的内部组件可以协同工作、各司其职，这样可以显著提高处理效率，也有利于架构的整洁性、可维护性和可扩展性。<br>MySQL 的架构从总体上看分为三个层面：客户端、服务器层、存储引擎。<br>客户端负责面向客户的连接处理、授权认证、安全访问等功能。<br>服务器层是 MySQL 的一个核心服务，包含查询解析器、词法分析器、语法分析器、优化器、查询缓存、执行器、以及 MySQL相关的内置函数、存储过程、触发器、视图等。服务器层主要目的是解决与存储引擎之间的交互。因为 MySQL 支持不同的存储引擎，比如支持事务处理的 InnoDB 引擎，和非事务的 MyISAM 引擎。以及基于内存处理的 Memory 引擎，所以跨存储引擎的功能都在服务器层进行处理。<br>存储引擎负责数据的存储和提取，管理数据以什么方式持久化到硬盘上并且不会丢失的问题，以及如何管理数据的可靠性问题。存储引擎不会去解析 SQL ，也不会去和其他的存储引擎进行通信，只会处理和响应来自服务器层的 API 请求。<br>从查询过程上来看，整个过程应该是这样的：</p>\n<ol>\n<li>当一个客户端与 MySQL 服务器通过 TCP 的三次握手建立连接时，一次会话就开始了，客户端首先需要通过正确的用户名、密码来通过 MySQL 的连接检查和授权认证，以此来证明我是有许可授权的。</li>\n<li>当连接成功并鉴权通过时，用户就获得了会话授权，此时用户就可以发送 SQL 指令来给 MySQL 服务器下达指令我要干什么。</li>\n<li>当 MySQL 服务器层获取用户下达的 SQL 指令时服务层就需要通过内部的机制来去理解指令的意图。那么就需要对 SQL 指令进行解读，通过词法分析来对关键词进行拆解判断指令要做的动作、通过语法分析器来判断指令有没有不能被理解的部分、通过优化器来判断应该怎么执行会更高效，再去查询缓存中以 SQL 指令为key 去判断是否有执行过的记录，如果有就把缓存过的查询结果返回，如果没有就去走执行器跟存储引擎进行 API 交互来获取符合条件的数据并将查询结果缓存到查询缓存中并将查询结果返回给客户端，一次整个的查询过程就结束掉了。</li>\n</ol>\n<p>问题三：MySQL 是如何解决多个会话同时访问同一数据的问题的？<br>多个会话在同一时间访问同一数据的问题不单单是指查询的操作，也可能是修改、删除、新增等业务场景。就像一个门同时只能允许一个人通过，但此时如果两个人都要通过这个门，如果两个人都不谦让的情况在，那么最终的结果就是大家都只能耗着谁都过不去，这个过程称之为“死锁”。如果此时有一个人主动避让这个循环就将被打破，大家也都能高效率的通过门。<br>但当多个用户在同一时刻去操作同一资源，尤其是一个是查询，一个是删除或者更新操作的时候就会出现非幂等性的问题进而产生脏读和幻读问题。MySQL 的查询操作本身就是幂等性的，因为不论查询多少次，在数据不被修改的前提下数据返回的最终结果都是一致的。幻读和脏读问题的本质其实就是数据的并发控制问题和数据的隔离问题。MySQL 在服务器层面通过锁机制来解决数据的并发控制问题，在存储引擎层面通过锁机制和事务的隔离级别和 MVCC 事务版本号机制来解决数据脏读和幻读问题。<br>锁机制的实现跟银行柜台窗口的排队机制是很像的，在银行柜台窗口都有空闲且无人排队时，那么你到哪个窗口办理业务都是可以的，因为不存在柜台窗口的资源竞争性问题。但如果当人多了超过柜台所接待的最大人数，就需要通过取号系统来排队等号。当柜台窗口的用户在办业务时，后面的用户都需要排队等待。当柜台用户办理完业务时，用户所取的号码就会从独占状态释放，柜台用户号码的下一个用户才能到窗口办理业务并独占柜台资源，此时号码会转换为独占状态，下一个编号就进入等待状态，如果下一个编号被连续叫号 3 次没有用户应答，该编号就会被释放，延续到下个编号的用户。那么这个锁其实就是排他锁。只不过银行通过队列 + 锁解决了柜台资源的竞争性问题。<br>MySQL 通过表锁来实现数据竞争性的管理。一个用户在对表进行写操作前，需要先获取写锁，这会阻塞其他用户对该表的所有读写操作，也就是此时用户在释放锁前对该表是独占的。当没有写锁时，其他读锁的用户才能获取读锁，在当前用户获取读锁的同时，其他用户也是可以获取的。<br>行级锁的优点是其锁粒度更小，因为只需要锁定需要的数据航，锁粒度更小意味着影响的数据量会小很多，也会支持更大的并发量，但缺点是维护的成本也会更高，比如：检查锁、获取锁、判断锁的状态、释放锁。但这些都是存储引擎自身去管理和维护的。<br>锁机制在一定程度上确实解决了数据访问的竞争问题，但是在某些特定的场景下锁机制也不是万能的，比如张三从银行账户转账 1000 元给李四，就需要这几个步骤：</p>\n<ol>\n<li>首先张三的账户上有没有 1000 元，如果没有则余额不足没办法转账；</li>\n<li>从张三的账户中扣减 1000 元；</li>\n<li>李四的账户中增加 1000 元；<br>此时只有当三个操作都成功的情况下整个的转账流程才算完成，但如果有一步不满足要求都不能算成功，此时单纯的通过锁机制很难实现这个逻辑，为了解决这个问题就需要事务来完成，只有当整个事务都成功时转账的操作才算完成。事务通过隔离级别的控制以达到隔离访问的目的，这样的好处是通过隔离级别的控制让其他事务能在什么情况下看到数据的更改。比如说当处于“未提交读”的情况下，即使事务没有提交，其他事务也是可以看到的，此时其他事务如果读到没有提交或者撤掉提交前的事务数据，因为读取的是无效数据，这个情况被称之为“脏读”，通过调整隔离级别为“可重复读”就可以解决该问题。还有种情况是事务读取了某个范围的数据记录时，其他事务又在这个范围内插入或修改了记录，之前的事务再次查询这个范围的数据记录时，就会产生幻读的问题，MySQL 通过 MVCC 来解决了幻读的问题，也就是通过创建时间的事务版本号和过期时间的事务版本号来判断的。</li>\n</ol>\n<p>问题四：在“提交读“的事务隔离级别下，因为两次执行同样的查询，可能会得到不一样的结果，为什么？</p>\n<p>问题五：为什么大多数数据库系统的默认级别是“提交读”，而 MySQL 的默认级别是“可重复读”？</p>\n<p>问题六：为什么 MySQL 使用 InnoDB 来作为默认的存储引擎？<br>数据存储的可靠性以及数据的完整性是存储问题的重要难题，InnoDB 引擎支持事务，性能和自动崩溃恢复特性也在众多环境下得到良好的验证。使用 MVCC 来支持高并发，通过间隙锁策略来解决幻读的问题。通过聚簇索引存储数据结构来提高查询的效率和性能。InnoDB 的内部也做了很多的优化来提高插入性能。</p>"},{"title":"【高性能MySQL：第五章节（创建高性能的索引）】学习小节","toc":true,"abbrlink":"c59e41cc","date":"2025-03-27T18:12:43.000Z","_content":"\n本章讨论了索引，索引是数据库的物理设计，对于索引的深入理解和利用是高效使用 MySQL 的基础。\n\n<!--more-->\n\n问题一：什么是索引、索引有哪些好处和缺点？\n* 什么是索引：\n索引是存储引擎为了快速找到记录的一种数据结构。可以简单的把索引理解为书的目录、大楼的楼层平面索引图，可以通过目录快速了解这本书讲的是什么、通过大楼的楼层平面索引图知道这栋大楼里有什么、以及我们如何到达那里。\n* 索引的优点：\n索引最大的好处就是可以快速获取到需要数据记录，因为索引是存储引擎的工作，所以每个存储引擎的索引机制都不同，根据 InnoDB 的 B-Tree 索引的优势，有下面三个优点：\n1. 减少需要扫描的数据量：因为 B-Tree 数据结构的优势，可以通过非叶子节点的 key 来选择合适的节点指针从而快速找到需要的叶子节点的数据指针获取数据，以此来达到减少随机 I/O 读取的次数，同时叶子节点的数据是根据链表的形式顺序存储的，所以对于顺序 I/O 也有较高的性能；\n2. 避免排序和临时表：因为叶子节点的数据是顺序存储的，所以对于 Order By 之类的操作也是可以使用顺序 I/O来提高查询效率，避免重复排序的问题；\n3. 可以将随机读写变为顺序读写：因为通过 key 在非叶子节点来找到叶子节点位置的，这个过程被称为随机读写，但是当找到叶子节点后叶子节点的数据是顺序存储的，所以随机读写会变为顺序读写，以此来提高查询效率；\n* 索引的缺点：\n    * 索引的优点是可以提高数据的快速检索速度，但前提是要遵循索引的使用原则：最左前缀原则、索引顺序、选择合适的索引类型，否则会适得其反，甚至降低查询效率。\n    * 对于数据量很小的表全表扫描可能效率会比走索引效果更好。对于几十万、百万级别的数据量索引的优势才能发挥的出来，对于千万、亿级别的数据量使用分区技术可能会更合适。\n    * 查询中索引的列是一个表达式或者函数的参数，则无法使用索引，例如：where id + 1 =2或者 tochar(col_name)；\n\n问题二：MySQL 中支持哪些索引？这些索引的优缺点和适用场景有那些？\nMySQL 中支持的索引有：B-Tree 索引、Hash 索引、空间数据索引（R-Tree）、全文索引、聚簇索引、覆盖索引。\n* B-Tree 索引\n使用 B-Tree 结构来存储数据。\n特点：只有叶子节点（三级节点）按照链表结构顺序存储所有数据，非节点是叶子节点的数据指针，用于通过层级索引的方式来提高查询效率。非叶子节点是其子节点的数据范围的最大值，数据范围永远是左边比右边小、右边比左边大，且从根节点到叶子节点的层次深度相同。\n优点：叶子节点按顺序存储，叶子节点到根节点的距离相同，查询效率高；\n缺点：当主键键值是数值类型且使用AUTO_INCREMENT来进行自增时是新增、修改、删除效率比较高。但当主键是 UUID 时因为其是随机的，在插入时如果数据页已经满了，需要通过数据页分裂来存储数据，此时会造成较大的性能开销，尤其是当插入主键是随机的大量数据时。\n适应场景：\n1. 全值匹配：全值匹配指的是和索引中的所有列进行匹配；\n2. 匹配最左前缀：匹配以指定 key 开头的记录，也就是是当索引存在多个字段时只匹配第一列；\n3. 匹配列前缀：只匹配列的值开头的部分，比如：like 'd%' 可以，like '%d' 不行；\n4. 匹配范围值：在指定 key 之间的范围数据，要符合最左前缀原则；\n5. 索引查询：覆盖索引场景；\n\n* Hash 索引：Hash 索引基于 Hash 表实现，只有精确匹配的列 Hash 索引才有效。\n新增逻辑：\n1. 对索引列进行 Hash 计算，获取 Hash 码；\n2. 将 Hash 码以 key 的形式保存到索引文件中，value 值是每个数据行的物理位置指针；\n注意：Hash 索引只包含 Hash 值和行指针，而不存储字段值，只有 Hash 码是顺序存储的，数据行不是。\n查询逻辑：\n1. 先对where 查询的字段值进行 Hash 计算，获取 Hash 值；\n2. 使用获取的 Hash 值去索引文件中查询对应的记录指针，当出现 Hash 冲突时，存储引擎必须遍历链表中的所有行指针，逐行比较直到找到所有符合条件的行记录；\n3. 如果找到了指定的行记录指针，比较指针记录是否为指定值，以此来验证是需要查找的记录；\n优点：读取等值比较（=、in）查询效率极高；\n缺点：不支持范围查询和排序，且查询使用的是索引列的全部字段而非指定字段。当数据量大时，存在 Hash 冲突的问题。解决 Hash 冲突的办法就是在 where 查询条件中带入 Hash 值和对应的列值，这样当出现 Hash 冲突时语句的条件不成立，就能避免问题；\n\n* 空间数据索引（R-Tree）\nMyISAM表支持空间索引，可以用作地理数据存储。和B-Tree索引不同，这类索引无须前缀查询。空间索引会从所有维度来索引数据。查询时，可以有效地使用任意维度来组合查询。\n实际开发过程中没有使用过。\n\n* 全文索引\n全文索引是一种特殊类型的索引，它查找的是文本中的关键字，而不是直接比较索引中的值。全文索引更类似于搜索引擎做的事情，而不是简单的 where 条件匹配。\n一般情况下不会使用全文索引，如果有需要全文索引的场景，更多会将查询数据抽取到 ES 这种搜索框架去实现。\n\n* 聚簇索引\n聚餐索引不是一个索引类型，而是一种数据存储方式。当表中有聚簇索引时，它的数据行实际上存放在索引的叶子页上。聚簇索引就是在同一个表结构中保存了B-Tree 的索引和数据，因为 B-Tree 的节点页（非叶子节点）只包含了索引列，叶子页包含了行的全部数据。所以一个表只能有一个聚簇索引。\nInnoDB 通过主键聚集数据，也就是说被索引的数据基本上就是主键列。如果没有定义主键，InnoDB 会选择一个唯一的非空索引代替。如果没有这样的索引，InnoDB 会隐式定义一个主键来作为聚簇索引。\n优点：\n1. 可以把索引和数据保存在一起，这样可以便于覆盖索引的查询；\n2. 数据访问更快。聚簇索引将索引和数据保存在同一个B-Tree中，因此从聚簇索引中获取数据通常比在非聚簇索引中查找要快。\n缺点：如果主键不是顺利的在插入时可能会导致页分裂问题，此时聚簇索引的插入会导致性能问题。\n\n* 覆盖索引\n如果一个索引包含了所有需要查询的字段的值，我们就称之为覆盖索引；\n优点：提高读取效率：因为索引比数据更小，所以如果只需要读取索引，那么 MySQL 就会极大地减少数据访问量。其次索引是按照列值顺序存储的，所以范围查询会比从磁盘中 逐个读取每一行的 I/O次数要少的多。使用聚簇索引时，二级索引在叶子节点中保存了行的主键值，如果二级主键能够覆盖查询，则可以避免对主键索引的二次查询。\n覆盖索引可能失效的情况：\n1. 索引列的数量小于查询列的数量，导致没有索引可以覆盖这个查询，且查询列要符合最左前缀原则；\n2. 如果在索引中执行了前缀以 % 的like 操作，则无法匹配索引；\n\n问题三：怎么知道索引是不是有效的？如何避免索引失效的问题？\n1. 避免冗余和重复的索引（可以使用Percona Toolkit的相关工具），如果需要建立同类型的索引，首先考虑的应该是扩展已有的索引；\n2. 删除没有使用的索引，但对于唯一索引要慎重，因为唯一索引是为了保证数据的完整性；\n3. 可以通过 alter table 重建表来重建相关索引，只需要将表的存储引擎修改为当前的引擎即可；\n\n问题：\n* 什么是临时表，为什么需要临时表，为什么索引和临时表有关？\n* 对于大型系统，元数据信息表的技巧是如何使用的？\n* 唯一索引是不是 B-Tree 索引？它是如何实现的？\n* B-Tree 的叶子节点已经有了所有的行记录，为什么还需要聚簇索引？\n","source":"_posts/【高性能MySQL：第五章节（创建高性能的索引）】学习小节.md","raw":"---\ntitle: 【高性能MySQL：第五章节（创建高性能的索引）】学习小节\ntoc: true\ntags:\n  - MySQL\nabbrlink: c59e41cc\ndate: 2025-03-27 18:12:43\n---\n\n本章讨论了索引，索引是数据库的物理设计，对于索引的深入理解和利用是高效使用 MySQL 的基础。\n\n<!--more-->\n\n问题一：什么是索引、索引有哪些好处和缺点？\n* 什么是索引：\n索引是存储引擎为了快速找到记录的一种数据结构。可以简单的把索引理解为书的目录、大楼的楼层平面索引图，可以通过目录快速了解这本书讲的是什么、通过大楼的楼层平面索引图知道这栋大楼里有什么、以及我们如何到达那里。\n* 索引的优点：\n索引最大的好处就是可以快速获取到需要数据记录，因为索引是存储引擎的工作，所以每个存储引擎的索引机制都不同，根据 InnoDB 的 B-Tree 索引的优势，有下面三个优点：\n1. 减少需要扫描的数据量：因为 B-Tree 数据结构的优势，可以通过非叶子节点的 key 来选择合适的节点指针从而快速找到需要的叶子节点的数据指针获取数据，以此来达到减少随机 I/O 读取的次数，同时叶子节点的数据是根据链表的形式顺序存储的，所以对于顺序 I/O 也有较高的性能；\n2. 避免排序和临时表：因为叶子节点的数据是顺序存储的，所以对于 Order By 之类的操作也是可以使用顺序 I/O来提高查询效率，避免重复排序的问题；\n3. 可以将随机读写变为顺序读写：因为通过 key 在非叶子节点来找到叶子节点位置的，这个过程被称为随机读写，但是当找到叶子节点后叶子节点的数据是顺序存储的，所以随机读写会变为顺序读写，以此来提高查询效率；\n* 索引的缺点：\n    * 索引的优点是可以提高数据的快速检索速度，但前提是要遵循索引的使用原则：最左前缀原则、索引顺序、选择合适的索引类型，否则会适得其反，甚至降低查询效率。\n    * 对于数据量很小的表全表扫描可能效率会比走索引效果更好。对于几十万、百万级别的数据量索引的优势才能发挥的出来，对于千万、亿级别的数据量使用分区技术可能会更合适。\n    * 查询中索引的列是一个表达式或者函数的参数，则无法使用索引，例如：where id + 1 =2或者 tochar(col_name)；\n\n问题二：MySQL 中支持哪些索引？这些索引的优缺点和适用场景有那些？\nMySQL 中支持的索引有：B-Tree 索引、Hash 索引、空间数据索引（R-Tree）、全文索引、聚簇索引、覆盖索引。\n* B-Tree 索引\n使用 B-Tree 结构来存储数据。\n特点：只有叶子节点（三级节点）按照链表结构顺序存储所有数据，非节点是叶子节点的数据指针，用于通过层级索引的方式来提高查询效率。非叶子节点是其子节点的数据范围的最大值，数据范围永远是左边比右边小、右边比左边大，且从根节点到叶子节点的层次深度相同。\n优点：叶子节点按顺序存储，叶子节点到根节点的距离相同，查询效率高；\n缺点：当主键键值是数值类型且使用AUTO_INCREMENT来进行自增时是新增、修改、删除效率比较高。但当主键是 UUID 时因为其是随机的，在插入时如果数据页已经满了，需要通过数据页分裂来存储数据，此时会造成较大的性能开销，尤其是当插入主键是随机的大量数据时。\n适应场景：\n1. 全值匹配：全值匹配指的是和索引中的所有列进行匹配；\n2. 匹配最左前缀：匹配以指定 key 开头的记录，也就是是当索引存在多个字段时只匹配第一列；\n3. 匹配列前缀：只匹配列的值开头的部分，比如：like 'd%' 可以，like '%d' 不行；\n4. 匹配范围值：在指定 key 之间的范围数据，要符合最左前缀原则；\n5. 索引查询：覆盖索引场景；\n\n* Hash 索引：Hash 索引基于 Hash 表实现，只有精确匹配的列 Hash 索引才有效。\n新增逻辑：\n1. 对索引列进行 Hash 计算，获取 Hash 码；\n2. 将 Hash 码以 key 的形式保存到索引文件中，value 值是每个数据行的物理位置指针；\n注意：Hash 索引只包含 Hash 值和行指针，而不存储字段值，只有 Hash 码是顺序存储的，数据行不是。\n查询逻辑：\n1. 先对where 查询的字段值进行 Hash 计算，获取 Hash 值；\n2. 使用获取的 Hash 值去索引文件中查询对应的记录指针，当出现 Hash 冲突时，存储引擎必须遍历链表中的所有行指针，逐行比较直到找到所有符合条件的行记录；\n3. 如果找到了指定的行记录指针，比较指针记录是否为指定值，以此来验证是需要查找的记录；\n优点：读取等值比较（=、in）查询效率极高；\n缺点：不支持范围查询和排序，且查询使用的是索引列的全部字段而非指定字段。当数据量大时，存在 Hash 冲突的问题。解决 Hash 冲突的办法就是在 where 查询条件中带入 Hash 值和对应的列值，这样当出现 Hash 冲突时语句的条件不成立，就能避免问题；\n\n* 空间数据索引（R-Tree）\nMyISAM表支持空间索引，可以用作地理数据存储。和B-Tree索引不同，这类索引无须前缀查询。空间索引会从所有维度来索引数据。查询时，可以有效地使用任意维度来组合查询。\n实际开发过程中没有使用过。\n\n* 全文索引\n全文索引是一种特殊类型的索引，它查找的是文本中的关键字，而不是直接比较索引中的值。全文索引更类似于搜索引擎做的事情，而不是简单的 where 条件匹配。\n一般情况下不会使用全文索引，如果有需要全文索引的场景，更多会将查询数据抽取到 ES 这种搜索框架去实现。\n\n* 聚簇索引\n聚餐索引不是一个索引类型，而是一种数据存储方式。当表中有聚簇索引时，它的数据行实际上存放在索引的叶子页上。聚簇索引就是在同一个表结构中保存了B-Tree 的索引和数据，因为 B-Tree 的节点页（非叶子节点）只包含了索引列，叶子页包含了行的全部数据。所以一个表只能有一个聚簇索引。\nInnoDB 通过主键聚集数据，也就是说被索引的数据基本上就是主键列。如果没有定义主键，InnoDB 会选择一个唯一的非空索引代替。如果没有这样的索引，InnoDB 会隐式定义一个主键来作为聚簇索引。\n优点：\n1. 可以把索引和数据保存在一起，这样可以便于覆盖索引的查询；\n2. 数据访问更快。聚簇索引将索引和数据保存在同一个B-Tree中，因此从聚簇索引中获取数据通常比在非聚簇索引中查找要快。\n缺点：如果主键不是顺利的在插入时可能会导致页分裂问题，此时聚簇索引的插入会导致性能问题。\n\n* 覆盖索引\n如果一个索引包含了所有需要查询的字段的值，我们就称之为覆盖索引；\n优点：提高读取效率：因为索引比数据更小，所以如果只需要读取索引，那么 MySQL 就会极大地减少数据访问量。其次索引是按照列值顺序存储的，所以范围查询会比从磁盘中 逐个读取每一行的 I/O次数要少的多。使用聚簇索引时，二级索引在叶子节点中保存了行的主键值，如果二级主键能够覆盖查询，则可以避免对主键索引的二次查询。\n覆盖索引可能失效的情况：\n1. 索引列的数量小于查询列的数量，导致没有索引可以覆盖这个查询，且查询列要符合最左前缀原则；\n2. 如果在索引中执行了前缀以 % 的like 操作，则无法匹配索引；\n\n问题三：怎么知道索引是不是有效的？如何避免索引失效的问题？\n1. 避免冗余和重复的索引（可以使用Percona Toolkit的相关工具），如果需要建立同类型的索引，首先考虑的应该是扩展已有的索引；\n2. 删除没有使用的索引，但对于唯一索引要慎重，因为唯一索引是为了保证数据的完整性；\n3. 可以通过 alter table 重建表来重建相关索引，只需要将表的存储引擎修改为当前的引擎即可；\n\n问题：\n* 什么是临时表，为什么需要临时表，为什么索引和临时表有关？\n* 对于大型系统，元数据信息表的技巧是如何使用的？\n* 唯一索引是不是 B-Tree 索引？它是如何实现的？\n* B-Tree 的叶子节点已经有了所有的行记录，为什么还需要聚簇索引？\n","slug":"【高性能MySQL：第五章节（创建高性能的索引）】学习小节","published":1,"updated":"2025-03-28T05:44:31.114Z","comments":1,"layout":"post","photos":[],"_id":"cm8se3tdq0015bb8lesl54d9u","content":"<p>本章讨论了索引，索引是数据库的物理设计，对于索引的深入理解和利用是高效使用 MySQL 的基础。</p>\n<span id=\"more\"></span>\n\n<p>问题一：什么是索引、索引有哪些好处和缺点？</p>\n<ul>\n<li>什么是索引：<br>索引是存储引擎为了快速找到记录的一种数据结构。可以简单的把索引理解为书的目录、大楼的楼层平面索引图，可以通过目录快速了解这本书讲的是什么、通过大楼的楼层平面索引图知道这栋大楼里有什么、以及我们如何到达那里。</li>\n<li>索引的优点：<br>索引最大的好处就是可以快速获取到需要数据记录，因为索引是存储引擎的工作，所以每个存储引擎的索引机制都不同，根据 InnoDB 的 B-Tree 索引的优势，有下面三个优点：</li>\n</ul>\n<ol>\n<li>减少需要扫描的数据量：因为 B-Tree 数据结构的优势，可以通过非叶子节点的 key 来选择合适的节点指针从而快速找到需要的叶子节点的数据指针获取数据，以此来达到减少随机 I&#x2F;O 读取的次数，同时叶子节点的数据是根据链表的形式顺序存储的，所以对于顺序 I&#x2F;O 也有较高的性能；</li>\n<li>避免排序和临时表：因为叶子节点的数据是顺序存储的，所以对于 Order By 之类的操作也是可以使用顺序 I&#x2F;O来提高查询效率，避免重复排序的问题；</li>\n<li>可以将随机读写变为顺序读写：因为通过 key 在非叶子节点来找到叶子节点位置的，这个过程被称为随机读写，但是当找到叶子节点后叶子节点的数据是顺序存储的，所以随机读写会变为顺序读写，以此来提高查询效率；</li>\n</ol>\n<ul>\n<li>索引的缺点：<ul>\n<li>索引的优点是可以提高数据的快速检索速度，但前提是要遵循索引的使用原则：最左前缀原则、索引顺序、选择合适的索引类型，否则会适得其反，甚至降低查询效率。</li>\n<li>对于数据量很小的表全表扫描可能效率会比走索引效果更好。对于几十万、百万级别的数据量索引的优势才能发挥的出来，对于千万、亿级别的数据量使用分区技术可能会更合适。</li>\n<li>查询中索引的列是一个表达式或者函数的参数，则无法使用索引，例如：where id + 1 &#x3D;2或者 tochar(col_name)；</li>\n</ul>\n</li>\n</ul>\n<p>问题二：MySQL 中支持哪些索引？这些索引的优缺点和适用场景有那些？<br>MySQL 中支持的索引有：B-Tree 索引、Hash 索引、空间数据索引（R-Tree）、全文索引、聚簇索引、覆盖索引。</p>\n<ul>\n<li>B-Tree 索引<br>使用 B-Tree 结构来存储数据。<br>特点：只有叶子节点（三级节点）按照链表结构顺序存储所有数据，非节点是叶子节点的数据指针，用于通过层级索引的方式来提高查询效率。非叶子节点是其子节点的数据范围的最大值，数据范围永远是左边比右边小、右边比左边大，且从根节点到叶子节点的层次深度相同。<br>优点：叶子节点按顺序存储，叶子节点到根节点的距离相同，查询效率高；<br>缺点：当主键键值是数值类型且使用AUTO_INCREMENT来进行自增时是新增、修改、删除效率比较高。但当主键是 UUID 时因为其是随机的，在插入时如果数据页已经满了，需要通过数据页分裂来存储数据，此时会造成较大的性能开销，尤其是当插入主键是随机的大量数据时。<br>适应场景：</li>\n</ul>\n<ol>\n<li>全值匹配：全值匹配指的是和索引中的所有列进行匹配；</li>\n<li>匹配最左前缀：匹配以指定 key 开头的记录，也就是是当索引存在多个字段时只匹配第一列；</li>\n<li>匹配列前缀：只匹配列的值开头的部分，比如：like ‘d%’ 可以，like ‘%d’ 不行；</li>\n<li>匹配范围值：在指定 key 之间的范围数据，要符合最左前缀原则；</li>\n<li>索引查询：覆盖索引场景；</li>\n</ol>\n<ul>\n<li>Hash 索引：Hash 索引基于 Hash 表实现，只有精确匹配的列 Hash 索引才有效。<br>新增逻辑：</li>\n</ul>\n<ol>\n<li>对索引列进行 Hash 计算，获取 Hash 码；</li>\n<li>将 Hash 码以 key 的形式保存到索引文件中，value 值是每个数据行的物理位置指针；<br>注意：Hash 索引只包含 Hash 值和行指针，而不存储字段值，只有 Hash 码是顺序存储的，数据行不是。<br>查询逻辑：</li>\n<li>先对where 查询的字段值进行 Hash 计算，获取 Hash 值；</li>\n<li>使用获取的 Hash 值去索引文件中查询对应的记录指针，当出现 Hash 冲突时，存储引擎必须遍历链表中的所有行指针，逐行比较直到找到所有符合条件的行记录；</li>\n<li>如果找到了指定的行记录指针，比较指针记录是否为指定值，以此来验证是需要查找的记录；<br>优点：读取等值比较（&#x3D;、in）查询效率极高；<br>缺点：不支持范围查询和排序，且查询使用的是索引列的全部字段而非指定字段。当数据量大时，存在 Hash 冲突的问题。解决 Hash 冲突的办法就是在 where 查询条件中带入 Hash 值和对应的列值，这样当出现 Hash 冲突时语句的条件不成立，就能避免问题；</li>\n</ol>\n<ul>\n<li><p>空间数据索引（R-Tree）<br>MyISAM表支持空间索引，可以用作地理数据存储。和B-Tree索引不同，这类索引无须前缀查询。空间索引会从所有维度来索引数据。查询时，可以有效地使用任意维度来组合查询。<br>实际开发过程中没有使用过。</p>\n</li>\n<li><p>全文索引<br>全文索引是一种特殊类型的索引，它查找的是文本中的关键字，而不是直接比较索引中的值。全文索引更类似于搜索引擎做的事情，而不是简单的 where 条件匹配。<br>一般情况下不会使用全文索引，如果有需要全文索引的场景，更多会将查询数据抽取到 ES 这种搜索框架去实现。</p>\n</li>\n<li><p>聚簇索引<br>聚餐索引不是一个索引类型，而是一种数据存储方式。当表中有聚簇索引时，它的数据行实际上存放在索引的叶子页上。聚簇索引就是在同一个表结构中保存了B-Tree 的索引和数据，因为 B-Tree 的节点页（非叶子节点）只包含了索引列，叶子页包含了行的全部数据。所以一个表只能有一个聚簇索引。<br>InnoDB 通过主键聚集数据，也就是说被索引的数据基本上就是主键列。如果没有定义主键，InnoDB 会选择一个唯一的非空索引代替。如果没有这样的索引，InnoDB 会隐式定义一个主键来作为聚簇索引。<br>优点：</p>\n</li>\n</ul>\n<ol>\n<li>可以把索引和数据保存在一起，这样可以便于覆盖索引的查询；</li>\n<li>数据访问更快。聚簇索引将索引和数据保存在同一个B-Tree中，因此从聚簇索引中获取数据通常比在非聚簇索引中查找要快。<br>缺点：如果主键不是顺利的在插入时可能会导致页分裂问题，此时聚簇索引的插入会导致性能问题。</li>\n</ol>\n<ul>\n<li>覆盖索引<br>如果一个索引包含了所有需要查询的字段的值，我们就称之为覆盖索引；<br>优点：提高读取效率：因为索引比数据更小，所以如果只需要读取索引，那么 MySQL 就会极大地减少数据访问量。其次索引是按照列值顺序存储的，所以范围查询会比从磁盘中 逐个读取每一行的 I&#x2F;O次数要少的多。使用聚簇索引时，二级索引在叶子节点中保存了行的主键值，如果二级主键能够覆盖查询，则可以避免对主键索引的二次查询。<br>覆盖索引可能失效的情况：</li>\n</ul>\n<ol>\n<li>索引列的数量小于查询列的数量，导致没有索引可以覆盖这个查询，且查询列要符合最左前缀原则；</li>\n<li>如果在索引中执行了前缀以 % 的like 操作，则无法匹配索引；</li>\n</ol>\n<p>问题三：怎么知道索引是不是有效的？如何避免索引失效的问题？</p>\n<ol>\n<li>避免冗余和重复的索引（可以使用Percona Toolkit的相关工具），如果需要建立同类型的索引，首先考虑的应该是扩展已有的索引；</li>\n<li>删除没有使用的索引，但对于唯一索引要慎重，因为唯一索引是为了保证数据的完整性；</li>\n<li>可以通过 alter table 重建表来重建相关索引，只需要将表的存储引擎修改为当前的引擎即可；</li>\n</ol>\n<p>问题：</p>\n<ul>\n<li>什么是临时表，为什么需要临时表，为什么索引和临时表有关？</li>\n<li>对于大型系统，元数据信息表的技巧是如何使用的？</li>\n<li>唯一索引是不是 B-Tree 索引？它是如何实现的？</li>\n<li>B-Tree 的叶子节点已经有了所有的行记录，为什么还需要聚簇索引？</li>\n</ul>\n","excerpt":"<p>本章讨论了索引，索引是数据库的物理设计，对于索引的深入理解和利用是高效使用 MySQL 的基础。</p>","more":"<p>问题一：什么是索引、索引有哪些好处和缺点？</p>\n<ul>\n<li>什么是索引：<br>索引是存储引擎为了快速找到记录的一种数据结构。可以简单的把索引理解为书的目录、大楼的楼层平面索引图，可以通过目录快速了解这本书讲的是什么、通过大楼的楼层平面索引图知道这栋大楼里有什么、以及我们如何到达那里。</li>\n<li>索引的优点：<br>索引最大的好处就是可以快速获取到需要数据记录，因为索引是存储引擎的工作，所以每个存储引擎的索引机制都不同，根据 InnoDB 的 B-Tree 索引的优势，有下面三个优点：</li>\n</ul>\n<ol>\n<li>减少需要扫描的数据量：因为 B-Tree 数据结构的优势，可以通过非叶子节点的 key 来选择合适的节点指针从而快速找到需要的叶子节点的数据指针获取数据，以此来达到减少随机 I&#x2F;O 读取的次数，同时叶子节点的数据是根据链表的形式顺序存储的，所以对于顺序 I&#x2F;O 也有较高的性能；</li>\n<li>避免排序和临时表：因为叶子节点的数据是顺序存储的，所以对于 Order By 之类的操作也是可以使用顺序 I&#x2F;O来提高查询效率，避免重复排序的问题；</li>\n<li>可以将随机读写变为顺序读写：因为通过 key 在非叶子节点来找到叶子节点位置的，这个过程被称为随机读写，但是当找到叶子节点后叶子节点的数据是顺序存储的，所以随机读写会变为顺序读写，以此来提高查询效率；</li>\n</ol>\n<ul>\n<li>索引的缺点：<ul>\n<li>索引的优点是可以提高数据的快速检索速度，但前提是要遵循索引的使用原则：最左前缀原则、索引顺序、选择合适的索引类型，否则会适得其反，甚至降低查询效率。</li>\n<li>对于数据量很小的表全表扫描可能效率会比走索引效果更好。对于几十万、百万级别的数据量索引的优势才能发挥的出来，对于千万、亿级别的数据量使用分区技术可能会更合适。</li>\n<li>查询中索引的列是一个表达式或者函数的参数，则无法使用索引，例如：where id + 1 &#x3D;2或者 tochar(col_name)；</li>\n</ul>\n</li>\n</ul>\n<p>问题二：MySQL 中支持哪些索引？这些索引的优缺点和适用场景有那些？<br>MySQL 中支持的索引有：B-Tree 索引、Hash 索引、空间数据索引（R-Tree）、全文索引、聚簇索引、覆盖索引。</p>\n<ul>\n<li>B-Tree 索引<br>使用 B-Tree 结构来存储数据。<br>特点：只有叶子节点（三级节点）按照链表结构顺序存储所有数据，非节点是叶子节点的数据指针，用于通过层级索引的方式来提高查询效率。非叶子节点是其子节点的数据范围的最大值，数据范围永远是左边比右边小、右边比左边大，且从根节点到叶子节点的层次深度相同。<br>优点：叶子节点按顺序存储，叶子节点到根节点的距离相同，查询效率高；<br>缺点：当主键键值是数值类型且使用AUTO_INCREMENT来进行自增时是新增、修改、删除效率比较高。但当主键是 UUID 时因为其是随机的，在插入时如果数据页已经满了，需要通过数据页分裂来存储数据，此时会造成较大的性能开销，尤其是当插入主键是随机的大量数据时。<br>适应场景：</li>\n</ul>\n<ol>\n<li>全值匹配：全值匹配指的是和索引中的所有列进行匹配；</li>\n<li>匹配最左前缀：匹配以指定 key 开头的记录，也就是是当索引存在多个字段时只匹配第一列；</li>\n<li>匹配列前缀：只匹配列的值开头的部分，比如：like ‘d%’ 可以，like ‘%d’ 不行；</li>\n<li>匹配范围值：在指定 key 之间的范围数据，要符合最左前缀原则；</li>\n<li>索引查询：覆盖索引场景；</li>\n</ol>\n<ul>\n<li>Hash 索引：Hash 索引基于 Hash 表实现，只有精确匹配的列 Hash 索引才有效。<br>新增逻辑：</li>\n</ul>\n<ol>\n<li>对索引列进行 Hash 计算，获取 Hash 码；</li>\n<li>将 Hash 码以 key 的形式保存到索引文件中，value 值是每个数据行的物理位置指针；<br>注意：Hash 索引只包含 Hash 值和行指针，而不存储字段值，只有 Hash 码是顺序存储的，数据行不是。<br>查询逻辑：</li>\n<li>先对where 查询的字段值进行 Hash 计算，获取 Hash 值；</li>\n<li>使用获取的 Hash 值去索引文件中查询对应的记录指针，当出现 Hash 冲突时，存储引擎必须遍历链表中的所有行指针，逐行比较直到找到所有符合条件的行记录；</li>\n<li>如果找到了指定的行记录指针，比较指针记录是否为指定值，以此来验证是需要查找的记录；<br>优点：读取等值比较（&#x3D;、in）查询效率极高；<br>缺点：不支持范围查询和排序，且查询使用的是索引列的全部字段而非指定字段。当数据量大时，存在 Hash 冲突的问题。解决 Hash 冲突的办法就是在 where 查询条件中带入 Hash 值和对应的列值，这样当出现 Hash 冲突时语句的条件不成立，就能避免问题；</li>\n</ol>\n<ul>\n<li><p>空间数据索引（R-Tree）<br>MyISAM表支持空间索引，可以用作地理数据存储。和B-Tree索引不同，这类索引无须前缀查询。空间索引会从所有维度来索引数据。查询时，可以有效地使用任意维度来组合查询。<br>实际开发过程中没有使用过。</p>\n</li>\n<li><p>全文索引<br>全文索引是一种特殊类型的索引，它查找的是文本中的关键字，而不是直接比较索引中的值。全文索引更类似于搜索引擎做的事情，而不是简单的 where 条件匹配。<br>一般情况下不会使用全文索引，如果有需要全文索引的场景，更多会将查询数据抽取到 ES 这种搜索框架去实现。</p>\n</li>\n<li><p>聚簇索引<br>聚餐索引不是一个索引类型，而是一种数据存储方式。当表中有聚簇索引时，它的数据行实际上存放在索引的叶子页上。聚簇索引就是在同一个表结构中保存了B-Tree 的索引和数据，因为 B-Tree 的节点页（非叶子节点）只包含了索引列，叶子页包含了行的全部数据。所以一个表只能有一个聚簇索引。<br>InnoDB 通过主键聚集数据，也就是说被索引的数据基本上就是主键列。如果没有定义主键，InnoDB 会选择一个唯一的非空索引代替。如果没有这样的索引，InnoDB 会隐式定义一个主键来作为聚簇索引。<br>优点：</p>\n</li>\n</ul>\n<ol>\n<li>可以把索引和数据保存在一起，这样可以便于覆盖索引的查询；</li>\n<li>数据访问更快。聚簇索引将索引和数据保存在同一个B-Tree中，因此从聚簇索引中获取数据通常比在非聚簇索引中查找要快。<br>缺点：如果主键不是顺利的在插入时可能会导致页分裂问题，此时聚簇索引的插入会导致性能问题。</li>\n</ol>\n<ul>\n<li>覆盖索引<br>如果一个索引包含了所有需要查询的字段的值，我们就称之为覆盖索引；<br>优点：提高读取效率：因为索引比数据更小，所以如果只需要读取索引，那么 MySQL 就会极大地减少数据访问量。其次索引是按照列值顺序存储的，所以范围查询会比从磁盘中 逐个读取每一行的 I&#x2F;O次数要少的多。使用聚簇索引时，二级索引在叶子节点中保存了行的主键值，如果二级主键能够覆盖查询，则可以避免对主键索引的二次查询。<br>覆盖索引可能失效的情况：</li>\n</ul>\n<ol>\n<li>索引列的数量小于查询列的数量，导致没有索引可以覆盖这个查询，且查询列要符合最左前缀原则；</li>\n<li>如果在索引中执行了前缀以 % 的like 操作，则无法匹配索引；</li>\n</ol>\n<p>问题三：怎么知道索引是不是有效的？如何避免索引失效的问题？</p>\n<ol>\n<li>避免冗余和重复的索引（可以使用Percona Toolkit的相关工具），如果需要建立同类型的索引，首先考虑的应该是扩展已有的索引；</li>\n<li>删除没有使用的索引，但对于唯一索引要慎重，因为唯一索引是为了保证数据的完整性；</li>\n<li>可以通过 alter table 重建表来重建相关索引，只需要将表的存储引擎修改为当前的引擎即可；</li>\n</ol>\n<p>问题：</p>\n<ul>\n<li>什么是临时表，为什么需要临时表，为什么索引和临时表有关？</li>\n<li>对于大型系统，元数据信息表的技巧是如何使用的？</li>\n<li>唯一索引是不是 B-Tree 索引？它是如何实现的？</li>\n<li>B-Tree 的叶子节点已经有了所有的行记录，为什么还需要聚簇索引？</li>\n</ul>"},{"title":"【高性能MySQL：第四章节（Schema与数据类型优化）】学习小节","toc":true,"abbrlink":"bd7a5f4c","date":"2025-03-27T18:10:41.000Z","_content":"\n<meta name=\"referrer\" content=\"no-referrer\" />\n\n本章介绍了不同数据类型的细节差别以及表设计的原则。\n\n<!-- more -->\n\n问题一：如何选择合适的数据类型来存储数据？\n在《高性能 MySQL 》中对于如何选择合适的类型提供了以下的几种建议，并做了一些解释。\n* 更小的通常更好。更小意味在存储空间上占用更少的存储，读取到内存中时占用更少的资源。比如要存储性别字段时，因为大陆由于国情问题，不承认双性人的存在，所以只可能会有男、女两种性别，这种情况可以用 char 来存，也可以用 tinyint 来存，还可以用 varchar 来存。但此时用 char 在可读性上可能是最合适的选择，但是用 tinyint 通过不同的数字来代表男、女也是一种不错的选择，尤其是需要存储用数字代表一些特定的状态标记的时候这是一种很常见的方案。但是在选择更小的同时要考虑数据的边界情况，因为当后期需要调整数据存储的类型时当表中的数据非常庞大时这是一个费时费力且不讨好的活。\n* 简单就好。简单的数据类型在操作上通过更简单，比如整数比字符串的操作代价要低很多，因为字符串受到语言的影响会存在字符集和排序规则的问题使操作字符串比操作数字更复杂。\n* 尽可能避免使用 NULL。在数据建表的过程中数据项为 NULL 可能是一个很常见的操作，因为在很多业务情况下很多字段的内容都不是必须要填写的，意味数据内容可以为空。在 MySQL 中 NULL也是列的默认属性。但一般最好不要为 NULL 值，因为记录为 NULL 时不论是索引还是通过函数进行统计都会比较复杂，有时候还需要额外对 NULL 的进行一些特殊的处理。如果 NULL 的项不作为索引或者统计字段，那么对于性能的影响可能比较小，其次记录为 NULL 时可能会使用更多的存储空间，可以使用空字符串的填充来代替 NULL。\n\n问题二：MySQL 中支持哪些数据类型？应用场景和优缺点是什么？\n在 MySQL 中支持的数据类型有：整数（int）、小数（decimal）、字符串（char、varchar）、大文本、枚举、日期类型、位数据类型、标识符这几种。\n* 整数\n对于整数 （int）可分为 8 位（tinyint）、16 位（smallint）、24 位（mediumint）、32 位（int）和 64 位存储空间（bigint），位数越小存储的范围越小，反之亦然。UNSIGNED 属性表示不允许存在负值，比如 tinyint unsigned 可以存储的范围是 0～255，而tinyint的存储范围是 -128 ~ 127。\n\n* 小数\n小数（decimal）与整数（int）不同的是，在 MySQL5.0 及以上的新版本中对小数支持精确计算，意味着不会四舍五入或者发生截断导致精度丢失问题。这对于财务或者金融领域中是个很大问题。\ndecimal 只是一种存储格式，在计算中decimal 会转换为 double 类型进行计算。float、double 和 decimal 都可以存储小数和指定精度，不同的是 decimal 的列可以指定小数点前后所允许的最大位数，比如 decimal(18,9) 小数点两边将各存储 9 个数字，一共使用 9 个字节，小数点前的数字用 4 个字节，小数点后的数字用 4 个字节，小数点本身占用 1 个字节，但这会占用更多的磁盘空间。在空间存储上 float 占用 4 个字节存储，double 占用 8 个字节。\n对于在客户端中比如 navicat 或者 MySQL 客户端在建表的时候可以使用 int(10) 来指定存储的位数其实是个误解，int(10)只是用来显示字符的个数，对于存储空间的使用来说 int(1) 和 int(10) 是等价的。\n\n* 字符串\nMySQL 字符串类型中最常用的有两种：char 和 varchar 都可以用来存储字符串。其存储方式由存储引擎决定。优缺点：\n优点：char 用于存储固定长度的字符串，对于长度固定的内容 char 有空间效率的优势，适合存储经常变更的数据且不容易产生碎片，比如身份证号。varchar 可用于存储可变长字符串，varchar 比 char 更节省存储空间，但如果通过使用参数 row_format=fixed 固定行的长度的话，这个优势就不存在了。\n缺点：varchar 在使用 update 做更新操作时，如果更新的内容长度比原来更长，如果行的占用空间增长，页内没有空间可以存储的情况下，InnoDB引擎需要通过分裂页来将内容放进页内，就像原来一行的东西是写在一页上的，但是内容增加了，就需要通过额外的页来记录新的内容。使用 char 类型来存储字符串的情况下，如果内容末尾有空格，char 会自动删除所有的末尾空格内容。\n问题：varchar(5) 和 varchar(50)存储“hello”的所需要的存储空间都是一样的，那是不是意味varchar(5) 和 varchar(50) 没有区别？\nvarchar(5) 和 varchar(50) 虽然在实际的存储空间上没有区别，但varchar(50)会消耗更多的内存空间，因为需要分配固定大小的内存区域来保存内部值，也就是说一个是在写入到硬盘上的所消耗的存储空间，一个是读取到内存中所需要的内存空间。同时也不利于临时表的排序处理。\n\n* 大文本\n大文本类型的数据存储类型有两个：blob 和 text，二者都是字符串的数据类型，前者使用二进制存储，而后者采用字符方式存储。\ntext 的数据类型有：tinytext、smalltext、text、mediumtext、longtext，存储的字符，有字符集和排序规则；\nblob 的数据类型有：tinyblob、smallblob、blob、mediumblob、longblob，存储的是二进制，所以没有字符集和排序规则；\n需要注意的问题：\n1. 当存储的值太大时，InnoDB 会使用特定的存储区域来存储内容，通过在行内存储 1～4 个字节的文件地址，来指向实际的物理存储位置。\n2. 排序时通过从头开始的 max_sort_length 参数长度做排序处理，而不是使用整个字符串做排序。如果需要指定长度有两种方式：修改 max_sort_length 的参数配置 或使用 order by substring(字段名,截取长度) 来实现。需要注意的是如果通过截取字符串的方式来排序要确保截取的字符串足够短，不要超过 max_heap_table_size 或 tmp_table_size，否则 MySQL 会将内存临时表转换为 MyISAM 磁盘临时表。通过 explain 执行计划的 extra 列是否包含“Using temporary” 来判断执行计划使用了隐式临时表。\n3. blob 和 text 列不能进行索引，也不能使用索引来解决排序问题。\n4. 尽可能避免使用 blob 和 text 类型，在早期的系统中，会使用 blob 来直接存储图片或者文件的二进制内容，但会随着数据的增多导致 schema 的数据文件越来越大，读取性能下降，后来通过存储文件路径的方式改进了此类问题。在部分小说类的系统依然会使用 text 来存储大文本内容，因为你无法确定内容到底有多长。\n\n* 枚举\n在开发过程中并没有使用过，因为字符串列表是固定的，添加或删除字符串必须使用 alter table 会导致表的重建，而且只能在列表末尾添加元素。\n* 日期类型\nMySQL 存储日期类型支持的有 datetime 和 timestrap。\ndatetime 存储的是一个日期格式（YYYYMMDDHHMMSS）的文本，精度为秒，时间范围从 1001 年 到 9999 年，显示采用 ANSI 标准，使用 8 个字节的存储空间（新版本使用 5 个字节）。一般也建议使用 datetime 来存储日期。\ntimestrap 类型保存了从 1970 年 1 月 1 日 到 2038 年的秒数，使用了 4 个字节的存储空间。可以通过时区自动更新时间戳，显示也依赖于时区的配置，timestrap 的默认为 NOT NULL。\n在某些对时间要求极高的业务系统，会使用 bigint 来存储 Unix 时间戳。\n\n* 位数据类型\n没用过，如果要存储状态信息会优先考虑 tinyint，因为查询时返回的是二进制字符串。在书中也不推荐使用。\n\n* 标识符（identifier ）\nidentifier：一般在实际的开发中用于区分特定字段的数据项在整张表中或者整个 schema 中是唯一的，用于和其他的 table 做数据关联使用。对于使用了 identifier 的字段可以使用 AUTO_INCREMENT 来自动增长，但在实际的业务中用到的场景不多，一般会使用雪花ID 或者 UUID 来做标识符的。\n\n问题三：什么是范式和反范式，有哪些优缺点？\n范式用于优化数据结构、避免存储相同的数据以节省存储空间，在修改数据的时候不用同时修改所处，也就说它是一种设计策略。\n但是避免存储相同的数据就意味着要把数据拆开，各管各的数据，对于存在关联的数据通过标识符进行关联，此时如果业务系统比较复杂或者表结构庞大，比如一个中大型业务系统几百张表是很常见的事情。此时为了获取指定的数据结构就需要通过 join 去联表获取相应的数据，当 join 过多时就会产生性能问题（比如去 join 十几张表）。\n为了解决这个问题，就需要在一些表上根据业务需求去做一些冗余字段（一般都会存储一些 ID 字段，或者必要的冗余），来减少联表查询的数量，因为范式的产生就是为了避免重复数据的问题，但为了提高查询效率就需要冗余一些字段来达到提升性能和方便维护的目的，这个就是反范式。\n反范式虽然通过冗余来降低了 SQL 的查询逻辑优化了查询效率，但是会产生一些维护成本，比如需要同时在多处更新一些信息来达到数据一致性的目的，这对于不熟悉业务系统的人来说可能会产生一些因技术债务产生的数据 BUG。\n\n问题：\n1. 数据存储是存储引擎的行为，那么 char 会自动删除所有的末尾空格内容的行为是属于存储引擎层还是服务层行为？\n2. timestrap 类型保存了从 1970 年 1 月 1 日 到 2038 年的秒数，那么对于 2038 年以后的日期系统会如何处理？\n3. 当 MySQL 服务器存在多数据中心的情况下，timestrap 的时区问题由谁来决定？","source":"_posts/【高性能MySQL：第四章节（Schema与数据类型优化）】学习小节.md","raw":"---\ntitle: 【高性能MySQL：第四章节（Schema与数据类型优化）】学习小节\ntoc: true\ntags:\n  - MySQL\nabbrlink: bd7a5f4c\ndate: 2025-03-27 18:10:41\n---\n\n<meta name=\"referrer\" content=\"no-referrer\" />\n\n本章介绍了不同数据类型的细节差别以及表设计的原则。\n\n<!-- more -->\n\n问题一：如何选择合适的数据类型来存储数据？\n在《高性能 MySQL 》中对于如何选择合适的类型提供了以下的几种建议，并做了一些解释。\n* 更小的通常更好。更小意味在存储空间上占用更少的存储，读取到内存中时占用更少的资源。比如要存储性别字段时，因为大陆由于国情问题，不承认双性人的存在，所以只可能会有男、女两种性别，这种情况可以用 char 来存，也可以用 tinyint 来存，还可以用 varchar 来存。但此时用 char 在可读性上可能是最合适的选择，但是用 tinyint 通过不同的数字来代表男、女也是一种不错的选择，尤其是需要存储用数字代表一些特定的状态标记的时候这是一种很常见的方案。但是在选择更小的同时要考虑数据的边界情况，因为当后期需要调整数据存储的类型时当表中的数据非常庞大时这是一个费时费力且不讨好的活。\n* 简单就好。简单的数据类型在操作上通过更简单，比如整数比字符串的操作代价要低很多，因为字符串受到语言的影响会存在字符集和排序规则的问题使操作字符串比操作数字更复杂。\n* 尽可能避免使用 NULL。在数据建表的过程中数据项为 NULL 可能是一个很常见的操作，因为在很多业务情况下很多字段的内容都不是必须要填写的，意味数据内容可以为空。在 MySQL 中 NULL也是列的默认属性。但一般最好不要为 NULL 值，因为记录为 NULL 时不论是索引还是通过函数进行统计都会比较复杂，有时候还需要额外对 NULL 的进行一些特殊的处理。如果 NULL 的项不作为索引或者统计字段，那么对于性能的影响可能比较小，其次记录为 NULL 时可能会使用更多的存储空间，可以使用空字符串的填充来代替 NULL。\n\n问题二：MySQL 中支持哪些数据类型？应用场景和优缺点是什么？\n在 MySQL 中支持的数据类型有：整数（int）、小数（decimal）、字符串（char、varchar）、大文本、枚举、日期类型、位数据类型、标识符这几种。\n* 整数\n对于整数 （int）可分为 8 位（tinyint）、16 位（smallint）、24 位（mediumint）、32 位（int）和 64 位存储空间（bigint），位数越小存储的范围越小，反之亦然。UNSIGNED 属性表示不允许存在负值，比如 tinyint unsigned 可以存储的范围是 0～255，而tinyint的存储范围是 -128 ~ 127。\n\n* 小数\n小数（decimal）与整数（int）不同的是，在 MySQL5.0 及以上的新版本中对小数支持精确计算，意味着不会四舍五入或者发生截断导致精度丢失问题。这对于财务或者金融领域中是个很大问题。\ndecimal 只是一种存储格式，在计算中decimal 会转换为 double 类型进行计算。float、double 和 decimal 都可以存储小数和指定精度，不同的是 decimal 的列可以指定小数点前后所允许的最大位数，比如 decimal(18,9) 小数点两边将各存储 9 个数字，一共使用 9 个字节，小数点前的数字用 4 个字节，小数点后的数字用 4 个字节，小数点本身占用 1 个字节，但这会占用更多的磁盘空间。在空间存储上 float 占用 4 个字节存储，double 占用 8 个字节。\n对于在客户端中比如 navicat 或者 MySQL 客户端在建表的时候可以使用 int(10) 来指定存储的位数其实是个误解，int(10)只是用来显示字符的个数，对于存储空间的使用来说 int(1) 和 int(10) 是等价的。\n\n* 字符串\nMySQL 字符串类型中最常用的有两种：char 和 varchar 都可以用来存储字符串。其存储方式由存储引擎决定。优缺点：\n优点：char 用于存储固定长度的字符串，对于长度固定的内容 char 有空间效率的优势，适合存储经常变更的数据且不容易产生碎片，比如身份证号。varchar 可用于存储可变长字符串，varchar 比 char 更节省存储空间，但如果通过使用参数 row_format=fixed 固定行的长度的话，这个优势就不存在了。\n缺点：varchar 在使用 update 做更新操作时，如果更新的内容长度比原来更长，如果行的占用空间增长，页内没有空间可以存储的情况下，InnoDB引擎需要通过分裂页来将内容放进页内，就像原来一行的东西是写在一页上的，但是内容增加了，就需要通过额外的页来记录新的内容。使用 char 类型来存储字符串的情况下，如果内容末尾有空格，char 会自动删除所有的末尾空格内容。\n问题：varchar(5) 和 varchar(50)存储“hello”的所需要的存储空间都是一样的，那是不是意味varchar(5) 和 varchar(50) 没有区别？\nvarchar(5) 和 varchar(50) 虽然在实际的存储空间上没有区别，但varchar(50)会消耗更多的内存空间，因为需要分配固定大小的内存区域来保存内部值，也就是说一个是在写入到硬盘上的所消耗的存储空间，一个是读取到内存中所需要的内存空间。同时也不利于临时表的排序处理。\n\n* 大文本\n大文本类型的数据存储类型有两个：blob 和 text，二者都是字符串的数据类型，前者使用二进制存储，而后者采用字符方式存储。\ntext 的数据类型有：tinytext、smalltext、text、mediumtext、longtext，存储的字符，有字符集和排序规则；\nblob 的数据类型有：tinyblob、smallblob、blob、mediumblob、longblob，存储的是二进制，所以没有字符集和排序规则；\n需要注意的问题：\n1. 当存储的值太大时，InnoDB 会使用特定的存储区域来存储内容，通过在行内存储 1～4 个字节的文件地址，来指向实际的物理存储位置。\n2. 排序时通过从头开始的 max_sort_length 参数长度做排序处理，而不是使用整个字符串做排序。如果需要指定长度有两种方式：修改 max_sort_length 的参数配置 或使用 order by substring(字段名,截取长度) 来实现。需要注意的是如果通过截取字符串的方式来排序要确保截取的字符串足够短，不要超过 max_heap_table_size 或 tmp_table_size，否则 MySQL 会将内存临时表转换为 MyISAM 磁盘临时表。通过 explain 执行计划的 extra 列是否包含“Using temporary” 来判断执行计划使用了隐式临时表。\n3. blob 和 text 列不能进行索引，也不能使用索引来解决排序问题。\n4. 尽可能避免使用 blob 和 text 类型，在早期的系统中，会使用 blob 来直接存储图片或者文件的二进制内容，但会随着数据的增多导致 schema 的数据文件越来越大，读取性能下降，后来通过存储文件路径的方式改进了此类问题。在部分小说类的系统依然会使用 text 来存储大文本内容，因为你无法确定内容到底有多长。\n\n* 枚举\n在开发过程中并没有使用过，因为字符串列表是固定的，添加或删除字符串必须使用 alter table 会导致表的重建，而且只能在列表末尾添加元素。\n* 日期类型\nMySQL 存储日期类型支持的有 datetime 和 timestrap。\ndatetime 存储的是一个日期格式（YYYYMMDDHHMMSS）的文本，精度为秒，时间范围从 1001 年 到 9999 年，显示采用 ANSI 标准，使用 8 个字节的存储空间（新版本使用 5 个字节）。一般也建议使用 datetime 来存储日期。\ntimestrap 类型保存了从 1970 年 1 月 1 日 到 2038 年的秒数，使用了 4 个字节的存储空间。可以通过时区自动更新时间戳，显示也依赖于时区的配置，timestrap 的默认为 NOT NULL。\n在某些对时间要求极高的业务系统，会使用 bigint 来存储 Unix 时间戳。\n\n* 位数据类型\n没用过，如果要存储状态信息会优先考虑 tinyint，因为查询时返回的是二进制字符串。在书中也不推荐使用。\n\n* 标识符（identifier ）\nidentifier：一般在实际的开发中用于区分特定字段的数据项在整张表中或者整个 schema 中是唯一的，用于和其他的 table 做数据关联使用。对于使用了 identifier 的字段可以使用 AUTO_INCREMENT 来自动增长，但在实际的业务中用到的场景不多，一般会使用雪花ID 或者 UUID 来做标识符的。\n\n问题三：什么是范式和反范式，有哪些优缺点？\n范式用于优化数据结构、避免存储相同的数据以节省存储空间，在修改数据的时候不用同时修改所处，也就说它是一种设计策略。\n但是避免存储相同的数据就意味着要把数据拆开，各管各的数据，对于存在关联的数据通过标识符进行关联，此时如果业务系统比较复杂或者表结构庞大，比如一个中大型业务系统几百张表是很常见的事情。此时为了获取指定的数据结构就需要通过 join 去联表获取相应的数据，当 join 过多时就会产生性能问题（比如去 join 十几张表）。\n为了解决这个问题，就需要在一些表上根据业务需求去做一些冗余字段（一般都会存储一些 ID 字段，或者必要的冗余），来减少联表查询的数量，因为范式的产生就是为了避免重复数据的问题，但为了提高查询效率就需要冗余一些字段来达到提升性能和方便维护的目的，这个就是反范式。\n反范式虽然通过冗余来降低了 SQL 的查询逻辑优化了查询效率，但是会产生一些维护成本，比如需要同时在多处更新一些信息来达到数据一致性的目的，这对于不熟悉业务系统的人来说可能会产生一些因技术债务产生的数据 BUG。\n\n问题：\n1. 数据存储是存储引擎的行为，那么 char 会自动删除所有的末尾空格内容的行为是属于存储引擎层还是服务层行为？\n2. timestrap 类型保存了从 1970 年 1 月 1 日 到 2038 年的秒数，那么对于 2038 年以后的日期系统会如何处理？\n3. 当 MySQL 服务器存在多数据中心的情况下，timestrap 的时区问题由谁来决定？","slug":"【高性能MySQL：第四章节（Schema与数据类型优化）】学习小节","published":1,"updated":"2025-03-28T05:44:31.114Z","comments":1,"layout":"post","photos":[],"_id":"cm8se3tdr0017bb8l86nxcggj","content":"<meta name=\"referrer\" content=\"no-referrer\" />\n\n<p>本章介绍了不同数据类型的细节差别以及表设计的原则。</p>\n<span id=\"more\"></span>\n\n<p>问题一：如何选择合适的数据类型来存储数据？<br>在《高性能 MySQL 》中对于如何选择合适的类型提供了以下的几种建议，并做了一些解释。</p>\n<ul>\n<li>更小的通常更好。更小意味在存储空间上占用更少的存储，读取到内存中时占用更少的资源。比如要存储性别字段时，因为大陆由于国情问题，不承认双性人的存在，所以只可能会有男、女两种性别，这种情况可以用 char 来存，也可以用 tinyint 来存，还可以用 varchar 来存。但此时用 char 在可读性上可能是最合适的选择，但是用 tinyint 通过不同的数字来代表男、女也是一种不错的选择，尤其是需要存储用数字代表一些特定的状态标记的时候这是一种很常见的方案。但是在选择更小的同时要考虑数据的边界情况，因为当后期需要调整数据存储的类型时当表中的数据非常庞大时这是一个费时费力且不讨好的活。</li>\n<li>简单就好。简单的数据类型在操作上通过更简单，比如整数比字符串的操作代价要低很多，因为字符串受到语言的影响会存在字符集和排序规则的问题使操作字符串比操作数字更复杂。</li>\n<li>尽可能避免使用 NULL。在数据建表的过程中数据项为 NULL 可能是一个很常见的操作，因为在很多业务情况下很多字段的内容都不是必须要填写的，意味数据内容可以为空。在 MySQL 中 NULL也是列的默认属性。但一般最好不要为 NULL 值，因为记录为 NULL 时不论是索引还是通过函数进行统计都会比较复杂，有时候还需要额外对 NULL 的进行一些特殊的处理。如果 NULL 的项不作为索引或者统计字段，那么对于性能的影响可能比较小，其次记录为 NULL 时可能会使用更多的存储空间，可以使用空字符串的填充来代替 NULL。</li>\n</ul>\n<p>问题二：MySQL 中支持哪些数据类型？应用场景和优缺点是什么？<br>在 MySQL 中支持的数据类型有：整数（int）、小数（decimal）、字符串（char、varchar）、大文本、枚举、日期类型、位数据类型、标识符这几种。</p>\n<ul>\n<li><p>整数<br>对于整数 （int）可分为 8 位（tinyint）、16 位（smallint）、24 位（mediumint）、32 位（int）和 64 位存储空间（bigint），位数越小存储的范围越小，反之亦然。UNSIGNED 属性表示不允许存在负值，比如 tinyint unsigned 可以存储的范围是 0～255，而tinyint的存储范围是 -128 ~ 127。</p>\n</li>\n<li><p>小数<br>小数（decimal）与整数（int）不同的是，在 MySQL5.0 及以上的新版本中对小数支持精确计算，意味着不会四舍五入或者发生截断导致精度丢失问题。这对于财务或者金融领域中是个很大问题。<br>decimal 只是一种存储格式，在计算中decimal 会转换为 double 类型进行计算。float、double 和 decimal 都可以存储小数和指定精度，不同的是 decimal 的列可以指定小数点前后所允许的最大位数，比如 decimal(18,9) 小数点两边将各存储 9 个数字，一共使用 9 个字节，小数点前的数字用 4 个字节，小数点后的数字用 4 个字节，小数点本身占用 1 个字节，但这会占用更多的磁盘空间。在空间存储上 float 占用 4 个字节存储，double 占用 8 个字节。<br>对于在客户端中比如 navicat 或者 MySQL 客户端在建表的时候可以使用 int(10) 来指定存储的位数其实是个误解，int(10)只是用来显示字符的个数，对于存储空间的使用来说 int(1) 和 int(10) 是等价的。</p>\n</li>\n<li><p>字符串<br>MySQL 字符串类型中最常用的有两种：char 和 varchar 都可以用来存储字符串。其存储方式由存储引擎决定。优缺点：<br>优点：char 用于存储固定长度的字符串，对于长度固定的内容 char 有空间效率的优势，适合存储经常变更的数据且不容易产生碎片，比如身份证号。varchar 可用于存储可变长字符串，varchar 比 char 更节省存储空间，但如果通过使用参数 row_format&#x3D;fixed 固定行的长度的话，这个优势就不存在了。<br>缺点：varchar 在使用 update 做更新操作时，如果更新的内容长度比原来更长，如果行的占用空间增长，页内没有空间可以存储的情况下，InnoDB引擎需要通过分裂页来将内容放进页内，就像原来一行的东西是写在一页上的，但是内容增加了，就需要通过额外的页来记录新的内容。使用 char 类型来存储字符串的情况下，如果内容末尾有空格，char 会自动删除所有的末尾空格内容。<br>问题：varchar(5) 和 varchar(50)存储“hello”的所需要的存储空间都是一样的，那是不是意味varchar(5) 和 varchar(50) 没有区别？<br>varchar(5) 和 varchar(50) 虽然在实际的存储空间上没有区别，但varchar(50)会消耗更多的内存空间，因为需要分配固定大小的内存区域来保存内部值，也就是说一个是在写入到硬盘上的所消耗的存储空间，一个是读取到内存中所需要的内存空间。同时也不利于临时表的排序处理。</p>\n</li>\n<li><p>大文本<br>大文本类型的数据存储类型有两个：blob 和 text，二者都是字符串的数据类型，前者使用二进制存储，而后者采用字符方式存储。<br>text 的数据类型有：tinytext、smalltext、text、mediumtext、longtext，存储的字符，有字符集和排序规则；<br>blob 的数据类型有：tinyblob、smallblob、blob、mediumblob、longblob，存储的是二进制，所以没有字符集和排序规则；<br>需要注意的问题：</p>\n</li>\n</ul>\n<ol>\n<li>当存储的值太大时，InnoDB 会使用特定的存储区域来存储内容，通过在行内存储 1～4 个字节的文件地址，来指向实际的物理存储位置。</li>\n<li>排序时通过从头开始的 max_sort_length 参数长度做排序处理，而不是使用整个字符串做排序。如果需要指定长度有两种方式：修改 max_sort_length 的参数配置 或使用 order by substring(字段名,截取长度) 来实现。需要注意的是如果通过截取字符串的方式来排序要确保截取的字符串足够短，不要超过 max_heap_table_size 或 tmp_table_size，否则 MySQL 会将内存临时表转换为 MyISAM 磁盘临时表。通过 explain 执行计划的 extra 列是否包含“Using temporary” 来判断执行计划使用了隐式临时表。</li>\n<li>blob 和 text 列不能进行索引，也不能使用索引来解决排序问题。</li>\n<li>尽可能避免使用 blob 和 text 类型，在早期的系统中，会使用 blob 来直接存储图片或者文件的二进制内容，但会随着数据的增多导致 schema 的数据文件越来越大，读取性能下降，后来通过存储文件路径的方式改进了此类问题。在部分小说类的系统依然会使用 text 来存储大文本内容，因为你无法确定内容到底有多长。</li>\n</ol>\n<ul>\n<li><p>枚举<br>在开发过程中并没有使用过，因为字符串列表是固定的，添加或删除字符串必须使用 alter table 会导致表的重建，而且只能在列表末尾添加元素。</p>\n</li>\n<li><p>日期类型<br>MySQL 存储日期类型支持的有 datetime 和 timestrap。<br>datetime 存储的是一个日期格式（YYYYMMDDHHMMSS）的文本，精度为秒，时间范围从 1001 年 到 9999 年，显示采用 ANSI 标准，使用 8 个字节的存储空间（新版本使用 5 个字节）。一般也建议使用 datetime 来存储日期。<br>timestrap 类型保存了从 1970 年 1 月 1 日 到 2038 年的秒数，使用了 4 个字节的存储空间。可以通过时区自动更新时间戳，显示也依赖于时区的配置，timestrap 的默认为 NOT NULL。<br>在某些对时间要求极高的业务系统，会使用 bigint 来存储 Unix 时间戳。</p>\n</li>\n<li><p>位数据类型<br>没用过，如果要存储状态信息会优先考虑 tinyint，因为查询时返回的是二进制字符串。在书中也不推荐使用。</p>\n</li>\n<li><p>标识符（identifier ）<br>identifier：一般在实际的开发中用于区分特定字段的数据项在整张表中或者整个 schema 中是唯一的，用于和其他的 table 做数据关联使用。对于使用了 identifier 的字段可以使用 AUTO_INCREMENT 来自动增长，但在实际的业务中用到的场景不多，一般会使用雪花ID 或者 UUID 来做标识符的。</p>\n</li>\n</ul>\n<p>问题三：什么是范式和反范式，有哪些优缺点？<br>范式用于优化数据结构、避免存储相同的数据以节省存储空间，在修改数据的时候不用同时修改所处，也就说它是一种设计策略。<br>但是避免存储相同的数据就意味着要把数据拆开，各管各的数据，对于存在关联的数据通过标识符进行关联，此时如果业务系统比较复杂或者表结构庞大，比如一个中大型业务系统几百张表是很常见的事情。此时为了获取指定的数据结构就需要通过 join 去联表获取相应的数据，当 join 过多时就会产生性能问题（比如去 join 十几张表）。<br>为了解决这个问题，就需要在一些表上根据业务需求去做一些冗余字段（一般都会存储一些 ID 字段，或者必要的冗余），来减少联表查询的数量，因为范式的产生就是为了避免重复数据的问题，但为了提高查询效率就需要冗余一些字段来达到提升性能和方便维护的目的，这个就是反范式。<br>反范式虽然通过冗余来降低了 SQL 的查询逻辑优化了查询效率，但是会产生一些维护成本，比如需要同时在多处更新一些信息来达到数据一致性的目的，这对于不熟悉业务系统的人来说可能会产生一些因技术债务产生的数据 BUG。</p>\n<p>问题：</p>\n<ol>\n<li>数据存储是存储引擎的行为，那么 char 会自动删除所有的末尾空格内容的行为是属于存储引擎层还是服务层行为？</li>\n<li>timestrap 类型保存了从 1970 年 1 月 1 日 到 2038 年的秒数，那么对于 2038 年以后的日期系统会如何处理？</li>\n<li>当 MySQL 服务器存在多数据中心的情况下，timestrap 的时区问题由谁来决定？</li>\n</ol>\n","excerpt":"<meta name=\"referrer\" content=\"no-referrer\" />\n\n<p>本章介绍了不同数据类型的细节差别以及表设计的原则。</p>","more":"<p>问题一：如何选择合适的数据类型来存储数据？<br>在《高性能 MySQL 》中对于如何选择合适的类型提供了以下的几种建议，并做了一些解释。</p>\n<ul>\n<li>更小的通常更好。更小意味在存储空间上占用更少的存储，读取到内存中时占用更少的资源。比如要存储性别字段时，因为大陆由于国情问题，不承认双性人的存在，所以只可能会有男、女两种性别，这种情况可以用 char 来存，也可以用 tinyint 来存，还可以用 varchar 来存。但此时用 char 在可读性上可能是最合适的选择，但是用 tinyint 通过不同的数字来代表男、女也是一种不错的选择，尤其是需要存储用数字代表一些特定的状态标记的时候这是一种很常见的方案。但是在选择更小的同时要考虑数据的边界情况，因为当后期需要调整数据存储的类型时当表中的数据非常庞大时这是一个费时费力且不讨好的活。</li>\n<li>简单就好。简单的数据类型在操作上通过更简单，比如整数比字符串的操作代价要低很多，因为字符串受到语言的影响会存在字符集和排序规则的问题使操作字符串比操作数字更复杂。</li>\n<li>尽可能避免使用 NULL。在数据建表的过程中数据项为 NULL 可能是一个很常见的操作，因为在很多业务情况下很多字段的内容都不是必须要填写的，意味数据内容可以为空。在 MySQL 中 NULL也是列的默认属性。但一般最好不要为 NULL 值，因为记录为 NULL 时不论是索引还是通过函数进行统计都会比较复杂，有时候还需要额外对 NULL 的进行一些特殊的处理。如果 NULL 的项不作为索引或者统计字段，那么对于性能的影响可能比较小，其次记录为 NULL 时可能会使用更多的存储空间，可以使用空字符串的填充来代替 NULL。</li>\n</ul>\n<p>问题二：MySQL 中支持哪些数据类型？应用场景和优缺点是什么？<br>在 MySQL 中支持的数据类型有：整数（int）、小数（decimal）、字符串（char、varchar）、大文本、枚举、日期类型、位数据类型、标识符这几种。</p>\n<ul>\n<li><p>整数<br>对于整数 （int）可分为 8 位（tinyint）、16 位（smallint）、24 位（mediumint）、32 位（int）和 64 位存储空间（bigint），位数越小存储的范围越小，反之亦然。UNSIGNED 属性表示不允许存在负值，比如 tinyint unsigned 可以存储的范围是 0～255，而tinyint的存储范围是 -128 ~ 127。</p>\n</li>\n<li><p>小数<br>小数（decimal）与整数（int）不同的是，在 MySQL5.0 及以上的新版本中对小数支持精确计算，意味着不会四舍五入或者发生截断导致精度丢失问题。这对于财务或者金融领域中是个很大问题。<br>decimal 只是一种存储格式，在计算中decimal 会转换为 double 类型进行计算。float、double 和 decimal 都可以存储小数和指定精度，不同的是 decimal 的列可以指定小数点前后所允许的最大位数，比如 decimal(18,9) 小数点两边将各存储 9 个数字，一共使用 9 个字节，小数点前的数字用 4 个字节，小数点后的数字用 4 个字节，小数点本身占用 1 个字节，但这会占用更多的磁盘空间。在空间存储上 float 占用 4 个字节存储，double 占用 8 个字节。<br>对于在客户端中比如 navicat 或者 MySQL 客户端在建表的时候可以使用 int(10) 来指定存储的位数其实是个误解，int(10)只是用来显示字符的个数，对于存储空间的使用来说 int(1) 和 int(10) 是等价的。</p>\n</li>\n<li><p>字符串<br>MySQL 字符串类型中最常用的有两种：char 和 varchar 都可以用来存储字符串。其存储方式由存储引擎决定。优缺点：<br>优点：char 用于存储固定长度的字符串，对于长度固定的内容 char 有空间效率的优势，适合存储经常变更的数据且不容易产生碎片，比如身份证号。varchar 可用于存储可变长字符串，varchar 比 char 更节省存储空间，但如果通过使用参数 row_format&#x3D;fixed 固定行的长度的话，这个优势就不存在了。<br>缺点：varchar 在使用 update 做更新操作时，如果更新的内容长度比原来更长，如果行的占用空间增长，页内没有空间可以存储的情况下，InnoDB引擎需要通过分裂页来将内容放进页内，就像原来一行的东西是写在一页上的，但是内容增加了，就需要通过额外的页来记录新的内容。使用 char 类型来存储字符串的情况下，如果内容末尾有空格，char 会自动删除所有的末尾空格内容。<br>问题：varchar(5) 和 varchar(50)存储“hello”的所需要的存储空间都是一样的，那是不是意味varchar(5) 和 varchar(50) 没有区别？<br>varchar(5) 和 varchar(50) 虽然在实际的存储空间上没有区别，但varchar(50)会消耗更多的内存空间，因为需要分配固定大小的内存区域来保存内部值，也就是说一个是在写入到硬盘上的所消耗的存储空间，一个是读取到内存中所需要的内存空间。同时也不利于临时表的排序处理。</p>\n</li>\n<li><p>大文本<br>大文本类型的数据存储类型有两个：blob 和 text，二者都是字符串的数据类型，前者使用二进制存储，而后者采用字符方式存储。<br>text 的数据类型有：tinytext、smalltext、text、mediumtext、longtext，存储的字符，有字符集和排序规则；<br>blob 的数据类型有：tinyblob、smallblob、blob、mediumblob、longblob，存储的是二进制，所以没有字符集和排序规则；<br>需要注意的问题：</p>\n</li>\n</ul>\n<ol>\n<li>当存储的值太大时，InnoDB 会使用特定的存储区域来存储内容，通过在行内存储 1～4 个字节的文件地址，来指向实际的物理存储位置。</li>\n<li>排序时通过从头开始的 max_sort_length 参数长度做排序处理，而不是使用整个字符串做排序。如果需要指定长度有两种方式：修改 max_sort_length 的参数配置 或使用 order by substring(字段名,截取长度) 来实现。需要注意的是如果通过截取字符串的方式来排序要确保截取的字符串足够短，不要超过 max_heap_table_size 或 tmp_table_size，否则 MySQL 会将内存临时表转换为 MyISAM 磁盘临时表。通过 explain 执行计划的 extra 列是否包含“Using temporary” 来判断执行计划使用了隐式临时表。</li>\n<li>blob 和 text 列不能进行索引，也不能使用索引来解决排序问题。</li>\n<li>尽可能避免使用 blob 和 text 类型，在早期的系统中，会使用 blob 来直接存储图片或者文件的二进制内容，但会随着数据的增多导致 schema 的数据文件越来越大，读取性能下降，后来通过存储文件路径的方式改进了此类问题。在部分小说类的系统依然会使用 text 来存储大文本内容，因为你无法确定内容到底有多长。</li>\n</ol>\n<ul>\n<li><p>枚举<br>在开发过程中并没有使用过，因为字符串列表是固定的，添加或删除字符串必须使用 alter table 会导致表的重建，而且只能在列表末尾添加元素。</p>\n</li>\n<li><p>日期类型<br>MySQL 存储日期类型支持的有 datetime 和 timestrap。<br>datetime 存储的是一个日期格式（YYYYMMDDHHMMSS）的文本，精度为秒，时间范围从 1001 年 到 9999 年，显示采用 ANSI 标准，使用 8 个字节的存储空间（新版本使用 5 个字节）。一般也建议使用 datetime 来存储日期。<br>timestrap 类型保存了从 1970 年 1 月 1 日 到 2038 年的秒数，使用了 4 个字节的存储空间。可以通过时区自动更新时间戳，显示也依赖于时区的配置，timestrap 的默认为 NOT NULL。<br>在某些对时间要求极高的业务系统，会使用 bigint 来存储 Unix 时间戳。</p>\n</li>\n<li><p>位数据类型<br>没用过，如果要存储状态信息会优先考虑 tinyint，因为查询时返回的是二进制字符串。在书中也不推荐使用。</p>\n</li>\n<li><p>标识符（identifier ）<br>identifier：一般在实际的开发中用于区分特定字段的数据项在整张表中或者整个 schema 中是唯一的，用于和其他的 table 做数据关联使用。对于使用了 identifier 的字段可以使用 AUTO_INCREMENT 来自动增长，但在实际的业务中用到的场景不多，一般会使用雪花ID 或者 UUID 来做标识符的。</p>\n</li>\n</ul>\n<p>问题三：什么是范式和反范式，有哪些优缺点？<br>范式用于优化数据结构、避免存储相同的数据以节省存储空间，在修改数据的时候不用同时修改所处，也就说它是一种设计策略。<br>但是避免存储相同的数据就意味着要把数据拆开，各管各的数据，对于存在关联的数据通过标识符进行关联，此时如果业务系统比较复杂或者表结构庞大，比如一个中大型业务系统几百张表是很常见的事情。此时为了获取指定的数据结构就需要通过 join 去联表获取相应的数据，当 join 过多时就会产生性能问题（比如去 join 十几张表）。<br>为了解决这个问题，就需要在一些表上根据业务需求去做一些冗余字段（一般都会存储一些 ID 字段，或者必要的冗余），来减少联表查询的数量，因为范式的产生就是为了避免重复数据的问题，但为了提高查询效率就需要冗余一些字段来达到提升性能和方便维护的目的，这个就是反范式。<br>反范式虽然通过冗余来降低了 SQL 的查询逻辑优化了查询效率，但是会产生一些维护成本，比如需要同时在多处更新一些信息来达到数据一致性的目的，这对于不熟悉业务系统的人来说可能会产生一些因技术债务产生的数据 BUG。</p>\n<p>问题：</p>\n<ol>\n<li>数据存储是存储引擎的行为，那么 char 会自动删除所有的末尾空格内容的行为是属于存储引擎层还是服务层行为？</li>\n<li>timestrap 类型保存了从 1970 年 1 月 1 日 到 2038 年的秒数，那么对于 2038 年以后的日期系统会如何处理？</li>\n<li>当 MySQL 服务器存在多数据中心的情况下，timestrap 的时区问题由谁来决定？</li>\n</ol>"},{"title":"使用ChatGPT的提问技巧","abbrlink":"698aa78f","date":"2023-11-12T19:43:24.000Z","toc":true,"_content":"<meta name=\"referrer\" content=\"no-referrer\" />\n\n本人将介绍一些ChatGPT的提问技巧，帮助我们更好的使用ChatGPT解决实际问题。\n\n<!--more-->\n\n## 什么是ChatGPT？\n\n如果一个人对世界上的知识几乎无所不知，可以进行实时对话，它可以无条件的帮我去搜索信息、多语言编程、多语言写作、推理、共创。帮我们调用其他的软件完成实际的工作任务，这个的一个人可以扮演你的导师、翻译官、程序员、咨询顾问、搜索引擎。这么一个人就是ChatGPT。\n\n## ChatGPT的特点\n\n1. 直接给你答案\n\n通过我们提出的问题，ChatGPT可以直接出我们的答案。\n\n1. GPT能对话式交互\n\nGoogle只能我们去问他，ChatGPT可以像聊天一样进行对话。\n\n1. ChatGPT能辅助我们完成工作任务\n\nChatGPT不仅可以解答我们的各种疑问，还可以基于我们的需要，辅助我们完成代码编程、内容翻译、文章创作的任务。\n\n## 5H2W分析方法\n\n5H2W分析方法是一种用于解决问题和制定决策的系统性工具。这种方法通常包括以下五个关键要素（5H）和两个核心问题（2W），这些要素和问题协同工作，帮助人们深入了解问题，找到解决方案。即What（是什么？）、Why（为什么做？）、Who（谁来做？）、When（什么时候做？）、Where（在哪里做？）、How（怎么做？）\n\n### 目的\n\n通过5W2H分析方法、帮助发现自身问题，并提出解决问题的方法。\n\n### 优势\n\n1. 可以帮助我们发现问题，并根据问题的线索找到解决问题的方法和思路。\n2. 可以准确地找到问题的关键，减少不必要的查找问题的时间，从而提高工作效率。\n\n<aside>\n⚠️ 通过ChatGPT和5H2W的组合，可以帮助我们更高效的找到问题的解决思路和方法。\n\n</aside>\n\n## 如何提问才能得到更高质量的答案？\n\n![Untitled](http://qiniu-image.gotojava.cn/blog/2023-12-15-191028.png)\n\n盲区\n\n问法一：我想了解XXX，我应该向你问哪些问题？\n\n比如：我想快速了解人工智能行业，我应该向你问哪些问题？\n\n问法二：请给我列出XXX领域/行业相关的，最常用的50个概念，并做简单解释。如果有英文缩写，请给出完整的英文解释。\n\n比如：请给我列出人工智能行业相关的最常用的50个概念，并做简单解释，如果有英文缩写，请给出完整的英文解释。\n\n问法三：请详细介绍一下XXX的主要生平事迹。请详细介绍一下XXX公司的发展历程。\n\n比如：请详细介绍一下艾隆·马斯克的主要生平事迹。请详细介绍一下Tesla公司的发展历程。\n\n## 公开区\n\n检验认知、扩充认知\n\n问法一：对于XXX主题/技能，你认为哪些是我必须理解和掌握的核心要点？\n\n比如：对于掌握ChatGPT的使用技能，你认为哪些是我必须理解和掌握的核心要点？\n\n问法二：我理解的XXX是这样的，你觉得我的理解对吗？\n\n比如：我理解的ChatGPT是一个无所不知的博士，你觉得我的理解对吗？\n\n问法三：我对XXX有一些想法，你能帮我批判性地分析一下这些想法的优点和缺点吗？\n\n问法四：我正在考虑XXX的决定，你能帮我分析一下可能的结果和影响吗？\n\n问法五：我知道XXX的概念，我想知道更多关于XXX的信息。\n\n问法六：我在XXX问题上遇到了困难，你能提供一些可能的解决方案或建议吗？\n\n问法七：我想要深入学习XXX，你能推荐一些进阶的学习资源或学习路径吗？\n\n问法八：我想要在XXX领域有所创新，你能提供一些启发或者想法吗？\n\n问法九：我想在XXX领域提升自己，你能根据最新的研究和趋势给我一些建议吗？\n\n问法十：我正在学习xxx，你能给我一些关于这个领域未来发展的观点吗？\n\n问法十一：给出一些背景信息，我要做关于XXX的研究，我认为原因是，还有其他可能的原因吗？给出一些可能的研究假设。\n\n问法十二：我是一个XXX行业的新手，马上要采访这个行业的资深大佬，我应该向他请教哪些有价值的问题？\n\n### 隐私区\n\n问法一：你怎么看待这种现象？\n\n问法二：可能的原因有哪些？\n\n问法三：这会对XXX产生什么样的影响？\n\n问法四：你觉得XXX应该怎么做？\n\n### 未知区\n\n问法一：如果xxx，这会对社会产生什么影响？\n\n比如：如果中国家庭都用上了ChatGPT，这对中国家教行业会有什么影响？\n\n## 达克效应\n\n![Untitled](http://qiniu-image.gotojava.cn/blog/2023-12-15-191031.png)\n\n<aside>\n💡 达克效应是指在认知能力低下的人更容易高估自己的技能水平，同时也更容易低估他人的技能水平的现象。相对地，高水平的人可能低估自己的能力，因为他们可能认为别人对该领域的能力水平与他们自己相近。\n\n</aside>\n\n### 反向提问\n\n问法一：为了测试我对xxx的了解程度，你会问我什么问题来检验我的水平，最少10个。\n\n问法二：我是xxx领域的专家，你会问我哪些问题来检验我的专业水平？最少10个。\n\n问法三：现在我们玩个”你问我答“的游戏，目的是为了测试我在xxx方面的专业水平。你负责提问，我负责回答。你要根据我的答案进行反馈、评价、补充。如果我说不知道，你就直接输出正确答案，然后你继续提问。\n\n问法四：我已经很精通XXX了，我想知道我是否还有需要学习的地方？\n\n## 应用性场景的提问\n\n1. 知道自己要干什么，但是不知道ChatGPT能帮你什么\n\n问法：我想做xxxx，你能给我提供什么帮助？\n\n1. 知道要ChatGPT帮你做什么，但是你不知道给它输入什么具体的信息。\n\n问法：我想要你xxx，我应该给你输入什么信息？\n\n1. 直接给ChatGPT指令。任务目标、背景信息、输出要求都非常清晰。\n\n问法：\n\n- 请推荐（书名、电视剧、电影、网站、博主、专家、学习资源）…\n- 请翻译…\n- 请总结…\n- 请润色…\n\n比如：请推荐10个高质量的Java的youtuber，按照粉丝量从高到低排序，并给出他们的YouTube频道链接。\n\n## 角色扮演式提问\n\n问法一：如果你是xxx，在某种情况下，xxx会说什么，会怎么想，会怎么看，会怎么做？\n\n问法二：你好，我是 [名人名字]。在我最近的电影中，有一场戏是关于 [某个情节] 的。你对这个场景有什么看法吗？\n\n问法三：您好，我是 [历史人物名字]。我在 [某个时期] 做了一些重要的决定。你认为这些决定对后来的历史产生了什么影响？\n\n问法四：[名人名字]，我听说你在 [某个事件] 中发表了重要言论。您能分享一下当时的思考和背后的原因吗？\n\n问法五：[名人名字]，在您的职业生涯中，您还有什么新的项目或计划吗？我们可以期待您的哪些新作品？\n\n问法六：[名人名字]，在您所在的领域，您认为目前有哪些令人兴奋或值得关注的行业动态？\n","source":"_posts/使用ChatGPT的提问技巧.md","raw":"---\ntitle: 使用ChatGPT的提问技巧\ntags:\n  - LLM\nabbrlink: 698aa78f\ndate: 2023-11-12 19:43:24\ntoc: true\n---\n<meta name=\"referrer\" content=\"no-referrer\" />\n\n本人将介绍一些ChatGPT的提问技巧，帮助我们更好的使用ChatGPT解决实际问题。\n\n<!--more-->\n\n## 什么是ChatGPT？\n\n如果一个人对世界上的知识几乎无所不知，可以进行实时对话，它可以无条件的帮我去搜索信息、多语言编程、多语言写作、推理、共创。帮我们调用其他的软件完成实际的工作任务，这个的一个人可以扮演你的导师、翻译官、程序员、咨询顾问、搜索引擎。这么一个人就是ChatGPT。\n\n## ChatGPT的特点\n\n1. 直接给你答案\n\n通过我们提出的问题，ChatGPT可以直接出我们的答案。\n\n1. GPT能对话式交互\n\nGoogle只能我们去问他，ChatGPT可以像聊天一样进行对话。\n\n1. ChatGPT能辅助我们完成工作任务\n\nChatGPT不仅可以解答我们的各种疑问，还可以基于我们的需要，辅助我们完成代码编程、内容翻译、文章创作的任务。\n\n## 5H2W分析方法\n\n5H2W分析方法是一种用于解决问题和制定决策的系统性工具。这种方法通常包括以下五个关键要素（5H）和两个核心问题（2W），这些要素和问题协同工作，帮助人们深入了解问题，找到解决方案。即What（是什么？）、Why（为什么做？）、Who（谁来做？）、When（什么时候做？）、Where（在哪里做？）、How（怎么做？）\n\n### 目的\n\n通过5W2H分析方法、帮助发现自身问题，并提出解决问题的方法。\n\n### 优势\n\n1. 可以帮助我们发现问题，并根据问题的线索找到解决问题的方法和思路。\n2. 可以准确地找到问题的关键，减少不必要的查找问题的时间，从而提高工作效率。\n\n<aside>\n⚠️ 通过ChatGPT和5H2W的组合，可以帮助我们更高效的找到问题的解决思路和方法。\n\n</aside>\n\n## 如何提问才能得到更高质量的答案？\n\n![Untitled](http://qiniu-image.gotojava.cn/blog/2023-12-15-191028.png)\n\n盲区\n\n问法一：我想了解XXX，我应该向你问哪些问题？\n\n比如：我想快速了解人工智能行业，我应该向你问哪些问题？\n\n问法二：请给我列出XXX领域/行业相关的，最常用的50个概念，并做简单解释。如果有英文缩写，请给出完整的英文解释。\n\n比如：请给我列出人工智能行业相关的最常用的50个概念，并做简单解释，如果有英文缩写，请给出完整的英文解释。\n\n问法三：请详细介绍一下XXX的主要生平事迹。请详细介绍一下XXX公司的发展历程。\n\n比如：请详细介绍一下艾隆·马斯克的主要生平事迹。请详细介绍一下Tesla公司的发展历程。\n\n## 公开区\n\n检验认知、扩充认知\n\n问法一：对于XXX主题/技能，你认为哪些是我必须理解和掌握的核心要点？\n\n比如：对于掌握ChatGPT的使用技能，你认为哪些是我必须理解和掌握的核心要点？\n\n问法二：我理解的XXX是这样的，你觉得我的理解对吗？\n\n比如：我理解的ChatGPT是一个无所不知的博士，你觉得我的理解对吗？\n\n问法三：我对XXX有一些想法，你能帮我批判性地分析一下这些想法的优点和缺点吗？\n\n问法四：我正在考虑XXX的决定，你能帮我分析一下可能的结果和影响吗？\n\n问法五：我知道XXX的概念，我想知道更多关于XXX的信息。\n\n问法六：我在XXX问题上遇到了困难，你能提供一些可能的解决方案或建议吗？\n\n问法七：我想要深入学习XXX，你能推荐一些进阶的学习资源或学习路径吗？\n\n问法八：我想要在XXX领域有所创新，你能提供一些启发或者想法吗？\n\n问法九：我想在XXX领域提升自己，你能根据最新的研究和趋势给我一些建议吗？\n\n问法十：我正在学习xxx，你能给我一些关于这个领域未来发展的观点吗？\n\n问法十一：给出一些背景信息，我要做关于XXX的研究，我认为原因是，还有其他可能的原因吗？给出一些可能的研究假设。\n\n问法十二：我是一个XXX行业的新手，马上要采访这个行业的资深大佬，我应该向他请教哪些有价值的问题？\n\n### 隐私区\n\n问法一：你怎么看待这种现象？\n\n问法二：可能的原因有哪些？\n\n问法三：这会对XXX产生什么样的影响？\n\n问法四：你觉得XXX应该怎么做？\n\n### 未知区\n\n问法一：如果xxx，这会对社会产生什么影响？\n\n比如：如果中国家庭都用上了ChatGPT，这对中国家教行业会有什么影响？\n\n## 达克效应\n\n![Untitled](http://qiniu-image.gotojava.cn/blog/2023-12-15-191031.png)\n\n<aside>\n💡 达克效应是指在认知能力低下的人更容易高估自己的技能水平，同时也更容易低估他人的技能水平的现象。相对地，高水平的人可能低估自己的能力，因为他们可能认为别人对该领域的能力水平与他们自己相近。\n\n</aside>\n\n### 反向提问\n\n问法一：为了测试我对xxx的了解程度，你会问我什么问题来检验我的水平，最少10个。\n\n问法二：我是xxx领域的专家，你会问我哪些问题来检验我的专业水平？最少10个。\n\n问法三：现在我们玩个”你问我答“的游戏，目的是为了测试我在xxx方面的专业水平。你负责提问，我负责回答。你要根据我的答案进行反馈、评价、补充。如果我说不知道，你就直接输出正确答案，然后你继续提问。\n\n问法四：我已经很精通XXX了，我想知道我是否还有需要学习的地方？\n\n## 应用性场景的提问\n\n1. 知道自己要干什么，但是不知道ChatGPT能帮你什么\n\n问法：我想做xxxx，你能给我提供什么帮助？\n\n1. 知道要ChatGPT帮你做什么，但是你不知道给它输入什么具体的信息。\n\n问法：我想要你xxx，我应该给你输入什么信息？\n\n1. 直接给ChatGPT指令。任务目标、背景信息、输出要求都非常清晰。\n\n问法：\n\n- 请推荐（书名、电视剧、电影、网站、博主、专家、学习资源）…\n- 请翻译…\n- 请总结…\n- 请润色…\n\n比如：请推荐10个高质量的Java的youtuber，按照粉丝量从高到低排序，并给出他们的YouTube频道链接。\n\n## 角色扮演式提问\n\n问法一：如果你是xxx，在某种情况下，xxx会说什么，会怎么想，会怎么看，会怎么做？\n\n问法二：你好，我是 [名人名字]。在我最近的电影中，有一场戏是关于 [某个情节] 的。你对这个场景有什么看法吗？\n\n问法三：您好，我是 [历史人物名字]。我在 [某个时期] 做了一些重要的决定。你认为这些决定对后来的历史产生了什么影响？\n\n问法四：[名人名字]，我听说你在 [某个事件] 中发表了重要言论。您能分享一下当时的思考和背后的原因吗？\n\n问法五：[名人名字]，在您的职业生涯中，您还有什么新的项目或计划吗？我们可以期待您的哪些新作品？\n\n问法六：[名人名字]，在您所在的领域，您认为目前有哪些令人兴奋或值得关注的行业动态？\n","slug":"使用ChatGPT的提问技巧","published":1,"updated":"2025-03-28T06:09:59.910Z","comments":1,"layout":"post","photos":[],"_id":"cm8se3tds001abb8lanug5nsc","content":"<meta name=\"referrer\" content=\"no-referrer\" />\n\n<p>本人将介绍一些ChatGPT的提问技巧，帮助我们更好的使用ChatGPT解决实际问题。</p>\n<span id=\"more\"></span>\n\n<h2 id=\"什么是ChatGPT？\"><a href=\"#什么是ChatGPT？\" class=\"headerlink\" title=\"什么是ChatGPT？\"></a>什么是ChatGPT？</h2><p>如果一个人对世界上的知识几乎无所不知，可以进行实时对话，它可以无条件的帮我去搜索信息、多语言编程、多语言写作、推理、共创。帮我们调用其他的软件完成实际的工作任务，这个的一个人可以扮演你的导师、翻译官、程序员、咨询顾问、搜索引擎。这么一个人就是ChatGPT。</p>\n<h2 id=\"ChatGPT的特点\"><a href=\"#ChatGPT的特点\" class=\"headerlink\" title=\"ChatGPT的特点\"></a>ChatGPT的特点</h2><ol>\n<li>直接给你答案</li>\n</ol>\n<p>通过我们提出的问题，ChatGPT可以直接出我们的答案。</p>\n<ol>\n<li>GPT能对话式交互</li>\n</ol>\n<p>Google只能我们去问他，ChatGPT可以像聊天一样进行对话。</p>\n<ol>\n<li>ChatGPT能辅助我们完成工作任务</li>\n</ol>\n<p>ChatGPT不仅可以解答我们的各种疑问，还可以基于我们的需要，辅助我们完成代码编程、内容翻译、文章创作的任务。</p>\n<h2 id=\"5H2W分析方法\"><a href=\"#5H2W分析方法\" class=\"headerlink\" title=\"5H2W分析方法\"></a>5H2W分析方法</h2><p>5H2W分析方法是一种用于解决问题和制定决策的系统性工具。这种方法通常包括以下五个关键要素（5H）和两个核心问题（2W），这些要素和问题协同工作，帮助人们深入了解问题，找到解决方案。即What（是什么？）、Why（为什么做？）、Who（谁来做？）、When（什么时候做？）、Where（在哪里做？）、How（怎么做？）</p>\n<h3 id=\"目的\"><a href=\"#目的\" class=\"headerlink\" title=\"目的\"></a>目的</h3><p>通过5W2H分析方法、帮助发现自身问题，并提出解决问题的方法。</p>\n<h3 id=\"优势\"><a href=\"#优势\" class=\"headerlink\" title=\"优势\"></a>优势</h3><ol>\n<li>可以帮助我们发现问题，并根据问题的线索找到解决问题的方法和思路。</li>\n<li>可以准确地找到问题的关键，减少不必要的查找问题的时间，从而提高工作效率。</li>\n</ol>\n<aside>\n⚠️ 通过ChatGPT和5H2W的组合，可以帮助我们更高效的找到问题的解决思路和方法。\n\n</aside>\n\n<h2 id=\"如何提问才能得到更高质量的答案？\"><a href=\"#如何提问才能得到更高质量的答案？\" class=\"headerlink\" title=\"如何提问才能得到更高质量的答案？\"></a>如何提问才能得到更高质量的答案？</h2><p><img src=\"http://qiniu-image.gotojava.cn/blog/2023-12-15-191028.png\" alt=\"Untitled\"></p>\n<p>盲区</p>\n<p>问法一：我想了解XXX，我应该向你问哪些问题？</p>\n<p>比如：我想快速了解人工智能行业，我应该向你问哪些问题？</p>\n<p>问法二：请给我列出XXX领域&#x2F;行业相关的，最常用的50个概念，并做简单解释。如果有英文缩写，请给出完整的英文解释。</p>\n<p>比如：请给我列出人工智能行业相关的最常用的50个概念，并做简单解释，如果有英文缩写，请给出完整的英文解释。</p>\n<p>问法三：请详细介绍一下XXX的主要生平事迹。请详细介绍一下XXX公司的发展历程。</p>\n<p>比如：请详细介绍一下艾隆·马斯克的主要生平事迹。请详细介绍一下Tesla公司的发展历程。</p>\n<h2 id=\"公开区\"><a href=\"#公开区\" class=\"headerlink\" title=\"公开区\"></a>公开区</h2><p>检验认知、扩充认知</p>\n<p>问法一：对于XXX主题&#x2F;技能，你认为哪些是我必须理解和掌握的核心要点？</p>\n<p>比如：对于掌握ChatGPT的使用技能，你认为哪些是我必须理解和掌握的核心要点？</p>\n<p>问法二：我理解的XXX是这样的，你觉得我的理解对吗？</p>\n<p>比如：我理解的ChatGPT是一个无所不知的博士，你觉得我的理解对吗？</p>\n<p>问法三：我对XXX有一些想法，你能帮我批判性地分析一下这些想法的优点和缺点吗？</p>\n<p>问法四：我正在考虑XXX的决定，你能帮我分析一下可能的结果和影响吗？</p>\n<p>问法五：我知道XXX的概念，我想知道更多关于XXX的信息。</p>\n<p>问法六：我在XXX问题上遇到了困难，你能提供一些可能的解决方案或建议吗？</p>\n<p>问法七：我想要深入学习XXX，你能推荐一些进阶的学习资源或学习路径吗？</p>\n<p>问法八：我想要在XXX领域有所创新，你能提供一些启发或者想法吗？</p>\n<p>问法九：我想在XXX领域提升自己，你能根据最新的研究和趋势给我一些建议吗？</p>\n<p>问法十：我正在学习xxx，你能给我一些关于这个领域未来发展的观点吗？</p>\n<p>问法十一：给出一些背景信息，我要做关于XXX的研究，我认为原因是，还有其他可能的原因吗？给出一些可能的研究假设。</p>\n<p>问法十二：我是一个XXX行业的新手，马上要采访这个行业的资深大佬，我应该向他请教哪些有价值的问题？</p>\n<h3 id=\"隐私区\"><a href=\"#隐私区\" class=\"headerlink\" title=\"隐私区\"></a>隐私区</h3><p>问法一：你怎么看待这种现象？</p>\n<p>问法二：可能的原因有哪些？</p>\n<p>问法三：这会对XXX产生什么样的影响？</p>\n<p>问法四：你觉得XXX应该怎么做？</p>\n<h3 id=\"未知区\"><a href=\"#未知区\" class=\"headerlink\" title=\"未知区\"></a>未知区</h3><p>问法一：如果xxx，这会对社会产生什么影响？</p>\n<p>比如：如果中国家庭都用上了ChatGPT，这对中国家教行业会有什么影响？</p>\n<h2 id=\"达克效应\"><a href=\"#达克效应\" class=\"headerlink\" title=\"达克效应\"></a>达克效应</h2><p><img src=\"http://qiniu-image.gotojava.cn/blog/2023-12-15-191031.png\" alt=\"Untitled\"></p>\n<aside>\n💡 达克效应是指在认知能力低下的人更容易高估自己的技能水平，同时也更容易低估他人的技能水平的现象。相对地，高水平的人可能低估自己的能力，因为他们可能认为别人对该领域的能力水平与他们自己相近。\n\n</aside>\n\n<h3 id=\"反向提问\"><a href=\"#反向提问\" class=\"headerlink\" title=\"反向提问\"></a>反向提问</h3><p>问法一：为了测试我对xxx的了解程度，你会问我什么问题来检验我的水平，最少10个。</p>\n<p>问法二：我是xxx领域的专家，你会问我哪些问题来检验我的专业水平？最少10个。</p>\n<p>问法三：现在我们玩个”你问我答“的游戏，目的是为了测试我在xxx方面的专业水平。你负责提问，我负责回答。你要根据我的答案进行反馈、评价、补充。如果我说不知道，你就直接输出正确答案，然后你继续提问。</p>\n<p>问法四：我已经很精通XXX了，我想知道我是否还有需要学习的地方？</p>\n<h2 id=\"应用性场景的提问\"><a href=\"#应用性场景的提问\" class=\"headerlink\" title=\"应用性场景的提问\"></a>应用性场景的提问</h2><ol>\n<li>知道自己要干什么，但是不知道ChatGPT能帮你什么</li>\n</ol>\n<p>问法：我想做xxxx，你能给我提供什么帮助？</p>\n<ol>\n<li>知道要ChatGPT帮你做什么，但是你不知道给它输入什么具体的信息。</li>\n</ol>\n<p>问法：我想要你xxx，我应该给你输入什么信息？</p>\n<ol>\n<li>直接给ChatGPT指令。任务目标、背景信息、输出要求都非常清晰。</li>\n</ol>\n<p>问法：</p>\n<ul>\n<li>请推荐（书名、电视剧、电影、网站、博主、专家、学习资源）…</li>\n<li>请翻译…</li>\n<li>请总结…</li>\n<li>请润色…</li>\n</ul>\n<p>比如：请推荐10个高质量的Java的youtuber，按照粉丝量从高到低排序，并给出他们的YouTube频道链接。</p>\n<h2 id=\"角色扮演式提问\"><a href=\"#角色扮演式提问\" class=\"headerlink\" title=\"角色扮演式提问\"></a>角色扮演式提问</h2><p>问法一：如果你是xxx，在某种情况下，xxx会说什么，会怎么想，会怎么看，会怎么做？</p>\n<p>问法二：你好，我是 [名人名字]。在我最近的电影中，有一场戏是关于 [某个情节] 的。你对这个场景有什么看法吗？</p>\n<p>问法三：您好，我是 [历史人物名字]。我在 [某个时期] 做了一些重要的决定。你认为这些决定对后来的历史产生了什么影响？</p>\n<p>问法四：[名人名字]，我听说你在 [某个事件] 中发表了重要言论。您能分享一下当时的思考和背后的原因吗？</p>\n<p>问法五：[名人名字]，在您的职业生涯中，您还有什么新的项目或计划吗？我们可以期待您的哪些新作品？</p>\n<p>问法六：[名人名字]，在您所在的领域，您认为目前有哪些令人兴奋或值得关注的行业动态？</p>\n","excerpt":"<meta name=\"referrer\" content=\"no-referrer\" />\n\n<p>本人将介绍一些ChatGPT的提问技巧，帮助我们更好的使用ChatGPT解决实际问题。</p>","more":"<h2 id=\"什么是ChatGPT？\"><a href=\"#什么是ChatGPT？\" class=\"headerlink\" title=\"什么是ChatGPT？\"></a>什么是ChatGPT？</h2><p>如果一个人对世界上的知识几乎无所不知，可以进行实时对话，它可以无条件的帮我去搜索信息、多语言编程、多语言写作、推理、共创。帮我们调用其他的软件完成实际的工作任务，这个的一个人可以扮演你的导师、翻译官、程序员、咨询顾问、搜索引擎。这么一个人就是ChatGPT。</p>\n<h2 id=\"ChatGPT的特点\"><a href=\"#ChatGPT的特点\" class=\"headerlink\" title=\"ChatGPT的特点\"></a>ChatGPT的特点</h2><ol>\n<li>直接给你答案</li>\n</ol>\n<p>通过我们提出的问题，ChatGPT可以直接出我们的答案。</p>\n<ol>\n<li>GPT能对话式交互</li>\n</ol>\n<p>Google只能我们去问他，ChatGPT可以像聊天一样进行对话。</p>\n<ol>\n<li>ChatGPT能辅助我们完成工作任务</li>\n</ol>\n<p>ChatGPT不仅可以解答我们的各种疑问，还可以基于我们的需要，辅助我们完成代码编程、内容翻译、文章创作的任务。</p>\n<h2 id=\"5H2W分析方法\"><a href=\"#5H2W分析方法\" class=\"headerlink\" title=\"5H2W分析方法\"></a>5H2W分析方法</h2><p>5H2W分析方法是一种用于解决问题和制定决策的系统性工具。这种方法通常包括以下五个关键要素（5H）和两个核心问题（2W），这些要素和问题协同工作，帮助人们深入了解问题，找到解决方案。即What（是什么？）、Why（为什么做？）、Who（谁来做？）、When（什么时候做？）、Where（在哪里做？）、How（怎么做？）</p>\n<h3 id=\"目的\"><a href=\"#目的\" class=\"headerlink\" title=\"目的\"></a>目的</h3><p>通过5W2H分析方法、帮助发现自身问题，并提出解决问题的方法。</p>\n<h3 id=\"优势\"><a href=\"#优势\" class=\"headerlink\" title=\"优势\"></a>优势</h3><ol>\n<li>可以帮助我们发现问题，并根据问题的线索找到解决问题的方法和思路。</li>\n<li>可以准确地找到问题的关键，减少不必要的查找问题的时间，从而提高工作效率。</li>\n</ol>\n<aside>\n⚠️ 通过ChatGPT和5H2W的组合，可以帮助我们更高效的找到问题的解决思路和方法。\n\n</aside>\n\n<h2 id=\"如何提问才能得到更高质量的答案？\"><a href=\"#如何提问才能得到更高质量的答案？\" class=\"headerlink\" title=\"如何提问才能得到更高质量的答案？\"></a>如何提问才能得到更高质量的答案？</h2><p><img src=\"http://qiniu-image.gotojava.cn/blog/2023-12-15-191028.png\" alt=\"Untitled\"></p>\n<p>盲区</p>\n<p>问法一：我想了解XXX，我应该向你问哪些问题？</p>\n<p>比如：我想快速了解人工智能行业，我应该向你问哪些问题？</p>\n<p>问法二：请给我列出XXX领域&#x2F;行业相关的，最常用的50个概念，并做简单解释。如果有英文缩写，请给出完整的英文解释。</p>\n<p>比如：请给我列出人工智能行业相关的最常用的50个概念，并做简单解释，如果有英文缩写，请给出完整的英文解释。</p>\n<p>问法三：请详细介绍一下XXX的主要生平事迹。请详细介绍一下XXX公司的发展历程。</p>\n<p>比如：请详细介绍一下艾隆·马斯克的主要生平事迹。请详细介绍一下Tesla公司的发展历程。</p>\n<h2 id=\"公开区\"><a href=\"#公开区\" class=\"headerlink\" title=\"公开区\"></a>公开区</h2><p>检验认知、扩充认知</p>\n<p>问法一：对于XXX主题&#x2F;技能，你认为哪些是我必须理解和掌握的核心要点？</p>\n<p>比如：对于掌握ChatGPT的使用技能，你认为哪些是我必须理解和掌握的核心要点？</p>\n<p>问法二：我理解的XXX是这样的，你觉得我的理解对吗？</p>\n<p>比如：我理解的ChatGPT是一个无所不知的博士，你觉得我的理解对吗？</p>\n<p>问法三：我对XXX有一些想法，你能帮我批判性地分析一下这些想法的优点和缺点吗？</p>\n<p>问法四：我正在考虑XXX的决定，你能帮我分析一下可能的结果和影响吗？</p>\n<p>问法五：我知道XXX的概念，我想知道更多关于XXX的信息。</p>\n<p>问法六：我在XXX问题上遇到了困难，你能提供一些可能的解决方案或建议吗？</p>\n<p>问法七：我想要深入学习XXX，你能推荐一些进阶的学习资源或学习路径吗？</p>\n<p>问法八：我想要在XXX领域有所创新，你能提供一些启发或者想法吗？</p>\n<p>问法九：我想在XXX领域提升自己，你能根据最新的研究和趋势给我一些建议吗？</p>\n<p>问法十：我正在学习xxx，你能给我一些关于这个领域未来发展的观点吗？</p>\n<p>问法十一：给出一些背景信息，我要做关于XXX的研究，我认为原因是，还有其他可能的原因吗？给出一些可能的研究假设。</p>\n<p>问法十二：我是一个XXX行业的新手，马上要采访这个行业的资深大佬，我应该向他请教哪些有价值的问题？</p>\n<h3 id=\"隐私区\"><a href=\"#隐私区\" class=\"headerlink\" title=\"隐私区\"></a>隐私区</h3><p>问法一：你怎么看待这种现象？</p>\n<p>问法二：可能的原因有哪些？</p>\n<p>问法三：这会对XXX产生什么样的影响？</p>\n<p>问法四：你觉得XXX应该怎么做？</p>\n<h3 id=\"未知区\"><a href=\"#未知区\" class=\"headerlink\" title=\"未知区\"></a>未知区</h3><p>问法一：如果xxx，这会对社会产生什么影响？</p>\n<p>比如：如果中国家庭都用上了ChatGPT，这对中国家教行业会有什么影响？</p>\n<h2 id=\"达克效应\"><a href=\"#达克效应\" class=\"headerlink\" title=\"达克效应\"></a>达克效应</h2><p><img src=\"http://qiniu-image.gotojava.cn/blog/2023-12-15-191031.png\" alt=\"Untitled\"></p>\n<aside>\n💡 达克效应是指在认知能力低下的人更容易高估自己的技能水平，同时也更容易低估他人的技能水平的现象。相对地，高水平的人可能低估自己的能力，因为他们可能认为别人对该领域的能力水平与他们自己相近。\n\n</aside>\n\n<h3 id=\"反向提问\"><a href=\"#反向提问\" class=\"headerlink\" title=\"反向提问\"></a>反向提问</h3><p>问法一：为了测试我对xxx的了解程度，你会问我什么问题来检验我的水平，最少10个。</p>\n<p>问法二：我是xxx领域的专家，你会问我哪些问题来检验我的专业水平？最少10个。</p>\n<p>问法三：现在我们玩个”你问我答“的游戏，目的是为了测试我在xxx方面的专业水平。你负责提问，我负责回答。你要根据我的答案进行反馈、评价、补充。如果我说不知道，你就直接输出正确答案，然后你继续提问。</p>\n<p>问法四：我已经很精通XXX了，我想知道我是否还有需要学习的地方？</p>\n<h2 id=\"应用性场景的提问\"><a href=\"#应用性场景的提问\" class=\"headerlink\" title=\"应用性场景的提问\"></a>应用性场景的提问</h2><ol>\n<li>知道自己要干什么，但是不知道ChatGPT能帮你什么</li>\n</ol>\n<p>问法：我想做xxxx，你能给我提供什么帮助？</p>\n<ol>\n<li>知道要ChatGPT帮你做什么，但是你不知道给它输入什么具体的信息。</li>\n</ol>\n<p>问法：我想要你xxx，我应该给你输入什么信息？</p>\n<ol>\n<li>直接给ChatGPT指令。任务目标、背景信息、输出要求都非常清晰。</li>\n</ol>\n<p>问法：</p>\n<ul>\n<li>请推荐（书名、电视剧、电影、网站、博主、专家、学习资源）…</li>\n<li>请翻译…</li>\n<li>请总结…</li>\n<li>请润色…</li>\n</ul>\n<p>比如：请推荐10个高质量的Java的youtuber，按照粉丝量从高到低排序，并给出他们的YouTube频道链接。</p>\n<h2 id=\"角色扮演式提问\"><a href=\"#角色扮演式提问\" class=\"headerlink\" title=\"角色扮演式提问\"></a>角色扮演式提问</h2><p>问法一：如果你是xxx，在某种情况下，xxx会说什么，会怎么想，会怎么看，会怎么做？</p>\n<p>问法二：你好，我是 [名人名字]。在我最近的电影中，有一场戏是关于 [某个情节] 的。你对这个场景有什么看法吗？</p>\n<p>问法三：您好，我是 [历史人物名字]。我在 [某个时期] 做了一些重要的决定。你认为这些决定对后来的历史产生了什么影响？</p>\n<p>问法四：[名人名字]，我听说你在 [某个事件] 中发表了重要言论。您能分享一下当时的思考和背后的原因吗？</p>\n<p>问法五：[名人名字]，在您的职业生涯中，您还有什么新的项目或计划吗？我们可以期待您的哪些新作品？</p>\n<p>问法六：[名人名字]，在您所在的领域，您认为目前有哪些令人兴奋或值得关注的行业动态？</p>"},{"title":"使用Rsyslog归集系统日志","abbrlink":"1836dc99","date":"2023-08-25T02:33:57.000Z","toc":true,"_content":"<meta name=\"referrer\" content=\"no-referrer\" />\n\n因为项目需要对私有云服务器的日志进行归集，以方便后续对日志进行分析处理。结合项目的实际需求研究了一下Rsyslog的基本使用并进行了有效性的验证，在此对实现过程进行一个记录\n\n<!--more-->\n\n## Rsyslog是什么？\n\n> Rsyslog是一个极快日志处理系统，能够接受来自各种来源的输入，对其进行转换，并将结果输出到不同的目的地。\n\n## 测试环境说明\n\n操作系统：`统信UOS20企业版`\n\n测试服务器IP：`172.25.16.29`\n\n测试客户端IP：`172.25.16.34`\n\n## 服务端配置\n\n> 启动UDP传输并进行端口监听\n\n修改 `/etc/rsyslog.conf`文件，如果没有则添加如下内容\n\n![image-20230825160221797](http://qiniu-image.gotojava.cn/blog/2023-12-15-191033.png)\n\n```\n$ModLoad imudp\n$UDPServerRun 514\n```\n\n> 创建default.conf配置文件\n\n在 `/etc/rsyslog.d/`目录下创建 `default.conf`文件，并加入如下内容：\n\n```shell\n# Use default timestamp format  # 使用自定义的格式\n$ActionFileDefaultTemplate RSYSLOG_TraditionalFileFormat\n# 定义日志模板，日志显示格式如下：\n# %$now%：当前日期，格式：2023-08-23，\n# %timestamp:8:15%：当前时间戳：时:分:秒，\n# %hostname%：主机名\n# %FROMHOST-IP%：客户端IP\n# %syslogfacility-text%：客户端日志类型\n#    auth         #pam产生的日志，认证日志\n#    authpriv     #ssh,ftp等登录信息的验证信息，认证授权认证\n#    cron         #时间任务相关\n#    kern         #内核\n#    lpr          #打印\n#    mail         #邮件\n#    mark(syslog) #rsyslog服务内部的信息,时间标识\n#    news         #新闻组\n#    user         #用户程序产生的相关信息\n#    uucp         #unix to unix copy, unix主机之间相关的通讯\n#    local 1~7    #自定义的日志设备\n# %syslogseverity-text%：客户端日志级别\n#    debug           #有调式信息的，日志信息最多\n#    info            #一般信息的日志，最常用\n#    notice          #最具有重要性的普通条件的信息\n#    warning, warn   #警告级别\n#    err, error      #错误级别，阻止某个功能或者模块不能正常工作的信息\n#    crit            #严重级别，阻止整个系统或者整个软件不能正常工作的信息\n#    alert           #需要立刻修改的信息\n#    emerg, panic    #内核崩溃等严重信息\n# %app-name%：客户端执行的程序名\n# %msg%：消息体\n$template myFormat,\"%$now% %timestamp:8:15% | %hostname%@%FROMHOST-IP% | %syslogfacility-text% | %syslogseverity-text% | %app-name% | %msg%\\n\"\n$ActionFileDefaultTemplate myFormat   \n# 根据客户端的IP单独存放主机日志在不同目录，/data/rsyslog-bak需要手动创建\n$template RemoteLogs,\"/data/rsyslog-bak/%fromhost-ip%/%fromhost-ip%_%$YEAR%-%$MONTH%-%$DAY%.log\"\n# 排除本地主机IP日志记录，只记录远程主机日志\n:fromhost-ip, !isequal, \"127.0.0.1\" ?RemoteLogs\n# 忽略之前所有的日志，远程主机日志记录完之后不再继续往下记录\n& ~\n```\n\n> 重启服务端rsyslog服务\n\n```\nsystemctl restart rsyslog\n```\n\n## 客户端配置\n\n修改 `/etc/rsyslog.conf`配置文件\n\n```shell\n# 若启用UDP进行传输，则取消下面两行的注释，如果没有则添加到modules下\nmodule(load=\"imudp\")\ninput(type=\"imudp\" port=\"514\")\n\n或加入如下内容\n$ModLoad imudp\n$UDPServerRun 514\n\n#使用UDP传输所有日志到日志服务器（在末尾添加如下内容）\n*.*    @172.25.16.29\n```\n\n> 重启服务端rsyslog服务\n\n```\nsystemctl restart rsyslog\n```\n\n## 测试\n\n> 日期生成\n\n![image-20230825210852478](http://qiniu-image.gotojava.cn/blog/2023-12-15-191035.png)\n\n![image-20230825160343801](http://qiniu-image.gotojava.cn/blog/2023-12-15-191037.png)\n\n> 客户端生成日志\n\n```shell\nlogger \"rsyslog test\"\n```\n\n![image-20230825161141448](http://qiniu-image.gotojava.cn/blog/2023-12-15-191040.png)\n\n> 服务端监控输出\n\n```shell\ntail -20f /rsyslog-bak/172.25.16.34/172.25.16.34_2023-08-25.log\n```\n\n![image-20230825161233634](http://qiniu-image.gotojava.cn/blog/2023-12-15-191042.png)\n","source":"_posts/使用rsyslog归集系统日志.md","raw":"---\ntitle: 使用Rsyslog归集系统日志\ncategories:\n  - 开发者笔记\ntags:\n  - Linux\nabbrlink: 1836dc99\ndate: 2023-08-25 02:33:57\ntoc: true\n---\n<meta name=\"referrer\" content=\"no-referrer\" />\n\n因为项目需要对私有云服务器的日志进行归集，以方便后续对日志进行分析处理。结合项目的实际需求研究了一下Rsyslog的基本使用并进行了有效性的验证，在此对实现过程进行一个记录\n\n<!--more-->\n\n## Rsyslog是什么？\n\n> Rsyslog是一个极快日志处理系统，能够接受来自各种来源的输入，对其进行转换，并将结果输出到不同的目的地。\n\n## 测试环境说明\n\n操作系统：`统信UOS20企业版`\n\n测试服务器IP：`172.25.16.29`\n\n测试客户端IP：`172.25.16.34`\n\n## 服务端配置\n\n> 启动UDP传输并进行端口监听\n\n修改 `/etc/rsyslog.conf`文件，如果没有则添加如下内容\n\n![image-20230825160221797](http://qiniu-image.gotojava.cn/blog/2023-12-15-191033.png)\n\n```\n$ModLoad imudp\n$UDPServerRun 514\n```\n\n> 创建default.conf配置文件\n\n在 `/etc/rsyslog.d/`目录下创建 `default.conf`文件，并加入如下内容：\n\n```shell\n# Use default timestamp format  # 使用自定义的格式\n$ActionFileDefaultTemplate RSYSLOG_TraditionalFileFormat\n# 定义日志模板，日志显示格式如下：\n# %$now%：当前日期，格式：2023-08-23，\n# %timestamp:8:15%：当前时间戳：时:分:秒，\n# %hostname%：主机名\n# %FROMHOST-IP%：客户端IP\n# %syslogfacility-text%：客户端日志类型\n#    auth         #pam产生的日志，认证日志\n#    authpriv     #ssh,ftp等登录信息的验证信息，认证授权认证\n#    cron         #时间任务相关\n#    kern         #内核\n#    lpr          #打印\n#    mail         #邮件\n#    mark(syslog) #rsyslog服务内部的信息,时间标识\n#    news         #新闻组\n#    user         #用户程序产生的相关信息\n#    uucp         #unix to unix copy, unix主机之间相关的通讯\n#    local 1~7    #自定义的日志设备\n# %syslogseverity-text%：客户端日志级别\n#    debug           #有调式信息的，日志信息最多\n#    info            #一般信息的日志，最常用\n#    notice          #最具有重要性的普通条件的信息\n#    warning, warn   #警告级别\n#    err, error      #错误级别，阻止某个功能或者模块不能正常工作的信息\n#    crit            #严重级别，阻止整个系统或者整个软件不能正常工作的信息\n#    alert           #需要立刻修改的信息\n#    emerg, panic    #内核崩溃等严重信息\n# %app-name%：客户端执行的程序名\n# %msg%：消息体\n$template myFormat,\"%$now% %timestamp:8:15% | %hostname%@%FROMHOST-IP% | %syslogfacility-text% | %syslogseverity-text% | %app-name% | %msg%\\n\"\n$ActionFileDefaultTemplate myFormat   \n# 根据客户端的IP单独存放主机日志在不同目录，/data/rsyslog-bak需要手动创建\n$template RemoteLogs,\"/data/rsyslog-bak/%fromhost-ip%/%fromhost-ip%_%$YEAR%-%$MONTH%-%$DAY%.log\"\n# 排除本地主机IP日志记录，只记录远程主机日志\n:fromhost-ip, !isequal, \"127.0.0.1\" ?RemoteLogs\n# 忽略之前所有的日志，远程主机日志记录完之后不再继续往下记录\n& ~\n```\n\n> 重启服务端rsyslog服务\n\n```\nsystemctl restart rsyslog\n```\n\n## 客户端配置\n\n修改 `/etc/rsyslog.conf`配置文件\n\n```shell\n# 若启用UDP进行传输，则取消下面两行的注释，如果没有则添加到modules下\nmodule(load=\"imudp\")\ninput(type=\"imudp\" port=\"514\")\n\n或加入如下内容\n$ModLoad imudp\n$UDPServerRun 514\n\n#使用UDP传输所有日志到日志服务器（在末尾添加如下内容）\n*.*    @172.25.16.29\n```\n\n> 重启服务端rsyslog服务\n\n```\nsystemctl restart rsyslog\n```\n\n## 测试\n\n> 日期生成\n\n![image-20230825210852478](http://qiniu-image.gotojava.cn/blog/2023-12-15-191035.png)\n\n![image-20230825160343801](http://qiniu-image.gotojava.cn/blog/2023-12-15-191037.png)\n\n> 客户端生成日志\n\n```shell\nlogger \"rsyslog test\"\n```\n\n![image-20230825161141448](http://qiniu-image.gotojava.cn/blog/2023-12-15-191040.png)\n\n> 服务端监控输出\n\n```shell\ntail -20f /rsyslog-bak/172.25.16.34/172.25.16.34_2023-08-25.log\n```\n\n![image-20230825161233634](http://qiniu-image.gotojava.cn/blog/2023-12-15-191042.png)\n","slug":"使用rsyslog归集系统日志","published":1,"updated":"2025-03-28T06:10:02.971Z","comments":1,"layout":"post","photos":[],"_id":"cm8se3tds001cbb8lebdgb6f1","content":"<meta name=\"referrer\" content=\"no-referrer\" />\n\n<p>因为项目需要对私有云服务器的日志进行归集，以方便后续对日志进行分析处理。结合项目的实际需求研究了一下Rsyslog的基本使用并进行了有效性的验证，在此对实现过程进行一个记录</p>\n<span id=\"more\"></span>\n\n<h2 id=\"Rsyslog是什么？\"><a href=\"#Rsyslog是什么？\" class=\"headerlink\" title=\"Rsyslog是什么？\"></a>Rsyslog是什么？</h2><blockquote>\n<p>Rsyslog是一个极快日志处理系统，能够接受来自各种来源的输入，对其进行转换，并将结果输出到不同的目的地。</p>\n</blockquote>\n<h2 id=\"测试环境说明\"><a href=\"#测试环境说明\" class=\"headerlink\" title=\"测试环境说明\"></a>测试环境说明</h2><p>操作系统：<code>统信UOS20企业版</code></p>\n<p>测试服务器IP：<code>172.25.16.29</code></p>\n<p>测试客户端IP：<code>172.25.16.34</code></p>\n<h2 id=\"服务端配置\"><a href=\"#服务端配置\" class=\"headerlink\" title=\"服务端配置\"></a>服务端配置</h2><blockquote>\n<p>启动UDP传输并进行端口监听</p>\n</blockquote>\n<p>修改 <code>/etc/rsyslog.conf</code>文件，如果没有则添加如下内容</p>\n<p><img src=\"http://qiniu-image.gotojava.cn/blog/2023-12-15-191033.png\" alt=\"image-20230825160221797\"></p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">$ModLoad imudp</span><br><span class=\"line\">$UDPServerRun 514</span><br></pre></td></tr></table></figure>\n\n<blockquote>\n<p>创建default.conf配置文件</p>\n</blockquote>\n<p>在 <code>/etc/rsyslog.d/</code>目录下创建 <code>default.conf</code>文件，并加入如下内容：</p>\n<figure class=\"highlight shell\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br><span class=\"line\">38</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"meta prompt_\"># </span><span class=\"language-bash\">Use default timestamp format  <span class=\"comment\"># 使用自定义的格式</span></span></span><br><span class=\"line\"><span class=\"meta prompt_\">$</span><span class=\"language-bash\">ActionFileDefaultTemplate RSYSLOG_TraditionalFileFormat</span></span><br><span class=\"line\"><span class=\"meta prompt_\"># </span><span class=\"language-bash\">定义日志模板，日志显示格式如下：</span></span><br><span class=\"line\"><span class=\"meta prompt_\"># </span><span class=\"language-bash\">%<span class=\"variable\">$now</span>%：当前日期，格式：2023-08-23，</span></span><br><span class=\"line\"><span class=\"meta prompt_\"># </span><span class=\"language-bash\">%timestamp:8:15%：当前时间戳：时:分:秒，</span></span><br><span class=\"line\"><span class=\"meta prompt_\"># </span><span class=\"language-bash\">%hostname%：主机名</span></span><br><span class=\"line\"><span class=\"meta prompt_\"># </span><span class=\"language-bash\">%FROMHOST-IP%：客户端IP</span></span><br><span class=\"line\"><span class=\"meta prompt_\"># </span><span class=\"language-bash\">%syslogfacility-text%：客户端日志类型</span></span><br><span class=\"line\"><span class=\"meta prompt_\"># </span><span class=\"language-bash\">   auth         <span class=\"comment\">#pam产生的日志，认证日志</span></span></span><br><span class=\"line\"><span class=\"meta prompt_\"># </span><span class=\"language-bash\">   authpriv     <span class=\"comment\">#ssh,ftp等登录信息的验证信息，认证授权认证</span></span></span><br><span class=\"line\"><span class=\"meta prompt_\"># </span><span class=\"language-bash\">   cron         <span class=\"comment\">#时间任务相关</span></span></span><br><span class=\"line\"><span class=\"meta prompt_\"># </span><span class=\"language-bash\">   kern         <span class=\"comment\">#内核</span></span></span><br><span class=\"line\"><span class=\"meta prompt_\"># </span><span class=\"language-bash\">   lpr          <span class=\"comment\">#打印</span></span></span><br><span class=\"line\"><span class=\"meta prompt_\"># </span><span class=\"language-bash\">   mail         <span class=\"comment\">#邮件</span></span></span><br><span class=\"line\"><span class=\"meta prompt_\"># </span><span class=\"language-bash\">   mark(syslog) <span class=\"comment\">#rsyslog服务内部的信息,时间标识</span></span></span><br><span class=\"line\"><span class=\"meta prompt_\"># </span><span class=\"language-bash\">   news         <span class=\"comment\">#新闻组</span></span></span><br><span class=\"line\"><span class=\"meta prompt_\"># </span><span class=\"language-bash\">   user         <span class=\"comment\">#用户程序产生的相关信息</span></span></span><br><span class=\"line\"><span class=\"meta prompt_\"># </span><span class=\"language-bash\">   uucp         <span class=\"comment\">#unix to unix copy, unix主机之间相关的通讯</span></span></span><br><span class=\"line\"><span class=\"meta prompt_\"># </span><span class=\"language-bash\">   <span class=\"built_in\">local</span> 1~7    <span class=\"comment\">#自定义的日志设备</span></span></span><br><span class=\"line\"><span class=\"meta prompt_\"># </span><span class=\"language-bash\">%syslogseverity-text%：客户端日志级别</span></span><br><span class=\"line\"><span class=\"meta prompt_\"># </span><span class=\"language-bash\">   debug           <span class=\"comment\">#有调式信息的，日志信息最多</span></span></span><br><span class=\"line\"><span class=\"meta prompt_\"># </span><span class=\"language-bash\">   info            <span class=\"comment\">#一般信息的日志，最常用</span></span></span><br><span class=\"line\"><span class=\"meta prompt_\"># </span><span class=\"language-bash\">   notice          <span class=\"comment\">#最具有重要性的普通条件的信息</span></span></span><br><span class=\"line\"><span class=\"meta prompt_\"># </span><span class=\"language-bash\">   warning, warn   <span class=\"comment\">#警告级别</span></span></span><br><span class=\"line\"><span class=\"meta prompt_\"># </span><span class=\"language-bash\">   err, error      <span class=\"comment\">#错误级别，阻止某个功能或者模块不能正常工作的信息</span></span></span><br><span class=\"line\"><span class=\"meta prompt_\"># </span><span class=\"language-bash\">   crit            <span class=\"comment\">#严重级别，阻止整个系统或者整个软件不能正常工作的信息</span></span></span><br><span class=\"line\"><span class=\"meta prompt_\"># </span><span class=\"language-bash\">   alert           <span class=\"comment\">#需要立刻修改的信息</span></span></span><br><span class=\"line\"><span class=\"meta prompt_\"># </span><span class=\"language-bash\">   emerg, panic    <span class=\"comment\">#内核崩溃等严重信息</span></span></span><br><span class=\"line\"><span class=\"meta prompt_\"># </span><span class=\"language-bash\">%app-name%：客户端执行的程序名</span></span><br><span class=\"line\"><span class=\"meta prompt_\"># </span><span class=\"language-bash\">%msg%：消息体</span></span><br><span class=\"line\"><span class=\"meta prompt_\">$</span><span class=\"language-bash\">template myFormat,<span class=\"string\">&quot;%<span class=\"variable\">$now</span>% %timestamp:8:15% | %hostname%@%FROMHOST-IP% | %syslogfacility-text% | %syslogseverity-text% | %app-name% | %msg%\\n&quot;</span></span></span><br><span class=\"line\"><span class=\"meta prompt_\">$</span><span class=\"language-bash\">ActionFileDefaultTemplate myFormat</span>   </span><br><span class=\"line\"><span class=\"meta prompt_\"># </span><span class=\"language-bash\">根据客户端的IP单独存放主机日志在不同目录，/data/rsyslog-bak需要手动创建</span></span><br><span class=\"line\"><span class=\"meta prompt_\">$</span><span class=\"language-bash\">template RemoteLogs,<span class=\"string\">&quot;/data/rsyslog-bak/%fromhost-ip%/%fromhost-ip%_%<span class=\"variable\">$YEAR</span>%-%<span class=\"variable\">$MONTH</span>%-%<span class=\"variable\">$DAY</span>%.log&quot;</span></span></span><br><span class=\"line\"><span class=\"meta prompt_\"># </span><span class=\"language-bash\">排除本地主机IP日志记录，只记录远程主机日志</span></span><br><span class=\"line\">:fromhost-ip, !isequal, &quot;127.0.0.1&quot; ?RemoteLogs</span><br><span class=\"line\"><span class=\"meta prompt_\"># </span><span class=\"language-bash\">忽略之前所有的日志，远程主机日志记录完之后不再继续往下记录</span></span><br><span class=\"line\">&amp; ~</span><br></pre></td></tr></table></figure>\n\n<blockquote>\n<p>重启服务端rsyslog服务</p>\n</blockquote>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">systemctl restart rsyslog</span><br></pre></td></tr></table></figure>\n\n<h2 id=\"客户端配置\"><a href=\"#客户端配置\" class=\"headerlink\" title=\"客户端配置\"></a>客户端配置</h2><p>修改 <code>/etc/rsyslog.conf</code>配置文件</p>\n<figure class=\"highlight shell\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"meta prompt_\"># </span><span class=\"language-bash\">若启用UDP进行传输，则取消下面两行的注释，如果没有则添加到modules下</span></span><br><span class=\"line\">module(load=&quot;imudp&quot;)</span><br><span class=\"line\">input(type=&quot;imudp&quot; port=&quot;514&quot;)</span><br><span class=\"line\"></span><br><span class=\"line\">或加入如下内容</span><br><span class=\"line\"><span class=\"meta prompt_\">$</span><span class=\"language-bash\">ModLoad imudp</span></span><br><span class=\"line\"><span class=\"meta prompt_\">$</span><span class=\"language-bash\">UDPServerRun 514</span></span><br><span class=\"line\"><span class=\"meta prompt_\"></span></span><br><span class=\"line\"><span class=\"meta prompt_\">#</span><span class=\"language-bash\">使用UDP传输所有日志到日志服务器（在末尾添加如下内容）</span></span><br><span class=\"line\">*.*    @172.25.16.29</span><br></pre></td></tr></table></figure>\n\n<blockquote>\n<p>重启服务端rsyslog服务</p>\n</blockquote>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">systemctl restart rsyslog</span><br></pre></td></tr></table></figure>\n\n<h2 id=\"测试\"><a href=\"#测试\" class=\"headerlink\" title=\"测试\"></a>测试</h2><blockquote>\n<p>日期生成</p>\n</blockquote>\n<p><img src=\"http://qiniu-image.gotojava.cn/blog/2023-12-15-191035.png\" alt=\"image-20230825210852478\"></p>\n<p><img src=\"http://qiniu-image.gotojava.cn/blog/2023-12-15-191037.png\" alt=\"image-20230825160343801\"></p>\n<blockquote>\n<p>客户端生成日志</p>\n</blockquote>\n<figure class=\"highlight shell\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">logger &quot;rsyslog test&quot;</span><br></pre></td></tr></table></figure>\n\n<p><img src=\"http://qiniu-image.gotojava.cn/blog/2023-12-15-191040.png\" alt=\"image-20230825161141448\"></p>\n<blockquote>\n<p>服务端监控输出</p>\n</blockquote>\n<figure class=\"highlight shell\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">tail -20f /rsyslog-bak/172.25.16.34/172.25.16.34_2023-08-25.log</span><br></pre></td></tr></table></figure>\n\n<p><img src=\"http://qiniu-image.gotojava.cn/blog/2023-12-15-191042.png\" alt=\"image-20230825161233634\"></p>\n","excerpt":"<meta name=\"referrer\" content=\"no-referrer\" />\n\n<p>因为项目需要对私有云服务器的日志进行归集，以方便后续对日志进行分析处理。结合项目的实际需求研究了一下Rsyslog的基本使用并进行了有效性的验证，在此对实现过程进行一个记录</p>","more":"<h2 id=\"Rsyslog是什么？\"><a href=\"#Rsyslog是什么？\" class=\"headerlink\" title=\"Rsyslog是什么？\"></a>Rsyslog是什么？</h2><blockquote>\n<p>Rsyslog是一个极快日志处理系统，能够接受来自各种来源的输入，对其进行转换，并将结果输出到不同的目的地。</p>\n</blockquote>\n<h2 id=\"测试环境说明\"><a href=\"#测试环境说明\" class=\"headerlink\" title=\"测试环境说明\"></a>测试环境说明</h2><p>操作系统：<code>统信UOS20企业版</code></p>\n<p>测试服务器IP：<code>172.25.16.29</code></p>\n<p>测试客户端IP：<code>172.25.16.34</code></p>\n<h2 id=\"服务端配置\"><a href=\"#服务端配置\" class=\"headerlink\" title=\"服务端配置\"></a>服务端配置</h2><blockquote>\n<p>启动UDP传输并进行端口监听</p>\n</blockquote>\n<p>修改 <code>/etc/rsyslog.conf</code>文件，如果没有则添加如下内容</p>\n<p><img src=\"http://qiniu-image.gotojava.cn/blog/2023-12-15-191033.png\" alt=\"image-20230825160221797\"></p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">$ModLoad imudp</span><br><span class=\"line\">$UDPServerRun 514</span><br></pre></td></tr></table></figure>\n\n<blockquote>\n<p>创建default.conf配置文件</p>\n</blockquote>\n<p>在 <code>/etc/rsyslog.d/</code>目录下创建 <code>default.conf</code>文件，并加入如下内容：</p>\n<figure class=\"highlight shell\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br><span class=\"line\">38</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"meta prompt_\"># </span><span class=\"language-bash\">Use default timestamp format  <span class=\"comment\"># 使用自定义的格式</span></span></span><br><span class=\"line\"><span class=\"meta prompt_\">$</span><span class=\"language-bash\">ActionFileDefaultTemplate RSYSLOG_TraditionalFileFormat</span></span><br><span class=\"line\"><span class=\"meta prompt_\"># </span><span class=\"language-bash\">定义日志模板，日志显示格式如下：</span></span><br><span class=\"line\"><span class=\"meta prompt_\"># </span><span class=\"language-bash\">%<span class=\"variable\">$now</span>%：当前日期，格式：2023-08-23，</span></span><br><span class=\"line\"><span class=\"meta prompt_\"># </span><span class=\"language-bash\">%timestamp:8:15%：当前时间戳：时:分:秒，</span></span><br><span class=\"line\"><span class=\"meta prompt_\"># </span><span class=\"language-bash\">%hostname%：主机名</span></span><br><span class=\"line\"><span class=\"meta prompt_\"># </span><span class=\"language-bash\">%FROMHOST-IP%：客户端IP</span></span><br><span class=\"line\"><span class=\"meta prompt_\"># </span><span class=\"language-bash\">%syslogfacility-text%：客户端日志类型</span></span><br><span class=\"line\"><span class=\"meta prompt_\"># </span><span class=\"language-bash\">   auth         <span class=\"comment\">#pam产生的日志，认证日志</span></span></span><br><span class=\"line\"><span class=\"meta prompt_\"># </span><span class=\"language-bash\">   authpriv     <span class=\"comment\">#ssh,ftp等登录信息的验证信息，认证授权认证</span></span></span><br><span class=\"line\"><span class=\"meta prompt_\"># </span><span class=\"language-bash\">   cron         <span class=\"comment\">#时间任务相关</span></span></span><br><span class=\"line\"><span class=\"meta prompt_\"># </span><span class=\"language-bash\">   kern         <span class=\"comment\">#内核</span></span></span><br><span class=\"line\"><span class=\"meta prompt_\"># </span><span class=\"language-bash\">   lpr          <span class=\"comment\">#打印</span></span></span><br><span class=\"line\"><span class=\"meta prompt_\"># </span><span class=\"language-bash\">   mail         <span class=\"comment\">#邮件</span></span></span><br><span class=\"line\"><span class=\"meta prompt_\"># </span><span class=\"language-bash\">   mark(syslog) <span class=\"comment\">#rsyslog服务内部的信息,时间标识</span></span></span><br><span class=\"line\"><span class=\"meta prompt_\"># </span><span class=\"language-bash\">   news         <span class=\"comment\">#新闻组</span></span></span><br><span class=\"line\"><span class=\"meta prompt_\"># </span><span class=\"language-bash\">   user         <span class=\"comment\">#用户程序产生的相关信息</span></span></span><br><span class=\"line\"><span class=\"meta prompt_\"># </span><span class=\"language-bash\">   uucp         <span class=\"comment\">#unix to unix copy, unix主机之间相关的通讯</span></span></span><br><span class=\"line\"><span class=\"meta prompt_\"># </span><span class=\"language-bash\">   <span class=\"built_in\">local</span> 1~7    <span class=\"comment\">#自定义的日志设备</span></span></span><br><span class=\"line\"><span class=\"meta prompt_\"># </span><span class=\"language-bash\">%syslogseverity-text%：客户端日志级别</span></span><br><span class=\"line\"><span class=\"meta prompt_\"># </span><span class=\"language-bash\">   debug           <span class=\"comment\">#有调式信息的，日志信息最多</span></span></span><br><span class=\"line\"><span class=\"meta prompt_\"># </span><span class=\"language-bash\">   info            <span class=\"comment\">#一般信息的日志，最常用</span></span></span><br><span class=\"line\"><span class=\"meta prompt_\"># </span><span class=\"language-bash\">   notice          <span class=\"comment\">#最具有重要性的普通条件的信息</span></span></span><br><span class=\"line\"><span class=\"meta prompt_\"># </span><span class=\"language-bash\">   warning, warn   <span class=\"comment\">#警告级别</span></span></span><br><span class=\"line\"><span class=\"meta prompt_\"># </span><span class=\"language-bash\">   err, error      <span class=\"comment\">#错误级别，阻止某个功能或者模块不能正常工作的信息</span></span></span><br><span class=\"line\"><span class=\"meta prompt_\"># </span><span class=\"language-bash\">   crit            <span class=\"comment\">#严重级别，阻止整个系统或者整个软件不能正常工作的信息</span></span></span><br><span class=\"line\"><span class=\"meta prompt_\"># </span><span class=\"language-bash\">   alert           <span class=\"comment\">#需要立刻修改的信息</span></span></span><br><span class=\"line\"><span class=\"meta prompt_\"># </span><span class=\"language-bash\">   emerg, panic    <span class=\"comment\">#内核崩溃等严重信息</span></span></span><br><span class=\"line\"><span class=\"meta prompt_\"># </span><span class=\"language-bash\">%app-name%：客户端执行的程序名</span></span><br><span class=\"line\"><span class=\"meta prompt_\"># </span><span class=\"language-bash\">%msg%：消息体</span></span><br><span class=\"line\"><span class=\"meta prompt_\">$</span><span class=\"language-bash\">template myFormat,<span class=\"string\">&quot;%<span class=\"variable\">$now</span>% %timestamp:8:15% | %hostname%@%FROMHOST-IP% | %syslogfacility-text% | %syslogseverity-text% | %app-name% | %msg%\\n&quot;</span></span></span><br><span class=\"line\"><span class=\"meta prompt_\">$</span><span class=\"language-bash\">ActionFileDefaultTemplate myFormat</span>   </span><br><span class=\"line\"><span class=\"meta prompt_\"># </span><span class=\"language-bash\">根据客户端的IP单独存放主机日志在不同目录，/data/rsyslog-bak需要手动创建</span></span><br><span class=\"line\"><span class=\"meta prompt_\">$</span><span class=\"language-bash\">template RemoteLogs,<span class=\"string\">&quot;/data/rsyslog-bak/%fromhost-ip%/%fromhost-ip%_%<span class=\"variable\">$YEAR</span>%-%<span class=\"variable\">$MONTH</span>%-%<span class=\"variable\">$DAY</span>%.log&quot;</span></span></span><br><span class=\"line\"><span class=\"meta prompt_\"># </span><span class=\"language-bash\">排除本地主机IP日志记录，只记录远程主机日志</span></span><br><span class=\"line\">:fromhost-ip, !isequal, &quot;127.0.0.1&quot; ?RemoteLogs</span><br><span class=\"line\"><span class=\"meta prompt_\"># </span><span class=\"language-bash\">忽略之前所有的日志，远程主机日志记录完之后不再继续往下记录</span></span><br><span class=\"line\">&amp; ~</span><br></pre></td></tr></table></figure>\n\n<blockquote>\n<p>重启服务端rsyslog服务</p>\n</blockquote>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">systemctl restart rsyslog</span><br></pre></td></tr></table></figure>\n\n<h2 id=\"客户端配置\"><a href=\"#客户端配置\" class=\"headerlink\" title=\"客户端配置\"></a>客户端配置</h2><p>修改 <code>/etc/rsyslog.conf</code>配置文件</p>\n<figure class=\"highlight shell\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"meta prompt_\"># </span><span class=\"language-bash\">若启用UDP进行传输，则取消下面两行的注释，如果没有则添加到modules下</span></span><br><span class=\"line\">module(load=&quot;imudp&quot;)</span><br><span class=\"line\">input(type=&quot;imudp&quot; port=&quot;514&quot;)</span><br><span class=\"line\"></span><br><span class=\"line\">或加入如下内容</span><br><span class=\"line\"><span class=\"meta prompt_\">$</span><span class=\"language-bash\">ModLoad imudp</span></span><br><span class=\"line\"><span class=\"meta prompt_\">$</span><span class=\"language-bash\">UDPServerRun 514</span></span><br><span class=\"line\"><span class=\"meta prompt_\"></span></span><br><span class=\"line\"><span class=\"meta prompt_\">#</span><span class=\"language-bash\">使用UDP传输所有日志到日志服务器（在末尾添加如下内容）</span></span><br><span class=\"line\">*.*    @172.25.16.29</span><br></pre></td></tr></table></figure>\n\n<blockquote>\n<p>重启服务端rsyslog服务</p>\n</blockquote>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">systemctl restart rsyslog</span><br></pre></td></tr></table></figure>\n\n<h2 id=\"测试\"><a href=\"#测试\" class=\"headerlink\" title=\"测试\"></a>测试</h2><blockquote>\n<p>日期生成</p>\n</blockquote>\n<p><img src=\"http://qiniu-image.gotojava.cn/blog/2023-12-15-191035.png\" alt=\"image-20230825210852478\"></p>\n<p><img src=\"http://qiniu-image.gotojava.cn/blog/2023-12-15-191037.png\" alt=\"image-20230825160343801\"></p>\n<blockquote>\n<p>客户端生成日志</p>\n</blockquote>\n<figure class=\"highlight shell\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">logger &quot;rsyslog test&quot;</span><br></pre></td></tr></table></figure>\n\n<p><img src=\"http://qiniu-image.gotojava.cn/blog/2023-12-15-191040.png\" alt=\"image-20230825161141448\"></p>\n<blockquote>\n<p>服务端监控输出</p>\n</blockquote>\n<figure class=\"highlight shell\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">tail -20f /rsyslog-bak/172.25.16.34/172.25.16.34_2023-08-25.log</span><br></pre></td></tr></table></figure>\n\n<p><img src=\"http://qiniu-image.gotojava.cn/blog/2023-12-15-191042.png\" alt=\"image-20230825161233634\"></p>"},{"title":"关于SSH服务“Permission denied, please try again.”问题的解决方案","abbrlink":"9fdf7a25","date":"2023-09-08T22:06:33.000Z","toc":true,"_content":"<meta name=\"referrer\" content=\"no-referrer\" />\n\n通过SSH远程登陆时，告知被禁止登陆。经过排查和查询网络资料。因为这个问题遇到的概率比较低。所以在这里把解决过程记录以下。\n\n<!--more-->\n\n通过SSH终端工具连接时报以下问题：\n\n![image-20230908200743172](http://qiniu-image.gotojava.cn/blog/2023-12-15-191022.png)\n\n这里说一下情况，服务器是云主机，托管于私有云供应商。然后通过堡垒机进行统一管理和运维。然后由于前一段时间的等级保护安全测评工作，服务器已经做了安全加固，也对SSH的版本进行了升级，跟远程登陆有关的安全措施如下：\n\n1. 设置口令复杂度；\n2. 设置口令重复使用次数限制；\n3. 设置密码过期时间\n4. 限制本地登陆和远程登陆次数；\n5. 禁用root远程SSH登陆；\n6. 升级OpenSSH；\n\n本次登陆使用的是普通账号，报的是 `userauth failed`。而不是密码错误的信息。\n\n而且云管账户下的机器为统一口令，不会出现个别机器口令不一样的情况，而且这个主机和其他主机安全策略完全一样，其他主机可以正常登陆。\n\n通过其他终端访问该服务器，并通过问题机器的VNC查看SSH日志，情况是这样的\n\n![image-20230908202026877](http://qiniu-image.gotojava.cn/blog/2023-12-15-191023.png)\n\n> 通过 `tail -100f /var/log/auth.log`查看认证日志\n\n![image-20230908202134973](http://qiniu-image.gotojava.cn/blog/2023-12-15-191024.png)\n\n发现是SSH可以验证成功的，但是客户端的登陆被禁止。\n\n此时问题陷入了僵局。后来在同事的提醒下，通过VNC的终端查看了问题机器的错误登陆次数：\n\n```shell\npam_tally2 --user wsupport\n```\n\n![image-20230908202445787](http://qiniu-image.gotojava.cn/blog/2023-12-15-191025.png)\n\n发现登陆错误次数达到了124次，然后尝试对错误登陆次数进行重置\n\n```shell\npam_tally2 --user wsupport  --reset\n```\n\n![image-20230908202644624](http://qiniu-image.gotojava.cn/blog/2023-12-15-191026.png)\n\n重新尝试SSH登陆后，发现可以正常登陆。\n","source":"_posts/关于SSH服务“Permission-denied-please-try-again-”问题的解决方案.md","raw":"---\ntitle: '关于SSH服务“Permission denied, please try again.”问题的解决方案'\ncategories:\n  - 开发者笔记\ntags:\n  - Linux\nabbrlink: 9fdf7a25\ndate: 2023-09-08 22:06:33\ntoc: true\n---\n<meta name=\"referrer\" content=\"no-referrer\" />\n\n通过SSH远程登陆时，告知被禁止登陆。经过排查和查询网络资料。因为这个问题遇到的概率比较低。所以在这里把解决过程记录以下。\n\n<!--more-->\n\n通过SSH终端工具连接时报以下问题：\n\n![image-20230908200743172](http://qiniu-image.gotojava.cn/blog/2023-12-15-191022.png)\n\n这里说一下情况，服务器是云主机，托管于私有云供应商。然后通过堡垒机进行统一管理和运维。然后由于前一段时间的等级保护安全测评工作，服务器已经做了安全加固，也对SSH的版本进行了升级，跟远程登陆有关的安全措施如下：\n\n1. 设置口令复杂度；\n2. 设置口令重复使用次数限制；\n3. 设置密码过期时间\n4. 限制本地登陆和远程登陆次数；\n5. 禁用root远程SSH登陆；\n6. 升级OpenSSH；\n\n本次登陆使用的是普通账号，报的是 `userauth failed`。而不是密码错误的信息。\n\n而且云管账户下的机器为统一口令，不会出现个别机器口令不一样的情况，而且这个主机和其他主机安全策略完全一样，其他主机可以正常登陆。\n\n通过其他终端访问该服务器，并通过问题机器的VNC查看SSH日志，情况是这样的\n\n![image-20230908202026877](http://qiniu-image.gotojava.cn/blog/2023-12-15-191023.png)\n\n> 通过 `tail -100f /var/log/auth.log`查看认证日志\n\n![image-20230908202134973](http://qiniu-image.gotojava.cn/blog/2023-12-15-191024.png)\n\n发现是SSH可以验证成功的，但是客户端的登陆被禁止。\n\n此时问题陷入了僵局。后来在同事的提醒下，通过VNC的终端查看了问题机器的错误登陆次数：\n\n```shell\npam_tally2 --user wsupport\n```\n\n![image-20230908202445787](http://qiniu-image.gotojava.cn/blog/2023-12-15-191025.png)\n\n发现登陆错误次数达到了124次，然后尝试对错误登陆次数进行重置\n\n```shell\npam_tally2 --user wsupport  --reset\n```\n\n![image-20230908202644624](http://qiniu-image.gotojava.cn/blog/2023-12-15-191026.png)\n\n重新尝试SSH登陆后，发现可以正常登陆。\n","slug":"关于SSH服务“Permission-denied-please-try-again-”问题的解决方案","published":1,"updated":"2025-03-28T06:09:36.062Z","comments":1,"layout":"post","photos":[],"_id":"cm8se3tdu001fbb8l7zb7e27j","content":"<meta name=\"referrer\" content=\"no-referrer\" />\n\n<p>通过SSH远程登陆时，告知被禁止登陆。经过排查和查询网络资料。因为这个问题遇到的概率比较低。所以在这里把解决过程记录以下。</p>\n<span id=\"more\"></span>\n\n<p>通过SSH终端工具连接时报以下问题：</p>\n<p><img src=\"http://qiniu-image.gotojava.cn/blog/2023-12-15-191022.png\" alt=\"image-20230908200743172\"></p>\n<p>这里说一下情况，服务器是云主机，托管于私有云供应商。然后通过堡垒机进行统一管理和运维。然后由于前一段时间的等级保护安全测评工作，服务器已经做了安全加固，也对SSH的版本进行了升级，跟远程登陆有关的安全措施如下：</p>\n<ol>\n<li>设置口令复杂度；</li>\n<li>设置口令重复使用次数限制；</li>\n<li>设置密码过期时间</li>\n<li>限制本地登陆和远程登陆次数；</li>\n<li>禁用root远程SSH登陆；</li>\n<li>升级OpenSSH；</li>\n</ol>\n<p>本次登陆使用的是普通账号，报的是 <code>userauth failed</code>。而不是密码错误的信息。</p>\n<p>而且云管账户下的机器为统一口令，不会出现个别机器口令不一样的情况，而且这个主机和其他主机安全策略完全一样，其他主机可以正常登陆。</p>\n<p>通过其他终端访问该服务器，并通过问题机器的VNC查看SSH日志，情况是这样的</p>\n<p><img src=\"http://qiniu-image.gotojava.cn/blog/2023-12-15-191023.png\" alt=\"image-20230908202026877\"></p>\n<blockquote>\n<p>通过 <code>tail -100f /var/log/auth.log</code>查看认证日志</p>\n</blockquote>\n<p><img src=\"http://qiniu-image.gotojava.cn/blog/2023-12-15-191024.png\" alt=\"image-20230908202134973\"></p>\n<p>发现是SSH可以验证成功的，但是客户端的登陆被禁止。</p>\n<p>此时问题陷入了僵局。后来在同事的提醒下，通过VNC的终端查看了问题机器的错误登陆次数：</p>\n<figure class=\"highlight shell\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">pam_tally2 --user wsupport</span><br></pre></td></tr></table></figure>\n\n<p><img src=\"http://qiniu-image.gotojava.cn/blog/2023-12-15-191025.png\" alt=\"image-20230908202445787\"></p>\n<p>发现登陆错误次数达到了124次，然后尝试对错误登陆次数进行重置</p>\n<figure class=\"highlight shell\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">pam_tally2 --user wsupport  --reset</span><br></pre></td></tr></table></figure>\n\n<p><img src=\"http://qiniu-image.gotojava.cn/blog/2023-12-15-191026.png\" alt=\"image-20230908202644624\"></p>\n<p>重新尝试SSH登陆后，发现可以正常登陆。</p>\n","excerpt":"<meta name=\"referrer\" content=\"no-referrer\" />\n\n<p>通过SSH远程登陆时，告知被禁止登陆。经过排查和查询网络资料。因为这个问题遇到的概率比较低。所以在这里把解决过程记录以下。</p>","more":"<p>通过SSH终端工具连接时报以下问题：</p>\n<p><img src=\"http://qiniu-image.gotojava.cn/blog/2023-12-15-191022.png\" alt=\"image-20230908200743172\"></p>\n<p>这里说一下情况，服务器是云主机，托管于私有云供应商。然后通过堡垒机进行统一管理和运维。然后由于前一段时间的等级保护安全测评工作，服务器已经做了安全加固，也对SSH的版本进行了升级，跟远程登陆有关的安全措施如下：</p>\n<ol>\n<li>设置口令复杂度；</li>\n<li>设置口令重复使用次数限制；</li>\n<li>设置密码过期时间</li>\n<li>限制本地登陆和远程登陆次数；</li>\n<li>禁用root远程SSH登陆；</li>\n<li>升级OpenSSH；</li>\n</ol>\n<p>本次登陆使用的是普通账号，报的是 <code>userauth failed</code>。而不是密码错误的信息。</p>\n<p>而且云管账户下的机器为统一口令，不会出现个别机器口令不一样的情况，而且这个主机和其他主机安全策略完全一样，其他主机可以正常登陆。</p>\n<p>通过其他终端访问该服务器，并通过问题机器的VNC查看SSH日志，情况是这样的</p>\n<p><img src=\"http://qiniu-image.gotojava.cn/blog/2023-12-15-191023.png\" alt=\"image-20230908202026877\"></p>\n<blockquote>\n<p>通过 <code>tail -100f /var/log/auth.log</code>查看认证日志</p>\n</blockquote>\n<p><img src=\"http://qiniu-image.gotojava.cn/blog/2023-12-15-191024.png\" alt=\"image-20230908202134973\"></p>\n<p>发现是SSH可以验证成功的，但是客户端的登陆被禁止。</p>\n<p>此时问题陷入了僵局。后来在同事的提醒下，通过VNC的终端查看了问题机器的错误登陆次数：</p>\n<figure class=\"highlight shell\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">pam_tally2 --user wsupport</span><br></pre></td></tr></table></figure>\n\n<p><img src=\"http://qiniu-image.gotojava.cn/blog/2023-12-15-191025.png\" alt=\"image-20230908202445787\"></p>\n<p>发现登陆错误次数达到了124次，然后尝试对错误登陆次数进行重置</p>\n<figure class=\"highlight shell\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">pam_tally2 --user wsupport  --reset</span><br></pre></td></tr></table></figure>\n\n<p><img src=\"http://qiniu-image.gotojava.cn/blog/2023-12-15-191026.png\" alt=\"image-20230908202644624\"></p>\n<p>重新尝试SSH登陆后，发现可以正常登陆。</p>"},{"title":"如何利用备忘录让会议更高效？","abbrlink":"60bd0b8","date":"2024-01-19T02:49:07.000Z","toc":true,"_content":"\n亚马逊公司的创始人贝佐斯在做客美国著名的主持人`莱克斯·弗里德曼（Lex Fridman）`博客专访节目时，主持人问贝佐斯：\"我听说**亚马逊开会时，不准使用 PPT，发言人必须提交一份六页的备忘录**。这是真的吗？\"\n\n<!--more-->\n\n这个事情一直是传闻，但这一次，贝佐斯亲口承认确实如此。\"新来的人可能会大吃一惊，我们的开会方式与众不同。\"\n\n\"会议的前30分钟，我们是不说话的。大家在会议室中安静地坐在一起，阅读这份六页的备忘录，在空白处做笔记，过了30分钟才开始讨论。\"\n\n这真的很奇怪，你见过半个小时没人说话的会议吗？\n\n贝佐斯解释：\"你可以说，更好的做法是，大家都提前阅读这些备忘录。但问题是，人们没有时间这样做，他们参加会议只是因为必须出席。\"\n\n\"我们索性在会议上留出时间，让大家现场阅读材料，然后就可以进行真正高层次的讨论了，所有人都跟得上讨论的主题，不会搞不清一些基本的事实。\"\n\n那么，为什么一定要当事人提交六页的备忘录，而不是现场主讲 PPT 呢？\n\n贝佐斯说，**书面的备忘录要比 PPT 演示，效果好得多**，主要有以下几点原因。\n\n（1）PPT 的设计目的是说服，这是一种销售工具。但是在公司内部，你想要的是真相，而不是业务主管的推销。\n\n（2）PPT 的缺点是，它对作者相对容易，对观众来说却很难抓住要点。备忘录正好相反，写好一份六页的备忘录，对于作者是很难的。\n\n你可能需要两周的时间，先写出初稿，然后再重写，不断加工，确保你的文字是准确和可靠的。所以，备忘录对作者非常困难，但对观众就好多了，半小时的阅读就能搞清楚事情的来龙去脉，也看得出作者对这个问题的熟悉程度。\n\n（3）备忘录可以节省会议时间。如果是 PPT 演示，高管们会不停地打断提问，结果发现答案就在下一张幻灯片。\n\n但是，阅读备忘录时，你必须先把所有问题写在空白处，当你读到最后一页时，发现很多问题已经得到了解答，这就节省了当众提问的时间。\n\n（4）PPT 演示过程中，主讲人也许会根据现场情况，临时决定隐藏或修改一些讲法。备忘录就没有这个问题，主讲人必须事先给出完整描述，你更能了解他的真实想法。\n\n（5）PPT 通常只是一些要点，不是完整的句子，有利于隐藏很多草率的想法。而备忘录是完整的段落，必须有主题句，有动词和名词，你很难隐藏自己的草率思维。\n\n备忘录迫使作者处于最佳状态，你能得到一个人真正最好的想法。如果 PPT 演示，你们可能要讨论很久，发言人才能进入最佳状态。从长远来看，备忘录节省了你的时间。\n\n以上就是贝佐斯不允许使用 PPT 的五点理由。\n\n我觉得这些理由很有说服力。PPT 在国内已经泛滥成灾，大家好像默认，它是开会的标准方式，缺了还不行。这真的要改一下，学习亚马逊的\"备忘录开会法\"----**先写成文档，再进行讨论**----可能是更好更正确的做法。\n\n原文：[《科技爱好者周刊（第 285 期）：为什么 PPT 不如备忘录》](https://www.ruanyifeng.com/blog/2024/01/weekly-issue-285.html)","source":"_posts/如何利用备忘录让会议更高效？.md","raw":"---\ntitle: 如何利用备忘录让会议更高效？\nabbrlink: 60bd0b8\ndate: 2024-01-19 02:49:07\ntoc: true\n---\n\n亚马逊公司的创始人贝佐斯在做客美国著名的主持人`莱克斯·弗里德曼（Lex Fridman）`博客专访节目时，主持人问贝佐斯：\"我听说**亚马逊开会时，不准使用 PPT，发言人必须提交一份六页的备忘录**。这是真的吗？\"\n\n<!--more-->\n\n这个事情一直是传闻，但这一次，贝佐斯亲口承认确实如此。\"新来的人可能会大吃一惊，我们的开会方式与众不同。\"\n\n\"会议的前30分钟，我们是不说话的。大家在会议室中安静地坐在一起，阅读这份六页的备忘录，在空白处做笔记，过了30分钟才开始讨论。\"\n\n这真的很奇怪，你见过半个小时没人说话的会议吗？\n\n贝佐斯解释：\"你可以说，更好的做法是，大家都提前阅读这些备忘录。但问题是，人们没有时间这样做，他们参加会议只是因为必须出席。\"\n\n\"我们索性在会议上留出时间，让大家现场阅读材料，然后就可以进行真正高层次的讨论了，所有人都跟得上讨论的主题，不会搞不清一些基本的事实。\"\n\n那么，为什么一定要当事人提交六页的备忘录，而不是现场主讲 PPT 呢？\n\n贝佐斯说，**书面的备忘录要比 PPT 演示，效果好得多**，主要有以下几点原因。\n\n（1）PPT 的设计目的是说服，这是一种销售工具。但是在公司内部，你想要的是真相，而不是业务主管的推销。\n\n（2）PPT 的缺点是，它对作者相对容易，对观众来说却很难抓住要点。备忘录正好相反，写好一份六页的备忘录，对于作者是很难的。\n\n你可能需要两周的时间，先写出初稿，然后再重写，不断加工，确保你的文字是准确和可靠的。所以，备忘录对作者非常困难，但对观众就好多了，半小时的阅读就能搞清楚事情的来龙去脉，也看得出作者对这个问题的熟悉程度。\n\n（3）备忘录可以节省会议时间。如果是 PPT 演示，高管们会不停地打断提问，结果发现答案就在下一张幻灯片。\n\n但是，阅读备忘录时，你必须先把所有问题写在空白处，当你读到最后一页时，发现很多问题已经得到了解答，这就节省了当众提问的时间。\n\n（4）PPT 演示过程中，主讲人也许会根据现场情况，临时决定隐藏或修改一些讲法。备忘录就没有这个问题，主讲人必须事先给出完整描述，你更能了解他的真实想法。\n\n（5）PPT 通常只是一些要点，不是完整的句子，有利于隐藏很多草率的想法。而备忘录是完整的段落，必须有主题句，有动词和名词，你很难隐藏自己的草率思维。\n\n备忘录迫使作者处于最佳状态，你能得到一个人真正最好的想法。如果 PPT 演示，你们可能要讨论很久，发言人才能进入最佳状态。从长远来看，备忘录节省了你的时间。\n\n以上就是贝佐斯不允许使用 PPT 的五点理由。\n\n我觉得这些理由很有说服力。PPT 在国内已经泛滥成灾，大家好像默认，它是开会的标准方式，缺了还不行。这真的要改一下，学习亚马逊的\"备忘录开会法\"----**先写成文档，再进行讨论**----可能是更好更正确的做法。\n\n原文：[《科技爱好者周刊（第 285 期）：为什么 PPT 不如备忘录》](https://www.ruanyifeng.com/blog/2024/01/weekly-issue-285.html)","slug":"如何利用备忘录让会议更高效？","published":1,"updated":"2025-03-28T06:09:56.063Z","comments":1,"layout":"post","photos":[],"_id":"cm8se3tdu001hbb8l90hr612b","content":"<p>亚马逊公司的创始人贝佐斯在做客美国著名的主持人<code>莱克斯·弗里德曼（Lex Fridman）</code>博客专访节目时，主持人问贝佐斯：”我听说<strong>亚马逊开会时，不准使用 PPT，发言人必须提交一份六页的备忘录</strong>。这是真的吗？”</p>\n<span id=\"more\"></span>\n\n<p>这个事情一直是传闻，但这一次，贝佐斯亲口承认确实如此。”新来的人可能会大吃一惊，我们的开会方式与众不同。”</p>\n<p>“会议的前30分钟，我们是不说话的。大家在会议室中安静地坐在一起，阅读这份六页的备忘录，在空白处做笔记，过了30分钟才开始讨论。”</p>\n<p>这真的很奇怪，你见过半个小时没人说话的会议吗？</p>\n<p>贝佐斯解释：”你可以说，更好的做法是，大家都提前阅读这些备忘录。但问题是，人们没有时间这样做，他们参加会议只是因为必须出席。”</p>\n<p>“我们索性在会议上留出时间，让大家现场阅读材料，然后就可以进行真正高层次的讨论了，所有人都跟得上讨论的主题，不会搞不清一些基本的事实。”</p>\n<p>那么，为什么一定要当事人提交六页的备忘录，而不是现场主讲 PPT 呢？</p>\n<p>贝佐斯说，<strong>书面的备忘录要比 PPT 演示，效果好得多</strong>，主要有以下几点原因。</p>\n<p>（1）PPT 的设计目的是说服，这是一种销售工具。但是在公司内部，你想要的是真相，而不是业务主管的推销。</p>\n<p>（2）PPT 的缺点是，它对作者相对容易，对观众来说却很难抓住要点。备忘录正好相反，写好一份六页的备忘录，对于作者是很难的。</p>\n<p>你可能需要两周的时间，先写出初稿，然后再重写，不断加工，确保你的文字是准确和可靠的。所以，备忘录对作者非常困难，但对观众就好多了，半小时的阅读就能搞清楚事情的来龙去脉，也看得出作者对这个问题的熟悉程度。</p>\n<p>（3）备忘录可以节省会议时间。如果是 PPT 演示，高管们会不停地打断提问，结果发现答案就在下一张幻灯片。</p>\n<p>但是，阅读备忘录时，你必须先把所有问题写在空白处，当你读到最后一页时，发现很多问题已经得到了解答，这就节省了当众提问的时间。</p>\n<p>（4）PPT 演示过程中，主讲人也许会根据现场情况，临时决定隐藏或修改一些讲法。备忘录就没有这个问题，主讲人必须事先给出完整描述，你更能了解他的真实想法。</p>\n<p>（5）PPT 通常只是一些要点，不是完整的句子，有利于隐藏很多草率的想法。而备忘录是完整的段落，必须有主题句，有动词和名词，你很难隐藏自己的草率思维。</p>\n<p>备忘录迫使作者处于最佳状态，你能得到一个人真正最好的想法。如果 PPT 演示，你们可能要讨论很久，发言人才能进入最佳状态。从长远来看，备忘录节省了你的时间。</p>\n<p>以上就是贝佐斯不允许使用 PPT 的五点理由。</p>\n<p>我觉得这些理由很有说服力。PPT 在国内已经泛滥成灾，大家好像默认，它是开会的标准方式，缺了还不行。这真的要改一下，学习亚马逊的”备忘录开会法”—-<strong>先写成文档，再进行讨论</strong>—-可能是更好更正确的做法。</p>\n<p>原文：<a href=\"https://www.ruanyifeng.com/blog/2024/01/weekly-issue-285.html\">《科技爱好者周刊（第 285 期）：为什么 PPT 不如备忘录》</a></p>\n","excerpt":"<p>亚马逊公司的创始人贝佐斯在做客美国著名的主持人<code>莱克斯·弗里德曼（Lex Fridman）</code>博客专访节目时，主持人问贝佐斯：”我听说<strong>亚马逊开会时，不准使用 PPT，发言人必须提交一份六页的备忘录</strong>。这是真的吗？”</p>","more":"<p>这个事情一直是传闻，但这一次，贝佐斯亲口承认确实如此。”新来的人可能会大吃一惊，我们的开会方式与众不同。”</p>\n<p>“会议的前30分钟，我们是不说话的。大家在会议室中安静地坐在一起，阅读这份六页的备忘录，在空白处做笔记，过了30分钟才开始讨论。”</p>\n<p>这真的很奇怪，你见过半个小时没人说话的会议吗？</p>\n<p>贝佐斯解释：”你可以说，更好的做法是，大家都提前阅读这些备忘录。但问题是，人们没有时间这样做，他们参加会议只是因为必须出席。”</p>\n<p>“我们索性在会议上留出时间，让大家现场阅读材料，然后就可以进行真正高层次的讨论了，所有人都跟得上讨论的主题，不会搞不清一些基本的事实。”</p>\n<p>那么，为什么一定要当事人提交六页的备忘录，而不是现场主讲 PPT 呢？</p>\n<p>贝佐斯说，<strong>书面的备忘录要比 PPT 演示，效果好得多</strong>，主要有以下几点原因。</p>\n<p>（1）PPT 的设计目的是说服，这是一种销售工具。但是在公司内部，你想要的是真相，而不是业务主管的推销。</p>\n<p>（2）PPT 的缺点是，它对作者相对容易，对观众来说却很难抓住要点。备忘录正好相反，写好一份六页的备忘录，对于作者是很难的。</p>\n<p>你可能需要两周的时间，先写出初稿，然后再重写，不断加工，确保你的文字是准确和可靠的。所以，备忘录对作者非常困难，但对观众就好多了，半小时的阅读就能搞清楚事情的来龙去脉，也看得出作者对这个问题的熟悉程度。</p>\n<p>（3）备忘录可以节省会议时间。如果是 PPT 演示，高管们会不停地打断提问，结果发现答案就在下一张幻灯片。</p>\n<p>但是，阅读备忘录时，你必须先把所有问题写在空白处，当你读到最后一页时，发现很多问题已经得到了解答，这就节省了当众提问的时间。</p>\n<p>（4）PPT 演示过程中，主讲人也许会根据现场情况，临时决定隐藏或修改一些讲法。备忘录就没有这个问题，主讲人必须事先给出完整描述，你更能了解他的真实想法。</p>\n<p>（5）PPT 通常只是一些要点，不是完整的句子，有利于隐藏很多草率的想法。而备忘录是完整的段落，必须有主题句，有动词和名词，你很难隐藏自己的草率思维。</p>\n<p>备忘录迫使作者处于最佳状态，你能得到一个人真正最好的想法。如果 PPT 演示，你们可能要讨论很久，发言人才能进入最佳状态。从长远来看，备忘录节省了你的时间。</p>\n<p>以上就是贝佐斯不允许使用 PPT 的五点理由。</p>\n<p>我觉得这些理由很有说服力。PPT 在国内已经泛滥成灾，大家好像默认，它是开会的标准方式，缺了还不行。这真的要改一下，学习亚马逊的”备忘录开会法”—-<strong>先写成文档，再进行讨论</strong>—-可能是更好更正确的做法。</p>\n<p>原文：<a href=\"https://www.ruanyifeng.com/blog/2024/01/weekly-issue-285.html\">《科技爱好者周刊（第 285 期）：为什么 PPT 不如备忘录》</a></p>"},{"title":"如何获取Linux系统的年龄","toc":true,"abbrlink":"b3ec94dd","date":"2024-11-01T17:56:30.000Z","_content":"\n\n本文将介绍几个简单的命令来获取不同 Linux 系统安装时间的方法。\n\n<!-- more -->\n\n## 通用\n\n- stat 命令获取\n\nstat命令Birth字段为空置的操作系统内核版本为3.10.0，不满足条件kernerl >=4.11 所以stat命令显示空值。\n\n```\n# stat / | awk '/Birth: /{print $2 \" \" substr($3,1,5)}'\n# uname -r\n3.10.0-1160.118.1.el7.x86_64\n```\n\n- 通过文件系统获取\n\n通过获取文件系统的创建时间来获取\n\n```bash\n# tune2fs -l $(df -P / | awk 'NR==2{print $1}') | grep 'Filesystem created'\nFilesystem created:       Mon Jun  3 17:54:37 2024\n```\n\n## Debian / Ubuntu\n\n```bash\nsudo head -n1 /var/log/installer/syslog\n```\n\n## Fedora / Rocky Linux / AlmaLinux\n\n*在 Fedora、Red Hat Enterprise Linux 及其所有分支（如 Rocky Linux、AlmaLinux、Oracle Linux 等）中，我们可以通过检查“ basesystem* ”包的安装日期作为操作系统安装时间的可靠标记。\n\n```\n[root@localhost ~]# sudo rpm -qi basesystem | grep -i \"install date\"\nInstall Date: 2024年01月02日 星期二 11时15分24秒\n```\n\n但是请记住，如果您正在执行就地升级，例如从 Fedora 38 到 Fedora 39、从 Rocky 9.1 到 Rocky 9.2 等，则检索“ *basesystem* ”包信息时显示的日期将是升级时间的日期。\n\n### Arch Linux\n\n```\nhead -n1 /var/log/pacman.log\n```\n\n## Refences\n\n- [Linux Installation Date: How to Discover Your System’s Age](https://linuxiac.com/how-to-find-linux-os-installation-date/)\n\n- [Linux xfs文件系统stat命令Birth字段为空的原因探究](https://blog.csdn.net/Gefangenes/article/details/130629574)\n","source":"_posts/如何获取Linux系统的年龄.md","raw":"---\ntitle: 如何获取Linux系统的年龄\ntags:\n  - Linux\ntoc: true\nabbrlink: b3ec94dd\ndate: 2024-11-01 17:56:30\n---\n\n\n本文将介绍几个简单的命令来获取不同 Linux 系统安装时间的方法。\n\n<!-- more -->\n\n## 通用\n\n- stat 命令获取\n\nstat命令Birth字段为空置的操作系统内核版本为3.10.0，不满足条件kernerl >=4.11 所以stat命令显示空值。\n\n```\n# stat / | awk '/Birth: /{print $2 \" \" substr($3,1,5)}'\n# uname -r\n3.10.0-1160.118.1.el7.x86_64\n```\n\n- 通过文件系统获取\n\n通过获取文件系统的创建时间来获取\n\n```bash\n# tune2fs -l $(df -P / | awk 'NR==2{print $1}') | grep 'Filesystem created'\nFilesystem created:       Mon Jun  3 17:54:37 2024\n```\n\n## Debian / Ubuntu\n\n```bash\nsudo head -n1 /var/log/installer/syslog\n```\n\n## Fedora / Rocky Linux / AlmaLinux\n\n*在 Fedora、Red Hat Enterprise Linux 及其所有分支（如 Rocky Linux、AlmaLinux、Oracle Linux 等）中，我们可以通过检查“ basesystem* ”包的安装日期作为操作系统安装时间的可靠标记。\n\n```\n[root@localhost ~]# sudo rpm -qi basesystem | grep -i \"install date\"\nInstall Date: 2024年01月02日 星期二 11时15分24秒\n```\n\n但是请记住，如果您正在执行就地升级，例如从 Fedora 38 到 Fedora 39、从 Rocky 9.1 到 Rocky 9.2 等，则检索“ *basesystem* ”包信息时显示的日期将是升级时间的日期。\n\n### Arch Linux\n\n```\nhead -n1 /var/log/pacman.log\n```\n\n## Refences\n\n- [Linux Installation Date: How to Discover Your System’s Age](https://linuxiac.com/how-to-find-linux-os-installation-date/)\n\n- [Linux xfs文件系统stat命令Birth字段为空的原因探究](https://blog.csdn.net/Gefangenes/article/details/130629574)\n","slug":"如何获取Linux系统的年龄","published":1,"updated":"2025-03-28T06:09:52.659Z","comments":1,"layout":"post","photos":[],"_id":"cm8se3tdv001jbb8l5vgj5h4c","content":"<p>本文将介绍几个简单的命令来获取不同 Linux 系统安装时间的方法。</p>\n<span id=\"more\"></span>\n\n<h2 id=\"通用\"><a href=\"#通用\" class=\"headerlink\" title=\"通用\"></a>通用</h2><ul>\n<li>stat 命令获取</li>\n</ul>\n<p>stat命令Birth字段为空置的操作系统内核版本为3.10.0，不满足条件kernerl &gt;&#x3D;4.11 所以stat命令显示空值。</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"># stat / | awk &#x27;/Birth: /&#123;print $2 &quot; &quot; substr($3,1,5)&#125;&#x27;</span><br><span class=\"line\"># uname -r</span><br><span class=\"line\">3.10.0-1160.118.1.el7.x86_64</span><br></pre></td></tr></table></figure>\n\n<ul>\n<li>通过文件系统获取</li>\n</ul>\n<p>通过获取文件系统的创建时间来获取</p>\n<figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\"># tune2fs -l $(df -P / | awk &#x27;NR==2&#123;print $1&#125;&#x27;) | grep &#x27;Filesystem created&#x27;</span></span><br><span class=\"line\">Filesystem created:       Mon Jun  3 17:54:37 2024</span><br></pre></td></tr></table></figure>\n\n<h2 id=\"Debian-Ubuntu\"><a href=\"#Debian-Ubuntu\" class=\"headerlink\" title=\"Debian &#x2F; Ubuntu\"></a>Debian &#x2F; Ubuntu</h2><figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"built_in\">sudo</span> <span class=\"built_in\">head</span> -n1 /var/log/installer/syslog</span><br></pre></td></tr></table></figure>\n\n<h2 id=\"Fedora-Rocky-Linux-AlmaLinux\"><a href=\"#Fedora-Rocky-Linux-AlmaLinux\" class=\"headerlink\" title=\"Fedora &#x2F; Rocky Linux &#x2F; AlmaLinux\"></a>Fedora &#x2F; Rocky Linux &#x2F; AlmaLinux</h2><p><em>在 Fedora、Red Hat Enterprise Linux 及其所有分支（如 Rocky Linux、AlmaLinux、Oracle Linux 等）中，我们可以通过检查“ basesystem</em> ”包的安装日期作为操作系统安装时间的可靠标记。</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">[root@localhost ~]# sudo rpm -qi basesystem | grep -i &quot;install date&quot;</span><br><span class=\"line\">Install Date: 2024年01月02日 星期二 11时15分24秒</span><br></pre></td></tr></table></figure>\n\n<p>但是请记住，如果您正在执行就地升级，例如从 Fedora 38 到 Fedora 39、从 Rocky 9.1 到 Rocky 9.2 等，则检索“ <em>basesystem</em> ”包信息时显示的日期将是升级时间的日期。</p>\n<h3 id=\"Arch-Linux\"><a href=\"#Arch-Linux\" class=\"headerlink\" title=\"Arch Linux\"></a>Arch Linux</h3><figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">head -n1 /var/log/pacman.log</span><br></pre></td></tr></table></figure>\n\n<h2 id=\"Refences\"><a href=\"#Refences\" class=\"headerlink\" title=\"Refences\"></a>Refences</h2><ul>\n<li><p><a href=\"https://linuxiac.com/how-to-find-linux-os-installation-date/\">Linux Installation Date: How to Discover Your System’s Age</a></p>\n</li>\n<li><p><a href=\"https://blog.csdn.net/Gefangenes/article/details/130629574\">Linux xfs文件系统stat命令Birth字段为空的原因探究</a></p>\n</li>\n</ul>\n","excerpt":"<p>本文将介绍几个简单的命令来获取不同 Linux 系统安装时间的方法。</p>","more":"<h2 id=\"通用\"><a href=\"#通用\" class=\"headerlink\" title=\"通用\"></a>通用</h2><ul>\n<li>stat 命令获取</li>\n</ul>\n<p>stat命令Birth字段为空置的操作系统内核版本为3.10.0，不满足条件kernerl &gt;&#x3D;4.11 所以stat命令显示空值。</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"># stat / | awk &#x27;/Birth: /&#123;print $2 &quot; &quot; substr($3,1,5)&#125;&#x27;</span><br><span class=\"line\"># uname -r</span><br><span class=\"line\">3.10.0-1160.118.1.el7.x86_64</span><br></pre></td></tr></table></figure>\n\n<ul>\n<li>通过文件系统获取</li>\n</ul>\n<p>通过获取文件系统的创建时间来获取</p>\n<figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\"># tune2fs -l $(df -P / | awk &#x27;NR==2&#123;print $1&#125;&#x27;) | grep &#x27;Filesystem created&#x27;</span></span><br><span class=\"line\">Filesystem created:       Mon Jun  3 17:54:37 2024</span><br></pre></td></tr></table></figure>\n\n<h2 id=\"Debian-Ubuntu\"><a href=\"#Debian-Ubuntu\" class=\"headerlink\" title=\"Debian &#x2F; Ubuntu\"></a>Debian &#x2F; Ubuntu</h2><figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"built_in\">sudo</span> <span class=\"built_in\">head</span> -n1 /var/log/installer/syslog</span><br></pre></td></tr></table></figure>\n\n<h2 id=\"Fedora-Rocky-Linux-AlmaLinux\"><a href=\"#Fedora-Rocky-Linux-AlmaLinux\" class=\"headerlink\" title=\"Fedora &#x2F; Rocky Linux &#x2F; AlmaLinux\"></a>Fedora &#x2F; Rocky Linux &#x2F; AlmaLinux</h2><p><em>在 Fedora、Red Hat Enterprise Linux 及其所有分支（如 Rocky Linux、AlmaLinux、Oracle Linux 等）中，我们可以通过检查“ basesystem</em> ”包的安装日期作为操作系统安装时间的可靠标记。</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">[root@localhost ~]# sudo rpm -qi basesystem | grep -i &quot;install date&quot;</span><br><span class=\"line\">Install Date: 2024年01月02日 星期二 11时15分24秒</span><br></pre></td></tr></table></figure>\n\n<p>但是请记住，如果您正在执行就地升级，例如从 Fedora 38 到 Fedora 39、从 Rocky 9.1 到 Rocky 9.2 等，则检索“ <em>basesystem</em> ”包信息时显示的日期将是升级时间的日期。</p>\n<h3 id=\"Arch-Linux\"><a href=\"#Arch-Linux\" class=\"headerlink\" title=\"Arch Linux\"></a>Arch Linux</h3><figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">head -n1 /var/log/pacman.log</span><br></pre></td></tr></table></figure>\n\n<h2 id=\"Refences\"><a href=\"#Refences\" class=\"headerlink\" title=\"Refences\"></a>Refences</h2><ul>\n<li><p><a href=\"https://linuxiac.com/how-to-find-linux-os-installation-date/\">Linux Installation Date: How to Discover Your System’s Age</a></p>\n</li>\n<li><p><a href=\"https://blog.csdn.net/Gefangenes/article/details/130629574\">Linux xfs文件系统stat命令Birth字段为空的原因探究</a></p>\n</li>\n</ul>"},{"title":"常用软件记录","abbrlink":"2878e73f","date":"2023-07-21T18:34:55.000Z","toc":true,"_content":"用于记录和分享一些自己在 Windows 、macOS、IOS 下遇到的一些好用的软件和工具。\n\n<!--more-->\n\n### 操作系统工具\n\n#### 日常使用\n\n- **视频会议**：✨[腾讯会议](https://meeting.tencent.com/)\n- **文件解压缩：**[MacZip](https://ezip.awehunt.com/)\n- **待办提醒**：苹果提醒事项、苹果便签\n- **电子邮件**：苹果邮件\n- **聊天工具**：[微信](https://weixin.qq.com/)、[企业微信](https://work.weixin.qq.com)\n- 翻译：微信截图翻译、[通义千问](https://tongyi.aliyun.com)\n- VPN：[LetsVPN](https://ric.asiway.org/?shortlink=0gesgjiu&c=cs-articles&pid=activity&af_xp=custom&source_caller=ui)、✨[Taishan Net](https://jpin.taishan666.xyz)\n- **备忘录**：苹果备忘录、✨[Flomo](https://flomoapp.com)\n- 日程管理：苹果日历\n- 写作工具：✨[Typora](https://www.icloud.com.cn/iclouddrive/07dw7bzS6ec_XBnGQdwoXgcPw#Typora_1.6.7_osx)\n- 图床：[PicGO](https://picgo.github.io/PicGo-Doc/)\n- 输入法：[搜狗输入法](https://pinyin.sogou.com/mac/)、✨[微信输入法](https://z.weixin.qq.com/)\n- 软件包管理：[Homebrew](https://brew.sh/)\n\n#### 开发工具\n\n- **代码编辑器**：✨[IDEA](https://www.jetbrains.com/)、✨[VSCode](https://code.visualstudio.com/)\n- Git：[Git](https://git-scm.com/download)、[SVN](https://formulae.brew.sh/formula/subversion#default)\n- **浏览器**：✨[Google Chrome](https://www.google.cn/chrome/index.html)\n- **虚拟化**：[Docker](https://www.docker.com/)、✨[Parallels Desktop](https://www.icloud.com.cn/iclouddrive/051LwYlz9I5q-75mQjuesqPDg#ParallelsDesktop-18.1.1-53328_M_osx)\n- 终端工具：✨[WindTerm](https://windterm.org/)\n- 数据库工具：✨Navicat、[达梦数据库](https://www.dameng.com/DM8.html)、[Another Redis Desktop Manager](https://github.com/qishibo/AnotherRedisDesktopManager)\n- 远程工具：[Microsoft Remote Desktop](https://apps.apple.com/tw/app/microsoft-remote-desktop/id1295203466)\n- 数据库建模工具：✨[PDManer](https://gitee.com/robergroup/pdmaner/releases)\n- 接口测试工具：[Postman](https://www.postman.com/downloads/)、[Jemter](https://jmeter.apache.org/)\n\n### 操作系统工具\n\n- 文件查找搜索：✨[Everything](https://www.voidtools.com/zh-cn/)\n\n### 网页工具\n\n- ✨腾讯杂项在线工具：[杂项工具箱](https://tool.browser.qq.com/)\n- ✨画图工具：[ProcessOn](https://www.processon.com/)\n- ✨[微信读书](https://weread.qq.com/)\n- [绘制3D架构图](https://icraft.gantcloud.com/)\n- [获取实时新闻](https://newsnow.busiyi.world/c/realtime)\n- [开源许可证选择器](https://open-source-license-chooser.toolsnav.top/zh/)\n\n### 操作系统\n\n* Windows：✨[MSDN-itellyou](https://msdn.itellyou.cn/)\n\n> 推荐使用LTSC版本的操作系统，系统比较纯净，但需要[激活](https://www.icloud.com.cn/iclouddrive/009dT5FmvFW1dVjWVR8XkFnSA#HEU_KMS_Activator)\n\n* Linux：[CentOS](https://www.centos.org/download/)\n\n> 比较推荐直接去一些软件源上下载，这里举例[清华源](https://mirrors.tuna.tsinghua.edu.cn/ubuntu-cdimage/releases/23.04/release/)\n\n### 浏览器插件\n\n- ✨[AdGuard AdBlocker](https://chrome.google.com/webstore/detail/adguard-adblocker/bgnkhhnnamicmpeenaelnjfhikgbkllg)拦截广告\n- ✨[FireShot](https://chrome.google.com/webstore/detail/take-webpage-screenshots/mcbpblocgmgfnpjjppndjkmgjaogfceg) 捕捉网页截图\n- ✨[Wappalyzer](https://www.wappalyzer.com/apps/?utm_source=popup&utm_medium=extension&utm_campaign=wappalyzer) *分析网站所使用的组件*\n","source":"_posts/常用软件记录.md","raw":"---\ntitle: 常用软件记录\nabbrlink: 2878e73f\ndate: 2023-07-21 18:34:55\ntoc: true\n---\n用于记录和分享一些自己在 Windows 、macOS、IOS 下遇到的一些好用的软件和工具。\n\n<!--more-->\n\n### 操作系统工具\n\n#### 日常使用\n\n- **视频会议**：✨[腾讯会议](https://meeting.tencent.com/)\n- **文件解压缩：**[MacZip](https://ezip.awehunt.com/)\n- **待办提醒**：苹果提醒事项、苹果便签\n- **电子邮件**：苹果邮件\n- **聊天工具**：[微信](https://weixin.qq.com/)、[企业微信](https://work.weixin.qq.com)\n- 翻译：微信截图翻译、[通义千问](https://tongyi.aliyun.com)\n- VPN：[LetsVPN](https://ric.asiway.org/?shortlink=0gesgjiu&c=cs-articles&pid=activity&af_xp=custom&source_caller=ui)、✨[Taishan Net](https://jpin.taishan666.xyz)\n- **备忘录**：苹果备忘录、✨[Flomo](https://flomoapp.com)\n- 日程管理：苹果日历\n- 写作工具：✨[Typora](https://www.icloud.com.cn/iclouddrive/07dw7bzS6ec_XBnGQdwoXgcPw#Typora_1.6.7_osx)\n- 图床：[PicGO](https://picgo.github.io/PicGo-Doc/)\n- 输入法：[搜狗输入法](https://pinyin.sogou.com/mac/)、✨[微信输入法](https://z.weixin.qq.com/)\n- 软件包管理：[Homebrew](https://brew.sh/)\n\n#### 开发工具\n\n- **代码编辑器**：✨[IDEA](https://www.jetbrains.com/)、✨[VSCode](https://code.visualstudio.com/)\n- Git：[Git](https://git-scm.com/download)、[SVN](https://formulae.brew.sh/formula/subversion#default)\n- **浏览器**：✨[Google Chrome](https://www.google.cn/chrome/index.html)\n- **虚拟化**：[Docker](https://www.docker.com/)、✨[Parallels Desktop](https://www.icloud.com.cn/iclouddrive/051LwYlz9I5q-75mQjuesqPDg#ParallelsDesktop-18.1.1-53328_M_osx)\n- 终端工具：✨[WindTerm](https://windterm.org/)\n- 数据库工具：✨Navicat、[达梦数据库](https://www.dameng.com/DM8.html)、[Another Redis Desktop Manager](https://github.com/qishibo/AnotherRedisDesktopManager)\n- 远程工具：[Microsoft Remote Desktop](https://apps.apple.com/tw/app/microsoft-remote-desktop/id1295203466)\n- 数据库建模工具：✨[PDManer](https://gitee.com/robergroup/pdmaner/releases)\n- 接口测试工具：[Postman](https://www.postman.com/downloads/)、[Jemter](https://jmeter.apache.org/)\n\n### 操作系统工具\n\n- 文件查找搜索：✨[Everything](https://www.voidtools.com/zh-cn/)\n\n### 网页工具\n\n- ✨腾讯杂项在线工具：[杂项工具箱](https://tool.browser.qq.com/)\n- ✨画图工具：[ProcessOn](https://www.processon.com/)\n- ✨[微信读书](https://weread.qq.com/)\n- [绘制3D架构图](https://icraft.gantcloud.com/)\n- [获取实时新闻](https://newsnow.busiyi.world/c/realtime)\n- [开源许可证选择器](https://open-source-license-chooser.toolsnav.top/zh/)\n\n### 操作系统\n\n* Windows：✨[MSDN-itellyou](https://msdn.itellyou.cn/)\n\n> 推荐使用LTSC版本的操作系统，系统比较纯净，但需要[激活](https://www.icloud.com.cn/iclouddrive/009dT5FmvFW1dVjWVR8XkFnSA#HEU_KMS_Activator)\n\n* Linux：[CentOS](https://www.centos.org/download/)\n\n> 比较推荐直接去一些软件源上下载，这里举例[清华源](https://mirrors.tuna.tsinghua.edu.cn/ubuntu-cdimage/releases/23.04/release/)\n\n### 浏览器插件\n\n- ✨[AdGuard AdBlocker](https://chrome.google.com/webstore/detail/adguard-adblocker/bgnkhhnnamicmpeenaelnjfhikgbkllg)拦截广告\n- ✨[FireShot](https://chrome.google.com/webstore/detail/take-webpage-screenshots/mcbpblocgmgfnpjjppndjkmgjaogfceg) 捕捉网页截图\n- ✨[Wappalyzer](https://www.wappalyzer.com/apps/?utm_source=popup&utm_medium=extension&utm_campaign=wappalyzer) *分析网站所使用的组件*\n","slug":"常用软件记录","published":1,"updated":"2025-03-28T06:12:36.685Z","comments":1,"layout":"post","photos":[],"_id":"cm8se3tdw001mbb8lg5kmge0s","content":"<p>用于记录和分享一些自己在 Windows 、macOS、IOS 下遇到的一些好用的软件和工具。</p>\n<span id=\"more\"></span>\n\n<h3 id=\"操作系统工具\"><a href=\"#操作系统工具\" class=\"headerlink\" title=\"操作系统工具\"></a>操作系统工具</h3><h4 id=\"日常使用\"><a href=\"#日常使用\" class=\"headerlink\" title=\"日常使用\"></a>日常使用</h4><ul>\n<li><strong>视频会议</strong>：✨<a href=\"https://meeting.tencent.com/\">腾讯会议</a></li>\n<li><strong>文件解压缩：</strong><a href=\"https://ezip.awehunt.com/\">MacZip</a></li>\n<li><strong>待办提醒</strong>：苹果提醒事项、苹果便签</li>\n<li><strong>电子邮件</strong>：苹果邮件</li>\n<li><strong>聊天工具</strong>：<a href=\"https://weixin.qq.com/\">微信</a>、<a href=\"https://work.weixin.qq.com/\">企业微信</a></li>\n<li>翻译：微信截图翻译、<a href=\"https://tongyi.aliyun.com/\">通义千问</a></li>\n<li>VPN：<a href=\"https://ric.asiway.org/?shortlink=0gesgjiu&c=cs-articles&pid=activity&af_xp=custom&source_caller=ui\">LetsVPN</a>、✨<a href=\"https://jpin.taishan666.xyz/\">Taishan Net</a></li>\n<li><strong>备忘录</strong>：苹果备忘录、✨<a href=\"https://flomoapp.com/\">Flomo</a></li>\n<li>日程管理：苹果日历</li>\n<li>写作工具：✨<a href=\"https://www.icloud.com.cn/iclouddrive/07dw7bzS6ec_XBnGQdwoXgcPw#Typora_1.6.7_osx\">Typora</a></li>\n<li>图床：<a href=\"https://picgo.github.io/PicGo-Doc/\">PicGO</a></li>\n<li>输入法：<a href=\"https://pinyin.sogou.com/mac/\">搜狗输入法</a>、✨<a href=\"https://z.weixin.qq.com/\">微信输入法</a></li>\n<li>软件包管理：<a href=\"https://brew.sh/\">Homebrew</a></li>\n</ul>\n<h4 id=\"开发工具\"><a href=\"#开发工具\" class=\"headerlink\" title=\"开发工具\"></a>开发工具</h4><ul>\n<li><strong>代码编辑器</strong>：✨<a href=\"https://www.jetbrains.com/\">IDEA</a>、✨<a href=\"https://code.visualstudio.com/\">VSCode</a></li>\n<li>Git：<a href=\"https://git-scm.com/download\">Git</a>、<a href=\"https://formulae.brew.sh/formula/subversion#default\">SVN</a></li>\n<li><strong>浏览器</strong>：✨<a href=\"https://www.google.cn/chrome/index.html\">Google Chrome</a></li>\n<li><strong>虚拟化</strong>：<a href=\"https://www.docker.com/\">Docker</a>、✨<a href=\"https://www.icloud.com.cn/iclouddrive/051LwYlz9I5q-75mQjuesqPDg#ParallelsDesktop-18.1.1-53328_M_osx\">Parallels Desktop</a></li>\n<li>终端工具：✨<a href=\"https://windterm.org/\">WindTerm</a></li>\n<li>数据库工具：✨Navicat、<a href=\"https://www.dameng.com/DM8.html\">达梦数据库</a>、<a href=\"https://github.com/qishibo/AnotherRedisDesktopManager\">Another Redis Desktop Manager</a></li>\n<li>远程工具：<a href=\"https://apps.apple.com/tw/app/microsoft-remote-desktop/id1295203466\">Microsoft Remote Desktop</a></li>\n<li>数据库建模工具：✨<a href=\"https://gitee.com/robergroup/pdmaner/releases\">PDManer</a></li>\n<li>接口测试工具：<a href=\"https://www.postman.com/downloads/\">Postman</a>、<a href=\"https://jmeter.apache.org/\">Jemter</a></li>\n</ul>\n<h3 id=\"操作系统工具-1\"><a href=\"#操作系统工具-1\" class=\"headerlink\" title=\"操作系统工具\"></a>操作系统工具</h3><ul>\n<li>文件查找搜索：✨<a href=\"https://www.voidtools.com/zh-cn/\">Everything</a></li>\n</ul>\n<h3 id=\"网页工具\"><a href=\"#网页工具\" class=\"headerlink\" title=\"网页工具\"></a>网页工具</h3><ul>\n<li>✨腾讯杂项在线工具：<a href=\"https://tool.browser.qq.com/\">杂项工具箱</a></li>\n<li>✨画图工具：<a href=\"https://www.processon.com/\">ProcessOn</a></li>\n<li>✨<a href=\"https://weread.qq.com/\">微信读书</a></li>\n<li><a href=\"https://icraft.gantcloud.com/\">绘制3D架构图</a></li>\n<li><a href=\"https://newsnow.busiyi.world/c/realtime\">获取实时新闻</a></li>\n<li><a href=\"https://open-source-license-chooser.toolsnav.top/zh/\">开源许可证选择器</a></li>\n</ul>\n<h3 id=\"操作系统\"><a href=\"#操作系统\" class=\"headerlink\" title=\"操作系统\"></a>操作系统</h3><ul>\n<li>Windows：✨<a href=\"https://msdn.itellyou.cn/\">MSDN-itellyou</a></li>\n</ul>\n<blockquote>\n<p>推荐使用LTSC版本的操作系统，系统比较纯净，但需要<a href=\"https://www.icloud.com.cn/iclouddrive/009dT5FmvFW1dVjWVR8XkFnSA#HEU_KMS_Activator\">激活</a></p>\n</blockquote>\n<ul>\n<li>Linux：<a href=\"https://www.centos.org/download/\">CentOS</a></li>\n</ul>\n<blockquote>\n<p>比较推荐直接去一些软件源上下载，这里举例<a href=\"https://mirrors.tuna.tsinghua.edu.cn/ubuntu-cdimage/releases/23.04/release/\">清华源</a></p>\n</blockquote>\n<h3 id=\"浏览器插件\"><a href=\"#浏览器插件\" class=\"headerlink\" title=\"浏览器插件\"></a>浏览器插件</h3><ul>\n<li>✨<a href=\"https://chrome.google.com/webstore/detail/adguard-adblocker/bgnkhhnnamicmpeenaelnjfhikgbkllg\">AdGuard AdBlocker</a>拦截广告</li>\n<li>✨<a href=\"https://chrome.google.com/webstore/detail/take-webpage-screenshots/mcbpblocgmgfnpjjppndjkmgjaogfceg\">FireShot</a> 捕捉网页截图</li>\n<li>✨<a href=\"https://www.wappalyzer.com/apps/?utm_source=popup&utm_medium=extension&utm_campaign=wappalyzer\">Wappalyzer</a> <em>分析网站所使用的组件</em></li>\n</ul>\n","excerpt":"<p>用于记录和分享一些自己在 Windows 、macOS、IOS 下遇到的一些好用的软件和工具。</p>","more":"<h3 id=\"操作系统工具\"><a href=\"#操作系统工具\" class=\"headerlink\" title=\"操作系统工具\"></a>操作系统工具</h3><h4 id=\"日常使用\"><a href=\"#日常使用\" class=\"headerlink\" title=\"日常使用\"></a>日常使用</h4><ul>\n<li><strong>视频会议</strong>：✨<a href=\"https://meeting.tencent.com/\">腾讯会议</a></li>\n<li><strong>文件解压缩：</strong><a href=\"https://ezip.awehunt.com/\">MacZip</a></li>\n<li><strong>待办提醒</strong>：苹果提醒事项、苹果便签</li>\n<li><strong>电子邮件</strong>：苹果邮件</li>\n<li><strong>聊天工具</strong>：<a href=\"https://weixin.qq.com/\">微信</a>、<a href=\"https://work.weixin.qq.com/\">企业微信</a></li>\n<li>翻译：微信截图翻译、<a href=\"https://tongyi.aliyun.com/\">通义千问</a></li>\n<li>VPN：<a href=\"https://ric.asiway.org/?shortlink=0gesgjiu&c=cs-articles&pid=activity&af_xp=custom&source_caller=ui\">LetsVPN</a>、✨<a href=\"https://jpin.taishan666.xyz/\">Taishan Net</a></li>\n<li><strong>备忘录</strong>：苹果备忘录、✨<a href=\"https://flomoapp.com/\">Flomo</a></li>\n<li>日程管理：苹果日历</li>\n<li>写作工具：✨<a href=\"https://www.icloud.com.cn/iclouddrive/07dw7bzS6ec_XBnGQdwoXgcPw#Typora_1.6.7_osx\">Typora</a></li>\n<li>图床：<a href=\"https://picgo.github.io/PicGo-Doc/\">PicGO</a></li>\n<li>输入法：<a href=\"https://pinyin.sogou.com/mac/\">搜狗输入法</a>、✨<a href=\"https://z.weixin.qq.com/\">微信输入法</a></li>\n<li>软件包管理：<a href=\"https://brew.sh/\">Homebrew</a></li>\n</ul>\n<h4 id=\"开发工具\"><a href=\"#开发工具\" class=\"headerlink\" title=\"开发工具\"></a>开发工具</h4><ul>\n<li><strong>代码编辑器</strong>：✨<a href=\"https://www.jetbrains.com/\">IDEA</a>、✨<a href=\"https://code.visualstudio.com/\">VSCode</a></li>\n<li>Git：<a href=\"https://git-scm.com/download\">Git</a>、<a href=\"https://formulae.brew.sh/formula/subversion#default\">SVN</a></li>\n<li><strong>浏览器</strong>：✨<a href=\"https://www.google.cn/chrome/index.html\">Google Chrome</a></li>\n<li><strong>虚拟化</strong>：<a href=\"https://www.docker.com/\">Docker</a>、✨<a href=\"https://www.icloud.com.cn/iclouddrive/051LwYlz9I5q-75mQjuesqPDg#ParallelsDesktop-18.1.1-53328_M_osx\">Parallels Desktop</a></li>\n<li>终端工具：✨<a href=\"https://windterm.org/\">WindTerm</a></li>\n<li>数据库工具：✨Navicat、<a href=\"https://www.dameng.com/DM8.html\">达梦数据库</a>、<a href=\"https://github.com/qishibo/AnotherRedisDesktopManager\">Another Redis Desktop Manager</a></li>\n<li>远程工具：<a href=\"https://apps.apple.com/tw/app/microsoft-remote-desktop/id1295203466\">Microsoft Remote Desktop</a></li>\n<li>数据库建模工具：✨<a href=\"https://gitee.com/robergroup/pdmaner/releases\">PDManer</a></li>\n<li>接口测试工具：<a href=\"https://www.postman.com/downloads/\">Postman</a>、<a href=\"https://jmeter.apache.org/\">Jemter</a></li>\n</ul>\n<h3 id=\"操作系统工具-1\"><a href=\"#操作系统工具-1\" class=\"headerlink\" title=\"操作系统工具\"></a>操作系统工具</h3><ul>\n<li>文件查找搜索：✨<a href=\"https://www.voidtools.com/zh-cn/\">Everything</a></li>\n</ul>\n<h3 id=\"网页工具\"><a href=\"#网页工具\" class=\"headerlink\" title=\"网页工具\"></a>网页工具</h3><ul>\n<li>✨腾讯杂项在线工具：<a href=\"https://tool.browser.qq.com/\">杂项工具箱</a></li>\n<li>✨画图工具：<a href=\"https://www.processon.com/\">ProcessOn</a></li>\n<li>✨<a href=\"https://weread.qq.com/\">微信读书</a></li>\n<li><a href=\"https://icraft.gantcloud.com/\">绘制3D架构图</a></li>\n<li><a href=\"https://newsnow.busiyi.world/c/realtime\">获取实时新闻</a></li>\n<li><a href=\"https://open-source-license-chooser.toolsnav.top/zh/\">开源许可证选择器</a></li>\n</ul>\n<h3 id=\"操作系统\"><a href=\"#操作系统\" class=\"headerlink\" title=\"操作系统\"></a>操作系统</h3><ul>\n<li>Windows：✨<a href=\"https://msdn.itellyou.cn/\">MSDN-itellyou</a></li>\n</ul>\n<blockquote>\n<p>推荐使用LTSC版本的操作系统，系统比较纯净，但需要<a href=\"https://www.icloud.com.cn/iclouddrive/009dT5FmvFW1dVjWVR8XkFnSA#HEU_KMS_Activator\">激活</a></p>\n</blockquote>\n<ul>\n<li>Linux：<a href=\"https://www.centos.org/download/\">CentOS</a></li>\n</ul>\n<blockquote>\n<p>比较推荐直接去一些软件源上下载，这里举例<a href=\"https://mirrors.tuna.tsinghua.edu.cn/ubuntu-cdimage/releases/23.04/release/\">清华源</a></p>\n</blockquote>\n<h3 id=\"浏览器插件\"><a href=\"#浏览器插件\" class=\"headerlink\" title=\"浏览器插件\"></a>浏览器插件</h3><ul>\n<li>✨<a href=\"https://chrome.google.com/webstore/detail/adguard-adblocker/bgnkhhnnamicmpeenaelnjfhikgbkllg\">AdGuard AdBlocker</a>拦截广告</li>\n<li>✨<a href=\"https://chrome.google.com/webstore/detail/take-webpage-screenshots/mcbpblocgmgfnpjjppndjkmgjaogfceg\">FireShot</a> 捕捉网页截图</li>\n<li>✨<a href=\"https://www.wappalyzer.com/apps/?utm_source=popup&utm_medium=extension&utm_campaign=wappalyzer\">Wappalyzer</a> <em>分析网站所使用的组件</em></li>\n</ul>"},{"title":"微信读书这个技巧让免费阅读成为可能","abbrlink":"6b5ee4f0","date":"2024-02-27T17:14:25.000Z","toc":true,"_content":"<meta name=\"referrer\" content=\"no-referrer\" />\n\n本文用于分享一些微信读书的一些技巧和方法，目的在于让免费阅读成为可能。\n\n<!--more-->\n\n## 前言\n\n元宵节前夕，微信读书书友圈的一个书友发了一篇寻求建议的文章，需求是“想看微信读书上的一些书籍，但书籍看到一半发现要充会员才能看，犹豫要不要充的问题”。我也顺便参与讨论了一些，表达了不建议充的观点和逻辑，没想到引起了很多人的兴趣，所以在此把一些自己的方法和资源分享出来。\n\n> 【微信读书】是基于微信关系链的官方阅读应用，同时支持IOS、Web、安卓和iPad终端平台。\n>\n> 在提供美妙阅读体验的同时，为用户推荐合适的书籍，并可查看微信好友的读书动态、与好友讨论正在阅读的书籍等。\n\n对于微信读书的技巧，我主要分享两点，也是很多人会遇到的：\n\n1. 解决想用微信读书但某些书籍在微信读书找不到的问题；\n2. 解决微信读书看一半发现要付费权益卡的问题；\n\n同时在这两点之上，再穿插分享一些关于微信读书的使用技巧，如：书籍和寻找和导入、微信读书的阅读机制（包括：时长兑换福利、阅读挑战赛、读书小队、微信活动）、笔记的使用技巧、期刊订阅等等。同时对于微信付费会员卡和体验卡的差异进行对比，帮助大家更好的了解微信读书这个很棒的工具。\n\n综合以上所述，本文的大纲如下：\n\n1. 书籍的寻找和导入\n2. 同步微信文章收藏\n3. 善用微信读书机制\n\n- 时长兑福利\n- 每日福利\n\n4. 笔记的使用技巧\n5. 期刊订阅\n6. 组建微信读书群\n7. 付费会员卡和体验卡的对比\n\n## 书籍的寻找和导入\n\n首先这个是一个很棒的功能，微信读书知道自己不可能把所有的书籍资源都包含进去，所以给我们开放了一个接口，这个接口允许我们自己上传书籍到书架中去阅读。那么这就涉及到了两个问题：第一如何找书的问题？第二怎么上传到微信读书书架的问题？\n\n### 怎么找书？\n\n找书的前提是知道书名、作者，或者知道这本书长啥样。对于如何找书，我一般使用下面的几个资源网站：\n\n1. [ZLibrary图书馆](https://zlibrary-sg.se)：Z-Library号称世界上最大的电子图书馆。🌟\n2. [鸠摩搜索-文档搜索引擎](https://www.jiumodiary.com/)\n3. [书格](https://www.shuge.org/)：主要提供古籍搜索\n\n以上三个都是时间比较久，知名度比较高的站点，相对来说更加稳定可靠一些。也会有些专门的导航站，用于收集各种网站资源，但是我这里不推荐，因为容易死掉，可能哪天就用不成了。你可以自己收藏在浏览器中，用的时候直接点。\n\n另外要说的一点是ZLibrary是国外的，有可能会因为国内的网络环境原因这个网址就突然不能访问了，这个时候你用必应去搜索“Zlibrary 镜像站”就会找到可用的站。或者使用科学上网的方法进行访问。\n\n以ZLibrary举例，我们找《毛泽东选集》这本书，那么在搜索栏直接搜就好了。然后下载我们所需要的版本，\n\n![毛泽东选集](https://qiniu-image.gotojava.cn/blog/image-20240227182343013.png)\n\n在下载时，优先下载 epub 和 mobi两种格式的书籍，都没有的时候，再去考虑其他的。目前微信读书支持的导入格式有：txt、epub、pdf、doc、docx、mobi、azw3，市面上流行的格式基本上都支持。\n\n### 导入书籍\n\n说完了找书，那我们来说说导入。对于电脑端的用户可以使用浏览器进行导入，对于IOS、安卓用户可以使用手机进行导入，只要你设备上有这个资源就行了。\n\n- [电脑端导入](https://weread.qq.com/web/upload)\n\n![电脑端导入书籍](https://qiniu-image.gotojava.cn/blog/image-20240227183809609.png)\n\n然后选择上传的文件，就可以导入啦。\n\n- 手机端导入\n\n![手机端导入](https://qiniu-image.gotojava.cn/blog/image-20240227184050784.png)\n\n导入完成后，就可以在微信读书的书架上看到了，多端同步的。\n\n对于一些英文书籍，最新版的微信读书支持自动翻译功能和一些细节性的参数调整，这个可以在设置中设置。\n\n![参数设置调整](https://qiniu-image.gotojava.cn/blog/image-20240227184632888.png)\n\n## 同步微信公众号文章\n\n现在的自媒体时代，很多人会通过微信公众号来发布文章，我们可以将不错的文章加入到微信收藏中，微信读书可以同步这些收藏的文章，这样就可以实现集中管理。\n\n在微信读书的“设置”-“隐私”-“微信公众号文章”中可以授权。\n\n![微信公众号文章同步](https://qiniu-image.gotojava.cn/blog/image-20240227185300500.png)\n\n## 善用微信读书机制\n\n这里的微信读书机制是指微信读书App为了提高书友的活跃度和用户黏性，通过活动来刺激书友参与阅读和分享观点的。这些活动包括送书、送书币、送体验卡等等，其目的在于让用户参与到阅读中去，只要你一直看，你就一直会得到奖励，通过这些奖励你再继续去阅读更多的书。\n\n### 时长兑福利\n\n书友可以通过“读书排行榜”-“时长兑换福利”来通过阅读的时间来兑换书币和临时体验卡，这些书币也是临时的，不用的话一个月左右就会失效。书币可以用来购买书籍，如果书币额度不够可以花钱充值，充值的书币不会失效。\n\n### 每日福利\n\n在微信读书的“阅读“页面中，有一个”每日福利“的版块，提供了一些免费获取书、书币、付费体验卡的活动。这些活动我们都可以参与。这些活动包括”答题闯关“、”阅读挑战赛“、”每日一答“、”积攒/组队抽体验卡“的活动，这些活动也增加了阅读的趣味性。\n\n![福利场](https://qiniu-image.gotojava.cn/blog/image-20240227191705084.png)\n\n比较有意思的一个是”读书小队“，一个小队可以有6个人，其中有一个人是队长。通过登陆、阅读、互动评论、每日一答来积攒积分，积分可以用来兑换体验卡和抽书。连阅读都卷死来了~\n\n![读书小队](https://qiniu-image.gotojava.cn/blog/image-20240227191812072.png)\n\n## 笔记的使用技巧\n\n### 手机端\n\n微信读书的笔记功能是一大靓点。对于手机端用户和网页端用户，可以对内容进行划线和标注。还可以留下你的想法让更多人看到与他人进行交流，同时也可以分享书摘、查询关键词的含义和寻找与关键词相关的书籍。\n\n![笔记标注](https://qiniu-image.gotojava.cn/blog/image-20240227192839345.png)\n\n### IPad端\n\n对于有iPad的用户，也可以试试微信读书IPad版的”Pencil笔记模式“，配合类纸膜写笔记很舒服~\n\n![导出笔记](https://qiniu-image.gotojava.cn/blog/image-20240227193808139.png)\n\n### 下载笔记\n\n我们在书中留下了很多零零散散的观点和想法，这些是我们阅读的痕迹。微信读书支持我们将自己的笔记导出来。\n\n![下载笔记](https://qiniu-image.gotojava.cn/blog/image-20240227195213241.png)\n\n微信读书允许我们将笔记复制到剪贴板中，在电脑上时我们可以把笔记复制到word中进行排版。\n\n具体可以参考Up主的分享：[超高效的读书笔记整理技巧 | 如何在 5 分钟内快速整理读书笔记？](https://www.bilibili.com/video/BV1vK4y1d7Wk/?vd_source=2467d52477b91eac005d50efcda2bfbe)\n\n## 期刊订阅\n\n微信读书也是可以订阅期刊的，期刊可以帮助我们了解行业或者某领域的最新消息和研究成果，内容也是比较权威和严谨的，对于我们快速学习非常有帮助。在当前知识碎片化的时代，期刊也是系统性学习的一部分。\n\n在微信读书中，可以通过”阅读“-”分类“-”期刊杂志“进行订阅，已订阅的内容可以在”我“-”订阅“-”期刊杂志“中查看和加入书架进行阅读。但需要注意的是期刊内容大部分是付费会员才可以看的，如果想免费阅读我们也可以自己下载和导入期刊。\n\n## 组建微信读书群\n\n组建读书群的目的有三：\n\n1. 解答以上步骤中遇到的问题和疑惑。\n\n很多朋友如果在上述的操作中遇到问题，可以通过在读书群中问答的方式得到解决。\n\n2. 通过微信读书群组建共读会\n\n一个人可以走的很快，一群人可以走的很远。共读不仅可以集众人之智，帮助我们读懂那些艰深的书，还能够构建一个知识共同体（学习环境）。这个共同体在我们读完书后也会继续存在下去。\n\n3. 通过集思广益获得更多的技巧和方法\n\n比如有些书籍你可能就是找不到，那么可以向其他人获取思路和资源消除信息差；对于在阅读中遇到的问题可能困扰了你许久，那么兴许他人的方法会对你有所帮助；\n\n不知道看什么书？也许他人的推荐就解答你的疑惑。\n\n如果你希望得到上述的帮助，那么欢迎加入我们~（加我微信我拉你入群。WeChat：yz2638385556，验证备注：微信读书群）\n\n## 付费会员卡和体验卡的对比\n\n这个对比是根据官方提供的付费会员卡和体验卡功能清单分析的\n\n![付费会员卡和体验卡的对比](https://qiniu-image.gotojava.cn/blog/image-20240227210452951.png)\n\n通过官方的功能清单发现，如果你是喜欢听书的，每周的阅读时间在5个小时左右，那么你开会员是划算的。如果你只是零散阅读，那么建议还是用体验卡更划算一些。对于一些书籍可以用书币购买的直接用书币购买，不能的或者书币不够的，自己下载资源导入吧~\n\n## 总结\n\n分享了关于微信读书的一些免费阅读方法和使用技巧。但对于微信读书的功能远不止这些，还有很多的技巧等待着我们去挖掘和发现。如果你有更好的资源或技巧也欢迎通过评论区分享~\n","source":"_posts/微信读书这些技巧让免费阅读成为可能.md","raw":"---\ntitle: '微信读书这个技巧让免费阅读成为可能'\nabbrlink: 6b5ee4f0\ndate: 2024-02-27 17:14:25\ntoc: true\n---\n<meta name=\"referrer\" content=\"no-referrer\" />\n\n本文用于分享一些微信读书的一些技巧和方法，目的在于让免费阅读成为可能。\n\n<!--more-->\n\n## 前言\n\n元宵节前夕，微信读书书友圈的一个书友发了一篇寻求建议的文章，需求是“想看微信读书上的一些书籍，但书籍看到一半发现要充会员才能看，犹豫要不要充的问题”。我也顺便参与讨论了一些，表达了不建议充的观点和逻辑，没想到引起了很多人的兴趣，所以在此把一些自己的方法和资源分享出来。\n\n> 【微信读书】是基于微信关系链的官方阅读应用，同时支持IOS、Web、安卓和iPad终端平台。\n>\n> 在提供美妙阅读体验的同时，为用户推荐合适的书籍，并可查看微信好友的读书动态、与好友讨论正在阅读的书籍等。\n\n对于微信读书的技巧，我主要分享两点，也是很多人会遇到的：\n\n1. 解决想用微信读书但某些书籍在微信读书找不到的问题；\n2. 解决微信读书看一半发现要付费权益卡的问题；\n\n同时在这两点之上，再穿插分享一些关于微信读书的使用技巧，如：书籍和寻找和导入、微信读书的阅读机制（包括：时长兑换福利、阅读挑战赛、读书小队、微信活动）、笔记的使用技巧、期刊订阅等等。同时对于微信付费会员卡和体验卡的差异进行对比，帮助大家更好的了解微信读书这个很棒的工具。\n\n综合以上所述，本文的大纲如下：\n\n1. 书籍的寻找和导入\n2. 同步微信文章收藏\n3. 善用微信读书机制\n\n- 时长兑福利\n- 每日福利\n\n4. 笔记的使用技巧\n5. 期刊订阅\n6. 组建微信读书群\n7. 付费会员卡和体验卡的对比\n\n## 书籍的寻找和导入\n\n首先这个是一个很棒的功能，微信读书知道自己不可能把所有的书籍资源都包含进去，所以给我们开放了一个接口，这个接口允许我们自己上传书籍到书架中去阅读。那么这就涉及到了两个问题：第一如何找书的问题？第二怎么上传到微信读书书架的问题？\n\n### 怎么找书？\n\n找书的前提是知道书名、作者，或者知道这本书长啥样。对于如何找书，我一般使用下面的几个资源网站：\n\n1. [ZLibrary图书馆](https://zlibrary-sg.se)：Z-Library号称世界上最大的电子图书馆。🌟\n2. [鸠摩搜索-文档搜索引擎](https://www.jiumodiary.com/)\n3. [书格](https://www.shuge.org/)：主要提供古籍搜索\n\n以上三个都是时间比较久，知名度比较高的站点，相对来说更加稳定可靠一些。也会有些专门的导航站，用于收集各种网站资源，但是我这里不推荐，因为容易死掉，可能哪天就用不成了。你可以自己收藏在浏览器中，用的时候直接点。\n\n另外要说的一点是ZLibrary是国外的，有可能会因为国内的网络环境原因这个网址就突然不能访问了，这个时候你用必应去搜索“Zlibrary 镜像站”就会找到可用的站。或者使用科学上网的方法进行访问。\n\n以ZLibrary举例，我们找《毛泽东选集》这本书，那么在搜索栏直接搜就好了。然后下载我们所需要的版本，\n\n![毛泽东选集](https://qiniu-image.gotojava.cn/blog/image-20240227182343013.png)\n\n在下载时，优先下载 epub 和 mobi两种格式的书籍，都没有的时候，再去考虑其他的。目前微信读书支持的导入格式有：txt、epub、pdf、doc、docx、mobi、azw3，市面上流行的格式基本上都支持。\n\n### 导入书籍\n\n说完了找书，那我们来说说导入。对于电脑端的用户可以使用浏览器进行导入，对于IOS、安卓用户可以使用手机进行导入，只要你设备上有这个资源就行了。\n\n- [电脑端导入](https://weread.qq.com/web/upload)\n\n![电脑端导入书籍](https://qiniu-image.gotojava.cn/blog/image-20240227183809609.png)\n\n然后选择上传的文件，就可以导入啦。\n\n- 手机端导入\n\n![手机端导入](https://qiniu-image.gotojava.cn/blog/image-20240227184050784.png)\n\n导入完成后，就可以在微信读书的书架上看到了，多端同步的。\n\n对于一些英文书籍，最新版的微信读书支持自动翻译功能和一些细节性的参数调整，这个可以在设置中设置。\n\n![参数设置调整](https://qiniu-image.gotojava.cn/blog/image-20240227184632888.png)\n\n## 同步微信公众号文章\n\n现在的自媒体时代，很多人会通过微信公众号来发布文章，我们可以将不错的文章加入到微信收藏中，微信读书可以同步这些收藏的文章，这样就可以实现集中管理。\n\n在微信读书的“设置”-“隐私”-“微信公众号文章”中可以授权。\n\n![微信公众号文章同步](https://qiniu-image.gotojava.cn/blog/image-20240227185300500.png)\n\n## 善用微信读书机制\n\n这里的微信读书机制是指微信读书App为了提高书友的活跃度和用户黏性，通过活动来刺激书友参与阅读和分享观点的。这些活动包括送书、送书币、送体验卡等等，其目的在于让用户参与到阅读中去，只要你一直看，你就一直会得到奖励，通过这些奖励你再继续去阅读更多的书。\n\n### 时长兑福利\n\n书友可以通过“读书排行榜”-“时长兑换福利”来通过阅读的时间来兑换书币和临时体验卡，这些书币也是临时的，不用的话一个月左右就会失效。书币可以用来购买书籍，如果书币额度不够可以花钱充值，充值的书币不会失效。\n\n### 每日福利\n\n在微信读书的“阅读“页面中，有一个”每日福利“的版块，提供了一些免费获取书、书币、付费体验卡的活动。这些活动我们都可以参与。这些活动包括”答题闯关“、”阅读挑战赛“、”每日一答“、”积攒/组队抽体验卡“的活动，这些活动也增加了阅读的趣味性。\n\n![福利场](https://qiniu-image.gotojava.cn/blog/image-20240227191705084.png)\n\n比较有意思的一个是”读书小队“，一个小队可以有6个人，其中有一个人是队长。通过登陆、阅读、互动评论、每日一答来积攒积分，积分可以用来兑换体验卡和抽书。连阅读都卷死来了~\n\n![读书小队](https://qiniu-image.gotojava.cn/blog/image-20240227191812072.png)\n\n## 笔记的使用技巧\n\n### 手机端\n\n微信读书的笔记功能是一大靓点。对于手机端用户和网页端用户，可以对内容进行划线和标注。还可以留下你的想法让更多人看到与他人进行交流，同时也可以分享书摘、查询关键词的含义和寻找与关键词相关的书籍。\n\n![笔记标注](https://qiniu-image.gotojava.cn/blog/image-20240227192839345.png)\n\n### IPad端\n\n对于有iPad的用户，也可以试试微信读书IPad版的”Pencil笔记模式“，配合类纸膜写笔记很舒服~\n\n![导出笔记](https://qiniu-image.gotojava.cn/blog/image-20240227193808139.png)\n\n### 下载笔记\n\n我们在书中留下了很多零零散散的观点和想法，这些是我们阅读的痕迹。微信读书支持我们将自己的笔记导出来。\n\n![下载笔记](https://qiniu-image.gotojava.cn/blog/image-20240227195213241.png)\n\n微信读书允许我们将笔记复制到剪贴板中，在电脑上时我们可以把笔记复制到word中进行排版。\n\n具体可以参考Up主的分享：[超高效的读书笔记整理技巧 | 如何在 5 分钟内快速整理读书笔记？](https://www.bilibili.com/video/BV1vK4y1d7Wk/?vd_source=2467d52477b91eac005d50efcda2bfbe)\n\n## 期刊订阅\n\n微信读书也是可以订阅期刊的，期刊可以帮助我们了解行业或者某领域的最新消息和研究成果，内容也是比较权威和严谨的，对于我们快速学习非常有帮助。在当前知识碎片化的时代，期刊也是系统性学习的一部分。\n\n在微信读书中，可以通过”阅读“-”分类“-”期刊杂志“进行订阅，已订阅的内容可以在”我“-”订阅“-”期刊杂志“中查看和加入书架进行阅读。但需要注意的是期刊内容大部分是付费会员才可以看的，如果想免费阅读我们也可以自己下载和导入期刊。\n\n## 组建微信读书群\n\n组建读书群的目的有三：\n\n1. 解答以上步骤中遇到的问题和疑惑。\n\n很多朋友如果在上述的操作中遇到问题，可以通过在读书群中问答的方式得到解决。\n\n2. 通过微信读书群组建共读会\n\n一个人可以走的很快，一群人可以走的很远。共读不仅可以集众人之智，帮助我们读懂那些艰深的书，还能够构建一个知识共同体（学习环境）。这个共同体在我们读完书后也会继续存在下去。\n\n3. 通过集思广益获得更多的技巧和方法\n\n比如有些书籍你可能就是找不到，那么可以向其他人获取思路和资源消除信息差；对于在阅读中遇到的问题可能困扰了你许久，那么兴许他人的方法会对你有所帮助；\n\n不知道看什么书？也许他人的推荐就解答你的疑惑。\n\n如果你希望得到上述的帮助，那么欢迎加入我们~（加我微信我拉你入群。WeChat：yz2638385556，验证备注：微信读书群）\n\n## 付费会员卡和体验卡的对比\n\n这个对比是根据官方提供的付费会员卡和体验卡功能清单分析的\n\n![付费会员卡和体验卡的对比](https://qiniu-image.gotojava.cn/blog/image-20240227210452951.png)\n\n通过官方的功能清单发现，如果你是喜欢听书的，每周的阅读时间在5个小时左右，那么你开会员是划算的。如果你只是零散阅读，那么建议还是用体验卡更划算一些。对于一些书籍可以用书币购买的直接用书币购买，不能的或者书币不够的，自己下载资源导入吧~\n\n## 总结\n\n分享了关于微信读书的一些免费阅读方法和使用技巧。但对于微信读书的功能远不止这些，还有很多的技巧等待着我们去挖掘和发现。如果你有更好的资源或技巧也欢迎通过评论区分享~\n","slug":"微信读书这些技巧让免费阅读成为可能","published":1,"updated":"2025-03-28T06:10:05.659Z","comments":1,"layout":"post","photos":[],"_id":"cm8se3tdx001pbb8l8zj31atr","content":"<meta name=\"referrer\" content=\"no-referrer\" />\n\n<p>本文用于分享一些微信读书的一些技巧和方法，目的在于让免费阅读成为可能。</p>\n<span id=\"more\"></span>\n\n<h2 id=\"前言\"><a href=\"#前言\" class=\"headerlink\" title=\"前言\"></a>前言</h2><p>元宵节前夕，微信读书书友圈的一个书友发了一篇寻求建议的文章，需求是“想看微信读书上的一些书籍，但书籍看到一半发现要充会员才能看，犹豫要不要充的问题”。我也顺便参与讨论了一些，表达了不建议充的观点和逻辑，没想到引起了很多人的兴趣，所以在此把一些自己的方法和资源分享出来。</p>\n<blockquote>\n<p>【微信读书】是基于微信关系链的官方阅读应用，同时支持IOS、Web、安卓和iPad终端平台。</p>\n<p>在提供美妙阅读体验的同时，为用户推荐合适的书籍，并可查看微信好友的读书动态、与好友讨论正在阅读的书籍等。</p>\n</blockquote>\n<p>对于微信读书的技巧，我主要分享两点，也是很多人会遇到的：</p>\n<ol>\n<li>解决想用微信读书但某些书籍在微信读书找不到的问题；</li>\n<li>解决微信读书看一半发现要付费权益卡的问题；</li>\n</ol>\n<p>同时在这两点之上，再穿插分享一些关于微信读书的使用技巧，如：书籍和寻找和导入、微信读书的阅读机制（包括：时长兑换福利、阅读挑战赛、读书小队、微信活动）、笔记的使用技巧、期刊订阅等等。同时对于微信付费会员卡和体验卡的差异进行对比，帮助大家更好的了解微信读书这个很棒的工具。</p>\n<p>综合以上所述，本文的大纲如下：</p>\n<ol>\n<li>书籍的寻找和导入</li>\n<li>同步微信文章收藏</li>\n<li>善用微信读书机制</li>\n</ol>\n<ul>\n<li>时长兑福利</li>\n<li>每日福利</li>\n</ul>\n<ol start=\"4\">\n<li>笔记的使用技巧</li>\n<li>期刊订阅</li>\n<li>组建微信读书群</li>\n<li>付费会员卡和体验卡的对比</li>\n</ol>\n<h2 id=\"书籍的寻找和导入\"><a href=\"#书籍的寻找和导入\" class=\"headerlink\" title=\"书籍的寻找和导入\"></a>书籍的寻找和导入</h2><p>首先这个是一个很棒的功能，微信读书知道自己不可能把所有的书籍资源都包含进去，所以给我们开放了一个接口，这个接口允许我们自己上传书籍到书架中去阅读。那么这就涉及到了两个问题：第一如何找书的问题？第二怎么上传到微信读书书架的问题？</p>\n<h3 id=\"怎么找书？\"><a href=\"#怎么找书？\" class=\"headerlink\" title=\"怎么找书？\"></a>怎么找书？</h3><p>找书的前提是知道书名、作者，或者知道这本书长啥样。对于如何找书，我一般使用下面的几个资源网站：</p>\n<ol>\n<li><a href=\"https://zlibrary-sg.se/\">ZLibrary图书馆</a>：Z-Library号称世界上最大的电子图书馆。🌟</li>\n<li><a href=\"https://www.jiumodiary.com/\">鸠摩搜索-文档搜索引擎</a></li>\n<li><a href=\"https://www.shuge.org/\">书格</a>：主要提供古籍搜索</li>\n</ol>\n<p>以上三个都是时间比较久，知名度比较高的站点，相对来说更加稳定可靠一些。也会有些专门的导航站，用于收集各种网站资源，但是我这里不推荐，因为容易死掉，可能哪天就用不成了。你可以自己收藏在浏览器中，用的时候直接点。</p>\n<p>另外要说的一点是ZLibrary是国外的，有可能会因为国内的网络环境原因这个网址就突然不能访问了，这个时候你用必应去搜索“Zlibrary 镜像站”就会找到可用的站。或者使用科学上网的方法进行访问。</p>\n<p>以ZLibrary举例，我们找《毛泽东选集》这本书，那么在搜索栏直接搜就好了。然后下载我们所需要的版本，</p>\n<p><img src=\"https://qiniu-image.gotojava.cn/blog/image-20240227182343013.png\" alt=\"毛泽东选集\"></p>\n<p>在下载时，优先下载 epub 和 mobi两种格式的书籍，都没有的时候，再去考虑其他的。目前微信读书支持的导入格式有：txt、epub、pdf、doc、docx、mobi、azw3，市面上流行的格式基本上都支持。</p>\n<h3 id=\"导入书籍\"><a href=\"#导入书籍\" class=\"headerlink\" title=\"导入书籍\"></a>导入书籍</h3><p>说完了找书，那我们来说说导入。对于电脑端的用户可以使用浏览器进行导入，对于IOS、安卓用户可以使用手机进行导入，只要你设备上有这个资源就行了。</p>\n<ul>\n<li><a href=\"https://weread.qq.com/web/upload\">电脑端导入</a></li>\n</ul>\n<p><img src=\"https://qiniu-image.gotojava.cn/blog/image-20240227183809609.png\" alt=\"电脑端导入书籍\"></p>\n<p>然后选择上传的文件，就可以导入啦。</p>\n<ul>\n<li>手机端导入</li>\n</ul>\n<p><img src=\"https://qiniu-image.gotojava.cn/blog/image-20240227184050784.png\" alt=\"手机端导入\"></p>\n<p>导入完成后，就可以在微信读书的书架上看到了，多端同步的。</p>\n<p>对于一些英文书籍，最新版的微信读书支持自动翻译功能和一些细节性的参数调整，这个可以在设置中设置。</p>\n<p><img src=\"https://qiniu-image.gotojava.cn/blog/image-20240227184632888.png\" alt=\"参数设置调整\"></p>\n<h2 id=\"同步微信公众号文章\"><a href=\"#同步微信公众号文章\" class=\"headerlink\" title=\"同步微信公众号文章\"></a>同步微信公众号文章</h2><p>现在的自媒体时代，很多人会通过微信公众号来发布文章，我们可以将不错的文章加入到微信收藏中，微信读书可以同步这些收藏的文章，这样就可以实现集中管理。</p>\n<p>在微信读书的“设置”-“隐私”-“微信公众号文章”中可以授权。</p>\n<p><img src=\"https://qiniu-image.gotojava.cn/blog/image-20240227185300500.png\" alt=\"微信公众号文章同步\"></p>\n<h2 id=\"善用微信读书机制\"><a href=\"#善用微信读书机制\" class=\"headerlink\" title=\"善用微信读书机制\"></a>善用微信读书机制</h2><p>这里的微信读书机制是指微信读书App为了提高书友的活跃度和用户黏性，通过活动来刺激书友参与阅读和分享观点的。这些活动包括送书、送书币、送体验卡等等，其目的在于让用户参与到阅读中去，只要你一直看，你就一直会得到奖励，通过这些奖励你再继续去阅读更多的书。</p>\n<h3 id=\"时长兑福利\"><a href=\"#时长兑福利\" class=\"headerlink\" title=\"时长兑福利\"></a>时长兑福利</h3><p>书友可以通过“读书排行榜”-“时长兑换福利”来通过阅读的时间来兑换书币和临时体验卡，这些书币也是临时的，不用的话一个月左右就会失效。书币可以用来购买书籍，如果书币额度不够可以花钱充值，充值的书币不会失效。</p>\n<h3 id=\"每日福利\"><a href=\"#每日福利\" class=\"headerlink\" title=\"每日福利\"></a>每日福利</h3><p>在微信读书的“阅读“页面中，有一个”每日福利“的版块，提供了一些免费获取书、书币、付费体验卡的活动。这些活动我们都可以参与。这些活动包括”答题闯关“、”阅读挑战赛“、”每日一答“、”积攒&#x2F;组队抽体验卡“的活动，这些活动也增加了阅读的趣味性。</p>\n<p><img src=\"https://qiniu-image.gotojava.cn/blog/image-20240227191705084.png\" alt=\"福利场\"></p>\n<p>比较有意思的一个是”读书小队“，一个小队可以有6个人，其中有一个人是队长。通过登陆、阅读、互动评论、每日一答来积攒积分，积分可以用来兑换体验卡和抽书。连阅读都卷死来了~</p>\n<p><img src=\"https://qiniu-image.gotojava.cn/blog/image-20240227191812072.png\" alt=\"读书小队\"></p>\n<h2 id=\"笔记的使用技巧\"><a href=\"#笔记的使用技巧\" class=\"headerlink\" title=\"笔记的使用技巧\"></a>笔记的使用技巧</h2><h3 id=\"手机端\"><a href=\"#手机端\" class=\"headerlink\" title=\"手机端\"></a>手机端</h3><p>微信读书的笔记功能是一大靓点。对于手机端用户和网页端用户，可以对内容进行划线和标注。还可以留下你的想法让更多人看到与他人进行交流，同时也可以分享书摘、查询关键词的含义和寻找与关键词相关的书籍。</p>\n<p><img src=\"https://qiniu-image.gotojava.cn/blog/image-20240227192839345.png\" alt=\"笔记标注\"></p>\n<h3 id=\"IPad端\"><a href=\"#IPad端\" class=\"headerlink\" title=\"IPad端\"></a>IPad端</h3><p>对于有iPad的用户，也可以试试微信读书IPad版的”Pencil笔记模式“，配合类纸膜写笔记很舒服~</p>\n<p><img src=\"https://qiniu-image.gotojava.cn/blog/image-20240227193808139.png\" alt=\"导出笔记\"></p>\n<h3 id=\"下载笔记\"><a href=\"#下载笔记\" class=\"headerlink\" title=\"下载笔记\"></a>下载笔记</h3><p>我们在书中留下了很多零零散散的观点和想法，这些是我们阅读的痕迹。微信读书支持我们将自己的笔记导出来。</p>\n<p><img src=\"https://qiniu-image.gotojava.cn/blog/image-20240227195213241.png\" alt=\"下载笔记\"></p>\n<p>微信读书允许我们将笔记复制到剪贴板中，在电脑上时我们可以把笔记复制到word中进行排版。</p>\n<p>具体可以参考Up主的分享：<a href=\"https://www.bilibili.com/video/BV1vK4y1d7Wk/?vd_source=2467d52477b91eac005d50efcda2bfbe\">超高效的读书笔记整理技巧 | 如何在 5 分钟内快速整理读书笔记？</a></p>\n<h2 id=\"期刊订阅\"><a href=\"#期刊订阅\" class=\"headerlink\" title=\"期刊订阅\"></a>期刊订阅</h2><p>微信读书也是可以订阅期刊的，期刊可以帮助我们了解行业或者某领域的最新消息和研究成果，内容也是比较权威和严谨的，对于我们快速学习非常有帮助。在当前知识碎片化的时代，期刊也是系统性学习的一部分。</p>\n<p>在微信读书中，可以通过”阅读“-”分类“-”期刊杂志“进行订阅，已订阅的内容可以在”我“-”订阅“-”期刊杂志“中查看和加入书架进行阅读。但需要注意的是期刊内容大部分是付费会员才可以看的，如果想免费阅读我们也可以自己下载和导入期刊。</p>\n<h2 id=\"组建微信读书群\"><a href=\"#组建微信读书群\" class=\"headerlink\" title=\"组建微信读书群\"></a>组建微信读书群</h2><p>组建读书群的目的有三：</p>\n<ol>\n<li>解答以上步骤中遇到的问题和疑惑。</li>\n</ol>\n<p>很多朋友如果在上述的操作中遇到问题，可以通过在读书群中问答的方式得到解决。</p>\n<ol start=\"2\">\n<li>通过微信读书群组建共读会</li>\n</ol>\n<p>一个人可以走的很快，一群人可以走的很远。共读不仅可以集众人之智，帮助我们读懂那些艰深的书，还能够构建一个知识共同体（学习环境）。这个共同体在我们读完书后也会继续存在下去。</p>\n<ol start=\"3\">\n<li>通过集思广益获得更多的技巧和方法</li>\n</ol>\n<p>比如有些书籍你可能就是找不到，那么可以向其他人获取思路和资源消除信息差；对于在阅读中遇到的问题可能困扰了你许久，那么兴许他人的方法会对你有所帮助；</p>\n<p>不知道看什么书？也许他人的推荐就解答你的疑惑。</p>\n<p>如果你希望得到上述的帮助，那么欢迎加入我们~（加我微信我拉你入群。WeChat：yz2638385556，验证备注：微信读书群）</p>\n<h2 id=\"付费会员卡和体验卡的对比\"><a href=\"#付费会员卡和体验卡的对比\" class=\"headerlink\" title=\"付费会员卡和体验卡的对比\"></a>付费会员卡和体验卡的对比</h2><p>这个对比是根据官方提供的付费会员卡和体验卡功能清单分析的</p>\n<p><img src=\"https://qiniu-image.gotojava.cn/blog/image-20240227210452951.png\" alt=\"付费会员卡和体验卡的对比\"></p>\n<p>通过官方的功能清单发现，如果你是喜欢听书的，每周的阅读时间在5个小时左右，那么你开会员是划算的。如果你只是零散阅读，那么建议还是用体验卡更划算一些。对于一些书籍可以用书币购买的直接用书币购买，不能的或者书币不够的，自己下载资源导入吧~</p>\n<h2 id=\"总结\"><a href=\"#总结\" class=\"headerlink\" title=\"总结\"></a>总结</h2><p>分享了关于微信读书的一些免费阅读方法和使用技巧。但对于微信读书的功能远不止这些，还有很多的技巧等待着我们去挖掘和发现。如果你有更好的资源或技巧也欢迎通过评论区分享~</p>\n","excerpt":"<meta name=\"referrer\" content=\"no-referrer\" />\n\n<p>本文用于分享一些微信读书的一些技巧和方法，目的在于让免费阅读成为可能。</p>","more":"<h2 id=\"前言\"><a href=\"#前言\" class=\"headerlink\" title=\"前言\"></a>前言</h2><p>元宵节前夕，微信读书书友圈的一个书友发了一篇寻求建议的文章，需求是“想看微信读书上的一些书籍，但书籍看到一半发现要充会员才能看，犹豫要不要充的问题”。我也顺便参与讨论了一些，表达了不建议充的观点和逻辑，没想到引起了很多人的兴趣，所以在此把一些自己的方法和资源分享出来。</p>\n<blockquote>\n<p>【微信读书】是基于微信关系链的官方阅读应用，同时支持IOS、Web、安卓和iPad终端平台。</p>\n<p>在提供美妙阅读体验的同时，为用户推荐合适的书籍，并可查看微信好友的读书动态、与好友讨论正在阅读的书籍等。</p>\n</blockquote>\n<p>对于微信读书的技巧，我主要分享两点，也是很多人会遇到的：</p>\n<ol>\n<li>解决想用微信读书但某些书籍在微信读书找不到的问题；</li>\n<li>解决微信读书看一半发现要付费权益卡的问题；</li>\n</ol>\n<p>同时在这两点之上，再穿插分享一些关于微信读书的使用技巧，如：书籍和寻找和导入、微信读书的阅读机制（包括：时长兑换福利、阅读挑战赛、读书小队、微信活动）、笔记的使用技巧、期刊订阅等等。同时对于微信付费会员卡和体验卡的差异进行对比，帮助大家更好的了解微信读书这个很棒的工具。</p>\n<p>综合以上所述，本文的大纲如下：</p>\n<ol>\n<li>书籍的寻找和导入</li>\n<li>同步微信文章收藏</li>\n<li>善用微信读书机制</li>\n</ol>\n<ul>\n<li>时长兑福利</li>\n<li>每日福利</li>\n</ul>\n<ol start=\"4\">\n<li>笔记的使用技巧</li>\n<li>期刊订阅</li>\n<li>组建微信读书群</li>\n<li>付费会员卡和体验卡的对比</li>\n</ol>\n<h2 id=\"书籍的寻找和导入\"><a href=\"#书籍的寻找和导入\" class=\"headerlink\" title=\"书籍的寻找和导入\"></a>书籍的寻找和导入</h2><p>首先这个是一个很棒的功能，微信读书知道自己不可能把所有的书籍资源都包含进去，所以给我们开放了一个接口，这个接口允许我们自己上传书籍到书架中去阅读。那么这就涉及到了两个问题：第一如何找书的问题？第二怎么上传到微信读书书架的问题？</p>\n<h3 id=\"怎么找书？\"><a href=\"#怎么找书？\" class=\"headerlink\" title=\"怎么找书？\"></a>怎么找书？</h3><p>找书的前提是知道书名、作者，或者知道这本书长啥样。对于如何找书，我一般使用下面的几个资源网站：</p>\n<ol>\n<li><a href=\"https://zlibrary-sg.se/\">ZLibrary图书馆</a>：Z-Library号称世界上最大的电子图书馆。🌟</li>\n<li><a href=\"https://www.jiumodiary.com/\">鸠摩搜索-文档搜索引擎</a></li>\n<li><a href=\"https://www.shuge.org/\">书格</a>：主要提供古籍搜索</li>\n</ol>\n<p>以上三个都是时间比较久，知名度比较高的站点，相对来说更加稳定可靠一些。也会有些专门的导航站，用于收集各种网站资源，但是我这里不推荐，因为容易死掉，可能哪天就用不成了。你可以自己收藏在浏览器中，用的时候直接点。</p>\n<p>另外要说的一点是ZLibrary是国外的，有可能会因为国内的网络环境原因这个网址就突然不能访问了，这个时候你用必应去搜索“Zlibrary 镜像站”就会找到可用的站。或者使用科学上网的方法进行访问。</p>\n<p>以ZLibrary举例，我们找《毛泽东选集》这本书，那么在搜索栏直接搜就好了。然后下载我们所需要的版本，</p>\n<p><img src=\"https://qiniu-image.gotojava.cn/blog/image-20240227182343013.png\" alt=\"毛泽东选集\"></p>\n<p>在下载时，优先下载 epub 和 mobi两种格式的书籍，都没有的时候，再去考虑其他的。目前微信读书支持的导入格式有：txt、epub、pdf、doc、docx、mobi、azw3，市面上流行的格式基本上都支持。</p>\n<h3 id=\"导入书籍\"><a href=\"#导入书籍\" class=\"headerlink\" title=\"导入书籍\"></a>导入书籍</h3><p>说完了找书，那我们来说说导入。对于电脑端的用户可以使用浏览器进行导入，对于IOS、安卓用户可以使用手机进行导入，只要你设备上有这个资源就行了。</p>\n<ul>\n<li><a href=\"https://weread.qq.com/web/upload\">电脑端导入</a></li>\n</ul>\n<p><img src=\"https://qiniu-image.gotojava.cn/blog/image-20240227183809609.png\" alt=\"电脑端导入书籍\"></p>\n<p>然后选择上传的文件，就可以导入啦。</p>\n<ul>\n<li>手机端导入</li>\n</ul>\n<p><img src=\"https://qiniu-image.gotojava.cn/blog/image-20240227184050784.png\" alt=\"手机端导入\"></p>\n<p>导入完成后，就可以在微信读书的书架上看到了，多端同步的。</p>\n<p>对于一些英文书籍，最新版的微信读书支持自动翻译功能和一些细节性的参数调整，这个可以在设置中设置。</p>\n<p><img src=\"https://qiniu-image.gotojava.cn/blog/image-20240227184632888.png\" alt=\"参数设置调整\"></p>\n<h2 id=\"同步微信公众号文章\"><a href=\"#同步微信公众号文章\" class=\"headerlink\" title=\"同步微信公众号文章\"></a>同步微信公众号文章</h2><p>现在的自媒体时代，很多人会通过微信公众号来发布文章，我们可以将不错的文章加入到微信收藏中，微信读书可以同步这些收藏的文章，这样就可以实现集中管理。</p>\n<p>在微信读书的“设置”-“隐私”-“微信公众号文章”中可以授权。</p>\n<p><img src=\"https://qiniu-image.gotojava.cn/blog/image-20240227185300500.png\" alt=\"微信公众号文章同步\"></p>\n<h2 id=\"善用微信读书机制\"><a href=\"#善用微信读书机制\" class=\"headerlink\" title=\"善用微信读书机制\"></a>善用微信读书机制</h2><p>这里的微信读书机制是指微信读书App为了提高书友的活跃度和用户黏性，通过活动来刺激书友参与阅读和分享观点的。这些活动包括送书、送书币、送体验卡等等，其目的在于让用户参与到阅读中去，只要你一直看，你就一直会得到奖励，通过这些奖励你再继续去阅读更多的书。</p>\n<h3 id=\"时长兑福利\"><a href=\"#时长兑福利\" class=\"headerlink\" title=\"时长兑福利\"></a>时长兑福利</h3><p>书友可以通过“读书排行榜”-“时长兑换福利”来通过阅读的时间来兑换书币和临时体验卡，这些书币也是临时的，不用的话一个月左右就会失效。书币可以用来购买书籍，如果书币额度不够可以花钱充值，充值的书币不会失效。</p>\n<h3 id=\"每日福利\"><a href=\"#每日福利\" class=\"headerlink\" title=\"每日福利\"></a>每日福利</h3><p>在微信读书的“阅读“页面中，有一个”每日福利“的版块，提供了一些免费获取书、书币、付费体验卡的活动。这些活动我们都可以参与。这些活动包括”答题闯关“、”阅读挑战赛“、”每日一答“、”积攒&#x2F;组队抽体验卡“的活动，这些活动也增加了阅读的趣味性。</p>\n<p><img src=\"https://qiniu-image.gotojava.cn/blog/image-20240227191705084.png\" alt=\"福利场\"></p>\n<p>比较有意思的一个是”读书小队“，一个小队可以有6个人，其中有一个人是队长。通过登陆、阅读、互动评论、每日一答来积攒积分，积分可以用来兑换体验卡和抽书。连阅读都卷死来了~</p>\n<p><img src=\"https://qiniu-image.gotojava.cn/blog/image-20240227191812072.png\" alt=\"读书小队\"></p>\n<h2 id=\"笔记的使用技巧\"><a href=\"#笔记的使用技巧\" class=\"headerlink\" title=\"笔记的使用技巧\"></a>笔记的使用技巧</h2><h3 id=\"手机端\"><a href=\"#手机端\" class=\"headerlink\" title=\"手机端\"></a>手机端</h3><p>微信读书的笔记功能是一大靓点。对于手机端用户和网页端用户，可以对内容进行划线和标注。还可以留下你的想法让更多人看到与他人进行交流，同时也可以分享书摘、查询关键词的含义和寻找与关键词相关的书籍。</p>\n<p><img src=\"https://qiniu-image.gotojava.cn/blog/image-20240227192839345.png\" alt=\"笔记标注\"></p>\n<h3 id=\"IPad端\"><a href=\"#IPad端\" class=\"headerlink\" title=\"IPad端\"></a>IPad端</h3><p>对于有iPad的用户，也可以试试微信读书IPad版的”Pencil笔记模式“，配合类纸膜写笔记很舒服~</p>\n<p><img src=\"https://qiniu-image.gotojava.cn/blog/image-20240227193808139.png\" alt=\"导出笔记\"></p>\n<h3 id=\"下载笔记\"><a href=\"#下载笔记\" class=\"headerlink\" title=\"下载笔记\"></a>下载笔记</h3><p>我们在书中留下了很多零零散散的观点和想法，这些是我们阅读的痕迹。微信读书支持我们将自己的笔记导出来。</p>\n<p><img src=\"https://qiniu-image.gotojava.cn/blog/image-20240227195213241.png\" alt=\"下载笔记\"></p>\n<p>微信读书允许我们将笔记复制到剪贴板中，在电脑上时我们可以把笔记复制到word中进行排版。</p>\n<p>具体可以参考Up主的分享：<a href=\"https://www.bilibili.com/video/BV1vK4y1d7Wk/?vd_source=2467d52477b91eac005d50efcda2bfbe\">超高效的读书笔记整理技巧 | 如何在 5 分钟内快速整理读书笔记？</a></p>\n<h2 id=\"期刊订阅\"><a href=\"#期刊订阅\" class=\"headerlink\" title=\"期刊订阅\"></a>期刊订阅</h2><p>微信读书也是可以订阅期刊的，期刊可以帮助我们了解行业或者某领域的最新消息和研究成果，内容也是比较权威和严谨的，对于我们快速学习非常有帮助。在当前知识碎片化的时代，期刊也是系统性学习的一部分。</p>\n<p>在微信读书中，可以通过”阅读“-”分类“-”期刊杂志“进行订阅，已订阅的内容可以在”我“-”订阅“-”期刊杂志“中查看和加入书架进行阅读。但需要注意的是期刊内容大部分是付费会员才可以看的，如果想免费阅读我们也可以自己下载和导入期刊。</p>\n<h2 id=\"组建微信读书群\"><a href=\"#组建微信读书群\" class=\"headerlink\" title=\"组建微信读书群\"></a>组建微信读书群</h2><p>组建读书群的目的有三：</p>\n<ol>\n<li>解答以上步骤中遇到的问题和疑惑。</li>\n</ol>\n<p>很多朋友如果在上述的操作中遇到问题，可以通过在读书群中问答的方式得到解决。</p>\n<ol start=\"2\">\n<li>通过微信读书群组建共读会</li>\n</ol>\n<p>一个人可以走的很快，一群人可以走的很远。共读不仅可以集众人之智，帮助我们读懂那些艰深的书，还能够构建一个知识共同体（学习环境）。这个共同体在我们读完书后也会继续存在下去。</p>\n<ol start=\"3\">\n<li>通过集思广益获得更多的技巧和方法</li>\n</ol>\n<p>比如有些书籍你可能就是找不到，那么可以向其他人获取思路和资源消除信息差；对于在阅读中遇到的问题可能困扰了你许久，那么兴许他人的方法会对你有所帮助；</p>\n<p>不知道看什么书？也许他人的推荐就解答你的疑惑。</p>\n<p>如果你希望得到上述的帮助，那么欢迎加入我们~（加我微信我拉你入群。WeChat：yz2638385556，验证备注：微信读书群）</p>\n<h2 id=\"付费会员卡和体验卡的对比\"><a href=\"#付费会员卡和体验卡的对比\" class=\"headerlink\" title=\"付费会员卡和体验卡的对比\"></a>付费会员卡和体验卡的对比</h2><p>这个对比是根据官方提供的付费会员卡和体验卡功能清单分析的</p>\n<p><img src=\"https://qiniu-image.gotojava.cn/blog/image-20240227210452951.png\" alt=\"付费会员卡和体验卡的对比\"></p>\n<p>通过官方的功能清单发现，如果你是喜欢听书的，每周的阅读时间在5个小时左右，那么你开会员是划算的。如果你只是零散阅读，那么建议还是用体验卡更划算一些。对于一些书籍可以用书币购买的直接用书币购买，不能的或者书币不够的，自己下载资源导入吧~</p>\n<h2 id=\"总结\"><a href=\"#总结\" class=\"headerlink\" title=\"总结\"></a>总结</h2><p>分享了关于微信读书的一些免费阅读方法和使用技巧。但对于微信读书的功能远不止这些，还有很多的技巧等待着我们去挖掘和发现。如果你有更好的资源或技巧也欢迎通过评论区分享~</p>"},{"title":"断舍离：迈向简约生活的第一步","abbrlink":"1bc91136","date":"2024-01-19T05:17:57.000Z","toc":true,"_content":"<meta name=\"referrer\" content=\"no-referrer\" />\n\n《断舍离》是山下英子老师从瑜伽的修行哲学”断行“、”舍行“、”离行“中提炼出”断舍离“的思维方式并用于日常生活的”整理“上。那么到底什么是断舍离？断舍离又是怎么去整理生活的？本文将追随山下英子老师，学习探索断舍离的简约之道。\n\n<!--more-->\n\n![《断舍离》思维导图](https://qiniu-image.gotojava.cn/blog/%E3%80%8A%E6%96%AD%E8%88%8D%E7%A6%BB%E3%80%8B.png)\n\n这次从上海回家乡的火车上，闲来无事，就翻阅了一下随身带的一本断舍离，其实在接触《断舍离》这本书之前，就对这本书有所耳闻，但一直没有机会拜读。这次刚好回家乡的路途时间较长，有足足22个小时的火车，刚好有机会学习一下。也算是缘分到了。\n\n翻开《断舍离》一书，就被书中的一行蓝底白色所吸引：”**放手一个无用之物，就腾出一点空间。处理一件多余之物，就减少一份负担。然后，翻开人生新篇章**。“。看到这句话的时候，内心有一种触动感。就像我们身处在一间采光良好，空间很大的房间里时，屋子里很干净、物品的摆放也很整齐，我相信多数人都会感到舒服。\n\n![整洁明亮的屋子-图片来自互联网](https://qiniu-image.gotojava.cn/blog/%E6%95%B4%E6%B4%81%E6%98%8E%E4%BA%AE%E7%9A%84%E5%B1%8B%E5%AD%90.jpg)\n\n但反之，如果你身处在一间杂物堆积、垃圾遍地的屋子里时，也会感觉到心被堵了。这种压迫感的环境逐渐让在这里生活的人变得思维迟钝、行动迟缓，然后渐渐变得封闭、不想外出，进而演变成近似愤懑抑郁的状态。\n\n![杂物堆积的屋子-图片来自互联网](https://qiniu-image.gotojava.cn/blog/%E6%9D%82%E7%89%A9%E5%A0%86%E7%A7%AF%E7%9A%84%E5%B1%8B%E5%AD%90.jpg)\n\n虽然新媒体和商家也在极力宣传着一些整理、收纳的方式方法，但其本质在于减少物品占用的空间体积、废物利用...治标不治本。而断舍离所倡导的是一种生活上的“新陈代谢”的思维方式。\n\n## 断舍离是什么\n\n那么什么是断舍离呢？\"断舍离\"是指通过**断绝不必要的联系**、**舍弃多余的物质与情感负担**，以及**清理整理个人生活和心灵空间**，达到简化生活、追求轻松自在的目的。橱柜里、餐架上或者冰箱中囤积的无用之物，家里随处堆积的废品破烂，还包括精神层面上那些不适宜的过剩观念，或是让自己陷入自我否定、自我谴责境地的消极思维或情感纪念物。只有放手这些东西，才能解放自己、解放人生。即：***斩“断”物欲***、*“**舍”弃废物***、***脱“离”执念***。\n\n## 我们为什么无法放手\n\n一、随着5G社会的发展，短视频、新媒体行业的兴起，加速了信息的流速。商家的大肆宣传，打折、促销、直播带货的低价锚点效应不断的刺激着我们的消费欲。使我们很难逃脱资本给我们量身打造的”买买买“的陷阱。记得每次出去逛街，总能看到一些卖衣服商家的小姐姐在门口大肆吆喝着：”68一件、100元两件，赶快进店看一看吧“。持着闲来无事看一看的心态，总是不由自主的走进店铺进行试选，导购的小姐姐热情似火的介绍和推荐以及熟练的话术让我不由自主的着了道。碰到特别合适的总忍不住剁个手。结账的时候常常也会感到肉疼，但还是扫码付款一气呵成。我相信此类的场景大家也都会遇到过。\n\n二、时代遗留的价值观，比如：”这个东西还能用“、”或许以后能用到，就先留下来吧“，而不是”**这个东西是真的需要吗**“。或者因商家打折、促销而多买的日用品、消耗品，回到家时，却发现了囤积占了很多的体积空间，扔了感觉心疼、浪费，有些可能甚至一次都没有使用过。\n\n三、现在由于工作繁忙、生活压力过大、待在家中的时间短、不会认真的做家务。还有很多是对家庭和家务有情绪，不想待在家中，只想埋头工作。看到家里乱七八糟，心情特别差、更是不愿意待在家中，陷入了不良循环。\n\n四、对于一些特别念旧的人，总是会收集和珍藏很多现在不用的旧物，小心翼翼地保留着以前的相册或是奖杯奖牌，以及带有过往纪念性质的信件、照片等小物件。总是沉湎过去的快乐时光，而忽略了对当下现实的投入。\n\n五、”生于忧患、死于安乐“是古人在与猛兽为群时，为了保证自己能生存下来在经历漫长的岁月中所总结的良言警句。对于现代生活的我们有很好的预警左右，也能让我们时刻保持警惕、以应对可能发生的安全威胁。但如果不停的为将来的事情所忧虑，不停地为将来储备东西。眼睛只盯着”某些东西没有，自己将来必定会发愁“的心态，也会导致我们囤积过多的日用品和消耗品。\n\n**断舍离，不是要求我们随意地”弃“，而是把”舍“作为解决问题的方法之一。**在进行取舍时，我们应该挑选出有质量的东西或者我们十分喜爱的，专注于那些与自己生活关联度高的物品上，处理掉不需要的物品。将物品压缩到能够建立和保持社会性从而选择适合的量即可，才能从最本真的意义上珍惜事物、热爱生活，并不是随意地、不走心地囤东西、扔东西。对于多囤积的物品，我们可以选择适当性的赠予邻居，从而建立我们和邻居之间的社交性往来、促进邻里关系。\n\n## 断舍离是怎么工作的\n\n![断舍离的工作机制](https://qiniu-image.gotojava.cn/blog/image-20240125021841658.png)\n\n我们知道了断舍离是通过“舍弃”来减压我们的生活环境，达到简化生活、追求轻松自在的目的。那么断舍离又是如何去“舍”的呢？下面我们将通过“八个技巧”、“五个收纳指南”来学习断舍离、掌握断舍离的要点。\n\n![断舍离的工作机制-八个技巧](https://qiniu-image.gotojava.cn/blog/image-20240125022204695.png)\n\n### 八个技巧\n\n**一、认识现状**\n\n假如我们要去爬一座海拔很高的山，首先要做的是准备登山用具、掌握登山所必须的知识、计划山路路线、进行食物储备、准备通讯设备、预备登山物资等等，而不是盲目的就去了。家务的整理也是一样的，我们首先需要做的，***就是掌握家里物品的数量和质量，观察东西有没有存在过剩的情况***。\n\n从三个阶段来评估住所的现状：\n\n1. 收纳空间的物品量合理，没有过度过量，偶尔出现“凌乱”摆放的情况；\n2. 收纳空间已经满载，甚至出现物品“溢出、过剩”情况；\n3. 东西已经好多年没有整理过，出现了“堆积”的情况；\n\n首先确认物品的“量”，接下来再判断居住空间的“质”处于什么水平。\n\n就像我这次回家，家里的衣橱中的柜子里存放着我学生时代的教材书籍和实验用的设备。父母因为不懂，也不敢随意处理，生怕我需要用的时候找不到。但我已经工作3年了，这些东西早已经过了”保质期“。后来清理了一座小山，才把柜子全部清空，只留下了一些必要的荣誉证书作为纪念。\n\n**二、停止自我否定**\n\n女性把“收拾家务”直接等同于“理所当然应会的家务劳动”，简单地把家务整理分成“会收拾”和“不会收拾”，理解成能力问题。男性则简单直接理解为“不收拾”，并没有添加什么个人情绪在其中。\n\n女性既受到了“没有收拾干净的环境”的损害，又不得不自虐自嘲为“不会收拾家务的女人”，心理上受到的伤害也越发地深刻。只有摆脱这种自罚性的思维倾向，不再去否定自我，才能实现思维观念上的断舍离。\n\n**三、描绘家的具体构想**\n\n收拾东西并不是我们最终的目的，我们真正想要的是**实现“健康舒适的居住空间”**。当我们的目的明确以后收拾东西仅仅只是实现“健康舒适的居住空间”这个目的手段而已。那么首先应该做的是明确描绘住所的蓝图，收拾整理完后，我想在这里进行怎样的生活？**这个模糊的念头可以帮助我们回到人生的原点”我究竟想要怎样的生活？“，也会变成我们实践断舍离的源动力。**\n\n**四、拿出杂物、俯瞰**\n\n把握自己现在的居所物品过剩、无法收纳的现状后，把杂物全部摆出来，放在地板上、桌上等水平面的位置。然后从高处对杂物总量进行俯瞰，俯瞰的目的是可以让我们知道需要整理的工作量大约有多少。\n\n在开始实施断舍离时，***要在计划的时间内从少量的、小单位的着手***。单位越小，将物品从收纳柜取出来所花的时间就越少。也不会打击对于断舍离的热情，同时能得到正向的反馈。这种小单位量的断舍离持续下去，不久就会变成大单位量的断舍离。\n\n**五、扔掉“怎么看都是垃圾·废品”的东西**\n\n扔掉过期保质的生鲜食品、没有食欲的食物，损坏的、不能使用的、已经忘却的、将来也用不上的东西开始处理。\n\n**六、以自我·时间为判断基准，考虑自身与物品的“关联度”，再进行取舍**\n\n<img src=\"https://qiniu-image.gotojava.cn/blog/image-20240125052516460.png\" width=\"400\">\n\n以“自我轴”为基准进行取舍时，只需要考虑“**这个东西我想不想用**”。\n\n有些东西一年可能才用的上一回，对于这些东西，**不要从频率，而要从和自己的“关联度”的视角进行判断**。\n\n物品与自己的关联度会随着时间而变化，同一件物品，不同的人会有不同的评判，也有不同的关联度。这是所有人、事、物三者关系网成立的大前提。在这个大前提下，那些同时满足必要、合适、愉快三个维度的物品很快就能被锁定。并且可以摆脱人、事、物单纯理解为非对即错、非善即恶的二元思维，逐渐形成多元性、尊重他人的意识。\n\n**七、以“必要·合适·愉快”为标准进行取舍**\n\n这个东西对我来说是必要的吗？是否适合我？使用起来是不是心情愉快？那么对于”现在“的我来说，那些”**不需要、不合适、不愉快的东西应该处理掉。**“\n\n不需要的东西：东西使用起来很便利，虽然没有坏，但是丢了也不发愁；\n\n不合适的东西：以前很重要，但是对现在的我不合适；\n\n不愉快的东西：长时间使用，但会有莫名的违和感和不愉快情绪；\n\n**八、收纳在杂物最适合化之后进行**\n\n- “收拾”就是对庞大的杂物量进行压缩和收纳的作业\n- “整理·分类” + “扫除”，总称为“打扫”。\n\n在断舍离的大前提下，最正确的“打扫”程序是首先清除那些垃圾、废品，以及不需要、不合适、不愉快的杂物，之后再转而进行杂物收纳，进行“清扫、擦拭、磨刷”。因为如果不按这个顺序做的话，把垃圾、废品或者不需要、不合适、不愉快的杂物重新塞进收纳箱，就完全失去了打扫的意义。而且、塞进柜子之后，这些杂物依然是以”机能不全“的状态藏在家中，\"大扫除\"并没有任何实际的意义。\n\n### 五个收纳指南\n\n**一、三分法**\n\n大分类 ➡️ 中分类 ➡️ 小分类，**分类的关键是三类不能交叉**，交叉会产生范畴错误，错误越多越会导致找东西花时间，思维也发生混乱。\n\n![三分法-厨房例子](https://qiniu-image.gotojava.cn/blog/image-20240125025928515.png)\n\n**二、7•5•1法**\n\n“7·5·1法”指的是进行杂物收纳时，对收纳空间的物量进行大致的估测。根据不同的收纳情况，将杂物总量压缩到收纳空间的”7成“、”5成“、”1成“。\n\n- “看不见的收纳空间”，占7成\n\n  衣柜、壁橱、抽屉等关上门就“看不见的收纳空间”所放杂物的量基本上占整体空间的7成。\n\n  留下3成的目的在于想取柜子最里面的东西时，有操作的空间，避免把前面的东西拿出来再重新去取，减少麻烦。\n- “看的见的收纳空间”，占5成\n\n  带玻璃门的柜子或橱柜关上门依然能“看得见的收纳空间”所放杂物的量基本上占整体空间的5成。5成的空间可以尽量保持一定的美观。\n- “展示性的收纳空间”，占1成\n\n  可以看到的开放性空间，如桌面、橱柜的水平面、门口的鞋柜等“展示性的收纳空间”上所放杂物的量基本上占整体空间的1成。\n\n**三、1 out 1 in 法（一出一进法）**\n\n**遵守“处理一个、收纳一个”的原则。先出再进**。因为先取出一个，再放入新东西，就不会出现失效的可能。让自己产生”决不能再随意买一些乱七八糟的东西“的觉悟。在面对可入手的诱惑时，让我们产生一丝心理上的犹豫。\n\n**四、one touch法（一键式法）**\n\n在进行杂物整理收纳时，打开收纳柜的们，取出里面的箱子，再打开盖子，这个动作会过于繁琐和麻烦。使用过后再收纳也会同样花时间，所以就随意扔在桌子上了。但如果把动作压缩到2步：打开门 ➡️ 拿出来（放回去），以 one touch（一键式）取出来，减少繁琐的收纳操作，更省心、省力，也不会感到太麻烦。\n\n**五、自立·自由·自在法**\n\n自立：毛巾、T恤等布艺制品立着叠放入收纳浅盒中；\n\n自由：根据杯子的形状种类排列，方便自由拿取；\n\n自在：底裤、袜子等小件衣物团着折叠扔进收纳盒中，自在滚动；\n\n从切实能出成绩的小地方着手，全力集中在“达成事件”上，一点点地增加成就感，给自己的“自信心账户”一点点地转账存钱。小地方获得的小成功不断累加，能给人以勇气和信心去面对自己的老大难问题。\n\n### 断舍离的步骤\n\n1. 认识现状；\n2. 选择取舍；\n3. 收纳整理；\n\n### 居所断舍离的要点\n\n- 衣柜的断舍离\n\n![衣柜的断舍离](https://qiniu-image.gotojava.cn/blog/image-20240125042251090.png)\n\n- 壁橱的断舍离\n\n![壁橱的断舍离](https://qiniu-image.gotojava.cn/blog/image-20240125031043646.png)\n\n- 厨房的断舍离\n\n![厨房的断舍离](https://qiniu-image.gotojava.cn/blog/image-20240125031110234.png)\n\n- 餐具柜的断舍离\n\n![餐具柜的断舍离](https://qiniu-image.gotojava.cn/blog/image-20240125031148638.png)\n\n- 冰箱的断舍离\n\n![冰箱的断舍离](https://qiniu-image.gotojava.cn/blog/image-20240125031223642.png)\n\n- 书架的断舍离\n\n![书架的断舍离](https://qiniu-image.gotojava.cn/blog/image-20240125031248948.png)\n\n- 厕所的断舍离\n\n![厕所的断舍离](https://qiniu-image.gotojava.cn/blog/image-20240125031316007.png)\n\n- 家门口的断舍离\n\n![家门口的断舍离](https://qiniu-image.gotojava.cn/blog/image-20240125031340614.png)\n\n- 客厅、餐厅的断舍离\n\n![客厅、餐厅的断舍离](https://qiniu-image.gotojava.cn/blog/image-20240125031403493.png)\n\n## 总结\n\n这本书倡导我们摒弃不必要的物品，将注意力从物质的积累转移到生活本身的追求上。通过践行“断舍离”的理念，我们可以释放内心的空间，变得更加轻松、自在。“断”即断绝不必要的购买，“舍”即舍弃家中不必要的物品，“离”则是脱离对物质的迷恋。通过“断舍离”，我们不仅可以整理自己的居住空间，也能让我们的生活变得更加充实、幸福。\n","source":"_posts/断舍离：迈向简约生活的第一步.md","raw":"---\ntitle: 断舍离：迈向简约生活的第一步\nabbrlink: 1bc91136\ndate: 2024-01-19 05:17:57\ntoc: true\n---\n<meta name=\"referrer\" content=\"no-referrer\" />\n\n《断舍离》是山下英子老师从瑜伽的修行哲学”断行“、”舍行“、”离行“中提炼出”断舍离“的思维方式并用于日常生活的”整理“上。那么到底什么是断舍离？断舍离又是怎么去整理生活的？本文将追随山下英子老师，学习探索断舍离的简约之道。\n\n<!--more-->\n\n![《断舍离》思维导图](https://qiniu-image.gotojava.cn/blog/%E3%80%8A%E6%96%AD%E8%88%8D%E7%A6%BB%E3%80%8B.png)\n\n这次从上海回家乡的火车上，闲来无事，就翻阅了一下随身带的一本断舍离，其实在接触《断舍离》这本书之前，就对这本书有所耳闻，但一直没有机会拜读。这次刚好回家乡的路途时间较长，有足足22个小时的火车，刚好有机会学习一下。也算是缘分到了。\n\n翻开《断舍离》一书，就被书中的一行蓝底白色所吸引：”**放手一个无用之物，就腾出一点空间。处理一件多余之物，就减少一份负担。然后，翻开人生新篇章**。“。看到这句话的时候，内心有一种触动感。就像我们身处在一间采光良好，空间很大的房间里时，屋子里很干净、物品的摆放也很整齐，我相信多数人都会感到舒服。\n\n![整洁明亮的屋子-图片来自互联网](https://qiniu-image.gotojava.cn/blog/%E6%95%B4%E6%B4%81%E6%98%8E%E4%BA%AE%E7%9A%84%E5%B1%8B%E5%AD%90.jpg)\n\n但反之，如果你身处在一间杂物堆积、垃圾遍地的屋子里时，也会感觉到心被堵了。这种压迫感的环境逐渐让在这里生活的人变得思维迟钝、行动迟缓，然后渐渐变得封闭、不想外出，进而演变成近似愤懑抑郁的状态。\n\n![杂物堆积的屋子-图片来自互联网](https://qiniu-image.gotojava.cn/blog/%E6%9D%82%E7%89%A9%E5%A0%86%E7%A7%AF%E7%9A%84%E5%B1%8B%E5%AD%90.jpg)\n\n虽然新媒体和商家也在极力宣传着一些整理、收纳的方式方法，但其本质在于减少物品占用的空间体积、废物利用...治标不治本。而断舍离所倡导的是一种生活上的“新陈代谢”的思维方式。\n\n## 断舍离是什么\n\n那么什么是断舍离呢？\"断舍离\"是指通过**断绝不必要的联系**、**舍弃多余的物质与情感负担**，以及**清理整理个人生活和心灵空间**，达到简化生活、追求轻松自在的目的。橱柜里、餐架上或者冰箱中囤积的无用之物，家里随处堆积的废品破烂，还包括精神层面上那些不适宜的过剩观念，或是让自己陷入自我否定、自我谴责境地的消极思维或情感纪念物。只有放手这些东西，才能解放自己、解放人生。即：***斩“断”物欲***、*“**舍”弃废物***、***脱“离”执念***。\n\n## 我们为什么无法放手\n\n一、随着5G社会的发展，短视频、新媒体行业的兴起，加速了信息的流速。商家的大肆宣传，打折、促销、直播带货的低价锚点效应不断的刺激着我们的消费欲。使我们很难逃脱资本给我们量身打造的”买买买“的陷阱。记得每次出去逛街，总能看到一些卖衣服商家的小姐姐在门口大肆吆喝着：”68一件、100元两件，赶快进店看一看吧“。持着闲来无事看一看的心态，总是不由自主的走进店铺进行试选，导购的小姐姐热情似火的介绍和推荐以及熟练的话术让我不由自主的着了道。碰到特别合适的总忍不住剁个手。结账的时候常常也会感到肉疼，但还是扫码付款一气呵成。我相信此类的场景大家也都会遇到过。\n\n二、时代遗留的价值观，比如：”这个东西还能用“、”或许以后能用到，就先留下来吧“，而不是”**这个东西是真的需要吗**“。或者因商家打折、促销而多买的日用品、消耗品，回到家时，却发现了囤积占了很多的体积空间，扔了感觉心疼、浪费，有些可能甚至一次都没有使用过。\n\n三、现在由于工作繁忙、生活压力过大、待在家中的时间短、不会认真的做家务。还有很多是对家庭和家务有情绪，不想待在家中，只想埋头工作。看到家里乱七八糟，心情特别差、更是不愿意待在家中，陷入了不良循环。\n\n四、对于一些特别念旧的人，总是会收集和珍藏很多现在不用的旧物，小心翼翼地保留着以前的相册或是奖杯奖牌，以及带有过往纪念性质的信件、照片等小物件。总是沉湎过去的快乐时光，而忽略了对当下现实的投入。\n\n五、”生于忧患、死于安乐“是古人在与猛兽为群时，为了保证自己能生存下来在经历漫长的岁月中所总结的良言警句。对于现代生活的我们有很好的预警左右，也能让我们时刻保持警惕、以应对可能发生的安全威胁。但如果不停的为将来的事情所忧虑，不停地为将来储备东西。眼睛只盯着”某些东西没有，自己将来必定会发愁“的心态，也会导致我们囤积过多的日用品和消耗品。\n\n**断舍离，不是要求我们随意地”弃“，而是把”舍“作为解决问题的方法之一。**在进行取舍时，我们应该挑选出有质量的东西或者我们十分喜爱的，专注于那些与自己生活关联度高的物品上，处理掉不需要的物品。将物品压缩到能够建立和保持社会性从而选择适合的量即可，才能从最本真的意义上珍惜事物、热爱生活，并不是随意地、不走心地囤东西、扔东西。对于多囤积的物品，我们可以选择适当性的赠予邻居，从而建立我们和邻居之间的社交性往来、促进邻里关系。\n\n## 断舍离是怎么工作的\n\n![断舍离的工作机制](https://qiniu-image.gotojava.cn/blog/image-20240125021841658.png)\n\n我们知道了断舍离是通过“舍弃”来减压我们的生活环境，达到简化生活、追求轻松自在的目的。那么断舍离又是如何去“舍”的呢？下面我们将通过“八个技巧”、“五个收纳指南”来学习断舍离、掌握断舍离的要点。\n\n![断舍离的工作机制-八个技巧](https://qiniu-image.gotojava.cn/blog/image-20240125022204695.png)\n\n### 八个技巧\n\n**一、认识现状**\n\n假如我们要去爬一座海拔很高的山，首先要做的是准备登山用具、掌握登山所必须的知识、计划山路路线、进行食物储备、准备通讯设备、预备登山物资等等，而不是盲目的就去了。家务的整理也是一样的，我们首先需要做的，***就是掌握家里物品的数量和质量，观察东西有没有存在过剩的情况***。\n\n从三个阶段来评估住所的现状：\n\n1. 收纳空间的物品量合理，没有过度过量，偶尔出现“凌乱”摆放的情况；\n2. 收纳空间已经满载，甚至出现物品“溢出、过剩”情况；\n3. 东西已经好多年没有整理过，出现了“堆积”的情况；\n\n首先确认物品的“量”，接下来再判断居住空间的“质”处于什么水平。\n\n就像我这次回家，家里的衣橱中的柜子里存放着我学生时代的教材书籍和实验用的设备。父母因为不懂，也不敢随意处理，生怕我需要用的时候找不到。但我已经工作3年了，这些东西早已经过了”保质期“。后来清理了一座小山，才把柜子全部清空，只留下了一些必要的荣誉证书作为纪念。\n\n**二、停止自我否定**\n\n女性把“收拾家务”直接等同于“理所当然应会的家务劳动”，简单地把家务整理分成“会收拾”和“不会收拾”，理解成能力问题。男性则简单直接理解为“不收拾”，并没有添加什么个人情绪在其中。\n\n女性既受到了“没有收拾干净的环境”的损害，又不得不自虐自嘲为“不会收拾家务的女人”，心理上受到的伤害也越发地深刻。只有摆脱这种自罚性的思维倾向，不再去否定自我，才能实现思维观念上的断舍离。\n\n**三、描绘家的具体构想**\n\n收拾东西并不是我们最终的目的，我们真正想要的是**实现“健康舒适的居住空间”**。当我们的目的明确以后收拾东西仅仅只是实现“健康舒适的居住空间”这个目的手段而已。那么首先应该做的是明确描绘住所的蓝图，收拾整理完后，我想在这里进行怎样的生活？**这个模糊的念头可以帮助我们回到人生的原点”我究竟想要怎样的生活？“，也会变成我们实践断舍离的源动力。**\n\n**四、拿出杂物、俯瞰**\n\n把握自己现在的居所物品过剩、无法收纳的现状后，把杂物全部摆出来，放在地板上、桌上等水平面的位置。然后从高处对杂物总量进行俯瞰，俯瞰的目的是可以让我们知道需要整理的工作量大约有多少。\n\n在开始实施断舍离时，***要在计划的时间内从少量的、小单位的着手***。单位越小，将物品从收纳柜取出来所花的时间就越少。也不会打击对于断舍离的热情，同时能得到正向的反馈。这种小单位量的断舍离持续下去，不久就会变成大单位量的断舍离。\n\n**五、扔掉“怎么看都是垃圾·废品”的东西**\n\n扔掉过期保质的生鲜食品、没有食欲的食物，损坏的、不能使用的、已经忘却的、将来也用不上的东西开始处理。\n\n**六、以自我·时间为判断基准，考虑自身与物品的“关联度”，再进行取舍**\n\n<img src=\"https://qiniu-image.gotojava.cn/blog/image-20240125052516460.png\" width=\"400\">\n\n以“自我轴”为基准进行取舍时，只需要考虑“**这个东西我想不想用**”。\n\n有些东西一年可能才用的上一回，对于这些东西，**不要从频率，而要从和自己的“关联度”的视角进行判断**。\n\n物品与自己的关联度会随着时间而变化，同一件物品，不同的人会有不同的评判，也有不同的关联度。这是所有人、事、物三者关系网成立的大前提。在这个大前提下，那些同时满足必要、合适、愉快三个维度的物品很快就能被锁定。并且可以摆脱人、事、物单纯理解为非对即错、非善即恶的二元思维，逐渐形成多元性、尊重他人的意识。\n\n**七、以“必要·合适·愉快”为标准进行取舍**\n\n这个东西对我来说是必要的吗？是否适合我？使用起来是不是心情愉快？那么对于”现在“的我来说，那些”**不需要、不合适、不愉快的东西应该处理掉。**“\n\n不需要的东西：东西使用起来很便利，虽然没有坏，但是丢了也不发愁；\n\n不合适的东西：以前很重要，但是对现在的我不合适；\n\n不愉快的东西：长时间使用，但会有莫名的违和感和不愉快情绪；\n\n**八、收纳在杂物最适合化之后进行**\n\n- “收拾”就是对庞大的杂物量进行压缩和收纳的作业\n- “整理·分类” + “扫除”，总称为“打扫”。\n\n在断舍离的大前提下，最正确的“打扫”程序是首先清除那些垃圾、废品，以及不需要、不合适、不愉快的杂物，之后再转而进行杂物收纳，进行“清扫、擦拭、磨刷”。因为如果不按这个顺序做的话，把垃圾、废品或者不需要、不合适、不愉快的杂物重新塞进收纳箱，就完全失去了打扫的意义。而且、塞进柜子之后，这些杂物依然是以”机能不全“的状态藏在家中，\"大扫除\"并没有任何实际的意义。\n\n### 五个收纳指南\n\n**一、三分法**\n\n大分类 ➡️ 中分类 ➡️ 小分类，**分类的关键是三类不能交叉**，交叉会产生范畴错误，错误越多越会导致找东西花时间，思维也发生混乱。\n\n![三分法-厨房例子](https://qiniu-image.gotojava.cn/blog/image-20240125025928515.png)\n\n**二、7•5•1法**\n\n“7·5·1法”指的是进行杂物收纳时，对收纳空间的物量进行大致的估测。根据不同的收纳情况，将杂物总量压缩到收纳空间的”7成“、”5成“、”1成“。\n\n- “看不见的收纳空间”，占7成\n\n  衣柜、壁橱、抽屉等关上门就“看不见的收纳空间”所放杂物的量基本上占整体空间的7成。\n\n  留下3成的目的在于想取柜子最里面的东西时，有操作的空间，避免把前面的东西拿出来再重新去取，减少麻烦。\n- “看的见的收纳空间”，占5成\n\n  带玻璃门的柜子或橱柜关上门依然能“看得见的收纳空间”所放杂物的量基本上占整体空间的5成。5成的空间可以尽量保持一定的美观。\n- “展示性的收纳空间”，占1成\n\n  可以看到的开放性空间，如桌面、橱柜的水平面、门口的鞋柜等“展示性的收纳空间”上所放杂物的量基本上占整体空间的1成。\n\n**三、1 out 1 in 法（一出一进法）**\n\n**遵守“处理一个、收纳一个”的原则。先出再进**。因为先取出一个，再放入新东西，就不会出现失效的可能。让自己产生”决不能再随意买一些乱七八糟的东西“的觉悟。在面对可入手的诱惑时，让我们产生一丝心理上的犹豫。\n\n**四、one touch法（一键式法）**\n\n在进行杂物整理收纳时，打开收纳柜的们，取出里面的箱子，再打开盖子，这个动作会过于繁琐和麻烦。使用过后再收纳也会同样花时间，所以就随意扔在桌子上了。但如果把动作压缩到2步：打开门 ➡️ 拿出来（放回去），以 one touch（一键式）取出来，减少繁琐的收纳操作，更省心、省力，也不会感到太麻烦。\n\n**五、自立·自由·自在法**\n\n自立：毛巾、T恤等布艺制品立着叠放入收纳浅盒中；\n\n自由：根据杯子的形状种类排列，方便自由拿取；\n\n自在：底裤、袜子等小件衣物团着折叠扔进收纳盒中，自在滚动；\n\n从切实能出成绩的小地方着手，全力集中在“达成事件”上，一点点地增加成就感，给自己的“自信心账户”一点点地转账存钱。小地方获得的小成功不断累加，能给人以勇气和信心去面对自己的老大难问题。\n\n### 断舍离的步骤\n\n1. 认识现状；\n2. 选择取舍；\n3. 收纳整理；\n\n### 居所断舍离的要点\n\n- 衣柜的断舍离\n\n![衣柜的断舍离](https://qiniu-image.gotojava.cn/blog/image-20240125042251090.png)\n\n- 壁橱的断舍离\n\n![壁橱的断舍离](https://qiniu-image.gotojava.cn/blog/image-20240125031043646.png)\n\n- 厨房的断舍离\n\n![厨房的断舍离](https://qiniu-image.gotojava.cn/blog/image-20240125031110234.png)\n\n- 餐具柜的断舍离\n\n![餐具柜的断舍离](https://qiniu-image.gotojava.cn/blog/image-20240125031148638.png)\n\n- 冰箱的断舍离\n\n![冰箱的断舍离](https://qiniu-image.gotojava.cn/blog/image-20240125031223642.png)\n\n- 书架的断舍离\n\n![书架的断舍离](https://qiniu-image.gotojava.cn/blog/image-20240125031248948.png)\n\n- 厕所的断舍离\n\n![厕所的断舍离](https://qiniu-image.gotojava.cn/blog/image-20240125031316007.png)\n\n- 家门口的断舍离\n\n![家门口的断舍离](https://qiniu-image.gotojava.cn/blog/image-20240125031340614.png)\n\n- 客厅、餐厅的断舍离\n\n![客厅、餐厅的断舍离](https://qiniu-image.gotojava.cn/blog/image-20240125031403493.png)\n\n## 总结\n\n这本书倡导我们摒弃不必要的物品，将注意力从物质的积累转移到生活本身的追求上。通过践行“断舍离”的理念，我们可以释放内心的空间，变得更加轻松、自在。“断”即断绝不必要的购买，“舍”即舍弃家中不必要的物品，“离”则是脱离对物质的迷恋。通过“断舍离”，我们不仅可以整理自己的居住空间，也能让我们的生活变得更加充实、幸福。\n","slug":"断舍离：迈向简约生活的第一步","published":1,"updated":"2025-03-28T06:09:33.609Z","comments":1,"layout":"post","photos":[],"_id":"cm8se3tdy001rbb8l8xgt8vy4","content":"<meta name=\"referrer\" content=\"no-referrer\" />\n\n<p>《断舍离》是山下英子老师从瑜伽的修行哲学”断行“、”舍行“、”离行“中提炼出”断舍离“的思维方式并用于日常生活的”整理“上。那么到底什么是断舍离？断舍离又是怎么去整理生活的？本文将追随山下英子老师，学习探索断舍离的简约之道。</p>\n<span id=\"more\"></span>\n\n<p><img src=\"https://qiniu-image.gotojava.cn/blog/%E3%80%8A%E6%96%AD%E8%88%8D%E7%A6%BB%E3%80%8B.png\" alt=\"《断舍离》思维导图\"></p>\n<p>这次从上海回家乡的火车上，闲来无事，就翻阅了一下随身带的一本断舍离，其实在接触《断舍离》这本书之前，就对这本书有所耳闻，但一直没有机会拜读。这次刚好回家乡的路途时间较长，有足足22个小时的火车，刚好有机会学习一下。也算是缘分到了。</p>\n<p>翻开《断舍离》一书，就被书中的一行蓝底白色所吸引：”<strong>放手一个无用之物，就腾出一点空间。处理一件多余之物，就减少一份负担。然后，翻开人生新篇章</strong>。“。看到这句话的时候，内心有一种触动感。就像我们身处在一间采光良好，空间很大的房间里时，屋子里很干净、物品的摆放也很整齐，我相信多数人都会感到舒服。</p>\n<p><img src=\"https://qiniu-image.gotojava.cn/blog/%E6%95%B4%E6%B4%81%E6%98%8E%E4%BA%AE%E7%9A%84%E5%B1%8B%E5%AD%90.jpg\" alt=\"整洁明亮的屋子-图片来自互联网\"></p>\n<p>但反之，如果你身处在一间杂物堆积、垃圾遍地的屋子里时，也会感觉到心被堵了。这种压迫感的环境逐渐让在这里生活的人变得思维迟钝、行动迟缓，然后渐渐变得封闭、不想外出，进而演变成近似愤懑抑郁的状态。</p>\n<p><img src=\"https://qiniu-image.gotojava.cn/blog/%E6%9D%82%E7%89%A9%E5%A0%86%E7%A7%AF%E7%9A%84%E5%B1%8B%E5%AD%90.jpg\" alt=\"杂物堆积的屋子-图片来自互联网\"></p>\n<p>虽然新媒体和商家也在极力宣传着一些整理、收纳的方式方法，但其本质在于减少物品占用的空间体积、废物利用…治标不治本。而断舍离所倡导的是一种生活上的“新陈代谢”的思维方式。</p>\n<h2 id=\"断舍离是什么\"><a href=\"#断舍离是什么\" class=\"headerlink\" title=\"断舍离是什么\"></a>断舍离是什么</h2><p>那么什么是断舍离呢？”断舍离”是指通过<strong>断绝不必要的联系</strong>、<strong>舍弃多余的物质与情感负担</strong>，以及<strong>清理整理个人生活和心灵空间</strong>，达到简化生活、追求轻松自在的目的。橱柜里、餐架上或者冰箱中囤积的无用之物，家里随处堆积的废品破烂，还包括精神层面上那些不适宜的过剩观念，或是让自己陷入自我否定、自我谴责境地的消极思维或情感纪念物。只有放手这些东西，才能解放自己、解放人生。即：<em><strong>斩“断”物欲</strong></em>、<em>“<strong>舍”弃废物</strong></em>、<em><strong>脱“离”执念</strong></em>。</p>\n<h2 id=\"我们为什么无法放手\"><a href=\"#我们为什么无法放手\" class=\"headerlink\" title=\"我们为什么无法放手\"></a>我们为什么无法放手</h2><p>一、随着5G社会的发展，短视频、新媒体行业的兴起，加速了信息的流速。商家的大肆宣传，打折、促销、直播带货的低价锚点效应不断的刺激着我们的消费欲。使我们很难逃脱资本给我们量身打造的”买买买“的陷阱。记得每次出去逛街，总能看到一些卖衣服商家的小姐姐在门口大肆吆喝着：”68一件、100元两件，赶快进店看一看吧“。持着闲来无事看一看的心态，总是不由自主的走进店铺进行试选，导购的小姐姐热情似火的介绍和推荐以及熟练的话术让我不由自主的着了道。碰到特别合适的总忍不住剁个手。结账的时候常常也会感到肉疼，但还是扫码付款一气呵成。我相信此类的场景大家也都会遇到过。</p>\n<p>二、时代遗留的价值观，比如：”这个东西还能用“、”或许以后能用到，就先留下来吧“，而不是”<strong>这个东西是真的需要吗</strong>“。或者因商家打折、促销而多买的日用品、消耗品，回到家时，却发现了囤积占了很多的体积空间，扔了感觉心疼、浪费，有些可能甚至一次都没有使用过。</p>\n<p>三、现在由于工作繁忙、生活压力过大、待在家中的时间短、不会认真的做家务。还有很多是对家庭和家务有情绪，不想待在家中，只想埋头工作。看到家里乱七八糟，心情特别差、更是不愿意待在家中，陷入了不良循环。</p>\n<p>四、对于一些特别念旧的人，总是会收集和珍藏很多现在不用的旧物，小心翼翼地保留着以前的相册或是奖杯奖牌，以及带有过往纪念性质的信件、照片等小物件。总是沉湎过去的快乐时光，而忽略了对当下现实的投入。</p>\n<p>五、”生于忧患、死于安乐“是古人在与猛兽为群时，为了保证自己能生存下来在经历漫长的岁月中所总结的良言警句。对于现代生活的我们有很好的预警左右，也能让我们时刻保持警惕、以应对可能发生的安全威胁。但如果不停的为将来的事情所忧虑，不停地为将来储备东西。眼睛只盯着”某些东西没有，自己将来必定会发愁“的心态，也会导致我们囤积过多的日用品和消耗品。</p>\n<p><strong>断舍离，不是要求我们随意地”弃“，而是把”舍“作为解决问题的方法之一。</strong>在进行取舍时，我们应该挑选出有质量的东西或者我们十分喜爱的，专注于那些与自己生活关联度高的物品上，处理掉不需要的物品。将物品压缩到能够建立和保持社会性从而选择适合的量即可，才能从最本真的意义上珍惜事物、热爱生活，并不是随意地、不走心地囤东西、扔东西。对于多囤积的物品，我们可以选择适当性的赠予邻居，从而建立我们和邻居之间的社交性往来、促进邻里关系。</p>\n<h2 id=\"断舍离是怎么工作的\"><a href=\"#断舍离是怎么工作的\" class=\"headerlink\" title=\"断舍离是怎么工作的\"></a>断舍离是怎么工作的</h2><p><img src=\"https://qiniu-image.gotojava.cn/blog/image-20240125021841658.png\" alt=\"断舍离的工作机制\"></p>\n<p>我们知道了断舍离是通过“舍弃”来减压我们的生活环境，达到简化生活、追求轻松自在的目的。那么断舍离又是如何去“舍”的呢？下面我们将通过“八个技巧”、“五个收纳指南”来学习断舍离、掌握断舍离的要点。</p>\n<p><img src=\"https://qiniu-image.gotojava.cn/blog/image-20240125022204695.png\" alt=\"断舍离的工作机制-八个技巧\"></p>\n<h3 id=\"八个技巧\"><a href=\"#八个技巧\" class=\"headerlink\" title=\"八个技巧\"></a>八个技巧</h3><p><strong>一、认识现状</strong></p>\n<p>假如我们要去爬一座海拔很高的山，首先要做的是准备登山用具、掌握登山所必须的知识、计划山路路线、进行食物储备、准备通讯设备、预备登山物资等等，而不是盲目的就去了。家务的整理也是一样的，我们首先需要做的，<em><strong>就是掌握家里物品的数量和质量，观察东西有没有存在过剩的情况</strong></em>。</p>\n<p>从三个阶段来评估住所的现状：</p>\n<ol>\n<li>收纳空间的物品量合理，没有过度过量，偶尔出现“凌乱”摆放的情况；</li>\n<li>收纳空间已经满载，甚至出现物品“溢出、过剩”情况；</li>\n<li>东西已经好多年没有整理过，出现了“堆积”的情况；</li>\n</ol>\n<p>首先确认物品的“量”，接下来再判断居住空间的“质”处于什么水平。</p>\n<p>就像我这次回家，家里的衣橱中的柜子里存放着我学生时代的教材书籍和实验用的设备。父母因为不懂，也不敢随意处理，生怕我需要用的时候找不到。但我已经工作3年了，这些东西早已经过了”保质期“。后来清理了一座小山，才把柜子全部清空，只留下了一些必要的荣誉证书作为纪念。</p>\n<p><strong>二、停止自我否定</strong></p>\n<p>女性把“收拾家务”直接等同于“理所当然应会的家务劳动”，简单地把家务整理分成“会收拾”和“不会收拾”，理解成能力问题。男性则简单直接理解为“不收拾”，并没有添加什么个人情绪在其中。</p>\n<p>女性既受到了“没有收拾干净的环境”的损害，又不得不自虐自嘲为“不会收拾家务的女人”，心理上受到的伤害也越发地深刻。只有摆脱这种自罚性的思维倾向，不再去否定自我，才能实现思维观念上的断舍离。</p>\n<p><strong>三、描绘家的具体构想</strong></p>\n<p>收拾东西并不是我们最终的目的，我们真正想要的是<strong>实现“健康舒适的居住空间”</strong>。当我们的目的明确以后收拾东西仅仅只是实现“健康舒适的居住空间”这个目的手段而已。那么首先应该做的是明确描绘住所的蓝图，收拾整理完后，我想在这里进行怎样的生活？<strong>这个模糊的念头可以帮助我们回到人生的原点”我究竟想要怎样的生活？“，也会变成我们实践断舍离的源动力。</strong></p>\n<p><strong>四、拿出杂物、俯瞰</strong></p>\n<p>把握自己现在的居所物品过剩、无法收纳的现状后，把杂物全部摆出来，放在地板上、桌上等水平面的位置。然后从高处对杂物总量进行俯瞰，俯瞰的目的是可以让我们知道需要整理的工作量大约有多少。</p>\n<p>在开始实施断舍离时，<em><strong>要在计划的时间内从少量的、小单位的着手</strong></em>。单位越小，将物品从收纳柜取出来所花的时间就越少。也不会打击对于断舍离的热情，同时能得到正向的反馈。这种小单位量的断舍离持续下去，不久就会变成大单位量的断舍离。</p>\n<p><strong>五、扔掉“怎么看都是垃圾·废品”的东西</strong></p>\n<p>扔掉过期保质的生鲜食品、没有食欲的食物，损坏的、不能使用的、已经忘却的、将来也用不上的东西开始处理。</p>\n<p><strong>六、以自我·时间为判断基准，考虑自身与物品的“关联度”，再进行取舍</strong></p>\n<img src=\"https://qiniu-image.gotojava.cn/blog/image-20240125052516460.png\" width=\"400\">\n\n<p>以“自我轴”为基准进行取舍时，只需要考虑“<strong>这个东西我想不想用</strong>”。</p>\n<p>有些东西一年可能才用的上一回，对于这些东西，<strong>不要从频率，而要从和自己的“关联度”的视角进行判断</strong>。</p>\n<p>物品与自己的关联度会随着时间而变化，同一件物品，不同的人会有不同的评判，也有不同的关联度。这是所有人、事、物三者关系网成立的大前提。在这个大前提下，那些同时满足必要、合适、愉快三个维度的物品很快就能被锁定。并且可以摆脱人、事、物单纯理解为非对即错、非善即恶的二元思维，逐渐形成多元性、尊重他人的意识。</p>\n<p><strong>七、以“必要·合适·愉快”为标准进行取舍</strong></p>\n<p>这个东西对我来说是必要的吗？是否适合我？使用起来是不是心情愉快？那么对于”现在“的我来说，那些”<strong>不需要、不合适、不愉快的东西应该处理掉。</strong>“</p>\n<p>不需要的东西：东西使用起来很便利，虽然没有坏，但是丢了也不发愁；</p>\n<p>不合适的东西：以前很重要，但是对现在的我不合适；</p>\n<p>不愉快的东西：长时间使用，但会有莫名的违和感和不愉快情绪；</p>\n<p><strong>八、收纳在杂物最适合化之后进行</strong></p>\n<ul>\n<li>“收拾”就是对庞大的杂物量进行压缩和收纳的作业</li>\n<li>“整理·分类” + “扫除”，总称为“打扫”。</li>\n</ul>\n<p>在断舍离的大前提下，最正确的“打扫”程序是首先清除那些垃圾、废品，以及不需要、不合适、不愉快的杂物，之后再转而进行杂物收纳，进行“清扫、擦拭、磨刷”。因为如果不按这个顺序做的话，把垃圾、废品或者不需要、不合适、不愉快的杂物重新塞进收纳箱，就完全失去了打扫的意义。而且、塞进柜子之后，这些杂物依然是以”机能不全“的状态藏在家中，”大扫除”并没有任何实际的意义。</p>\n<h3 id=\"五个收纳指南\"><a href=\"#五个收纳指南\" class=\"headerlink\" title=\"五个收纳指南\"></a>五个收纳指南</h3><p><strong>一、三分法</strong></p>\n<p>大分类 ➡️ 中分类 ➡️ 小分类，<strong>分类的关键是三类不能交叉</strong>，交叉会产生范畴错误，错误越多越会导致找东西花时间，思维也发生混乱。</p>\n<p><img src=\"https://qiniu-image.gotojava.cn/blog/image-20240125025928515.png\" alt=\"三分法-厨房例子\"></p>\n<p><strong>二、7•5•1法</strong></p>\n<p>“7·5·1法”指的是进行杂物收纳时，对收纳空间的物量进行大致的估测。根据不同的收纳情况，将杂物总量压缩到收纳空间的”7成“、”5成“、”1成“。</p>\n<ul>\n<li><p>“看不见的收纳空间”，占7成</p>\n<p>衣柜、壁橱、抽屉等关上门就“看不见的收纳空间”所放杂物的量基本上占整体空间的7成。</p>\n<p>留下3成的目的在于想取柜子最里面的东西时，有操作的空间，避免把前面的东西拿出来再重新去取，减少麻烦。</p>\n</li>\n<li><p>“看的见的收纳空间”，占5成</p>\n<p>带玻璃门的柜子或橱柜关上门依然能“看得见的收纳空间”所放杂物的量基本上占整体空间的5成。5成的空间可以尽量保持一定的美观。</p>\n</li>\n<li><p>“展示性的收纳空间”，占1成</p>\n<p>可以看到的开放性空间，如桌面、橱柜的水平面、门口的鞋柜等“展示性的收纳空间”上所放杂物的量基本上占整体空间的1成。</p>\n</li>\n</ul>\n<p><strong>三、1 out 1 in 法（一出一进法）</strong></p>\n<p><strong>遵守“处理一个、收纳一个”的原则。先出再进</strong>。因为先取出一个，再放入新东西，就不会出现失效的可能。让自己产生”决不能再随意买一些乱七八糟的东西“的觉悟。在面对可入手的诱惑时，让我们产生一丝心理上的犹豫。</p>\n<p><strong>四、one touch法（一键式法）</strong></p>\n<p>在进行杂物整理收纳时，打开收纳柜的们，取出里面的箱子，再打开盖子，这个动作会过于繁琐和麻烦。使用过后再收纳也会同样花时间，所以就随意扔在桌子上了。但如果把动作压缩到2步：打开门 ➡️ 拿出来（放回去），以 one touch（一键式）取出来，减少繁琐的收纳操作，更省心、省力，也不会感到太麻烦。</p>\n<p><strong>五、自立·自由·自在法</strong></p>\n<p>自立：毛巾、T恤等布艺制品立着叠放入收纳浅盒中；</p>\n<p>自由：根据杯子的形状种类排列，方便自由拿取；</p>\n<p>自在：底裤、袜子等小件衣物团着折叠扔进收纳盒中，自在滚动；</p>\n<p>从切实能出成绩的小地方着手，全力集中在“达成事件”上，一点点地增加成就感，给自己的“自信心账户”一点点地转账存钱。小地方获得的小成功不断累加，能给人以勇气和信心去面对自己的老大难问题。</p>\n<h3 id=\"断舍离的步骤\"><a href=\"#断舍离的步骤\" class=\"headerlink\" title=\"断舍离的步骤\"></a>断舍离的步骤</h3><ol>\n<li>认识现状；</li>\n<li>选择取舍；</li>\n<li>收纳整理；</li>\n</ol>\n<h3 id=\"居所断舍离的要点\"><a href=\"#居所断舍离的要点\" class=\"headerlink\" title=\"居所断舍离的要点\"></a>居所断舍离的要点</h3><ul>\n<li>衣柜的断舍离</li>\n</ul>\n<p><img src=\"https://qiniu-image.gotojava.cn/blog/image-20240125042251090.png\" alt=\"衣柜的断舍离\"></p>\n<ul>\n<li>壁橱的断舍离</li>\n</ul>\n<p><img src=\"https://qiniu-image.gotojava.cn/blog/image-20240125031043646.png\" alt=\"壁橱的断舍离\"></p>\n<ul>\n<li>厨房的断舍离</li>\n</ul>\n<p><img src=\"https://qiniu-image.gotojava.cn/blog/image-20240125031110234.png\" alt=\"厨房的断舍离\"></p>\n<ul>\n<li>餐具柜的断舍离</li>\n</ul>\n<p><img src=\"https://qiniu-image.gotojava.cn/blog/image-20240125031148638.png\" alt=\"餐具柜的断舍离\"></p>\n<ul>\n<li>冰箱的断舍离</li>\n</ul>\n<p><img src=\"https://qiniu-image.gotojava.cn/blog/image-20240125031223642.png\" alt=\"冰箱的断舍离\"></p>\n<ul>\n<li>书架的断舍离</li>\n</ul>\n<p><img src=\"https://qiniu-image.gotojava.cn/blog/image-20240125031248948.png\" alt=\"书架的断舍离\"></p>\n<ul>\n<li>厕所的断舍离</li>\n</ul>\n<p><img src=\"https://qiniu-image.gotojava.cn/blog/image-20240125031316007.png\" alt=\"厕所的断舍离\"></p>\n<ul>\n<li>家门口的断舍离</li>\n</ul>\n<p><img src=\"https://qiniu-image.gotojava.cn/blog/image-20240125031340614.png\" alt=\"家门口的断舍离\"></p>\n<ul>\n<li>客厅、餐厅的断舍离</li>\n</ul>\n<p><img src=\"https://qiniu-image.gotojava.cn/blog/image-20240125031403493.png\" alt=\"客厅、餐厅的断舍离\"></p>\n<h2 id=\"总结\"><a href=\"#总结\" class=\"headerlink\" title=\"总结\"></a>总结</h2><p>这本书倡导我们摒弃不必要的物品，将注意力从物质的积累转移到生活本身的追求上。通过践行“断舍离”的理念，我们可以释放内心的空间，变得更加轻松、自在。“断”即断绝不必要的购买，“舍”即舍弃家中不必要的物品，“离”则是脱离对物质的迷恋。通过“断舍离”，我们不仅可以整理自己的居住空间，也能让我们的生活变得更加充实、幸福。</p>\n","excerpt":"<meta name=\"referrer\" content=\"no-referrer\" />\n\n<p>《断舍离》是山下英子老师从瑜伽的修行哲学”断行“、”舍行“、”离行“中提炼出”断舍离“的思维方式并用于日常生活的”整理“上。那么到底什么是断舍离？断舍离又是怎么去整理生活的？本文将追随山下英子老师，学习探索断舍离的简约之道。</p>","more":"<p><img src=\"https://qiniu-image.gotojava.cn/blog/%E3%80%8A%E6%96%AD%E8%88%8D%E7%A6%BB%E3%80%8B.png\" alt=\"《断舍离》思维导图\"></p>\n<p>这次从上海回家乡的火车上，闲来无事，就翻阅了一下随身带的一本断舍离，其实在接触《断舍离》这本书之前，就对这本书有所耳闻，但一直没有机会拜读。这次刚好回家乡的路途时间较长，有足足22个小时的火车，刚好有机会学习一下。也算是缘分到了。</p>\n<p>翻开《断舍离》一书，就被书中的一行蓝底白色所吸引：”<strong>放手一个无用之物，就腾出一点空间。处理一件多余之物，就减少一份负担。然后，翻开人生新篇章</strong>。“。看到这句话的时候，内心有一种触动感。就像我们身处在一间采光良好，空间很大的房间里时，屋子里很干净、物品的摆放也很整齐，我相信多数人都会感到舒服。</p>\n<p><img src=\"https://qiniu-image.gotojava.cn/blog/%E6%95%B4%E6%B4%81%E6%98%8E%E4%BA%AE%E7%9A%84%E5%B1%8B%E5%AD%90.jpg\" alt=\"整洁明亮的屋子-图片来自互联网\"></p>\n<p>但反之，如果你身处在一间杂物堆积、垃圾遍地的屋子里时，也会感觉到心被堵了。这种压迫感的环境逐渐让在这里生活的人变得思维迟钝、行动迟缓，然后渐渐变得封闭、不想外出，进而演变成近似愤懑抑郁的状态。</p>\n<p><img src=\"https://qiniu-image.gotojava.cn/blog/%E6%9D%82%E7%89%A9%E5%A0%86%E7%A7%AF%E7%9A%84%E5%B1%8B%E5%AD%90.jpg\" alt=\"杂物堆积的屋子-图片来自互联网\"></p>\n<p>虽然新媒体和商家也在极力宣传着一些整理、收纳的方式方法，但其本质在于减少物品占用的空间体积、废物利用…治标不治本。而断舍离所倡导的是一种生活上的“新陈代谢”的思维方式。</p>\n<h2 id=\"断舍离是什么\"><a href=\"#断舍离是什么\" class=\"headerlink\" title=\"断舍离是什么\"></a>断舍离是什么</h2><p>那么什么是断舍离呢？”断舍离”是指通过<strong>断绝不必要的联系</strong>、<strong>舍弃多余的物质与情感负担</strong>，以及<strong>清理整理个人生活和心灵空间</strong>，达到简化生活、追求轻松自在的目的。橱柜里、餐架上或者冰箱中囤积的无用之物，家里随处堆积的废品破烂，还包括精神层面上那些不适宜的过剩观念，或是让自己陷入自我否定、自我谴责境地的消极思维或情感纪念物。只有放手这些东西，才能解放自己、解放人生。即：<em><strong>斩“断”物欲</strong></em>、<em>“<strong>舍”弃废物</strong></em>、<em><strong>脱“离”执念</strong></em>。</p>\n<h2 id=\"我们为什么无法放手\"><a href=\"#我们为什么无法放手\" class=\"headerlink\" title=\"我们为什么无法放手\"></a>我们为什么无法放手</h2><p>一、随着5G社会的发展，短视频、新媒体行业的兴起，加速了信息的流速。商家的大肆宣传，打折、促销、直播带货的低价锚点效应不断的刺激着我们的消费欲。使我们很难逃脱资本给我们量身打造的”买买买“的陷阱。记得每次出去逛街，总能看到一些卖衣服商家的小姐姐在门口大肆吆喝着：”68一件、100元两件，赶快进店看一看吧“。持着闲来无事看一看的心态，总是不由自主的走进店铺进行试选，导购的小姐姐热情似火的介绍和推荐以及熟练的话术让我不由自主的着了道。碰到特别合适的总忍不住剁个手。结账的时候常常也会感到肉疼，但还是扫码付款一气呵成。我相信此类的场景大家也都会遇到过。</p>\n<p>二、时代遗留的价值观，比如：”这个东西还能用“、”或许以后能用到，就先留下来吧“，而不是”<strong>这个东西是真的需要吗</strong>“。或者因商家打折、促销而多买的日用品、消耗品，回到家时，却发现了囤积占了很多的体积空间，扔了感觉心疼、浪费，有些可能甚至一次都没有使用过。</p>\n<p>三、现在由于工作繁忙、生活压力过大、待在家中的时间短、不会认真的做家务。还有很多是对家庭和家务有情绪，不想待在家中，只想埋头工作。看到家里乱七八糟，心情特别差、更是不愿意待在家中，陷入了不良循环。</p>\n<p>四、对于一些特别念旧的人，总是会收集和珍藏很多现在不用的旧物，小心翼翼地保留着以前的相册或是奖杯奖牌，以及带有过往纪念性质的信件、照片等小物件。总是沉湎过去的快乐时光，而忽略了对当下现实的投入。</p>\n<p>五、”生于忧患、死于安乐“是古人在与猛兽为群时，为了保证自己能生存下来在经历漫长的岁月中所总结的良言警句。对于现代生活的我们有很好的预警左右，也能让我们时刻保持警惕、以应对可能发生的安全威胁。但如果不停的为将来的事情所忧虑，不停地为将来储备东西。眼睛只盯着”某些东西没有，自己将来必定会发愁“的心态，也会导致我们囤积过多的日用品和消耗品。</p>\n<p><strong>断舍离，不是要求我们随意地”弃“，而是把”舍“作为解决问题的方法之一。</strong>在进行取舍时，我们应该挑选出有质量的东西或者我们十分喜爱的，专注于那些与自己生活关联度高的物品上，处理掉不需要的物品。将物品压缩到能够建立和保持社会性从而选择适合的量即可，才能从最本真的意义上珍惜事物、热爱生活，并不是随意地、不走心地囤东西、扔东西。对于多囤积的物品，我们可以选择适当性的赠予邻居，从而建立我们和邻居之间的社交性往来、促进邻里关系。</p>\n<h2 id=\"断舍离是怎么工作的\"><a href=\"#断舍离是怎么工作的\" class=\"headerlink\" title=\"断舍离是怎么工作的\"></a>断舍离是怎么工作的</h2><p><img src=\"https://qiniu-image.gotojava.cn/blog/image-20240125021841658.png\" alt=\"断舍离的工作机制\"></p>\n<p>我们知道了断舍离是通过“舍弃”来减压我们的生活环境，达到简化生活、追求轻松自在的目的。那么断舍离又是如何去“舍”的呢？下面我们将通过“八个技巧”、“五个收纳指南”来学习断舍离、掌握断舍离的要点。</p>\n<p><img src=\"https://qiniu-image.gotojava.cn/blog/image-20240125022204695.png\" alt=\"断舍离的工作机制-八个技巧\"></p>\n<h3 id=\"八个技巧\"><a href=\"#八个技巧\" class=\"headerlink\" title=\"八个技巧\"></a>八个技巧</h3><p><strong>一、认识现状</strong></p>\n<p>假如我们要去爬一座海拔很高的山，首先要做的是准备登山用具、掌握登山所必须的知识、计划山路路线、进行食物储备、准备通讯设备、预备登山物资等等，而不是盲目的就去了。家务的整理也是一样的，我们首先需要做的，<em><strong>就是掌握家里物品的数量和质量，观察东西有没有存在过剩的情况</strong></em>。</p>\n<p>从三个阶段来评估住所的现状：</p>\n<ol>\n<li>收纳空间的物品量合理，没有过度过量，偶尔出现“凌乱”摆放的情况；</li>\n<li>收纳空间已经满载，甚至出现物品“溢出、过剩”情况；</li>\n<li>东西已经好多年没有整理过，出现了“堆积”的情况；</li>\n</ol>\n<p>首先确认物品的“量”，接下来再判断居住空间的“质”处于什么水平。</p>\n<p>就像我这次回家，家里的衣橱中的柜子里存放着我学生时代的教材书籍和实验用的设备。父母因为不懂，也不敢随意处理，生怕我需要用的时候找不到。但我已经工作3年了，这些东西早已经过了”保质期“。后来清理了一座小山，才把柜子全部清空，只留下了一些必要的荣誉证书作为纪念。</p>\n<p><strong>二、停止自我否定</strong></p>\n<p>女性把“收拾家务”直接等同于“理所当然应会的家务劳动”，简单地把家务整理分成“会收拾”和“不会收拾”，理解成能力问题。男性则简单直接理解为“不收拾”，并没有添加什么个人情绪在其中。</p>\n<p>女性既受到了“没有收拾干净的环境”的损害，又不得不自虐自嘲为“不会收拾家务的女人”，心理上受到的伤害也越发地深刻。只有摆脱这种自罚性的思维倾向，不再去否定自我，才能实现思维观念上的断舍离。</p>\n<p><strong>三、描绘家的具体构想</strong></p>\n<p>收拾东西并不是我们最终的目的，我们真正想要的是<strong>实现“健康舒适的居住空间”</strong>。当我们的目的明确以后收拾东西仅仅只是实现“健康舒适的居住空间”这个目的手段而已。那么首先应该做的是明确描绘住所的蓝图，收拾整理完后，我想在这里进行怎样的生活？<strong>这个模糊的念头可以帮助我们回到人生的原点”我究竟想要怎样的生活？“，也会变成我们实践断舍离的源动力。</strong></p>\n<p><strong>四、拿出杂物、俯瞰</strong></p>\n<p>把握自己现在的居所物品过剩、无法收纳的现状后，把杂物全部摆出来，放在地板上、桌上等水平面的位置。然后从高处对杂物总量进行俯瞰，俯瞰的目的是可以让我们知道需要整理的工作量大约有多少。</p>\n<p>在开始实施断舍离时，<em><strong>要在计划的时间内从少量的、小单位的着手</strong></em>。单位越小，将物品从收纳柜取出来所花的时间就越少。也不会打击对于断舍离的热情，同时能得到正向的反馈。这种小单位量的断舍离持续下去，不久就会变成大单位量的断舍离。</p>\n<p><strong>五、扔掉“怎么看都是垃圾·废品”的东西</strong></p>\n<p>扔掉过期保质的生鲜食品、没有食欲的食物，损坏的、不能使用的、已经忘却的、将来也用不上的东西开始处理。</p>\n<p><strong>六、以自我·时间为判断基准，考虑自身与物品的“关联度”，再进行取舍</strong></p>\n<img src=\"https://qiniu-image.gotojava.cn/blog/image-20240125052516460.png\" width=\"400\">\n\n<p>以“自我轴”为基准进行取舍时，只需要考虑“<strong>这个东西我想不想用</strong>”。</p>\n<p>有些东西一年可能才用的上一回，对于这些东西，<strong>不要从频率，而要从和自己的“关联度”的视角进行判断</strong>。</p>\n<p>物品与自己的关联度会随着时间而变化，同一件物品，不同的人会有不同的评判，也有不同的关联度。这是所有人、事、物三者关系网成立的大前提。在这个大前提下，那些同时满足必要、合适、愉快三个维度的物品很快就能被锁定。并且可以摆脱人、事、物单纯理解为非对即错、非善即恶的二元思维，逐渐形成多元性、尊重他人的意识。</p>\n<p><strong>七、以“必要·合适·愉快”为标准进行取舍</strong></p>\n<p>这个东西对我来说是必要的吗？是否适合我？使用起来是不是心情愉快？那么对于”现在“的我来说，那些”<strong>不需要、不合适、不愉快的东西应该处理掉。</strong>“</p>\n<p>不需要的东西：东西使用起来很便利，虽然没有坏，但是丢了也不发愁；</p>\n<p>不合适的东西：以前很重要，但是对现在的我不合适；</p>\n<p>不愉快的东西：长时间使用，但会有莫名的违和感和不愉快情绪；</p>\n<p><strong>八、收纳在杂物最适合化之后进行</strong></p>\n<ul>\n<li>“收拾”就是对庞大的杂物量进行压缩和收纳的作业</li>\n<li>“整理·分类” + “扫除”，总称为“打扫”。</li>\n</ul>\n<p>在断舍离的大前提下，最正确的“打扫”程序是首先清除那些垃圾、废品，以及不需要、不合适、不愉快的杂物，之后再转而进行杂物收纳，进行“清扫、擦拭、磨刷”。因为如果不按这个顺序做的话，把垃圾、废品或者不需要、不合适、不愉快的杂物重新塞进收纳箱，就完全失去了打扫的意义。而且、塞进柜子之后，这些杂物依然是以”机能不全“的状态藏在家中，”大扫除”并没有任何实际的意义。</p>\n<h3 id=\"五个收纳指南\"><a href=\"#五个收纳指南\" class=\"headerlink\" title=\"五个收纳指南\"></a>五个收纳指南</h3><p><strong>一、三分法</strong></p>\n<p>大分类 ➡️ 中分类 ➡️ 小分类，<strong>分类的关键是三类不能交叉</strong>，交叉会产生范畴错误，错误越多越会导致找东西花时间，思维也发生混乱。</p>\n<p><img src=\"https://qiniu-image.gotojava.cn/blog/image-20240125025928515.png\" alt=\"三分法-厨房例子\"></p>\n<p><strong>二、7•5•1法</strong></p>\n<p>“7·5·1法”指的是进行杂物收纳时，对收纳空间的物量进行大致的估测。根据不同的收纳情况，将杂物总量压缩到收纳空间的”7成“、”5成“、”1成“。</p>\n<ul>\n<li><p>“看不见的收纳空间”，占7成</p>\n<p>衣柜、壁橱、抽屉等关上门就“看不见的收纳空间”所放杂物的量基本上占整体空间的7成。</p>\n<p>留下3成的目的在于想取柜子最里面的东西时，有操作的空间，避免把前面的东西拿出来再重新去取，减少麻烦。</p>\n</li>\n<li><p>“看的见的收纳空间”，占5成</p>\n<p>带玻璃门的柜子或橱柜关上门依然能“看得见的收纳空间”所放杂物的量基本上占整体空间的5成。5成的空间可以尽量保持一定的美观。</p>\n</li>\n<li><p>“展示性的收纳空间”，占1成</p>\n<p>可以看到的开放性空间，如桌面、橱柜的水平面、门口的鞋柜等“展示性的收纳空间”上所放杂物的量基本上占整体空间的1成。</p>\n</li>\n</ul>\n<p><strong>三、1 out 1 in 法（一出一进法）</strong></p>\n<p><strong>遵守“处理一个、收纳一个”的原则。先出再进</strong>。因为先取出一个，再放入新东西，就不会出现失效的可能。让自己产生”决不能再随意买一些乱七八糟的东西“的觉悟。在面对可入手的诱惑时，让我们产生一丝心理上的犹豫。</p>\n<p><strong>四、one touch法（一键式法）</strong></p>\n<p>在进行杂物整理收纳时，打开收纳柜的们，取出里面的箱子，再打开盖子，这个动作会过于繁琐和麻烦。使用过后再收纳也会同样花时间，所以就随意扔在桌子上了。但如果把动作压缩到2步：打开门 ➡️ 拿出来（放回去），以 one touch（一键式）取出来，减少繁琐的收纳操作，更省心、省力，也不会感到太麻烦。</p>\n<p><strong>五、自立·自由·自在法</strong></p>\n<p>自立：毛巾、T恤等布艺制品立着叠放入收纳浅盒中；</p>\n<p>自由：根据杯子的形状种类排列，方便自由拿取；</p>\n<p>自在：底裤、袜子等小件衣物团着折叠扔进收纳盒中，自在滚动；</p>\n<p>从切实能出成绩的小地方着手，全力集中在“达成事件”上，一点点地增加成就感，给自己的“自信心账户”一点点地转账存钱。小地方获得的小成功不断累加，能给人以勇气和信心去面对自己的老大难问题。</p>\n<h3 id=\"断舍离的步骤\"><a href=\"#断舍离的步骤\" class=\"headerlink\" title=\"断舍离的步骤\"></a>断舍离的步骤</h3><ol>\n<li>认识现状；</li>\n<li>选择取舍；</li>\n<li>收纳整理；</li>\n</ol>\n<h3 id=\"居所断舍离的要点\"><a href=\"#居所断舍离的要点\" class=\"headerlink\" title=\"居所断舍离的要点\"></a>居所断舍离的要点</h3><ul>\n<li>衣柜的断舍离</li>\n</ul>\n<p><img src=\"https://qiniu-image.gotojava.cn/blog/image-20240125042251090.png\" alt=\"衣柜的断舍离\"></p>\n<ul>\n<li>壁橱的断舍离</li>\n</ul>\n<p><img src=\"https://qiniu-image.gotojava.cn/blog/image-20240125031043646.png\" alt=\"壁橱的断舍离\"></p>\n<ul>\n<li>厨房的断舍离</li>\n</ul>\n<p><img src=\"https://qiniu-image.gotojava.cn/blog/image-20240125031110234.png\" alt=\"厨房的断舍离\"></p>\n<ul>\n<li>餐具柜的断舍离</li>\n</ul>\n<p><img src=\"https://qiniu-image.gotojava.cn/blog/image-20240125031148638.png\" alt=\"餐具柜的断舍离\"></p>\n<ul>\n<li>冰箱的断舍离</li>\n</ul>\n<p><img src=\"https://qiniu-image.gotojava.cn/blog/image-20240125031223642.png\" alt=\"冰箱的断舍离\"></p>\n<ul>\n<li>书架的断舍离</li>\n</ul>\n<p><img src=\"https://qiniu-image.gotojava.cn/blog/image-20240125031248948.png\" alt=\"书架的断舍离\"></p>\n<ul>\n<li>厕所的断舍离</li>\n</ul>\n<p><img src=\"https://qiniu-image.gotojava.cn/blog/image-20240125031316007.png\" alt=\"厕所的断舍离\"></p>\n<ul>\n<li>家门口的断舍离</li>\n</ul>\n<p><img src=\"https://qiniu-image.gotojava.cn/blog/image-20240125031340614.png\" alt=\"家门口的断舍离\"></p>\n<ul>\n<li>客厅、餐厅的断舍离</li>\n</ul>\n<p><img src=\"https://qiniu-image.gotojava.cn/blog/image-20240125031403493.png\" alt=\"客厅、餐厅的断舍离\"></p>\n<h2 id=\"总结\"><a href=\"#总结\" class=\"headerlink\" title=\"总结\"></a>总结</h2><p>这本书倡导我们摒弃不必要的物品，将注意力从物质的积累转移到生活本身的追求上。通过践行“断舍离”的理念，我们可以释放内心的空间，变得更加轻松、自在。“断”即断绝不必要的购买，“舍”即舍弃家中不必要的物品，“离”则是脱离对物质的迷恋。通过“断舍离”，我们不仅可以整理自己的居住空间，也能让我们的生活变得更加充实、幸福。</p>"},{"title":"电子邮件礼仪","abbrlink":"b01acda2","date":"2023-11-23T17:14:23.000Z","toc":true,"_content":"<meta name=\"referrer\" content=\"no-referrer\" />\n\n电子邮件是我们沟通方式的一部分，在早期网络不发达的时代，写信成了重要的沟通方式。那么如何写好一封得体的邮件，也成为了个人发展的重要技能之一。\n\n<!--more-->\n\n## 为什么需要？\n\n- 彰显工作能力和专业性\n\n通过使用合适的邮件语言，你开业传达出一个专业的形象，显得”我很专业！“。\n\n特别对于哪些我们不认识的人，这是对方判断我们的唯一方法。就像我们面试投递简历一样，别人也会通过初步了解一个人。\n\n- 提高工作效率\n\n邮件组织得当、条理清晰，避免浪费他人时间。\n\n- 严肃性\n\n商务电子邮件不同于私人邮件、它具备严肃性和商务规范性。\n\n## 电子邮件礼仪\n\n### 及时回复\n\n邮件应尽量及时回复，就像别人给你发的微信一样，你要给别人一个反馈，告诉别人你收到了消息。\n\n回复不一定是要给出解决方案，有时只是一个”好的“、”收到“、”了解“。\n\n及时回复代表了礼貌和对别人的尊重，如果不能及时回复，也请简单说明理由。特别是在别人协助你解决问题的时候。\n\n### 收件人、抄送、密送\n\n- 收件人（To List）\n\n需要回复或者采取行动的人，不要把仅需要了解此邮件事项的人放入收件人。\n\n- 抄送（CC List）\n\n需要了解此邮件事项相关的人。通常包含发件人的主管和收件人的主管，因为双方主管都需要了解你做的事情。\n\n- 密送（BCC List）\n\n发件人想把此邮件发送给他，但又不想被收件人或者抄送者知道。\n\n### 邮件主题\n\n1. 主题一定要写，不能为空。\n2. 主题必须具体、不含糊、且有意义，比如：”关于20231123研发部二组周工作例会会议记录“。\n3. 当回复邮件时，要修改主题以反映新的内容。\n\n   邮件回复或转发多次后，主题前面会自动添加”回复“、”Re“、”Fw“等，要适当删除，保留最多两个。反例：\n\n   > Re: Re: Re: Re: Re: 清明节放假事宜\n   >\n4. 主题内容包含附件时，要删除主题中的“发送附件：”，不要存在”发送附件：XXXX“的内容。\n\n### 称呼\n\n1. 邮件要有称呼。称呼要和收件人清单一致，不含抄送人。\n\n不少人写邮件一上来就直接说事情，给人的感觉是“你应该知道我是谁”；有的至多用个“你好”，这些都是不礼貌的做法。\n\n正确的做法是：如果对方有职位要称呼职位（姓氏+职位）；如果不清楚职位，可用姓氏+先生/小姐。当然十分熟悉的情况下，可以用双方习惯的称呼方式，而这种情况仅限于非正式邮件。值得注意的是，通常用“您好”比用“你好”更有礼貌，除非确定自己是上级或长者。\n\n比较忌讳的是管所有人都叫经理，普通员工自然很高兴，但会冒犯比经理职位高的人。    通常称呼他人可省去“副”字，但尽量不要跳级，更不可给别人降级。例如对方是副经理，可以称呼“姓氏+经理”，但不要称呼“姓氏+总”；而如果对方是副总裁，则不可称呼对方为经理或总经理。\n\n2. 当收件人为多人时，称呼可以使用：”各位：“、”各位领导：“、”各位同事“、”Dear all.“\n\n### 邮件正文\n\n正文要从”称呼“下另起一行，不要从”称呼“在同一行开始。\n\n按照逻辑顺序安排邮件内容。\n\n- **首先：**开门见山，点明问题；\n- **其次：**细节描述、背景说明；\n- **接着：**提供支持性材料或附件；\n- **留意：**原邮件（先前的邮件）加在回复内容之后；\n\n> “6W1H”是一个用于提出问题、进行调查或分析的工具，尤其在新闻报道、项目管理和问题解决等领域中常被使用。它代表着六个问句和一个问词，具体如下：\n>\n> 1. **What（什么）：** 问题的核心是什么？这关注事件或主题的本质。\n> 2. **Why（为什么）：** 为什么事件发生？这关注原因和动机。\n> 3. **Who（谁）：** 谁参与了事件？这关注相关的人物。\n> 4. **When（何时）：** 事件发生的时间是什么时候？这关注时间的范围。\n> 5. **Where（何地）：** 事件发生的地点在哪里？这关注地理位置。\n> 6. **How（如何）：** 事件是如何发生的？这关注事件的过程和方式。\n> 7. **How Much（多少）：** 这是附加的一个问题，关注数量或程度。\n\n<aside>\n⚠️ 通过6W1H清楚表达你的观点。\n</aside>\n\n### 回复或转发\n\n- 收件人和抄送\n\n回复或转发时，检查 “收件人”、“抄送”内的名单，加上那些必须包括的，删除那些不需要抄送的。\n\n- 礼节性回复\n\n如果你是主要的信息接收者(即表明你的名字在“收件人”中)，收到邮件时总是答复“谢谢”、“我明白”以确认你收到邮件。\n\n对于礼节性回复，你可仅仅回复给发送者 (不要回复给所有人)\n\n- 删除不必要的先前邮件或附件\n- 部门助理或联络窗口转发邮件\n\n及时转发给相关人员。如不清楚，请示主管\n\n一定抄送给原发件人和自己的主管，以便跟进\n\n- 回复错发的邮件\n\n由于邮箱地址类似等原因，发件人可能会错发邮件。如果收到别人错发的邮件，请回复发件人“我是XXX，你是否错发邮件？”当然，附上原邮件。\n\n### 如何更新邮件\n\n邮件发出后，发现内容有错，或情况有变化，则需更新邮件。\n\n1. 用原邮件转发，原主题后加update 或—更新, 表明这是更新的邮件\n2. 转发的内容中说明原邮件中哪里有错，更新为新的内容\n\n### 邮件沟通原则\n\n- 跟进\n\n对于紧急或重要的事情，应该打电话给相关人员，以确定其收到邮件并明白要做的事情。\n\n- 避免做邮递员\n\n“我发邮件了，他没看”（把责任推给别人）\n\n“我收到他的邮件回执，说明他收到邮件了”。\n\n要确定收人人收到邮件并了解要做什么事情，什么时候要完成，不要只做邮递员。\n\n### 缩略语\n\n当邮件是发给客户时，请使用规范的缩略语\n\n可以使用: ASAP, FYI, FYR 等.\n\n不要使用：\n\n| 缩写          | 解释                |\n| ------------- | :------------------ |\n| ref           | refer               |\n| Attn          | attention           |\n| pls           | please              |\n| q’ty         | quantity or qty     |\n| per           | as per              |\n| B’R, BstRdgs | Best Regards        |\n| Thks          | thanks or thank you |\n\n### Confidentiality Note\n\n对于部分法务性邮件或商务性邮件，可能涉及保密资料或所有权资料，这类邮件通常在最后加这样一段文字：\n\n> Confidentiality note:The information in this email and any attachment may contain confidential and proprietary information of ABC Company  and/or its affiliates  may be privileged or otherwise protected from disclosure. If you are not the intended recipient, you are hereby notified that any review, reliance or distribution by others or forwarding without express permission is strictly prohibited and may cause liability. In case you have received this message due to an error in transmission, we kindly ask you to notify the sender immediately and to delete this email and any attachment from your system.\n\n## 注意事项\n\n### 收件人、抄送、密送\n\n- 出部门的邮件，必须抄送给部门主管（总监、经理、副经理）。\n- 出公司的邮件，必须抄送给分管副总或总经理。\n- 公司内部沟通邮件不可抄送给公司外部人员，因为有些涉及商业机密，防止泄密问题。\n- 邮件只发给该发的人，不要发给不必要接收此邮件的人，以节省大家的时间。\n- 不建议使用密送，密送有可能看不到收件人和抄送的人，密送的回复有可能会被收件人和抄送的人看到。\n- 回复邮件时需要注意，不要随便就回复给所有人，通常不使用”回复全部“，要根据邮件内容修改收件人和抄送名单。\n\n### 邮件主题\n\n- 不要使用“万金油”邮件主题\n\n反例：![image-20231123182550920](http://qiniu-image.gotojava.cn/blog/2023-12-15-190843.png)\n\n- 主题与内容相符\n\n回复邮件时需要注意，主题要与邮件内容相符，特别注意在回复邮件时或转发邮件时，要根据邮件内容修改主题。\n\n![image-20231123182758899](http://qiniu-image.gotojava.cn/blog/2023-12-15-190845.png)\n\n- 主题不是正文\n\n不要把邮件正文内容写在主题中, 除非只有简单的一句话。以下是不恰当的邮件主题：\n\n![image-20231123183151947](http://qiniu-image.gotojava.cn/blog/2023-12-15-190847.png)\n\n![image-20231123183211769](http://qiniu-image.gotojava.cn/blog/2023-12-15-190849.png)\n\n### 特别注意不要使用感叹号\n\n> 感叹号：主要用在感叹句的句末，表示强烈的感情。感叹句是以抒发感情为主的句子，它所抒发的感情有赞颂、喜悦、愤怒、叹息、惊讶、伤悼等，句末都要用感叹号。《百度百科》\n\n除了“您好！”、“谢谢！”之外，都不要使用感叹号。\n\n在书面沟通和电子邮件沟通中，使用感叹号就表示拍桌子、大声吼叫、挥舞拳头、用中指指人。\n\n有的人甚至用一个感叹号还觉得不够，还用三个！！！，这是非常强烈的咆哮。\n\n### 忌回复所有人\n\n通常只需要答复发件人，很少有需要全部回复的情况，尽管对方可能同时发给了很多人。为了减少给别人带来的不必要麻烦，用“回复”功能即可；如果很有必要抄送给其他人，则尽量自己根据实际需要有选择性地写上去。\n\n尤其需要注意的是，好的事情可以抄送给他人，不好的事情尽量一对一处理；这与表扬当众，批评不当众是一个道理。当然，那种利用便利的往来邮件打嘴仗的行为只能影响个人形象。\n\n发件人为了避免出现对方随意点击“回复所有人”的不职业情况，可以把大批量的收件人地址放在“密送”处，然后在正文起始位置写上收信人的群体名称，例如“致：各事业部经理”等，有利于收信人清晰了解与自己同时收到邮件的还有哪些人，同时避免了垃圾邮件的产生。\n\n### 忌不分段\n\n有的人整篇邮件从头至尾写成一大片，象小说一样，给人眉目不清晰的感觉，不想看下去，从而自然影响处理的效率。\n\n推荐的方式是，尽量在一个显示页面完成全文，一段一个核心意思，然后空行写第二段；如果说的事项较多，建议加上序号，但一次最好不超过三项，否则不容易记住。\n\n当然，如果能根据收件人的具体情况调整字号大小、字体样式等，则为最佳。例如对方均是五十多岁的领导，可以适当调大字号，以便对方阅读，从而也提高了回复效率。\n\n### 忌重点不突出\n\n现在的职场压力和信息的充斥已很难容许人们逐字逐句地阅读一个完整的邮件。所以写信人可以把最核心的词用突出标识加以强调，包括加粗、增大字号或换字体、颜色等。但公文中通常只允许黑色和蓝色，只有相当于海报作用时才可以适当用彩色。\n\n邮件的标题至关重要，要行动性很强，只用核心词，去掉虚词。与行动、结果相关的字眼可放在句首的【】内，然后再写具体内容，例如标题可写为“【请9日前确认】xx会议日程”。\n\n### 忌不感谢\n\n有些人没有感谢的习惯，而这往往是邮件回复率低的一个主要原因。不论是寻求合作、请教问题、请人帮助，还是只是告知，都可以感谢对方的善意或配合。即便是领导命令对方与自己合作，说句感谢只能表明自己有修养；更何况自己请对方帮忙呢。\n\n### 忌不署名\n\n不署名，言外之意，对方应该能从邮件地址判断出自己是谁，或者“不用那么客气”，而这样做会给对方造成很多不便，也较影响办事效率，想打电话沟通具体事宜时，还需要再查找。\n\n### 避免错别字\n\n邮件中出现错别字会被认为是做事不认真，客户由此判断一个团队做事不认真。因此，一个有错别字的邮件可能导致几百万上千万订单的损失。\n\n如果使用outlook等写英文邮件，则每次使用“拼写检查”。如果写中文邮件，则自己要会检查。或者贴到word中进行中文语法检查。\n\n特别注意不要把人名写错。写错人名给人的感觉是极不尊重对方。(自己的名字按身份证上写，不要说“身份证是错的”，更不要按自己的喜欢来写)常见写错的名字有：丽莉利，平苹萍，洪红宏，华桦，清青菁，林淋琳，玲铃，民明名，生升，娇姣，英瑛。\n\n### 语气\n\n使用“请求”的语气以示尊重，不要用“命令”的语气。\n\n| 语气词 | 例子                                                                       |\n| :----- | :------------------------------------------------------------------------- |\n| 不好   | 请各事业部将XX表于明天报上来，谢谢。（你认为很客气？，其实存在着严重官僚） |\n| 好     | 请各事业部将XX表于明天发给我，谢谢。                                       |\n| 不好   | 附件是XXX文件，请查收！（除了“你好！”“谢谢！”再不要用感叹号）          |\n| 好     | 附件是XXX文件，请查收，谢谢！                                              |\n\n### 字体、颜色、缩减\n\n- 商务邮件具有其严肃性。\n\n不要采用不同的字体，除非很必要不要使用不同的颜色，除非你想用不同的颜色强调某些东西。\n\n- 电子邮件软件可能互不兼容，例如Notes 和 Outlook\n\n例如“删除线”，在另一邮件系统中可能不显示。\n\n在邮件中不要使用“缩进式”和“制表符(Tab)”，因为用另一软件打开它们可能导致文本不对齐\n\n发给公司外部的邮件，避免使用上述不兼容的格式\n\n## 培训资料获取\n\n电子邮件礼仪（PPT）\n\n链接: https://pan.baidu.com/s/1V-LwM58oQ8KE8TJbV79C4Q?pwd=8888 提取码: 8888\n","source":"_posts/电子邮件礼仪.md","raw":"---\ntitle: 电子邮件礼仪\nabbrlink: b01acda2\ndate: 2023-11-23 17:14:23\ntoc: true\n---\n<meta name=\"referrer\" content=\"no-referrer\" />\n\n电子邮件是我们沟通方式的一部分，在早期网络不发达的时代，写信成了重要的沟通方式。那么如何写好一封得体的邮件，也成为了个人发展的重要技能之一。\n\n<!--more-->\n\n## 为什么需要？\n\n- 彰显工作能力和专业性\n\n通过使用合适的邮件语言，你开业传达出一个专业的形象，显得”我很专业！“。\n\n特别对于哪些我们不认识的人，这是对方判断我们的唯一方法。就像我们面试投递简历一样，别人也会通过初步了解一个人。\n\n- 提高工作效率\n\n邮件组织得当、条理清晰，避免浪费他人时间。\n\n- 严肃性\n\n商务电子邮件不同于私人邮件、它具备严肃性和商务规范性。\n\n## 电子邮件礼仪\n\n### 及时回复\n\n邮件应尽量及时回复，就像别人给你发的微信一样，你要给别人一个反馈，告诉别人你收到了消息。\n\n回复不一定是要给出解决方案，有时只是一个”好的“、”收到“、”了解“。\n\n及时回复代表了礼貌和对别人的尊重，如果不能及时回复，也请简单说明理由。特别是在别人协助你解决问题的时候。\n\n### 收件人、抄送、密送\n\n- 收件人（To List）\n\n需要回复或者采取行动的人，不要把仅需要了解此邮件事项的人放入收件人。\n\n- 抄送（CC List）\n\n需要了解此邮件事项相关的人。通常包含发件人的主管和收件人的主管，因为双方主管都需要了解你做的事情。\n\n- 密送（BCC List）\n\n发件人想把此邮件发送给他，但又不想被收件人或者抄送者知道。\n\n### 邮件主题\n\n1. 主题一定要写，不能为空。\n2. 主题必须具体、不含糊、且有意义，比如：”关于20231123研发部二组周工作例会会议记录“。\n3. 当回复邮件时，要修改主题以反映新的内容。\n\n   邮件回复或转发多次后，主题前面会自动添加”回复“、”Re“、”Fw“等，要适当删除，保留最多两个。反例：\n\n   > Re: Re: Re: Re: Re: 清明节放假事宜\n   >\n4. 主题内容包含附件时，要删除主题中的“发送附件：”，不要存在”发送附件：XXXX“的内容。\n\n### 称呼\n\n1. 邮件要有称呼。称呼要和收件人清单一致，不含抄送人。\n\n不少人写邮件一上来就直接说事情，给人的感觉是“你应该知道我是谁”；有的至多用个“你好”，这些都是不礼貌的做法。\n\n正确的做法是：如果对方有职位要称呼职位（姓氏+职位）；如果不清楚职位，可用姓氏+先生/小姐。当然十分熟悉的情况下，可以用双方习惯的称呼方式，而这种情况仅限于非正式邮件。值得注意的是，通常用“您好”比用“你好”更有礼貌，除非确定自己是上级或长者。\n\n比较忌讳的是管所有人都叫经理，普通员工自然很高兴，但会冒犯比经理职位高的人。    通常称呼他人可省去“副”字，但尽量不要跳级，更不可给别人降级。例如对方是副经理，可以称呼“姓氏+经理”，但不要称呼“姓氏+总”；而如果对方是副总裁，则不可称呼对方为经理或总经理。\n\n2. 当收件人为多人时，称呼可以使用：”各位：“、”各位领导：“、”各位同事“、”Dear all.“\n\n### 邮件正文\n\n正文要从”称呼“下另起一行，不要从”称呼“在同一行开始。\n\n按照逻辑顺序安排邮件内容。\n\n- **首先：**开门见山，点明问题；\n- **其次：**细节描述、背景说明；\n- **接着：**提供支持性材料或附件；\n- **留意：**原邮件（先前的邮件）加在回复内容之后；\n\n> “6W1H”是一个用于提出问题、进行调查或分析的工具，尤其在新闻报道、项目管理和问题解决等领域中常被使用。它代表着六个问句和一个问词，具体如下：\n>\n> 1. **What（什么）：** 问题的核心是什么？这关注事件或主题的本质。\n> 2. **Why（为什么）：** 为什么事件发生？这关注原因和动机。\n> 3. **Who（谁）：** 谁参与了事件？这关注相关的人物。\n> 4. **When（何时）：** 事件发生的时间是什么时候？这关注时间的范围。\n> 5. **Where（何地）：** 事件发生的地点在哪里？这关注地理位置。\n> 6. **How（如何）：** 事件是如何发生的？这关注事件的过程和方式。\n> 7. **How Much（多少）：** 这是附加的一个问题，关注数量或程度。\n\n<aside>\n⚠️ 通过6W1H清楚表达你的观点。\n</aside>\n\n### 回复或转发\n\n- 收件人和抄送\n\n回复或转发时，检查 “收件人”、“抄送”内的名单，加上那些必须包括的，删除那些不需要抄送的。\n\n- 礼节性回复\n\n如果你是主要的信息接收者(即表明你的名字在“收件人”中)，收到邮件时总是答复“谢谢”、“我明白”以确认你收到邮件。\n\n对于礼节性回复，你可仅仅回复给发送者 (不要回复给所有人)\n\n- 删除不必要的先前邮件或附件\n- 部门助理或联络窗口转发邮件\n\n及时转发给相关人员。如不清楚，请示主管\n\n一定抄送给原发件人和自己的主管，以便跟进\n\n- 回复错发的邮件\n\n由于邮箱地址类似等原因，发件人可能会错发邮件。如果收到别人错发的邮件，请回复发件人“我是XXX，你是否错发邮件？”当然，附上原邮件。\n\n### 如何更新邮件\n\n邮件发出后，发现内容有错，或情况有变化，则需更新邮件。\n\n1. 用原邮件转发，原主题后加update 或—更新, 表明这是更新的邮件\n2. 转发的内容中说明原邮件中哪里有错，更新为新的内容\n\n### 邮件沟通原则\n\n- 跟进\n\n对于紧急或重要的事情，应该打电话给相关人员，以确定其收到邮件并明白要做的事情。\n\n- 避免做邮递员\n\n“我发邮件了，他没看”（把责任推给别人）\n\n“我收到他的邮件回执，说明他收到邮件了”。\n\n要确定收人人收到邮件并了解要做什么事情，什么时候要完成，不要只做邮递员。\n\n### 缩略语\n\n当邮件是发给客户时，请使用规范的缩略语\n\n可以使用: ASAP, FYI, FYR 等.\n\n不要使用：\n\n| 缩写          | 解释                |\n| ------------- | :------------------ |\n| ref           | refer               |\n| Attn          | attention           |\n| pls           | please              |\n| q’ty         | quantity or qty     |\n| per           | as per              |\n| B’R, BstRdgs | Best Regards        |\n| Thks          | thanks or thank you |\n\n### Confidentiality Note\n\n对于部分法务性邮件或商务性邮件，可能涉及保密资料或所有权资料，这类邮件通常在最后加这样一段文字：\n\n> Confidentiality note:The information in this email and any attachment may contain confidential and proprietary information of ABC Company  and/or its affiliates  may be privileged or otherwise protected from disclosure. If you are not the intended recipient, you are hereby notified that any review, reliance or distribution by others or forwarding without express permission is strictly prohibited and may cause liability. In case you have received this message due to an error in transmission, we kindly ask you to notify the sender immediately and to delete this email and any attachment from your system.\n\n## 注意事项\n\n### 收件人、抄送、密送\n\n- 出部门的邮件，必须抄送给部门主管（总监、经理、副经理）。\n- 出公司的邮件，必须抄送给分管副总或总经理。\n- 公司内部沟通邮件不可抄送给公司外部人员，因为有些涉及商业机密，防止泄密问题。\n- 邮件只发给该发的人，不要发给不必要接收此邮件的人，以节省大家的时间。\n- 不建议使用密送，密送有可能看不到收件人和抄送的人，密送的回复有可能会被收件人和抄送的人看到。\n- 回复邮件时需要注意，不要随便就回复给所有人，通常不使用”回复全部“，要根据邮件内容修改收件人和抄送名单。\n\n### 邮件主题\n\n- 不要使用“万金油”邮件主题\n\n反例：![image-20231123182550920](http://qiniu-image.gotojava.cn/blog/2023-12-15-190843.png)\n\n- 主题与内容相符\n\n回复邮件时需要注意，主题要与邮件内容相符，特别注意在回复邮件时或转发邮件时，要根据邮件内容修改主题。\n\n![image-20231123182758899](http://qiniu-image.gotojava.cn/blog/2023-12-15-190845.png)\n\n- 主题不是正文\n\n不要把邮件正文内容写在主题中, 除非只有简单的一句话。以下是不恰当的邮件主题：\n\n![image-20231123183151947](http://qiniu-image.gotojava.cn/blog/2023-12-15-190847.png)\n\n![image-20231123183211769](http://qiniu-image.gotojava.cn/blog/2023-12-15-190849.png)\n\n### 特别注意不要使用感叹号\n\n> 感叹号：主要用在感叹句的句末，表示强烈的感情。感叹句是以抒发感情为主的句子，它所抒发的感情有赞颂、喜悦、愤怒、叹息、惊讶、伤悼等，句末都要用感叹号。《百度百科》\n\n除了“您好！”、“谢谢！”之外，都不要使用感叹号。\n\n在书面沟通和电子邮件沟通中，使用感叹号就表示拍桌子、大声吼叫、挥舞拳头、用中指指人。\n\n有的人甚至用一个感叹号还觉得不够，还用三个！！！，这是非常强烈的咆哮。\n\n### 忌回复所有人\n\n通常只需要答复发件人，很少有需要全部回复的情况，尽管对方可能同时发给了很多人。为了减少给别人带来的不必要麻烦，用“回复”功能即可；如果很有必要抄送给其他人，则尽量自己根据实际需要有选择性地写上去。\n\n尤其需要注意的是，好的事情可以抄送给他人，不好的事情尽量一对一处理；这与表扬当众，批评不当众是一个道理。当然，那种利用便利的往来邮件打嘴仗的行为只能影响个人形象。\n\n发件人为了避免出现对方随意点击“回复所有人”的不职业情况，可以把大批量的收件人地址放在“密送”处，然后在正文起始位置写上收信人的群体名称，例如“致：各事业部经理”等，有利于收信人清晰了解与自己同时收到邮件的还有哪些人，同时避免了垃圾邮件的产生。\n\n### 忌不分段\n\n有的人整篇邮件从头至尾写成一大片，象小说一样，给人眉目不清晰的感觉，不想看下去，从而自然影响处理的效率。\n\n推荐的方式是，尽量在一个显示页面完成全文，一段一个核心意思，然后空行写第二段；如果说的事项较多，建议加上序号，但一次最好不超过三项，否则不容易记住。\n\n当然，如果能根据收件人的具体情况调整字号大小、字体样式等，则为最佳。例如对方均是五十多岁的领导，可以适当调大字号，以便对方阅读，从而也提高了回复效率。\n\n### 忌重点不突出\n\n现在的职场压力和信息的充斥已很难容许人们逐字逐句地阅读一个完整的邮件。所以写信人可以把最核心的词用突出标识加以强调，包括加粗、增大字号或换字体、颜色等。但公文中通常只允许黑色和蓝色，只有相当于海报作用时才可以适当用彩色。\n\n邮件的标题至关重要，要行动性很强，只用核心词，去掉虚词。与行动、结果相关的字眼可放在句首的【】内，然后再写具体内容，例如标题可写为“【请9日前确认】xx会议日程”。\n\n### 忌不感谢\n\n有些人没有感谢的习惯，而这往往是邮件回复率低的一个主要原因。不论是寻求合作、请教问题、请人帮助，还是只是告知，都可以感谢对方的善意或配合。即便是领导命令对方与自己合作，说句感谢只能表明自己有修养；更何况自己请对方帮忙呢。\n\n### 忌不署名\n\n不署名，言外之意，对方应该能从邮件地址判断出自己是谁，或者“不用那么客气”，而这样做会给对方造成很多不便，也较影响办事效率，想打电话沟通具体事宜时，还需要再查找。\n\n### 避免错别字\n\n邮件中出现错别字会被认为是做事不认真，客户由此判断一个团队做事不认真。因此，一个有错别字的邮件可能导致几百万上千万订单的损失。\n\n如果使用outlook等写英文邮件，则每次使用“拼写检查”。如果写中文邮件，则自己要会检查。或者贴到word中进行中文语法检查。\n\n特别注意不要把人名写错。写错人名给人的感觉是极不尊重对方。(自己的名字按身份证上写，不要说“身份证是错的”，更不要按自己的喜欢来写)常见写错的名字有：丽莉利，平苹萍，洪红宏，华桦，清青菁，林淋琳，玲铃，民明名，生升，娇姣，英瑛。\n\n### 语气\n\n使用“请求”的语气以示尊重，不要用“命令”的语气。\n\n| 语气词 | 例子                                                                       |\n| :----- | :------------------------------------------------------------------------- |\n| 不好   | 请各事业部将XX表于明天报上来，谢谢。（你认为很客气？，其实存在着严重官僚） |\n| 好     | 请各事业部将XX表于明天发给我，谢谢。                                       |\n| 不好   | 附件是XXX文件，请查收！（除了“你好！”“谢谢！”再不要用感叹号）          |\n| 好     | 附件是XXX文件，请查收，谢谢！                                              |\n\n### 字体、颜色、缩减\n\n- 商务邮件具有其严肃性。\n\n不要采用不同的字体，除非很必要不要使用不同的颜色，除非你想用不同的颜色强调某些东西。\n\n- 电子邮件软件可能互不兼容，例如Notes 和 Outlook\n\n例如“删除线”，在另一邮件系统中可能不显示。\n\n在邮件中不要使用“缩进式”和“制表符(Tab)”，因为用另一软件打开它们可能导致文本不对齐\n\n发给公司外部的邮件，避免使用上述不兼容的格式\n\n## 培训资料获取\n\n电子邮件礼仪（PPT）\n\n链接: https://pan.baidu.com/s/1V-LwM58oQ8KE8TJbV79C4Q?pwd=8888 提取码: 8888\n","slug":"电子邮件礼仪","published":1,"updated":"2025-03-28T06:09:28.555Z","comments":1,"layout":"post","photos":[],"_id":"cm8se3tdy001tbb8lbjsr636e","content":"<meta name=\"referrer\" content=\"no-referrer\" />\n\n<p>电子邮件是我们沟通方式的一部分，在早期网络不发达的时代，写信成了重要的沟通方式。那么如何写好一封得体的邮件，也成为了个人发展的重要技能之一。</p>\n<span id=\"more\"></span>\n\n<h2 id=\"为什么需要？\"><a href=\"#为什么需要？\" class=\"headerlink\" title=\"为什么需要？\"></a>为什么需要？</h2><ul>\n<li>彰显工作能力和专业性</li>\n</ul>\n<p>通过使用合适的邮件语言，你开业传达出一个专业的形象，显得”我很专业！“。</p>\n<p>特别对于哪些我们不认识的人，这是对方判断我们的唯一方法。就像我们面试投递简历一样，别人也会通过初步了解一个人。</p>\n<ul>\n<li>提高工作效率</li>\n</ul>\n<p>邮件组织得当、条理清晰，避免浪费他人时间。</p>\n<ul>\n<li>严肃性</li>\n</ul>\n<p>商务电子邮件不同于私人邮件、它具备严肃性和商务规范性。</p>\n<h2 id=\"电子邮件礼仪\"><a href=\"#电子邮件礼仪\" class=\"headerlink\" title=\"电子邮件礼仪\"></a>电子邮件礼仪</h2><h3 id=\"及时回复\"><a href=\"#及时回复\" class=\"headerlink\" title=\"及时回复\"></a>及时回复</h3><p>邮件应尽量及时回复，就像别人给你发的微信一样，你要给别人一个反馈，告诉别人你收到了消息。</p>\n<p>回复不一定是要给出解决方案，有时只是一个”好的“、”收到“、”了解“。</p>\n<p>及时回复代表了礼貌和对别人的尊重，如果不能及时回复，也请简单说明理由。特别是在别人协助你解决问题的时候。</p>\n<h3 id=\"收件人、抄送、密送\"><a href=\"#收件人、抄送、密送\" class=\"headerlink\" title=\"收件人、抄送、密送\"></a>收件人、抄送、密送</h3><ul>\n<li>收件人（To List）</li>\n</ul>\n<p>需要回复或者采取行动的人，不要把仅需要了解此邮件事项的人放入收件人。</p>\n<ul>\n<li>抄送（CC List）</li>\n</ul>\n<p>需要了解此邮件事项相关的人。通常包含发件人的主管和收件人的主管，因为双方主管都需要了解你做的事情。</p>\n<ul>\n<li>密送（BCC List）</li>\n</ul>\n<p>发件人想把此邮件发送给他，但又不想被收件人或者抄送者知道。</p>\n<h3 id=\"邮件主题\"><a href=\"#邮件主题\" class=\"headerlink\" title=\"邮件主题\"></a>邮件主题</h3><ol>\n<li><p>主题一定要写，不能为空。</p>\n</li>\n<li><p>主题必须具体、不含糊、且有意义，比如：”关于20231123研发部二组周工作例会会议记录“。</p>\n</li>\n<li><p>当回复邮件时，要修改主题以反映新的内容。</p>\n<p>邮件回复或转发多次后，主题前面会自动添加”回复“、”Re“、”Fw“等，要适当删除，保留最多两个。反例：</p>\n<blockquote>\n<p>Re: Re: Re: Re: Re: 清明节放假事宜</p>\n</blockquote>\n</li>\n<li><p>主题内容包含附件时，要删除主题中的“发送附件：”，不要存在”发送附件：XXXX“的内容。</p>\n</li>\n</ol>\n<h3 id=\"称呼\"><a href=\"#称呼\" class=\"headerlink\" title=\"称呼\"></a>称呼</h3><ol>\n<li>邮件要有称呼。称呼要和收件人清单一致，不含抄送人。</li>\n</ol>\n<p>不少人写邮件一上来就直接说事情，给人的感觉是“你应该知道我是谁”；有的至多用个“你好”，这些都是不礼貌的做法。</p>\n<p>正确的做法是：如果对方有职位要称呼职位（姓氏+职位）；如果不清楚职位，可用姓氏+先生&#x2F;小姐。当然十分熟悉的情况下，可以用双方习惯的称呼方式，而这种情况仅限于非正式邮件。值得注意的是，通常用“您好”比用“你好”更有礼貌，除非确定自己是上级或长者。</p>\n<p>比较忌讳的是管所有人都叫经理，普通员工自然很高兴，但会冒犯比经理职位高的人。    通常称呼他人可省去“副”字，但尽量不要跳级，更不可给别人降级。例如对方是副经理，可以称呼“姓氏+经理”，但不要称呼“姓氏+总”；而如果对方是副总裁，则不可称呼对方为经理或总经理。</p>\n<ol start=\"2\">\n<li>当收件人为多人时，称呼可以使用：”各位：“、”各位领导：“、”各位同事“、”Dear all.“</li>\n</ol>\n<h3 id=\"邮件正文\"><a href=\"#邮件正文\" class=\"headerlink\" title=\"邮件正文\"></a>邮件正文</h3><p>正文要从”称呼“下另起一行，不要从”称呼“在同一行开始。</p>\n<p>按照逻辑顺序安排邮件内容。</p>\n<ul>\n<li><strong>首先：</strong>开门见山，点明问题；</li>\n<li><strong>其次：</strong>细节描述、背景说明；</li>\n<li><strong>接着：</strong>提供支持性材料或附件；</li>\n<li><strong>留意：</strong>原邮件（先前的邮件）加在回复内容之后；</li>\n</ul>\n<blockquote>\n<p>“6W1H”是一个用于提出问题、进行调查或分析的工具，尤其在新闻报道、项目管理和问题解决等领域中常被使用。它代表着六个问句和一个问词，具体如下：</p>\n<ol>\n<li><strong>What（什么）：</strong> 问题的核心是什么？这关注事件或主题的本质。</li>\n<li><strong>Why（为什么）：</strong> 为什么事件发生？这关注原因和动机。</li>\n<li><strong>Who（谁）：</strong> 谁参与了事件？这关注相关的人物。</li>\n<li><strong>When（何时）：</strong> 事件发生的时间是什么时候？这关注时间的范围。</li>\n<li><strong>Where（何地）：</strong> 事件发生的地点在哪里？这关注地理位置。</li>\n<li><strong>How（如何）：</strong> 事件是如何发生的？这关注事件的过程和方式。</li>\n<li><strong>How Much（多少）：</strong> 这是附加的一个问题，关注数量或程度。</li>\n</ol>\n</blockquote>\n<aside>\n⚠️ 通过6W1H清楚表达你的观点。\n</aside>\n\n<h3 id=\"回复或转发\"><a href=\"#回复或转发\" class=\"headerlink\" title=\"回复或转发\"></a>回复或转发</h3><ul>\n<li>收件人和抄送</li>\n</ul>\n<p>回复或转发时，检查 “收件人”、“抄送”内的名单，加上那些必须包括的，删除那些不需要抄送的。</p>\n<ul>\n<li>礼节性回复</li>\n</ul>\n<p>如果你是主要的信息接收者(即表明你的名字在“收件人”中)，收到邮件时总是答复“谢谢”、“我明白”以确认你收到邮件。</p>\n<p>对于礼节性回复，你可仅仅回复给发送者 (不要回复给所有人)</p>\n<ul>\n<li>删除不必要的先前邮件或附件</li>\n<li>部门助理或联络窗口转发邮件</li>\n</ul>\n<p>及时转发给相关人员。如不清楚，请示主管</p>\n<p>一定抄送给原发件人和自己的主管，以便跟进</p>\n<ul>\n<li>回复错发的邮件</li>\n</ul>\n<p>由于邮箱地址类似等原因，发件人可能会错发邮件。如果收到别人错发的邮件，请回复发件人“我是XXX，你是否错发邮件？”当然，附上原邮件。</p>\n<h3 id=\"如何更新邮件\"><a href=\"#如何更新邮件\" class=\"headerlink\" title=\"如何更新邮件\"></a>如何更新邮件</h3><p>邮件发出后，发现内容有错，或情况有变化，则需更新邮件。</p>\n<ol>\n<li>用原邮件转发，原主题后加update 或—更新, 表明这是更新的邮件</li>\n<li>转发的内容中说明原邮件中哪里有错，更新为新的内容</li>\n</ol>\n<h3 id=\"邮件沟通原则\"><a href=\"#邮件沟通原则\" class=\"headerlink\" title=\"邮件沟通原则\"></a>邮件沟通原则</h3><ul>\n<li>跟进</li>\n</ul>\n<p>对于紧急或重要的事情，应该打电话给相关人员，以确定其收到邮件并明白要做的事情。</p>\n<ul>\n<li>避免做邮递员</li>\n</ul>\n<p>“我发邮件了，他没看”（把责任推给别人）</p>\n<p>“我收到他的邮件回执，说明他收到邮件了”。</p>\n<p>要确定收人人收到邮件并了解要做什么事情，什么时候要完成，不要只做邮递员。</p>\n<h3 id=\"缩略语\"><a href=\"#缩略语\" class=\"headerlink\" title=\"缩略语\"></a>缩略语</h3><p>当邮件是发给客户时，请使用规范的缩略语</p>\n<p>可以使用: ASAP, FYI, FYR 等.</p>\n<p>不要使用：</p>\n<table>\n<thead>\n<tr>\n<th>缩写</th>\n<th align=\"left\">解释</th>\n</tr>\n</thead>\n<tbody><tr>\n<td>ref</td>\n<td align=\"left\">refer</td>\n</tr>\n<tr>\n<td>Attn</td>\n<td align=\"left\">attention</td>\n</tr>\n<tr>\n<td>pls</td>\n<td align=\"left\">please</td>\n</tr>\n<tr>\n<td>q’ty</td>\n<td align=\"left\">quantity or qty</td>\n</tr>\n<tr>\n<td>per</td>\n<td align=\"left\">as per</td>\n</tr>\n<tr>\n<td>B’R, BstRdgs</td>\n<td align=\"left\">Best Regards</td>\n</tr>\n<tr>\n<td>Thks</td>\n<td align=\"left\">thanks or thank you</td>\n</tr>\n</tbody></table>\n<h3 id=\"Confidentiality-Note\"><a href=\"#Confidentiality-Note\" class=\"headerlink\" title=\"Confidentiality Note\"></a>Confidentiality Note</h3><p>对于部分法务性邮件或商务性邮件，可能涉及保密资料或所有权资料，这类邮件通常在最后加这样一段文字：</p>\n<blockquote>\n<p>Confidentiality note:The information in this email and any attachment may contain confidential and proprietary information of ABC Company  and&#x2F;or its affiliates  may be privileged or otherwise protected from disclosure. If you are not the intended recipient, you are hereby notified that any review, reliance or distribution by others or forwarding without express permission is strictly prohibited and may cause liability. In case you have received this message due to an error in transmission, we kindly ask you to notify the sender immediately and to delete this email and any attachment from your system.</p>\n</blockquote>\n<h2 id=\"注意事项\"><a href=\"#注意事项\" class=\"headerlink\" title=\"注意事项\"></a>注意事项</h2><h3 id=\"收件人、抄送、密送-1\"><a href=\"#收件人、抄送、密送-1\" class=\"headerlink\" title=\"收件人、抄送、密送\"></a>收件人、抄送、密送</h3><ul>\n<li>出部门的邮件，必须抄送给部门主管（总监、经理、副经理）。</li>\n<li>出公司的邮件，必须抄送给分管副总或总经理。</li>\n<li>公司内部沟通邮件不可抄送给公司外部人员，因为有些涉及商业机密，防止泄密问题。</li>\n<li>邮件只发给该发的人，不要发给不必要接收此邮件的人，以节省大家的时间。</li>\n<li>不建议使用密送，密送有可能看不到收件人和抄送的人，密送的回复有可能会被收件人和抄送的人看到。</li>\n<li>回复邮件时需要注意，不要随便就回复给所有人，通常不使用”回复全部“，要根据邮件内容修改收件人和抄送名单。</li>\n</ul>\n<h3 id=\"邮件主题-1\"><a href=\"#邮件主题-1\" class=\"headerlink\" title=\"邮件主题\"></a>邮件主题</h3><ul>\n<li>不要使用“万金油”邮件主题</li>\n</ul>\n<p>反例：<img src=\"http://qiniu-image.gotojava.cn/blog/2023-12-15-190843.png\" alt=\"image-20231123182550920\"></p>\n<ul>\n<li>主题与内容相符</li>\n</ul>\n<p>回复邮件时需要注意，主题要与邮件内容相符，特别注意在回复邮件时或转发邮件时，要根据邮件内容修改主题。</p>\n<p><img src=\"http://qiniu-image.gotojava.cn/blog/2023-12-15-190845.png\" alt=\"image-20231123182758899\"></p>\n<ul>\n<li>主题不是正文</li>\n</ul>\n<p>不要把邮件正文内容写在主题中, 除非只有简单的一句话。以下是不恰当的邮件主题：</p>\n<p><img src=\"http://qiniu-image.gotojava.cn/blog/2023-12-15-190847.png\" alt=\"image-20231123183151947\"></p>\n<p><img src=\"http://qiniu-image.gotojava.cn/blog/2023-12-15-190849.png\" alt=\"image-20231123183211769\"></p>\n<h3 id=\"特别注意不要使用感叹号\"><a href=\"#特别注意不要使用感叹号\" class=\"headerlink\" title=\"特别注意不要使用感叹号\"></a>特别注意不要使用感叹号</h3><blockquote>\n<p>感叹号：主要用在感叹句的句末，表示强烈的感情。感叹句是以抒发感情为主的句子，它所抒发的感情有赞颂、喜悦、愤怒、叹息、惊讶、伤悼等，句末都要用感叹号。《百度百科》</p>\n</blockquote>\n<p>除了“您好！”、“谢谢！”之外，都不要使用感叹号。</p>\n<p>在书面沟通和电子邮件沟通中，使用感叹号就表示拍桌子、大声吼叫、挥舞拳头、用中指指人。</p>\n<p>有的人甚至用一个感叹号还觉得不够，还用三个！！！，这是非常强烈的咆哮。</p>\n<h3 id=\"忌回复所有人\"><a href=\"#忌回复所有人\" class=\"headerlink\" title=\"忌回复所有人\"></a>忌回复所有人</h3><p>通常只需要答复发件人，很少有需要全部回复的情况，尽管对方可能同时发给了很多人。为了减少给别人带来的不必要麻烦，用“回复”功能即可；如果很有必要抄送给其他人，则尽量自己根据实际需要有选择性地写上去。</p>\n<p>尤其需要注意的是，好的事情可以抄送给他人，不好的事情尽量一对一处理；这与表扬当众，批评不当众是一个道理。当然，那种利用便利的往来邮件打嘴仗的行为只能影响个人形象。</p>\n<p>发件人为了避免出现对方随意点击“回复所有人”的不职业情况，可以把大批量的收件人地址放在“密送”处，然后在正文起始位置写上收信人的群体名称，例如“致：各事业部经理”等，有利于收信人清晰了解与自己同时收到邮件的还有哪些人，同时避免了垃圾邮件的产生。</p>\n<h3 id=\"忌不分段\"><a href=\"#忌不分段\" class=\"headerlink\" title=\"忌不分段\"></a>忌不分段</h3><p>有的人整篇邮件从头至尾写成一大片，象小说一样，给人眉目不清晰的感觉，不想看下去，从而自然影响处理的效率。</p>\n<p>推荐的方式是，尽量在一个显示页面完成全文，一段一个核心意思，然后空行写第二段；如果说的事项较多，建议加上序号，但一次最好不超过三项，否则不容易记住。</p>\n<p>当然，如果能根据收件人的具体情况调整字号大小、字体样式等，则为最佳。例如对方均是五十多岁的领导，可以适当调大字号，以便对方阅读，从而也提高了回复效率。</p>\n<h3 id=\"忌重点不突出\"><a href=\"#忌重点不突出\" class=\"headerlink\" title=\"忌重点不突出\"></a>忌重点不突出</h3><p>现在的职场压力和信息的充斥已很难容许人们逐字逐句地阅读一个完整的邮件。所以写信人可以把最核心的词用突出标识加以强调，包括加粗、增大字号或换字体、颜色等。但公文中通常只允许黑色和蓝色，只有相当于海报作用时才可以适当用彩色。</p>\n<p>邮件的标题至关重要，要行动性很强，只用核心词，去掉虚词。与行动、结果相关的字眼可放在句首的【】内，然后再写具体内容，例如标题可写为“【请9日前确认】xx会议日程”。</p>\n<h3 id=\"忌不感谢\"><a href=\"#忌不感谢\" class=\"headerlink\" title=\"忌不感谢\"></a>忌不感谢</h3><p>有些人没有感谢的习惯，而这往往是邮件回复率低的一个主要原因。不论是寻求合作、请教问题、请人帮助，还是只是告知，都可以感谢对方的善意或配合。即便是领导命令对方与自己合作，说句感谢只能表明自己有修养；更何况自己请对方帮忙呢。</p>\n<h3 id=\"忌不署名\"><a href=\"#忌不署名\" class=\"headerlink\" title=\"忌不署名\"></a>忌不署名</h3><p>不署名，言外之意，对方应该能从邮件地址判断出自己是谁，或者“不用那么客气”，而这样做会给对方造成很多不便，也较影响办事效率，想打电话沟通具体事宜时，还需要再查找。</p>\n<h3 id=\"避免错别字\"><a href=\"#避免错别字\" class=\"headerlink\" title=\"避免错别字\"></a>避免错别字</h3><p>邮件中出现错别字会被认为是做事不认真，客户由此判断一个团队做事不认真。因此，一个有错别字的邮件可能导致几百万上千万订单的损失。</p>\n<p>如果使用outlook等写英文邮件，则每次使用“拼写检查”。如果写中文邮件，则自己要会检查。或者贴到word中进行中文语法检查。</p>\n<p>特别注意不要把人名写错。写错人名给人的感觉是极不尊重对方。(自己的名字按身份证上写，不要说“身份证是错的”，更不要按自己的喜欢来写)常见写错的名字有：丽莉利，平苹萍，洪红宏，华桦，清青菁，林淋琳，玲铃，民明名，生升，娇姣，英瑛。</p>\n<h3 id=\"语气\"><a href=\"#语气\" class=\"headerlink\" title=\"语气\"></a>语气</h3><p>使用“请求”的语气以示尊重，不要用“命令”的语气。</p>\n<table>\n<thead>\n<tr>\n<th align=\"left\">语气词</th>\n<th align=\"left\">例子</th>\n</tr>\n</thead>\n<tbody><tr>\n<td align=\"left\">不好</td>\n<td align=\"left\">请各事业部将XX表于明天报上来，谢谢。（你认为很客气？，其实存在着严重官僚）</td>\n</tr>\n<tr>\n<td align=\"left\">好</td>\n<td align=\"left\">请各事业部将XX表于明天发给我，谢谢。</td>\n</tr>\n<tr>\n<td align=\"left\">不好</td>\n<td align=\"left\">附件是XXX文件，请查收！（除了“你好！”“谢谢！”再不要用感叹号）</td>\n</tr>\n<tr>\n<td align=\"left\">好</td>\n<td align=\"left\">附件是XXX文件，请查收，谢谢！</td>\n</tr>\n</tbody></table>\n<h3 id=\"字体、颜色、缩减\"><a href=\"#字体、颜色、缩减\" class=\"headerlink\" title=\"字体、颜色、缩减\"></a>字体、颜色、缩减</h3><ul>\n<li>商务邮件具有其严肃性。</li>\n</ul>\n<p>不要采用不同的字体，除非很必要不要使用不同的颜色，除非你想用不同的颜色强调某些东西。</p>\n<ul>\n<li>电子邮件软件可能互不兼容，例如Notes 和 Outlook</li>\n</ul>\n<p>例如“删除线”，在另一邮件系统中可能不显示。</p>\n<p>在邮件中不要使用“缩进式”和“制表符(Tab)”，因为用另一软件打开它们可能导致文本不对齐</p>\n<p>发给公司外部的邮件，避免使用上述不兼容的格式</p>\n<h2 id=\"培训资料获取\"><a href=\"#培训资料获取\" class=\"headerlink\" title=\"培训资料获取\"></a>培训资料获取</h2><p>电子邮件礼仪（PPT）</p>\n<p>链接: <a href=\"https://pan.baidu.com/s/1V-LwM58oQ8KE8TJbV79C4Q?pwd=8888\">https://pan.baidu.com/s/1V-LwM58oQ8KE8TJbV79C4Q?pwd=8888</a> 提取码: 8888</p>\n","excerpt":"<meta name=\"referrer\" content=\"no-referrer\" />\n\n<p>电子邮件是我们沟通方式的一部分，在早期网络不发达的时代，写信成了重要的沟通方式。那么如何写好一封得体的邮件，也成为了个人发展的重要技能之一。</p>","more":"<h2 id=\"为什么需要？\"><a href=\"#为什么需要？\" class=\"headerlink\" title=\"为什么需要？\"></a>为什么需要？</h2><ul>\n<li>彰显工作能力和专业性</li>\n</ul>\n<p>通过使用合适的邮件语言，你开业传达出一个专业的形象，显得”我很专业！“。</p>\n<p>特别对于哪些我们不认识的人，这是对方判断我们的唯一方法。就像我们面试投递简历一样，别人也会通过初步了解一个人。</p>\n<ul>\n<li>提高工作效率</li>\n</ul>\n<p>邮件组织得当、条理清晰，避免浪费他人时间。</p>\n<ul>\n<li>严肃性</li>\n</ul>\n<p>商务电子邮件不同于私人邮件、它具备严肃性和商务规范性。</p>\n<h2 id=\"电子邮件礼仪\"><a href=\"#电子邮件礼仪\" class=\"headerlink\" title=\"电子邮件礼仪\"></a>电子邮件礼仪</h2><h3 id=\"及时回复\"><a href=\"#及时回复\" class=\"headerlink\" title=\"及时回复\"></a>及时回复</h3><p>邮件应尽量及时回复，就像别人给你发的微信一样，你要给别人一个反馈，告诉别人你收到了消息。</p>\n<p>回复不一定是要给出解决方案，有时只是一个”好的“、”收到“、”了解“。</p>\n<p>及时回复代表了礼貌和对别人的尊重，如果不能及时回复，也请简单说明理由。特别是在别人协助你解决问题的时候。</p>\n<h3 id=\"收件人、抄送、密送\"><a href=\"#收件人、抄送、密送\" class=\"headerlink\" title=\"收件人、抄送、密送\"></a>收件人、抄送、密送</h3><ul>\n<li>收件人（To List）</li>\n</ul>\n<p>需要回复或者采取行动的人，不要把仅需要了解此邮件事项的人放入收件人。</p>\n<ul>\n<li>抄送（CC List）</li>\n</ul>\n<p>需要了解此邮件事项相关的人。通常包含发件人的主管和收件人的主管，因为双方主管都需要了解你做的事情。</p>\n<ul>\n<li>密送（BCC List）</li>\n</ul>\n<p>发件人想把此邮件发送给他，但又不想被收件人或者抄送者知道。</p>\n<h3 id=\"邮件主题\"><a href=\"#邮件主题\" class=\"headerlink\" title=\"邮件主题\"></a>邮件主题</h3><ol>\n<li><p>主题一定要写，不能为空。</p>\n</li>\n<li><p>主题必须具体、不含糊、且有意义，比如：”关于20231123研发部二组周工作例会会议记录“。</p>\n</li>\n<li><p>当回复邮件时，要修改主题以反映新的内容。</p>\n<p>邮件回复或转发多次后，主题前面会自动添加”回复“、”Re“、”Fw“等，要适当删除，保留最多两个。反例：</p>\n<blockquote>\n<p>Re: Re: Re: Re: Re: 清明节放假事宜</p>\n</blockquote>\n</li>\n<li><p>主题内容包含附件时，要删除主题中的“发送附件：”，不要存在”发送附件：XXXX“的内容。</p>\n</li>\n</ol>\n<h3 id=\"称呼\"><a href=\"#称呼\" class=\"headerlink\" title=\"称呼\"></a>称呼</h3><ol>\n<li>邮件要有称呼。称呼要和收件人清单一致，不含抄送人。</li>\n</ol>\n<p>不少人写邮件一上来就直接说事情，给人的感觉是“你应该知道我是谁”；有的至多用个“你好”，这些都是不礼貌的做法。</p>\n<p>正确的做法是：如果对方有职位要称呼职位（姓氏+职位）；如果不清楚职位，可用姓氏+先生&#x2F;小姐。当然十分熟悉的情况下，可以用双方习惯的称呼方式，而这种情况仅限于非正式邮件。值得注意的是，通常用“您好”比用“你好”更有礼貌，除非确定自己是上级或长者。</p>\n<p>比较忌讳的是管所有人都叫经理，普通员工自然很高兴，但会冒犯比经理职位高的人。    通常称呼他人可省去“副”字，但尽量不要跳级，更不可给别人降级。例如对方是副经理，可以称呼“姓氏+经理”，但不要称呼“姓氏+总”；而如果对方是副总裁，则不可称呼对方为经理或总经理。</p>\n<ol start=\"2\">\n<li>当收件人为多人时，称呼可以使用：”各位：“、”各位领导：“、”各位同事“、”Dear all.“</li>\n</ol>\n<h3 id=\"邮件正文\"><a href=\"#邮件正文\" class=\"headerlink\" title=\"邮件正文\"></a>邮件正文</h3><p>正文要从”称呼“下另起一行，不要从”称呼“在同一行开始。</p>\n<p>按照逻辑顺序安排邮件内容。</p>\n<ul>\n<li><strong>首先：</strong>开门见山，点明问题；</li>\n<li><strong>其次：</strong>细节描述、背景说明；</li>\n<li><strong>接着：</strong>提供支持性材料或附件；</li>\n<li><strong>留意：</strong>原邮件（先前的邮件）加在回复内容之后；</li>\n</ul>\n<blockquote>\n<p>“6W1H”是一个用于提出问题、进行调查或分析的工具，尤其在新闻报道、项目管理和问题解决等领域中常被使用。它代表着六个问句和一个问词，具体如下：</p>\n<ol>\n<li><strong>What（什么）：</strong> 问题的核心是什么？这关注事件或主题的本质。</li>\n<li><strong>Why（为什么）：</strong> 为什么事件发生？这关注原因和动机。</li>\n<li><strong>Who（谁）：</strong> 谁参与了事件？这关注相关的人物。</li>\n<li><strong>When（何时）：</strong> 事件发生的时间是什么时候？这关注时间的范围。</li>\n<li><strong>Where（何地）：</strong> 事件发生的地点在哪里？这关注地理位置。</li>\n<li><strong>How（如何）：</strong> 事件是如何发生的？这关注事件的过程和方式。</li>\n<li><strong>How Much（多少）：</strong> 这是附加的一个问题，关注数量或程度。</li>\n</ol>\n</blockquote>\n<aside>\n⚠️ 通过6W1H清楚表达你的观点。\n</aside>\n\n<h3 id=\"回复或转发\"><a href=\"#回复或转发\" class=\"headerlink\" title=\"回复或转发\"></a>回复或转发</h3><ul>\n<li>收件人和抄送</li>\n</ul>\n<p>回复或转发时，检查 “收件人”、“抄送”内的名单，加上那些必须包括的，删除那些不需要抄送的。</p>\n<ul>\n<li>礼节性回复</li>\n</ul>\n<p>如果你是主要的信息接收者(即表明你的名字在“收件人”中)，收到邮件时总是答复“谢谢”、“我明白”以确认你收到邮件。</p>\n<p>对于礼节性回复，你可仅仅回复给发送者 (不要回复给所有人)</p>\n<ul>\n<li>删除不必要的先前邮件或附件</li>\n<li>部门助理或联络窗口转发邮件</li>\n</ul>\n<p>及时转发给相关人员。如不清楚，请示主管</p>\n<p>一定抄送给原发件人和自己的主管，以便跟进</p>\n<ul>\n<li>回复错发的邮件</li>\n</ul>\n<p>由于邮箱地址类似等原因，发件人可能会错发邮件。如果收到别人错发的邮件，请回复发件人“我是XXX，你是否错发邮件？”当然，附上原邮件。</p>\n<h3 id=\"如何更新邮件\"><a href=\"#如何更新邮件\" class=\"headerlink\" title=\"如何更新邮件\"></a>如何更新邮件</h3><p>邮件发出后，发现内容有错，或情况有变化，则需更新邮件。</p>\n<ol>\n<li>用原邮件转发，原主题后加update 或—更新, 表明这是更新的邮件</li>\n<li>转发的内容中说明原邮件中哪里有错，更新为新的内容</li>\n</ol>\n<h3 id=\"邮件沟通原则\"><a href=\"#邮件沟通原则\" class=\"headerlink\" title=\"邮件沟通原则\"></a>邮件沟通原则</h3><ul>\n<li>跟进</li>\n</ul>\n<p>对于紧急或重要的事情，应该打电话给相关人员，以确定其收到邮件并明白要做的事情。</p>\n<ul>\n<li>避免做邮递员</li>\n</ul>\n<p>“我发邮件了，他没看”（把责任推给别人）</p>\n<p>“我收到他的邮件回执，说明他收到邮件了”。</p>\n<p>要确定收人人收到邮件并了解要做什么事情，什么时候要完成，不要只做邮递员。</p>\n<h3 id=\"缩略语\"><a href=\"#缩略语\" class=\"headerlink\" title=\"缩略语\"></a>缩略语</h3><p>当邮件是发给客户时，请使用规范的缩略语</p>\n<p>可以使用: ASAP, FYI, FYR 等.</p>\n<p>不要使用：</p>\n<table>\n<thead>\n<tr>\n<th>缩写</th>\n<th align=\"left\">解释</th>\n</tr>\n</thead>\n<tbody><tr>\n<td>ref</td>\n<td align=\"left\">refer</td>\n</tr>\n<tr>\n<td>Attn</td>\n<td align=\"left\">attention</td>\n</tr>\n<tr>\n<td>pls</td>\n<td align=\"left\">please</td>\n</tr>\n<tr>\n<td>q’ty</td>\n<td align=\"left\">quantity or qty</td>\n</tr>\n<tr>\n<td>per</td>\n<td align=\"left\">as per</td>\n</tr>\n<tr>\n<td>B’R, BstRdgs</td>\n<td align=\"left\">Best Regards</td>\n</tr>\n<tr>\n<td>Thks</td>\n<td align=\"left\">thanks or thank you</td>\n</tr>\n</tbody></table>\n<h3 id=\"Confidentiality-Note\"><a href=\"#Confidentiality-Note\" class=\"headerlink\" title=\"Confidentiality Note\"></a>Confidentiality Note</h3><p>对于部分法务性邮件或商务性邮件，可能涉及保密资料或所有权资料，这类邮件通常在最后加这样一段文字：</p>\n<blockquote>\n<p>Confidentiality note:The information in this email and any attachment may contain confidential and proprietary information of ABC Company  and&#x2F;or its affiliates  may be privileged or otherwise protected from disclosure. If you are not the intended recipient, you are hereby notified that any review, reliance or distribution by others or forwarding without express permission is strictly prohibited and may cause liability. In case you have received this message due to an error in transmission, we kindly ask you to notify the sender immediately and to delete this email and any attachment from your system.</p>\n</blockquote>\n<h2 id=\"注意事项\"><a href=\"#注意事项\" class=\"headerlink\" title=\"注意事项\"></a>注意事项</h2><h3 id=\"收件人、抄送、密送-1\"><a href=\"#收件人、抄送、密送-1\" class=\"headerlink\" title=\"收件人、抄送、密送\"></a>收件人、抄送、密送</h3><ul>\n<li>出部门的邮件，必须抄送给部门主管（总监、经理、副经理）。</li>\n<li>出公司的邮件，必须抄送给分管副总或总经理。</li>\n<li>公司内部沟通邮件不可抄送给公司外部人员，因为有些涉及商业机密，防止泄密问题。</li>\n<li>邮件只发给该发的人，不要发给不必要接收此邮件的人，以节省大家的时间。</li>\n<li>不建议使用密送，密送有可能看不到收件人和抄送的人，密送的回复有可能会被收件人和抄送的人看到。</li>\n<li>回复邮件时需要注意，不要随便就回复给所有人，通常不使用”回复全部“，要根据邮件内容修改收件人和抄送名单。</li>\n</ul>\n<h3 id=\"邮件主题-1\"><a href=\"#邮件主题-1\" class=\"headerlink\" title=\"邮件主题\"></a>邮件主题</h3><ul>\n<li>不要使用“万金油”邮件主题</li>\n</ul>\n<p>反例：<img src=\"http://qiniu-image.gotojava.cn/blog/2023-12-15-190843.png\" alt=\"image-20231123182550920\"></p>\n<ul>\n<li>主题与内容相符</li>\n</ul>\n<p>回复邮件时需要注意，主题要与邮件内容相符，特别注意在回复邮件时或转发邮件时，要根据邮件内容修改主题。</p>\n<p><img src=\"http://qiniu-image.gotojava.cn/blog/2023-12-15-190845.png\" alt=\"image-20231123182758899\"></p>\n<ul>\n<li>主题不是正文</li>\n</ul>\n<p>不要把邮件正文内容写在主题中, 除非只有简单的一句话。以下是不恰当的邮件主题：</p>\n<p><img src=\"http://qiniu-image.gotojava.cn/blog/2023-12-15-190847.png\" alt=\"image-20231123183151947\"></p>\n<p><img src=\"http://qiniu-image.gotojava.cn/blog/2023-12-15-190849.png\" alt=\"image-20231123183211769\"></p>\n<h3 id=\"特别注意不要使用感叹号\"><a href=\"#特别注意不要使用感叹号\" class=\"headerlink\" title=\"特别注意不要使用感叹号\"></a>特别注意不要使用感叹号</h3><blockquote>\n<p>感叹号：主要用在感叹句的句末，表示强烈的感情。感叹句是以抒发感情为主的句子，它所抒发的感情有赞颂、喜悦、愤怒、叹息、惊讶、伤悼等，句末都要用感叹号。《百度百科》</p>\n</blockquote>\n<p>除了“您好！”、“谢谢！”之外，都不要使用感叹号。</p>\n<p>在书面沟通和电子邮件沟通中，使用感叹号就表示拍桌子、大声吼叫、挥舞拳头、用中指指人。</p>\n<p>有的人甚至用一个感叹号还觉得不够，还用三个！！！，这是非常强烈的咆哮。</p>\n<h3 id=\"忌回复所有人\"><a href=\"#忌回复所有人\" class=\"headerlink\" title=\"忌回复所有人\"></a>忌回复所有人</h3><p>通常只需要答复发件人，很少有需要全部回复的情况，尽管对方可能同时发给了很多人。为了减少给别人带来的不必要麻烦，用“回复”功能即可；如果很有必要抄送给其他人，则尽量自己根据实际需要有选择性地写上去。</p>\n<p>尤其需要注意的是，好的事情可以抄送给他人，不好的事情尽量一对一处理；这与表扬当众，批评不当众是一个道理。当然，那种利用便利的往来邮件打嘴仗的行为只能影响个人形象。</p>\n<p>发件人为了避免出现对方随意点击“回复所有人”的不职业情况，可以把大批量的收件人地址放在“密送”处，然后在正文起始位置写上收信人的群体名称，例如“致：各事业部经理”等，有利于收信人清晰了解与自己同时收到邮件的还有哪些人，同时避免了垃圾邮件的产生。</p>\n<h3 id=\"忌不分段\"><a href=\"#忌不分段\" class=\"headerlink\" title=\"忌不分段\"></a>忌不分段</h3><p>有的人整篇邮件从头至尾写成一大片，象小说一样，给人眉目不清晰的感觉，不想看下去，从而自然影响处理的效率。</p>\n<p>推荐的方式是，尽量在一个显示页面完成全文，一段一个核心意思，然后空行写第二段；如果说的事项较多，建议加上序号，但一次最好不超过三项，否则不容易记住。</p>\n<p>当然，如果能根据收件人的具体情况调整字号大小、字体样式等，则为最佳。例如对方均是五十多岁的领导，可以适当调大字号，以便对方阅读，从而也提高了回复效率。</p>\n<h3 id=\"忌重点不突出\"><a href=\"#忌重点不突出\" class=\"headerlink\" title=\"忌重点不突出\"></a>忌重点不突出</h3><p>现在的职场压力和信息的充斥已很难容许人们逐字逐句地阅读一个完整的邮件。所以写信人可以把最核心的词用突出标识加以强调，包括加粗、增大字号或换字体、颜色等。但公文中通常只允许黑色和蓝色，只有相当于海报作用时才可以适当用彩色。</p>\n<p>邮件的标题至关重要，要行动性很强，只用核心词，去掉虚词。与行动、结果相关的字眼可放在句首的【】内，然后再写具体内容，例如标题可写为“【请9日前确认】xx会议日程”。</p>\n<h3 id=\"忌不感谢\"><a href=\"#忌不感谢\" class=\"headerlink\" title=\"忌不感谢\"></a>忌不感谢</h3><p>有些人没有感谢的习惯，而这往往是邮件回复率低的一个主要原因。不论是寻求合作、请教问题、请人帮助，还是只是告知，都可以感谢对方的善意或配合。即便是领导命令对方与自己合作，说句感谢只能表明自己有修养；更何况自己请对方帮忙呢。</p>\n<h3 id=\"忌不署名\"><a href=\"#忌不署名\" class=\"headerlink\" title=\"忌不署名\"></a>忌不署名</h3><p>不署名，言外之意，对方应该能从邮件地址判断出自己是谁，或者“不用那么客气”，而这样做会给对方造成很多不便，也较影响办事效率，想打电话沟通具体事宜时，还需要再查找。</p>\n<h3 id=\"避免错别字\"><a href=\"#避免错别字\" class=\"headerlink\" title=\"避免错别字\"></a>避免错别字</h3><p>邮件中出现错别字会被认为是做事不认真，客户由此判断一个团队做事不认真。因此，一个有错别字的邮件可能导致几百万上千万订单的损失。</p>\n<p>如果使用outlook等写英文邮件，则每次使用“拼写检查”。如果写中文邮件，则自己要会检查。或者贴到word中进行中文语法检查。</p>\n<p>特别注意不要把人名写错。写错人名给人的感觉是极不尊重对方。(自己的名字按身份证上写，不要说“身份证是错的”，更不要按自己的喜欢来写)常见写错的名字有：丽莉利，平苹萍，洪红宏，华桦，清青菁，林淋琳，玲铃，民明名，生升，娇姣，英瑛。</p>\n<h3 id=\"语气\"><a href=\"#语气\" class=\"headerlink\" title=\"语气\"></a>语气</h3><p>使用“请求”的语气以示尊重，不要用“命令”的语气。</p>\n<table>\n<thead>\n<tr>\n<th align=\"left\">语气词</th>\n<th align=\"left\">例子</th>\n</tr>\n</thead>\n<tbody><tr>\n<td align=\"left\">不好</td>\n<td align=\"left\">请各事业部将XX表于明天报上来，谢谢。（你认为很客气？，其实存在着严重官僚）</td>\n</tr>\n<tr>\n<td align=\"left\">好</td>\n<td align=\"left\">请各事业部将XX表于明天发给我，谢谢。</td>\n</tr>\n<tr>\n<td align=\"left\">不好</td>\n<td align=\"left\">附件是XXX文件，请查收！（除了“你好！”“谢谢！”再不要用感叹号）</td>\n</tr>\n<tr>\n<td align=\"left\">好</td>\n<td align=\"left\">附件是XXX文件，请查收，谢谢！</td>\n</tr>\n</tbody></table>\n<h3 id=\"字体、颜色、缩减\"><a href=\"#字体、颜色、缩减\" class=\"headerlink\" title=\"字体、颜色、缩减\"></a>字体、颜色、缩减</h3><ul>\n<li>商务邮件具有其严肃性。</li>\n</ul>\n<p>不要采用不同的字体，除非很必要不要使用不同的颜色，除非你想用不同的颜色强调某些东西。</p>\n<ul>\n<li>电子邮件软件可能互不兼容，例如Notes 和 Outlook</li>\n</ul>\n<p>例如“删除线”，在另一邮件系统中可能不显示。</p>\n<p>在邮件中不要使用“缩进式”和“制表符(Tab)”，因为用另一软件打开它们可能导致文本不对齐</p>\n<p>发给公司外部的邮件，避免使用上述不兼容的格式</p>\n<h2 id=\"培训资料获取\"><a href=\"#培训资料获取\" class=\"headerlink\" title=\"培训资料获取\"></a>培训资料获取</h2><p>电子邮件礼仪（PPT）</p>\n<p>链接: <a href=\"https://pan.baidu.com/s/1V-LwM58oQ8KE8TJbV79C4Q?pwd=8888\">https://pan.baidu.com/s/1V-LwM58oQ8KE8TJbV79C4Q?pwd=8888</a> 提取码: 8888</p>"},{"title":"苹果手机问题排查指导","toc":true,"abbrlink":"971c83b6","date":"2025-03-28T05:46:15.000Z","_content":"\n<meta name=\"referrer\" content=\"no-referrer\" />\n\n<!--more-->\n\n## iphone设置DNS\n\n针对部分终端上网异常的问题，如苹果手机，可以在对应终端上设置静态dns和关闭IP地址跟踪。如图所示：\n\n![](https://qiniu-image.gotojava.cn/blog/202503281352148.png)\n\n## iphone关闭限制IP地址跟踪\n\n针对部分终端上网异常的问题，如苹果手机，可以在对应终端上设置静态dns和关闭IP地址跟踪。隐私与安全，把所有跟踪都关闭。\n\n如图所示：\n\n![](https://qiniu-image.gotojava.cn/blog/202503281353281.png)\n\n## iphone隐私与安全，关闭所有跟踪\n\n![](https://qiniu-image.gotojava.cn/blog/202503281354275.png)\n\n## 网关设置终端DNS来源\n\n针对部分终端上网异常的问题，如苹果手机，可以在主网关上设置静态DNS，设置方法【网络】-【用户侧管理】-【IPv4配置】-【DNS来源】-选择静态配置，静态DNS可以填114.114.114.114加运营商DNS，如图所示：\n\n![](https://qiniu-image.gotojava.cn/blog/202503281354975.png)\n\n## 网关关闭IPv6\n\n集团规范要求IPv4/IPv6双栈，实际各省份各运营商网络有差异，国内IPv6网络还没有完全覆盖，部分运营商以及网站服务器无法满足IPv6完全覆盖。为提升体验解决部分手机测试无法达到千兆的问题，解决京东、淘宝、腾讯网课等部分网站不支持IPv6数据流的问题，建议用户关闭IPv6。\n\n![](https://qiniu-image.gotojava.cn/blog/202503281354382.png)\n\n## iphone开启Wi-Fi自动加入功能\n\niphone手机首次关联路由器显示“无网络连接”，约20s~2分钟后“无网络连接”消失，实际上网络是通的。\n\n苹果手机的新IOS版本15.3以后，增加了特定服务器域名探测功能，以此来判断网络是否连通，该服务器不稳定，导致探测失败，进而导致iphone手机显示“无网络连接”问题；实际上网络是通的。\n\niphone手机要打开自动关联功能，可以大概率规避“无网络连接”问题。\n\n## 网关Wi-Fi配置加密模式建议wpa2方式AES算法\n\n![](https://qiniu-image.gotojava.cn/blog/202503281355012.png)\n\n## 网关开启Wi-Fi5兼容模式，关闭802.11ax\n\n网关关闭Wi-Fi6（802.11ax），iphone重连。\n\n![](https://qiniu-image.gotojava.cn/blog/202503281355083.png)\n\n## iphone恢复网络设置\n\n可以尝试苹果手机设置里面恢复网络设置尝试一下，是否能恢复正常。\n\nChecklist\n\n| 序号 | 检查清单 |\n| --- | --- |\n| 1 | iphone设置DNS |\n| 2 | iphone关闭限制IP地址跟踪 |\n| 3 | iphone隐私与安全，关闭所有跟踪 |\n| 4 | 网关设置终端DNS来源 |\n| 5 | 网关关闭IPv6 |\n| 6 | iphone开启Wi-Fi自动加入功能 |\n| 7 | 网关Wi-Fi配置加密模式建议wpa2方式AES算法 |\n| 8 | 网关开启Wi-Fi5兼容模式，关闭802.11ax |\n| 9 | iphone恢复网络设置 |\n|  |  |\n","source":"_posts/苹果手机问题排查指导.md","raw":"---\ntitle: 苹果手机问题排查指导\ntoc: true\ntags: IOS\nabbrlink: 971c83b6\ndate: 2025-03-28 05:46:15\n---\n\n<meta name=\"referrer\" content=\"no-referrer\" />\n\n<!--more-->\n\n## iphone设置DNS\n\n针对部分终端上网异常的问题，如苹果手机，可以在对应终端上设置静态dns和关闭IP地址跟踪。如图所示：\n\n![](https://qiniu-image.gotojava.cn/blog/202503281352148.png)\n\n## iphone关闭限制IP地址跟踪\n\n针对部分终端上网异常的问题，如苹果手机，可以在对应终端上设置静态dns和关闭IP地址跟踪。隐私与安全，把所有跟踪都关闭。\n\n如图所示：\n\n![](https://qiniu-image.gotojava.cn/blog/202503281353281.png)\n\n## iphone隐私与安全，关闭所有跟踪\n\n![](https://qiniu-image.gotojava.cn/blog/202503281354275.png)\n\n## 网关设置终端DNS来源\n\n针对部分终端上网异常的问题，如苹果手机，可以在主网关上设置静态DNS，设置方法【网络】-【用户侧管理】-【IPv4配置】-【DNS来源】-选择静态配置，静态DNS可以填114.114.114.114加运营商DNS，如图所示：\n\n![](https://qiniu-image.gotojava.cn/blog/202503281354975.png)\n\n## 网关关闭IPv6\n\n集团规范要求IPv4/IPv6双栈，实际各省份各运营商网络有差异，国内IPv6网络还没有完全覆盖，部分运营商以及网站服务器无法满足IPv6完全覆盖。为提升体验解决部分手机测试无法达到千兆的问题，解决京东、淘宝、腾讯网课等部分网站不支持IPv6数据流的问题，建议用户关闭IPv6。\n\n![](https://qiniu-image.gotojava.cn/blog/202503281354382.png)\n\n## iphone开启Wi-Fi自动加入功能\n\niphone手机首次关联路由器显示“无网络连接”，约20s~2分钟后“无网络连接”消失，实际上网络是通的。\n\n苹果手机的新IOS版本15.3以后，增加了特定服务器域名探测功能，以此来判断网络是否连通，该服务器不稳定，导致探测失败，进而导致iphone手机显示“无网络连接”问题；实际上网络是通的。\n\niphone手机要打开自动关联功能，可以大概率规避“无网络连接”问题。\n\n## 网关Wi-Fi配置加密模式建议wpa2方式AES算法\n\n![](https://qiniu-image.gotojava.cn/blog/202503281355012.png)\n\n## 网关开启Wi-Fi5兼容模式，关闭802.11ax\n\n网关关闭Wi-Fi6（802.11ax），iphone重连。\n\n![](https://qiniu-image.gotojava.cn/blog/202503281355083.png)\n\n## iphone恢复网络设置\n\n可以尝试苹果手机设置里面恢复网络设置尝试一下，是否能恢复正常。\n\nChecklist\n\n| 序号 | 检查清单 |\n| --- | --- |\n| 1 | iphone设置DNS |\n| 2 | iphone关闭限制IP地址跟踪 |\n| 3 | iphone隐私与安全，关闭所有跟踪 |\n| 4 | 网关设置终端DNS来源 |\n| 5 | 网关关闭IPv6 |\n| 6 | iphone开启Wi-Fi自动加入功能 |\n| 7 | 网关Wi-Fi配置加密模式建议wpa2方式AES算法 |\n| 8 | 网关开启Wi-Fi5兼容模式，关闭802.11ax |\n| 9 | iphone恢复网络设置 |\n|  |  |\n","slug":"苹果手机问题排查指导","published":1,"updated":"2025-03-28T05:59:48.517Z","comments":1,"layout":"post","photos":[],"_id":"cm8se3tdz001vbb8l5nn4gmtq","content":"<meta name=\"referrer\" content=\"no-referrer\" />\n\n<span id=\"more\"></span>\n\n<h2 id=\"iphone设置DNS\"><a href=\"#iphone设置DNS\" class=\"headerlink\" title=\"iphone设置DNS\"></a>iphone设置DNS</h2><p>针对部分终端上网异常的问题，如苹果手机，可以在对应终端上设置静态dns和关闭IP地址跟踪。如图所示：</p>\n<p><img src=\"https://qiniu-image.gotojava.cn/blog/202503281352148.png\"></p>\n<h2 id=\"iphone关闭限制IP地址跟踪\"><a href=\"#iphone关闭限制IP地址跟踪\" class=\"headerlink\" title=\"iphone关闭限制IP地址跟踪\"></a>iphone关闭限制IP地址跟踪</h2><p>针对部分终端上网异常的问题，如苹果手机，可以在对应终端上设置静态dns和关闭IP地址跟踪。隐私与安全，把所有跟踪都关闭。</p>\n<p>如图所示：</p>\n<p><img src=\"https://qiniu-image.gotojava.cn/blog/202503281353281.png\"></p>\n<h2 id=\"iphone隐私与安全，关闭所有跟踪\"><a href=\"#iphone隐私与安全，关闭所有跟踪\" class=\"headerlink\" title=\"iphone隐私与安全，关闭所有跟踪\"></a>iphone隐私与安全，关闭所有跟踪</h2><p><img src=\"https://qiniu-image.gotojava.cn/blog/202503281354275.png\"></p>\n<h2 id=\"网关设置终端DNS来源\"><a href=\"#网关设置终端DNS来源\" class=\"headerlink\" title=\"网关设置终端DNS来源\"></a>网关设置终端DNS来源</h2><p>针对部分终端上网异常的问题，如苹果手机，可以在主网关上设置静态DNS，设置方法【网络】-【用户侧管理】-【IPv4配置】-【DNS来源】-选择静态配置，静态DNS可以填114.114.114.114加运营商DNS，如图所示：</p>\n<p><img src=\"https://qiniu-image.gotojava.cn/blog/202503281354975.png\"></p>\n<h2 id=\"网关关闭IPv6\"><a href=\"#网关关闭IPv6\" class=\"headerlink\" title=\"网关关闭IPv6\"></a>网关关闭IPv6</h2><p>集团规范要求IPv4&#x2F;IPv6双栈，实际各省份各运营商网络有差异，国内IPv6网络还没有完全覆盖，部分运营商以及网站服务器无法满足IPv6完全覆盖。为提升体验解决部分手机测试无法达到千兆的问题，解决京东、淘宝、腾讯网课等部分网站不支持IPv6数据流的问题，建议用户关闭IPv6。</p>\n<p><img src=\"https://qiniu-image.gotojava.cn/blog/202503281354382.png\"></p>\n<h2 id=\"iphone开启Wi-Fi自动加入功能\"><a href=\"#iphone开启Wi-Fi自动加入功能\" class=\"headerlink\" title=\"iphone开启Wi-Fi自动加入功能\"></a>iphone开启Wi-Fi自动加入功能</h2><p>iphone手机首次关联路由器显示“无网络连接”，约20s~2分钟后“无网络连接”消失，实际上网络是通的。</p>\n<p>苹果手机的新IOS版本15.3以后，增加了特定服务器域名探测功能，以此来判断网络是否连通，该服务器不稳定，导致探测失败，进而导致iphone手机显示“无网络连接”问题；实际上网络是通的。</p>\n<p>iphone手机要打开自动关联功能，可以大概率规避“无网络连接”问题。</p>\n<h2 id=\"网关Wi-Fi配置加密模式建议wpa2方式AES算法\"><a href=\"#网关Wi-Fi配置加密模式建议wpa2方式AES算法\" class=\"headerlink\" title=\"网关Wi-Fi配置加密模式建议wpa2方式AES算法\"></a>网关Wi-Fi配置加密模式建议wpa2方式AES算法</h2><p><img src=\"https://qiniu-image.gotojava.cn/blog/202503281355012.png\"></p>\n<h2 id=\"网关开启Wi-Fi5兼容模式，关闭802-11ax\"><a href=\"#网关开启Wi-Fi5兼容模式，关闭802-11ax\" class=\"headerlink\" title=\"网关开启Wi-Fi5兼容模式，关闭802.11ax\"></a>网关开启Wi-Fi5兼容模式，关闭802.11ax</h2><p>网关关闭Wi-Fi6（802.11ax），iphone重连。</p>\n<p><img src=\"https://qiniu-image.gotojava.cn/blog/202503281355083.png\"></p>\n<h2 id=\"iphone恢复网络设置\"><a href=\"#iphone恢复网络设置\" class=\"headerlink\" title=\"iphone恢复网络设置\"></a>iphone恢复网络设置</h2><p>可以尝试苹果手机设置里面恢复网络设置尝试一下，是否能恢复正常。</p>\n<p>Checklist</p>\n<table>\n<thead>\n<tr>\n<th>序号</th>\n<th>检查清单</th>\n</tr>\n</thead>\n<tbody><tr>\n<td>1</td>\n<td>iphone设置DNS</td>\n</tr>\n<tr>\n<td>2</td>\n<td>iphone关闭限制IP地址跟踪</td>\n</tr>\n<tr>\n<td>3</td>\n<td>iphone隐私与安全，关闭所有跟踪</td>\n</tr>\n<tr>\n<td>4</td>\n<td>网关设置终端DNS来源</td>\n</tr>\n<tr>\n<td>5</td>\n<td>网关关闭IPv6</td>\n</tr>\n<tr>\n<td>6</td>\n<td>iphone开启Wi-Fi自动加入功能</td>\n</tr>\n<tr>\n<td>7</td>\n<td>网关Wi-Fi配置加密模式建议wpa2方式AES算法</td>\n</tr>\n<tr>\n<td>8</td>\n<td>网关开启Wi-Fi5兼容模式，关闭802.11ax</td>\n</tr>\n<tr>\n<td>9</td>\n<td>iphone恢复网络设置</td>\n</tr>\n<tr>\n<td></td>\n<td></td>\n</tr>\n</tbody></table>\n","excerpt":"<meta name=\"referrer\" content=\"no-referrer\" />","more":"<h2 id=\"iphone设置DNS\"><a href=\"#iphone设置DNS\" class=\"headerlink\" title=\"iphone设置DNS\"></a>iphone设置DNS</h2><p>针对部分终端上网异常的问题，如苹果手机，可以在对应终端上设置静态dns和关闭IP地址跟踪。如图所示：</p>\n<p><img src=\"https://qiniu-image.gotojava.cn/blog/202503281352148.png\"></p>\n<h2 id=\"iphone关闭限制IP地址跟踪\"><a href=\"#iphone关闭限制IP地址跟踪\" class=\"headerlink\" title=\"iphone关闭限制IP地址跟踪\"></a>iphone关闭限制IP地址跟踪</h2><p>针对部分终端上网异常的问题，如苹果手机，可以在对应终端上设置静态dns和关闭IP地址跟踪。隐私与安全，把所有跟踪都关闭。</p>\n<p>如图所示：</p>\n<p><img src=\"https://qiniu-image.gotojava.cn/blog/202503281353281.png\"></p>\n<h2 id=\"iphone隐私与安全，关闭所有跟踪\"><a href=\"#iphone隐私与安全，关闭所有跟踪\" class=\"headerlink\" title=\"iphone隐私与安全，关闭所有跟踪\"></a>iphone隐私与安全，关闭所有跟踪</h2><p><img src=\"https://qiniu-image.gotojava.cn/blog/202503281354275.png\"></p>\n<h2 id=\"网关设置终端DNS来源\"><a href=\"#网关设置终端DNS来源\" class=\"headerlink\" title=\"网关设置终端DNS来源\"></a>网关设置终端DNS来源</h2><p>针对部分终端上网异常的问题，如苹果手机，可以在主网关上设置静态DNS，设置方法【网络】-【用户侧管理】-【IPv4配置】-【DNS来源】-选择静态配置，静态DNS可以填114.114.114.114加运营商DNS，如图所示：</p>\n<p><img src=\"https://qiniu-image.gotojava.cn/blog/202503281354975.png\"></p>\n<h2 id=\"网关关闭IPv6\"><a href=\"#网关关闭IPv6\" class=\"headerlink\" title=\"网关关闭IPv6\"></a>网关关闭IPv6</h2><p>集团规范要求IPv4&#x2F;IPv6双栈，实际各省份各运营商网络有差异，国内IPv6网络还没有完全覆盖，部分运营商以及网站服务器无法满足IPv6完全覆盖。为提升体验解决部分手机测试无法达到千兆的问题，解决京东、淘宝、腾讯网课等部分网站不支持IPv6数据流的问题，建议用户关闭IPv6。</p>\n<p><img src=\"https://qiniu-image.gotojava.cn/blog/202503281354382.png\"></p>\n<h2 id=\"iphone开启Wi-Fi自动加入功能\"><a href=\"#iphone开启Wi-Fi自动加入功能\" class=\"headerlink\" title=\"iphone开启Wi-Fi自动加入功能\"></a>iphone开启Wi-Fi自动加入功能</h2><p>iphone手机首次关联路由器显示“无网络连接”，约20s~2分钟后“无网络连接”消失，实际上网络是通的。</p>\n<p>苹果手机的新IOS版本15.3以后，增加了特定服务器域名探测功能，以此来判断网络是否连通，该服务器不稳定，导致探测失败，进而导致iphone手机显示“无网络连接”问题；实际上网络是通的。</p>\n<p>iphone手机要打开自动关联功能，可以大概率规避“无网络连接”问题。</p>\n<h2 id=\"网关Wi-Fi配置加密模式建议wpa2方式AES算法\"><a href=\"#网关Wi-Fi配置加密模式建议wpa2方式AES算法\" class=\"headerlink\" title=\"网关Wi-Fi配置加密模式建议wpa2方式AES算法\"></a>网关Wi-Fi配置加密模式建议wpa2方式AES算法</h2><p><img src=\"https://qiniu-image.gotojava.cn/blog/202503281355012.png\"></p>\n<h2 id=\"网关开启Wi-Fi5兼容模式，关闭802-11ax\"><a href=\"#网关开启Wi-Fi5兼容模式，关闭802-11ax\" class=\"headerlink\" title=\"网关开启Wi-Fi5兼容模式，关闭802.11ax\"></a>网关开启Wi-Fi5兼容模式，关闭802.11ax</h2><p>网关关闭Wi-Fi6（802.11ax），iphone重连。</p>\n<p><img src=\"https://qiniu-image.gotojava.cn/blog/202503281355083.png\"></p>\n<h2 id=\"iphone恢复网络设置\"><a href=\"#iphone恢复网络设置\" class=\"headerlink\" title=\"iphone恢复网络设置\"></a>iphone恢复网络设置</h2><p>可以尝试苹果手机设置里面恢复网络设置尝试一下，是否能恢复正常。</p>\n<p>Checklist</p>\n<table>\n<thead>\n<tr>\n<th>序号</th>\n<th>检查清单</th>\n</tr>\n</thead>\n<tbody><tr>\n<td>1</td>\n<td>iphone设置DNS</td>\n</tr>\n<tr>\n<td>2</td>\n<td>iphone关闭限制IP地址跟踪</td>\n</tr>\n<tr>\n<td>3</td>\n<td>iphone隐私与安全，关闭所有跟踪</td>\n</tr>\n<tr>\n<td>4</td>\n<td>网关设置终端DNS来源</td>\n</tr>\n<tr>\n<td>5</td>\n<td>网关关闭IPv6</td>\n</tr>\n<tr>\n<td>6</td>\n<td>iphone开启Wi-Fi自动加入功能</td>\n</tr>\n<tr>\n<td>7</td>\n<td>网关Wi-Fi配置加密模式建议wpa2方式AES算法</td>\n</tr>\n<tr>\n<td>8</td>\n<td>网关开启Wi-Fi5兼容模式，关闭802.11ax</td>\n</tr>\n<tr>\n<td>9</td>\n<td>iphone恢复网络设置</td>\n</tr>\n<tr>\n<td></td>\n<td></td>\n</tr>\n</tbody></table>"},{"title":"记一次HTTPS证书过期的处置过程","toc":true,"abbrlink":"ac3d766f","date":"2024-10-23T00:12:30.000Z","_content":"\n<meta name=\"referrer\" content=\"no-referrer\" />\n\n<!--more-->\n\n记一次 HTTPS 证书过期的处置过程的流水帐。\n\n## 背景\n\n因应用上线的需求在阿里云租用了一台服务器，考虑到后期发布的问题一并注册了一个域名。但近期因为项目关系导致该应用的上线时间一直在延期，域名证书因为申请是免费证书（DigiCert RSA）每次只有3个月的有效期，导致证书过期后没有及时更新，在Nginx的网关层`HTTP`又做了301跳转到`HTTP`的重定向。导致出现了下面的情况。\n\n![image-20241022233525178](https://qiniu-image.gotojava.cn/blog/202410222335262.png)\n\n![](https://qiniu-image.gotojava.cn/blog/202410222306643.png)\n\n查看签名证书详情我们可以看到，我们证书在10月1日早上8点就失效了，所以导致证书过期。\n\n## 临时解决方案\n\n1. 解除301重定向\n\n由于服务端做了301的跳转，导致网关层接受到的所有 HTTP 请求都会重定向到 HTTPS 。所以这里注释掉`return 301`的 HTTPS 跳转，并重写 HTTPS 的跳转使 HTTPS 的请求重定向到 HTTP 以解决证书无效的问题。并通过 <u>nginx -s reload</u> 重载nginx配置，使配置生效。此时网站的访问就会恢复正常。\n\n![image-20241022232942746](https://qiniu-image.gotojava.cn/blog/202410222330859.png)\n\n- HTTPS 重定向 HTTP\n\n```bash\nreturn 301 http://$server_name$request_uri;\n```\n\n- 更新 nginx 配置\n\n```bash\nnginx -s reload\n```\n\n2. 获取新证书\n\n向域名提供商提交申请，签发成功后会有邮件通知。DigiCert RSA 的审核周期预计在5分钟以内。![image-20241022234835430](https://qiniu-image.gotojava.cn/blog/202410222348543.png)\n\n## 更新证书\n\n- 获取证书\n\n点击下载获取应用的证书文件。根据服务器类型获取对应的证书文件即可。\n\n![image-20241022235602136](https://qiniu-image.gotojava.cn/blog/202410222356272.png)\n\n- 部署证书\n\n1. 将压缩文件解压，将签发的证书文件覆盖上传到对应的证书位置。\n\n![image-20241022235859498](https://qiniu-image.gotojava.cn/blog/202410222358664.png)\n\n![image-20241023000335484](https://qiniu-image.gotojava.cn/blog/202410230003590.png)\n\n2. 恢复配置文件的 HTTPS `301`重定向。\n\n![image-20241023000828198](https://qiniu-image.gotojava.cn/blog/202410230008287.png)\n\n```bash\nreturn 301 https://$server_name$request_uri;\n```\n\n3. 使用 `nginx -s reload`重新加载配置文件使配置生效。\n\n- 验证\n\n页面恢复正常，有效期延长。\n\n![image-20241023001055537](https://qiniu-image.gotojava.cn/blog/202410230010654.png)\n","source":"_posts/记一次HTTPS证书过期的处置过程.md","raw":"---\ntitle: 记一次HTTPS证书过期的处置过程\ntoc: true\nabbrlink: ac3d766f\ndate: 2024-10-23 00:12:30\n---\n\n<meta name=\"referrer\" content=\"no-referrer\" />\n\n<!--more-->\n\n记一次 HTTPS 证书过期的处置过程的流水帐。\n\n## 背景\n\n因应用上线的需求在阿里云租用了一台服务器，考虑到后期发布的问题一并注册了一个域名。但近期因为项目关系导致该应用的上线时间一直在延期，域名证书因为申请是免费证书（DigiCert RSA）每次只有3个月的有效期，导致证书过期后没有及时更新，在Nginx的网关层`HTTP`又做了301跳转到`HTTP`的重定向。导致出现了下面的情况。\n\n![image-20241022233525178](https://qiniu-image.gotojava.cn/blog/202410222335262.png)\n\n![](https://qiniu-image.gotojava.cn/blog/202410222306643.png)\n\n查看签名证书详情我们可以看到，我们证书在10月1日早上8点就失效了，所以导致证书过期。\n\n## 临时解决方案\n\n1. 解除301重定向\n\n由于服务端做了301的跳转，导致网关层接受到的所有 HTTP 请求都会重定向到 HTTPS 。所以这里注释掉`return 301`的 HTTPS 跳转，并重写 HTTPS 的跳转使 HTTPS 的请求重定向到 HTTP 以解决证书无效的问题。并通过 <u>nginx -s reload</u> 重载nginx配置，使配置生效。此时网站的访问就会恢复正常。\n\n![image-20241022232942746](https://qiniu-image.gotojava.cn/blog/202410222330859.png)\n\n- HTTPS 重定向 HTTP\n\n```bash\nreturn 301 http://$server_name$request_uri;\n```\n\n- 更新 nginx 配置\n\n```bash\nnginx -s reload\n```\n\n2. 获取新证书\n\n向域名提供商提交申请，签发成功后会有邮件通知。DigiCert RSA 的审核周期预计在5分钟以内。![image-20241022234835430](https://qiniu-image.gotojava.cn/blog/202410222348543.png)\n\n## 更新证书\n\n- 获取证书\n\n点击下载获取应用的证书文件。根据服务器类型获取对应的证书文件即可。\n\n![image-20241022235602136](https://qiniu-image.gotojava.cn/blog/202410222356272.png)\n\n- 部署证书\n\n1. 将压缩文件解压，将签发的证书文件覆盖上传到对应的证书位置。\n\n![image-20241022235859498](https://qiniu-image.gotojava.cn/blog/202410222358664.png)\n\n![image-20241023000335484](https://qiniu-image.gotojava.cn/blog/202410230003590.png)\n\n2. 恢复配置文件的 HTTPS `301`重定向。\n\n![image-20241023000828198](https://qiniu-image.gotojava.cn/blog/202410230008287.png)\n\n```bash\nreturn 301 https://$server_name$request_uri;\n```\n\n3. 使用 `nginx -s reload`重新加载配置文件使配置生效。\n\n- 验证\n\n页面恢复正常，有效期延长。\n\n![image-20241023001055537](https://qiniu-image.gotojava.cn/blog/202410230010654.png)\n","slug":"记一次HTTPS证书过期的处置过程","published":1,"updated":"2025-03-28T06:09:40.051Z","comments":1,"layout":"post","photos":[],"_id":"cm8se3tdz001wbb8lesrr3mq5","content":"<meta name=\"referrer\" content=\"no-referrer\" />\n\n<span id=\"more\"></span>\n\n<p>记一次 HTTPS 证书过期的处置过程的流水帐。</p>\n<h2 id=\"背景\"><a href=\"#背景\" class=\"headerlink\" title=\"背景\"></a>背景</h2><p>因应用上线的需求在阿里云租用了一台服务器，考虑到后期发布的问题一并注册了一个域名。但近期因为项目关系导致该应用的上线时间一直在延期，域名证书因为申请是免费证书（DigiCert RSA）每次只有3个月的有效期，导致证书过期后没有及时更新，在Nginx的网关层<code>HTTP</code>又做了301跳转到<code>HTTP</code>的重定向。导致出现了下面的情况。</p>\n<p><img src=\"https://qiniu-image.gotojava.cn/blog/202410222335262.png\" alt=\"image-20241022233525178\"></p>\n<p><img src=\"https://qiniu-image.gotojava.cn/blog/202410222306643.png\"></p>\n<p>查看签名证书详情我们可以看到，我们证书在10月1日早上8点就失效了，所以导致证书过期。</p>\n<h2 id=\"临时解决方案\"><a href=\"#临时解决方案\" class=\"headerlink\" title=\"临时解决方案\"></a>临时解决方案</h2><ol>\n<li>解除301重定向</li>\n</ol>\n<p>由于服务端做了301的跳转，导致网关层接受到的所有 HTTP 请求都会重定向到 HTTPS 。所以这里注释掉<code>return 301</code>的 HTTPS 跳转，并重写 HTTPS 的跳转使 HTTPS 的请求重定向到 HTTP 以解决证书无效的问题。并通过 <u>nginx -s reload</u> 重载nginx配置，使配置生效。此时网站的访问就会恢复正常。</p>\n<p><img src=\"https://qiniu-image.gotojava.cn/blog/202410222330859.png\" alt=\"image-20241022232942746\"></p>\n<ul>\n<li>HTTPS 重定向 HTTP</li>\n</ul>\n<figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"built_in\">return</span> 301 http://$server_name<span class=\"variable\">$request_uri</span>;</span><br></pre></td></tr></table></figure>\n\n<ul>\n<li>更新 nginx 配置</li>\n</ul>\n<figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">nginx -s reload</span><br></pre></td></tr></table></figure>\n\n<ol start=\"2\">\n<li>获取新证书</li>\n</ol>\n<p>向域名提供商提交申请，签发成功后会有邮件通知。DigiCert RSA 的审核周期预计在5分钟以内。<img src=\"https://qiniu-image.gotojava.cn/blog/202410222348543.png\" alt=\"image-20241022234835430\"></p>\n<h2 id=\"更新证书\"><a href=\"#更新证书\" class=\"headerlink\" title=\"更新证书\"></a>更新证书</h2><ul>\n<li>获取证书</li>\n</ul>\n<p>点击下载获取应用的证书文件。根据服务器类型获取对应的证书文件即可。</p>\n<p><img src=\"https://qiniu-image.gotojava.cn/blog/202410222356272.png\" alt=\"image-20241022235602136\"></p>\n<ul>\n<li>部署证书</li>\n</ul>\n<ol>\n<li>将压缩文件解压，将签发的证书文件覆盖上传到对应的证书位置。</li>\n</ol>\n<p><img src=\"https://qiniu-image.gotojava.cn/blog/202410222358664.png\" alt=\"image-20241022235859498\"></p>\n<p><img src=\"https://qiniu-image.gotojava.cn/blog/202410230003590.png\" alt=\"image-20241023000335484\"></p>\n<ol start=\"2\">\n<li>恢复配置文件的 HTTPS <code>301</code>重定向。</li>\n</ol>\n<p><img src=\"https://qiniu-image.gotojava.cn/blog/202410230008287.png\" alt=\"image-20241023000828198\"></p>\n<figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"built_in\">return</span> 301 https://$server_name<span class=\"variable\">$request_uri</span>;</span><br></pre></td></tr></table></figure>\n\n<ol start=\"3\">\n<li>使用 <code>nginx -s reload</code>重新加载配置文件使配置生效。</li>\n</ol>\n<ul>\n<li>验证</li>\n</ul>\n<p>页面恢复正常，有效期延长。</p>\n<p><img src=\"https://qiniu-image.gotojava.cn/blog/202410230010654.png\" alt=\"image-20241023001055537\"></p>\n","excerpt":"<meta name=\"referrer\" content=\"no-referrer\" />","more":"<p>记一次 HTTPS 证书过期的处置过程的流水帐。</p>\n<h2 id=\"背景\"><a href=\"#背景\" class=\"headerlink\" title=\"背景\"></a>背景</h2><p>因应用上线的需求在阿里云租用了一台服务器，考虑到后期发布的问题一并注册了一个域名。但近期因为项目关系导致该应用的上线时间一直在延期，域名证书因为申请是免费证书（DigiCert RSA）每次只有3个月的有效期，导致证书过期后没有及时更新，在Nginx的网关层<code>HTTP</code>又做了301跳转到<code>HTTP</code>的重定向。导致出现了下面的情况。</p>\n<p><img src=\"https://qiniu-image.gotojava.cn/blog/202410222335262.png\" alt=\"image-20241022233525178\"></p>\n<p><img src=\"https://qiniu-image.gotojava.cn/blog/202410222306643.png\"></p>\n<p>查看签名证书详情我们可以看到，我们证书在10月1日早上8点就失效了，所以导致证书过期。</p>\n<h2 id=\"临时解决方案\"><a href=\"#临时解决方案\" class=\"headerlink\" title=\"临时解决方案\"></a>临时解决方案</h2><ol>\n<li>解除301重定向</li>\n</ol>\n<p>由于服务端做了301的跳转，导致网关层接受到的所有 HTTP 请求都会重定向到 HTTPS 。所以这里注释掉<code>return 301</code>的 HTTPS 跳转，并重写 HTTPS 的跳转使 HTTPS 的请求重定向到 HTTP 以解决证书无效的问题。并通过 <u>nginx -s reload</u> 重载nginx配置，使配置生效。此时网站的访问就会恢复正常。</p>\n<p><img src=\"https://qiniu-image.gotojava.cn/blog/202410222330859.png\" alt=\"image-20241022232942746\"></p>\n<ul>\n<li>HTTPS 重定向 HTTP</li>\n</ul>\n<figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"built_in\">return</span> 301 http://$server_name<span class=\"variable\">$request_uri</span>;</span><br></pre></td></tr></table></figure>\n\n<ul>\n<li>更新 nginx 配置</li>\n</ul>\n<figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">nginx -s reload</span><br></pre></td></tr></table></figure>\n\n<ol start=\"2\">\n<li>获取新证书</li>\n</ol>\n<p>向域名提供商提交申请，签发成功后会有邮件通知。DigiCert RSA 的审核周期预计在5分钟以内。<img src=\"https://qiniu-image.gotojava.cn/blog/202410222348543.png\" alt=\"image-20241022234835430\"></p>\n<h2 id=\"更新证书\"><a href=\"#更新证书\" class=\"headerlink\" title=\"更新证书\"></a>更新证书</h2><ul>\n<li>获取证书</li>\n</ul>\n<p>点击下载获取应用的证书文件。根据服务器类型获取对应的证书文件即可。</p>\n<p><img src=\"https://qiniu-image.gotojava.cn/blog/202410222356272.png\" alt=\"image-20241022235602136\"></p>\n<ul>\n<li>部署证书</li>\n</ul>\n<ol>\n<li>将压缩文件解压，将签发的证书文件覆盖上传到对应的证书位置。</li>\n</ol>\n<p><img src=\"https://qiniu-image.gotojava.cn/blog/202410222358664.png\" alt=\"image-20241022235859498\"></p>\n<p><img src=\"https://qiniu-image.gotojava.cn/blog/202410230003590.png\" alt=\"image-20241023000335484\"></p>\n<ol start=\"2\">\n<li>恢复配置文件的 HTTPS <code>301</code>重定向。</li>\n</ol>\n<p><img src=\"https://qiniu-image.gotojava.cn/blog/202410230008287.png\" alt=\"image-20241023000828198\"></p>\n<figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"built_in\">return</span> 301 https://$server_name<span class=\"variable\">$request_uri</span>;</span><br></pre></td></tr></table></figure>\n\n<ol start=\"3\">\n<li>使用 <code>nginx -s reload</code>重新加载配置文件使配置生效。</li>\n</ol>\n<ul>\n<li>验证</li>\n</ul>\n<p>页面恢复正常，有效期延长。</p>\n<p><img src=\"https://qiniu-image.gotojava.cn/blog/202410230010654.png\" alt=\"image-20241023001055537\"></p>"},{"title":"达梦数据库信创安全加固说明","abbrlink":"d0046854","date":"2024-07-25T18:58:41.000Z","toc":true,"comments":1,"_content":"\n<meta name=\"referrer\" content=\"no-referrer\" />\n\n<!--more-->\n\n## 身份鉴别\n\n### W001-口令强度策略不够完善。\n\n```sql\n--查看密码策略\nSELECT PARA_NAME ,PARA_VALUE FROM V$DM_INI WHERE \"V$DM_INI\".PARA_NAME = 'PWD_POLICY'\n--修改密码策略（只针对新的用户生效）  \nALTER SYSTEM SET ‘PWD_POLICY’=31  BOTH;  \n--- 查看密码过期策略\nSELECT A.USERNAME,B.LIFE_TIME ,GRACE_TIME FROM  ALL_USERS A  ,SYSUSERS B WHERE A.USER_ID =B.ID\n--修改密码有效期90天,宽限期30天\n ALTER USER  用户名  LIMIT PASSWORD_LIFE_TIME 90, PASSWORD_GRACE_TIME 30;  \n```\n\n### W002-无登录失败处理功能。\n\n```sql\n--查看失败处理策略\nSELECT A.USERNAME,B.LOCK_TIME , b.FAILED_ATTEMPS ,b.CONN_IDLE_TIME FROM  ALL_USERS A  ,SYSUSERS B WHERE A.USER_ID =B.ID  \n--修改用户登录失败三次，锁定1分钟，空闲连接时间10分钟\nALTER USER 用户名  LIMIT PASSWORD_LOCK_TIME 1 , FAILED_LOGIN_ATTEMPS 3 ,CONNECT_IDLE_TIME 10;  \n```\n\n### W003-远程管理时未采用加密措施。\n\n```sql\n--使用SSL认证登录需要用户自己提供相关的SSL证书。\n--使用配通讯加密算法进行通讯加密(需要重启数据库生效）\nALTER SYSTEM SET 'COMM_ENCRYPT_NAME'='DES_CFB' SPFILE;\n--可以使用的加密算法查询\nSELECT * FROM V$CIPHERS;\n```\n\n## 访问策略\n\n### W005-未实现操作系统和数据库特权用户权限分离。\n\n```sql\n--创建普通用户语句。\nCREATE USER 用户名 IDENTIFIED  BY \"密码\";\n--授权\nGRANT RESOURCE,PUBLIC,VTI,SOI TO 用户;\n```\n\n## 安全审计\n\n> 使用SYSAUDITOR账户操作\n\n### W007-数据库审计开启\n\n```sql\n--开启数据审计\nSP_SET_ENABLE_AUDIT (1);\n--添加审计规则(SYSDBA/SYSAUDITOR添加，用户审计、用户实施DDL审计、用户实施DML审计、用户的权限更改审计，相关数据操作员添加，用户审计、用户实施DDL审计、用户的权限更改审计)。\n--用户审计\n--添加用户创建／修改／删除用户操作的审计\nSP_AUDIT_STMT('USER', '用户名', 'ALL');\n--添加用户登陆登出的审计\nSP_AUDIT_STMT('CONNECT', '用户名', 'ALL')\n--用户权限的更改审计\n--添加用户回收权限操作\nSP_AUDIT_STMT('REVOKE', '用户名' , 'ALL');\n--添加用户授权授予权限操作\nSP_AUDIT_STMT('GRANT', '用户名', 'ALL');\n--用户实施DML操作审计\n--添加用户表上删除的权限\nSP_AUDIT_STMT('DELETE TABLE', '用户名', 'ALL');\n--添加用户表上更新的权限\nSP_AUDIT_STMT('UPDATE TABLE', '用户名', 'ALL');\n--添加用户调用存储过程或函数操作\nSP_AUDIT_STMT('EXECUTE PROCEDURE', '用户名', 'ALL');\n--添加用户表上查询的权限\nSP_AUDIT_STMT('SELECT TABLE', '用户名', 'ALL');\n--添加用户表上插入的权限\nSP_AUDIT_STMT('INSERT TABLE', '用户名', 'ALL');\n--用户实施DDL操作审计\n--添加用户创建／删除角色操作\nSP_AUDIT_STMT('ROLE', '用户名', 'ALL');\n--添加用户创建／删除／设置当前模式操作\nSP_AUDIT_STMT('SCHEMA', '用户名', 'ALL');\n--添加用户创建／删除包规范\nSP_AUDIT_STMT('PACKAGE', '用户名', 'ALL');\n--添加用户创建／删除包规范\nSP_AUDIT_STMT('PACKAGE BODY', '用户名', 'ALL');\n--添加用户创建／修改／删除／清空基表操作\nSP_AUDIT_STMT('TABLE', '用户名', 'ALL');\n--添加用户创建／删除索引操作\nSP_AUDIT_STMT('INDEX', '用户名', 'ALL');\n--添加用户创建／修改／删除视图操作\nSP_AUDIT_STMT('VIEW', '用户名', 'ALL');\n--添加用户创建／修改／删除触发器操作\nSP_AUDIT_STMT('TRIGGER', '用户名', 'ALL');\n--添加用户创建／修改／删除存储模块操作\nSP_AUDIT_STMT('PROCEDURE', '用户名', 'ALL');\n--添加用户创建／修改／删除全文索引操作\nSP_AUDIT_STMT('CONTEXT', '用户名', 'ALL');\n--添加用户创建／修改/删除序列操作\nSP_AUDIT_STMT('SEQUENCE', '用户名', 'ALL');\n```\n\n### W008-数据库审计日志查看\n\n```sql\n--查看审计日志\nSELECT * FROM \"SYSAUDITOR\".\"V$AUDITRECORDS\";\n```\n\n### W009-审计日志文件定时备份\n\n```sql\n--本地磁盘空间充足，可以保留180天。\n--备份通过操作系统命令定时将数据库实例目录下AUDIT开头的日志文件拷贝走。\n--审计日志路径（默认数据库实例目录）\nSELECT * FROM V$DM_INI WHERE \"V$DM_INI\".PARA_NAME LIKE 'AUD_PATH%'\n```\n\n## 入侵规范\n\n### W011-未限制对设备的访问控制规则。\n\n```sql\n---添加允许IP地址连接用户登录数据库(做好记录服务器本地也需要相应IP登录）\nALTER USER \"用户名\" ALLOW_IP \"IP地址\";\n--查看允许登录IP。\nSELECT A.USERNAME,B.LOCK_TIME , b.ALLOW_ADDR FROM  ALL_USERS A  ,SYSUSERS B WHERE A.USER_ID =B.ID\n```\n\n## 数据完整性\n\n### <span id=\"key1\">W016-未采用密码技术进行通信完整性验证</span>。\n\n```sql\n--使用SSL认证登录需要用户自己提供相关的SSL证书。\n--使用配通讯加密算法进行通讯加密(需要重启数据库生效）\nALTER SYSTEM SET 'COMM_ENCRYPT_NAME'='DES_CFB' SPFILE;\n--可以使用的加密算法查询\nSELECT * FROM V$CIPHERS;\n```\n\n## 数据保密性\n\n### W018-未对重要数据进行加密传输。\n\n参考数据[完整性-W016](#key1)\n\n### W019-未对重要数据进行加密存储。\n\n相关重要字段的加密存储参考[数据库安全管理手册](https://www.alipan.com/s/ktJNZEaNsmr)（存储加密）\n\n## 个人信息保护\n\n### W024-数据库对个人信息明文存储。\n\n相关重要字段的加密存储参考[数据库安全管理手册](https://www.alipan.com/s/ktJNZEaNsmr)（存储加密）\n\n","source":"_posts/达梦数据库信创安全加固说明.md","raw":"---\ncategories:\n  - 开发者笔记\ntags:\n  - 达梦数据库\ntitle: 达梦数据库信创安全加固说明\nabbrlink: d0046854\ndate: 2024-07-25 18:58:41\ntoc: true\ncomments: true\n---\n\n<meta name=\"referrer\" content=\"no-referrer\" />\n\n<!--more-->\n\n## 身份鉴别\n\n### W001-口令强度策略不够完善。\n\n```sql\n--查看密码策略\nSELECT PARA_NAME ,PARA_VALUE FROM V$DM_INI WHERE \"V$DM_INI\".PARA_NAME = 'PWD_POLICY'\n--修改密码策略（只针对新的用户生效）  \nALTER SYSTEM SET ‘PWD_POLICY’=31  BOTH;  \n--- 查看密码过期策略\nSELECT A.USERNAME,B.LIFE_TIME ,GRACE_TIME FROM  ALL_USERS A  ,SYSUSERS B WHERE A.USER_ID =B.ID\n--修改密码有效期90天,宽限期30天\n ALTER USER  用户名  LIMIT PASSWORD_LIFE_TIME 90, PASSWORD_GRACE_TIME 30;  \n```\n\n### W002-无登录失败处理功能。\n\n```sql\n--查看失败处理策略\nSELECT A.USERNAME,B.LOCK_TIME , b.FAILED_ATTEMPS ,b.CONN_IDLE_TIME FROM  ALL_USERS A  ,SYSUSERS B WHERE A.USER_ID =B.ID  \n--修改用户登录失败三次，锁定1分钟，空闲连接时间10分钟\nALTER USER 用户名  LIMIT PASSWORD_LOCK_TIME 1 , FAILED_LOGIN_ATTEMPS 3 ,CONNECT_IDLE_TIME 10;  \n```\n\n### W003-远程管理时未采用加密措施。\n\n```sql\n--使用SSL认证登录需要用户自己提供相关的SSL证书。\n--使用配通讯加密算法进行通讯加密(需要重启数据库生效）\nALTER SYSTEM SET 'COMM_ENCRYPT_NAME'='DES_CFB' SPFILE;\n--可以使用的加密算法查询\nSELECT * FROM V$CIPHERS;\n```\n\n## 访问策略\n\n### W005-未实现操作系统和数据库特权用户权限分离。\n\n```sql\n--创建普通用户语句。\nCREATE USER 用户名 IDENTIFIED  BY \"密码\";\n--授权\nGRANT RESOURCE,PUBLIC,VTI,SOI TO 用户;\n```\n\n## 安全审计\n\n> 使用SYSAUDITOR账户操作\n\n### W007-数据库审计开启\n\n```sql\n--开启数据审计\nSP_SET_ENABLE_AUDIT (1);\n--添加审计规则(SYSDBA/SYSAUDITOR添加，用户审计、用户实施DDL审计、用户实施DML审计、用户的权限更改审计，相关数据操作员添加，用户审计、用户实施DDL审计、用户的权限更改审计)。\n--用户审计\n--添加用户创建／修改／删除用户操作的审计\nSP_AUDIT_STMT('USER', '用户名', 'ALL');\n--添加用户登陆登出的审计\nSP_AUDIT_STMT('CONNECT', '用户名', 'ALL')\n--用户权限的更改审计\n--添加用户回收权限操作\nSP_AUDIT_STMT('REVOKE', '用户名' , 'ALL');\n--添加用户授权授予权限操作\nSP_AUDIT_STMT('GRANT', '用户名', 'ALL');\n--用户实施DML操作审计\n--添加用户表上删除的权限\nSP_AUDIT_STMT('DELETE TABLE', '用户名', 'ALL');\n--添加用户表上更新的权限\nSP_AUDIT_STMT('UPDATE TABLE', '用户名', 'ALL');\n--添加用户调用存储过程或函数操作\nSP_AUDIT_STMT('EXECUTE PROCEDURE', '用户名', 'ALL');\n--添加用户表上查询的权限\nSP_AUDIT_STMT('SELECT TABLE', '用户名', 'ALL');\n--添加用户表上插入的权限\nSP_AUDIT_STMT('INSERT TABLE', '用户名', 'ALL');\n--用户实施DDL操作审计\n--添加用户创建／删除角色操作\nSP_AUDIT_STMT('ROLE', '用户名', 'ALL');\n--添加用户创建／删除／设置当前模式操作\nSP_AUDIT_STMT('SCHEMA', '用户名', 'ALL');\n--添加用户创建／删除包规范\nSP_AUDIT_STMT('PACKAGE', '用户名', 'ALL');\n--添加用户创建／删除包规范\nSP_AUDIT_STMT('PACKAGE BODY', '用户名', 'ALL');\n--添加用户创建／修改／删除／清空基表操作\nSP_AUDIT_STMT('TABLE', '用户名', 'ALL');\n--添加用户创建／删除索引操作\nSP_AUDIT_STMT('INDEX', '用户名', 'ALL');\n--添加用户创建／修改／删除视图操作\nSP_AUDIT_STMT('VIEW', '用户名', 'ALL');\n--添加用户创建／修改／删除触发器操作\nSP_AUDIT_STMT('TRIGGER', '用户名', 'ALL');\n--添加用户创建／修改／删除存储模块操作\nSP_AUDIT_STMT('PROCEDURE', '用户名', 'ALL');\n--添加用户创建／修改／删除全文索引操作\nSP_AUDIT_STMT('CONTEXT', '用户名', 'ALL');\n--添加用户创建／修改/删除序列操作\nSP_AUDIT_STMT('SEQUENCE', '用户名', 'ALL');\n```\n\n### W008-数据库审计日志查看\n\n```sql\n--查看审计日志\nSELECT * FROM \"SYSAUDITOR\".\"V$AUDITRECORDS\";\n```\n\n### W009-审计日志文件定时备份\n\n```sql\n--本地磁盘空间充足，可以保留180天。\n--备份通过操作系统命令定时将数据库实例目录下AUDIT开头的日志文件拷贝走。\n--审计日志路径（默认数据库实例目录）\nSELECT * FROM V$DM_INI WHERE \"V$DM_INI\".PARA_NAME LIKE 'AUD_PATH%'\n```\n\n## 入侵规范\n\n### W011-未限制对设备的访问控制规则。\n\n```sql\n---添加允许IP地址连接用户登录数据库(做好记录服务器本地也需要相应IP登录）\nALTER USER \"用户名\" ALLOW_IP \"IP地址\";\n--查看允许登录IP。\nSELECT A.USERNAME,B.LOCK_TIME , b.ALLOW_ADDR FROM  ALL_USERS A  ,SYSUSERS B WHERE A.USER_ID =B.ID\n```\n\n## 数据完整性\n\n### <span id=\"key1\">W016-未采用密码技术进行通信完整性验证</span>。\n\n```sql\n--使用SSL认证登录需要用户自己提供相关的SSL证书。\n--使用配通讯加密算法进行通讯加密(需要重启数据库生效）\nALTER SYSTEM SET 'COMM_ENCRYPT_NAME'='DES_CFB' SPFILE;\n--可以使用的加密算法查询\nSELECT * FROM V$CIPHERS;\n```\n\n## 数据保密性\n\n### W018-未对重要数据进行加密传输。\n\n参考数据[完整性-W016](#key1)\n\n### W019-未对重要数据进行加密存储。\n\n相关重要字段的加密存储参考[数据库安全管理手册](https://www.alipan.com/s/ktJNZEaNsmr)（存储加密）\n\n## 个人信息保护\n\n### W024-数据库对个人信息明文存储。\n\n相关重要字段的加密存储参考[数据库安全管理手册](https://www.alipan.com/s/ktJNZEaNsmr)（存储加密）\n\n","slug":"达梦数据库信创安全加固说明","published":1,"updated":"2025-03-28T06:09:23.282Z","layout":"post","photos":[],"_id":"cm8se3te0001ybb8lafp4acdi","content":"<meta name=\"referrer\" content=\"no-referrer\" />\n\n<span id=\"more\"></span>\n\n<h2 id=\"身份鉴别\"><a href=\"#身份鉴别\" class=\"headerlink\" title=\"身份鉴别\"></a>身份鉴别</h2><h3 id=\"W001-口令强度策略不够完善。\"><a href=\"#W001-口令强度策略不够完善。\" class=\"headerlink\" title=\"W001-口令强度策略不够完善。\"></a>W001-口令强度策略不够完善。</h3><figure class=\"highlight sql\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">--查看密码策略</span></span><br><span class=\"line\"><span class=\"keyword\">SELECT</span> PARA_NAME ,PARA_VALUE <span class=\"keyword\">FROM</span> V$DM_INI <span class=\"keyword\">WHERE</span> &quot;V$DM_INI&quot;.PARA_NAME <span class=\"operator\">=</span> <span class=\"string\">&#x27;PWD_POLICY&#x27;</span></span><br><span class=\"line\"><span class=\"comment\">--修改密码策略（只针对新的用户生效）  </span></span><br><span class=\"line\"><span class=\"keyword\">ALTER</span> <span class=\"keyword\">SYSTEM</span> <span class=\"keyword\">SET</span> ‘PWD_POLICY’<span class=\"operator\">=</span><span class=\"number\">31</span>  <span class=\"keyword\">BOTH</span>;  </span><br><span class=\"line\"><span class=\"comment\">--- 查看密码过期策略</span></span><br><span class=\"line\"><span class=\"keyword\">SELECT</span> A.USERNAME,B.LIFE_TIME ,GRACE_TIME <span class=\"keyword\">FROM</span>  ALL_USERS A  ,SYSUSERS B <span class=\"keyword\">WHERE</span> A.USER_ID <span class=\"operator\">=</span>B.ID</span><br><span class=\"line\"><span class=\"comment\">--修改密码有效期90天,宽限期30天</span></span><br><span class=\"line\"> <span class=\"keyword\">ALTER</span> <span class=\"keyword\">USER</span>  用户名  LIMIT PASSWORD_LIFE_TIME <span class=\"number\">90</span>, PASSWORD_GRACE_TIME <span class=\"number\">30</span>;  </span><br></pre></td></tr></table></figure>\n\n<h3 id=\"W002-无登录失败处理功能。\"><a href=\"#W002-无登录失败处理功能。\" class=\"headerlink\" title=\"W002-无登录失败处理功能。\"></a>W002-无登录失败处理功能。</h3><figure class=\"highlight sql\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">--查看失败处理策略</span></span><br><span class=\"line\"><span class=\"keyword\">SELECT</span> A.USERNAME,B.LOCK_TIME , b.FAILED_ATTEMPS ,b.CONN_IDLE_TIME <span class=\"keyword\">FROM</span>  ALL_USERS A  ,SYSUSERS B <span class=\"keyword\">WHERE</span> A.USER_ID <span class=\"operator\">=</span>B.ID  </span><br><span class=\"line\"><span class=\"comment\">--修改用户登录失败三次，锁定1分钟，空闲连接时间10分钟</span></span><br><span class=\"line\"><span class=\"keyword\">ALTER</span> <span class=\"keyword\">USER</span> 用户名  LIMIT PASSWORD_LOCK_TIME <span class=\"number\">1</span> , FAILED_LOGIN_ATTEMPS <span class=\"number\">3</span> ,CONNECT_IDLE_TIME <span class=\"number\">10</span>;  </span><br></pre></td></tr></table></figure>\n\n<h3 id=\"W003-远程管理时未采用加密措施。\"><a href=\"#W003-远程管理时未采用加密措施。\" class=\"headerlink\" title=\"W003-远程管理时未采用加密措施。\"></a>W003-远程管理时未采用加密措施。</h3><figure class=\"highlight sql\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">--使用SSL认证登录需要用户自己提供相关的SSL证书。</span></span><br><span class=\"line\"><span class=\"comment\">--使用配通讯加密算法进行通讯加密(需要重启数据库生效）</span></span><br><span class=\"line\"><span class=\"keyword\">ALTER</span> <span class=\"keyword\">SYSTEM</span> <span class=\"keyword\">SET</span> <span class=\"string\">&#x27;COMM_ENCRYPT_NAME&#x27;</span><span class=\"operator\">=</span><span class=\"string\">&#x27;DES_CFB&#x27;</span> SPFILE;</span><br><span class=\"line\"><span class=\"comment\">--可以使用的加密算法查询</span></span><br><span class=\"line\"><span class=\"keyword\">SELECT</span> <span class=\"operator\">*</span> <span class=\"keyword\">FROM</span> V$CIPHERS;</span><br></pre></td></tr></table></figure>\n\n<h2 id=\"访问策略\"><a href=\"#访问策略\" class=\"headerlink\" title=\"访问策略\"></a>访问策略</h2><h3 id=\"W005-未实现操作系统和数据库特权用户权限分离。\"><a href=\"#W005-未实现操作系统和数据库特权用户权限分离。\" class=\"headerlink\" title=\"W005-未实现操作系统和数据库特权用户权限分离。\"></a>W005-未实现操作系统和数据库特权用户权限分离。</h3><figure class=\"highlight sql\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">--创建普通用户语句。</span></span><br><span class=\"line\"><span class=\"keyword\">CREATE</span> <span class=\"keyword\">USER</span> 用户名 IDENTIFIED  <span class=\"keyword\">BY</span> &quot;密码&quot;;</span><br><span class=\"line\"><span class=\"comment\">--授权</span></span><br><span class=\"line\"><span class=\"keyword\">GRANT</span> RESOURCE,PUBLIC,VTI,SOI <span class=\"keyword\">TO</span> 用户;</span><br></pre></td></tr></table></figure>\n\n<h2 id=\"安全审计\"><a href=\"#安全审计\" class=\"headerlink\" title=\"安全审计\"></a>安全审计</h2><blockquote>\n<p>使用SYSAUDITOR账户操作</p>\n</blockquote>\n<h3 id=\"W007-数据库审计开启\"><a href=\"#W007-数据库审计开启\" class=\"headerlink\" title=\"W007-数据库审计开启\"></a>W007-数据库审计开启</h3><figure class=\"highlight sql\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br><span class=\"line\">38</span><br><span class=\"line\">39</span><br><span class=\"line\">40</span><br><span class=\"line\">41</span><br><span class=\"line\">42</span><br><span class=\"line\">43</span><br><span class=\"line\">44</span><br><span class=\"line\">45</span><br><span class=\"line\">46</span><br><span class=\"line\">47</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">--开启数据审计</span></span><br><span class=\"line\">SP_SET_ENABLE_AUDIT (<span class=\"number\">1</span>);</span><br><span class=\"line\"><span class=\"comment\">--添加审计规则(SYSDBA/SYSAUDITOR添加，用户审计、用户实施DDL审计、用户实施DML审计、用户的权限更改审计，相关数据操作员添加，用户审计、用户实施DDL审计、用户的权限更改审计)。</span></span><br><span class=\"line\"><span class=\"comment\">--用户审计</span></span><br><span class=\"line\"><span class=\"comment\">--添加用户创建／修改／删除用户操作的审计</span></span><br><span class=\"line\">SP_AUDIT_STMT(<span class=\"string\">&#x27;USER&#x27;</span>, <span class=\"string\">&#x27;用户名&#x27;</span>, <span class=\"string\">&#x27;ALL&#x27;</span>);</span><br><span class=\"line\"><span class=\"comment\">--添加用户登陆登出的审计</span></span><br><span class=\"line\">SP_AUDIT_STMT(<span class=\"string\">&#x27;CONNECT&#x27;</span>, <span class=\"string\">&#x27;用户名&#x27;</span>, <span class=\"string\">&#x27;ALL&#x27;</span>)</span><br><span class=\"line\"><span class=\"comment\">--用户权限的更改审计</span></span><br><span class=\"line\"><span class=\"comment\">--添加用户回收权限操作</span></span><br><span class=\"line\">SP_AUDIT_STMT(<span class=\"string\">&#x27;REVOKE&#x27;</span>, <span class=\"string\">&#x27;用户名&#x27;</span> , <span class=\"string\">&#x27;ALL&#x27;</span>);</span><br><span class=\"line\"><span class=\"comment\">--添加用户授权授予权限操作</span></span><br><span class=\"line\">SP_AUDIT_STMT(<span class=\"string\">&#x27;GRANT&#x27;</span>, <span class=\"string\">&#x27;用户名&#x27;</span>, <span class=\"string\">&#x27;ALL&#x27;</span>);</span><br><span class=\"line\"><span class=\"comment\">--用户实施DML操作审计</span></span><br><span class=\"line\"><span class=\"comment\">--添加用户表上删除的权限</span></span><br><span class=\"line\">SP_AUDIT_STMT(<span class=\"string\">&#x27;DELETE TABLE&#x27;</span>, <span class=\"string\">&#x27;用户名&#x27;</span>, <span class=\"string\">&#x27;ALL&#x27;</span>);</span><br><span class=\"line\"><span class=\"comment\">--添加用户表上更新的权限</span></span><br><span class=\"line\">SP_AUDIT_STMT(<span class=\"string\">&#x27;UPDATE TABLE&#x27;</span>, <span class=\"string\">&#x27;用户名&#x27;</span>, <span class=\"string\">&#x27;ALL&#x27;</span>);</span><br><span class=\"line\"><span class=\"comment\">--添加用户调用存储过程或函数操作</span></span><br><span class=\"line\">SP_AUDIT_STMT(<span class=\"string\">&#x27;EXECUTE PROCEDURE&#x27;</span>, <span class=\"string\">&#x27;用户名&#x27;</span>, <span class=\"string\">&#x27;ALL&#x27;</span>);</span><br><span class=\"line\"><span class=\"comment\">--添加用户表上查询的权限</span></span><br><span class=\"line\">SP_AUDIT_STMT(<span class=\"string\">&#x27;SELECT TABLE&#x27;</span>, <span class=\"string\">&#x27;用户名&#x27;</span>, <span class=\"string\">&#x27;ALL&#x27;</span>);</span><br><span class=\"line\"><span class=\"comment\">--添加用户表上插入的权限</span></span><br><span class=\"line\">SP_AUDIT_STMT(<span class=\"string\">&#x27;INSERT TABLE&#x27;</span>, <span class=\"string\">&#x27;用户名&#x27;</span>, <span class=\"string\">&#x27;ALL&#x27;</span>);</span><br><span class=\"line\"><span class=\"comment\">--用户实施DDL操作审计</span></span><br><span class=\"line\"><span class=\"comment\">--添加用户创建／删除角色操作</span></span><br><span class=\"line\">SP_AUDIT_STMT(<span class=\"string\">&#x27;ROLE&#x27;</span>, <span class=\"string\">&#x27;用户名&#x27;</span>, <span class=\"string\">&#x27;ALL&#x27;</span>);</span><br><span class=\"line\"><span class=\"comment\">--添加用户创建／删除／设置当前模式操作</span></span><br><span class=\"line\">SP_AUDIT_STMT(<span class=\"string\">&#x27;SCHEMA&#x27;</span>, <span class=\"string\">&#x27;用户名&#x27;</span>, <span class=\"string\">&#x27;ALL&#x27;</span>);</span><br><span class=\"line\"><span class=\"comment\">--添加用户创建／删除包规范</span></span><br><span class=\"line\">SP_AUDIT_STMT(<span class=\"string\">&#x27;PACKAGE&#x27;</span>, <span class=\"string\">&#x27;用户名&#x27;</span>, <span class=\"string\">&#x27;ALL&#x27;</span>);</span><br><span class=\"line\"><span class=\"comment\">--添加用户创建／删除包规范</span></span><br><span class=\"line\">SP_AUDIT_STMT(<span class=\"string\">&#x27;PACKAGE BODY&#x27;</span>, <span class=\"string\">&#x27;用户名&#x27;</span>, <span class=\"string\">&#x27;ALL&#x27;</span>);</span><br><span class=\"line\"><span class=\"comment\">--添加用户创建／修改／删除／清空基表操作</span></span><br><span class=\"line\">SP_AUDIT_STMT(<span class=\"string\">&#x27;TABLE&#x27;</span>, <span class=\"string\">&#x27;用户名&#x27;</span>, <span class=\"string\">&#x27;ALL&#x27;</span>);</span><br><span class=\"line\"><span class=\"comment\">--添加用户创建／删除索引操作</span></span><br><span class=\"line\">SP_AUDIT_STMT(<span class=\"string\">&#x27;INDEX&#x27;</span>, <span class=\"string\">&#x27;用户名&#x27;</span>, <span class=\"string\">&#x27;ALL&#x27;</span>);</span><br><span class=\"line\"><span class=\"comment\">--添加用户创建／修改／删除视图操作</span></span><br><span class=\"line\">SP_AUDIT_STMT(<span class=\"string\">&#x27;VIEW&#x27;</span>, <span class=\"string\">&#x27;用户名&#x27;</span>, <span class=\"string\">&#x27;ALL&#x27;</span>);</span><br><span class=\"line\"><span class=\"comment\">--添加用户创建／修改／删除触发器操作</span></span><br><span class=\"line\">SP_AUDIT_STMT(<span class=\"string\">&#x27;TRIGGER&#x27;</span>, <span class=\"string\">&#x27;用户名&#x27;</span>, <span class=\"string\">&#x27;ALL&#x27;</span>);</span><br><span class=\"line\"><span class=\"comment\">--添加用户创建／修改／删除存储模块操作</span></span><br><span class=\"line\">SP_AUDIT_STMT(<span class=\"string\">&#x27;PROCEDURE&#x27;</span>, <span class=\"string\">&#x27;用户名&#x27;</span>, <span class=\"string\">&#x27;ALL&#x27;</span>);</span><br><span class=\"line\"><span class=\"comment\">--添加用户创建／修改／删除全文索引操作</span></span><br><span class=\"line\">SP_AUDIT_STMT(<span class=\"string\">&#x27;CONTEXT&#x27;</span>, <span class=\"string\">&#x27;用户名&#x27;</span>, <span class=\"string\">&#x27;ALL&#x27;</span>);</span><br><span class=\"line\"><span class=\"comment\">--添加用户创建／修改/删除序列操作</span></span><br><span class=\"line\">SP_AUDIT_STMT(<span class=\"string\">&#x27;SEQUENCE&#x27;</span>, <span class=\"string\">&#x27;用户名&#x27;</span>, <span class=\"string\">&#x27;ALL&#x27;</span>);</span><br></pre></td></tr></table></figure>\n\n<h3 id=\"W008-数据库审计日志查看\"><a href=\"#W008-数据库审计日志查看\" class=\"headerlink\" title=\"W008-数据库审计日志查看\"></a>W008-数据库审计日志查看</h3><figure class=\"highlight sql\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">--查看审计日志</span></span><br><span class=\"line\"><span class=\"keyword\">SELECT</span> <span class=\"operator\">*</span> <span class=\"keyword\">FROM</span> &quot;SYSAUDITOR&quot;.&quot;V$AUDITRECORDS&quot;;</span><br></pre></td></tr></table></figure>\n\n<h3 id=\"W009-审计日志文件定时备份\"><a href=\"#W009-审计日志文件定时备份\" class=\"headerlink\" title=\"W009-审计日志文件定时备份\"></a>W009-审计日志文件定时备份</h3><figure class=\"highlight sql\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">--本地磁盘空间充足，可以保留180天。</span></span><br><span class=\"line\"><span class=\"comment\">--备份通过操作系统命令定时将数据库实例目录下AUDIT开头的日志文件拷贝走。</span></span><br><span class=\"line\"><span class=\"comment\">--审计日志路径（默认数据库实例目录）</span></span><br><span class=\"line\"><span class=\"keyword\">SELECT</span> <span class=\"operator\">*</span> <span class=\"keyword\">FROM</span> V$DM_INI <span class=\"keyword\">WHERE</span> &quot;V$DM_INI&quot;.PARA_NAME <span class=\"keyword\">LIKE</span> <span class=\"string\">&#x27;AUD_PATH%&#x27;</span></span><br></pre></td></tr></table></figure>\n\n<h2 id=\"入侵规范\"><a href=\"#入侵规范\" class=\"headerlink\" title=\"入侵规范\"></a>入侵规范</h2><h3 id=\"W011-未限制对设备的访问控制规则。\"><a href=\"#W011-未限制对设备的访问控制规则。\" class=\"headerlink\" title=\"W011-未限制对设备的访问控制规则。\"></a>W011-未限制对设备的访问控制规则。</h3><figure class=\"highlight sql\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">---添加允许IP地址连接用户登录数据库(做好记录服务器本地也需要相应IP登录）</span></span><br><span class=\"line\"><span class=\"keyword\">ALTER</span> <span class=\"keyword\">USER</span> &quot;用户名&quot; ALLOW_IP &quot;IP地址&quot;;</span><br><span class=\"line\"><span class=\"comment\">--查看允许登录IP。</span></span><br><span class=\"line\"><span class=\"keyword\">SELECT</span> A.USERNAME,B.LOCK_TIME , b.ALLOW_ADDR <span class=\"keyword\">FROM</span>  ALL_USERS A  ,SYSUSERS B <span class=\"keyword\">WHERE</span> A.USER_ID <span class=\"operator\">=</span>B.ID</span><br></pre></td></tr></table></figure>\n\n<h2 id=\"数据完整性\"><a href=\"#数据完整性\" class=\"headerlink\" title=\"数据完整性\"></a>数据完整性</h2><h3 id=\"W016-未采用密码技术进行通信完整性验证。\"><a href=\"#W016-未采用密码技术进行通信完整性验证。\" class=\"headerlink\" title=\"W016-未采用密码技术进行通信完整性验证。\"></a><span id=\"key1\">W016-未采用密码技术进行通信完整性验证</span>。</h3><figure class=\"highlight sql\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">--使用SSL认证登录需要用户自己提供相关的SSL证书。</span></span><br><span class=\"line\"><span class=\"comment\">--使用配通讯加密算法进行通讯加密(需要重启数据库生效）</span></span><br><span class=\"line\"><span class=\"keyword\">ALTER</span> <span class=\"keyword\">SYSTEM</span> <span class=\"keyword\">SET</span> <span class=\"string\">&#x27;COMM_ENCRYPT_NAME&#x27;</span><span class=\"operator\">=</span><span class=\"string\">&#x27;DES_CFB&#x27;</span> SPFILE;</span><br><span class=\"line\"><span class=\"comment\">--可以使用的加密算法查询</span></span><br><span class=\"line\"><span class=\"keyword\">SELECT</span> <span class=\"operator\">*</span> <span class=\"keyword\">FROM</span> V$CIPHERS;</span><br></pre></td></tr></table></figure>\n\n<h2 id=\"数据保密性\"><a href=\"#数据保密性\" class=\"headerlink\" title=\"数据保密性\"></a>数据保密性</h2><h3 id=\"W018-未对重要数据进行加密传输。\"><a href=\"#W018-未对重要数据进行加密传输。\" class=\"headerlink\" title=\"W018-未对重要数据进行加密传输。\"></a>W018-未对重要数据进行加密传输。</h3><p>参考数据<a href=\"#key1\">完整性-W016</a></p>\n<h3 id=\"W019-未对重要数据进行加密存储。\"><a href=\"#W019-未对重要数据进行加密存储。\" class=\"headerlink\" title=\"W019-未对重要数据进行加密存储。\"></a>W019-未对重要数据进行加密存储。</h3><p>相关重要字段的加密存储参考<a href=\"https://www.alipan.com/s/ktJNZEaNsmr\">数据库安全管理手册</a>（存储加密）</p>\n<h2 id=\"个人信息保护\"><a href=\"#个人信息保护\" class=\"headerlink\" title=\"个人信息保护\"></a>个人信息保护</h2><h3 id=\"W024-数据库对个人信息明文存储。\"><a href=\"#W024-数据库对个人信息明文存储。\" class=\"headerlink\" title=\"W024-数据库对个人信息明文存储。\"></a>W024-数据库对个人信息明文存储。</h3><p>相关重要字段的加密存储参考<a href=\"https://www.alipan.com/s/ktJNZEaNsmr\">数据库安全管理手册</a>（存储加密）</p>\n","excerpt":"<meta name=\"referrer\" content=\"no-referrer\" />","more":"<h2 id=\"身份鉴别\"><a href=\"#身份鉴别\" class=\"headerlink\" title=\"身份鉴别\"></a>身份鉴别</h2><h3 id=\"W001-口令强度策略不够完善。\"><a href=\"#W001-口令强度策略不够完善。\" class=\"headerlink\" title=\"W001-口令强度策略不够完善。\"></a>W001-口令强度策略不够完善。</h3><figure class=\"highlight sql\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">--查看密码策略</span></span><br><span class=\"line\"><span class=\"keyword\">SELECT</span> PARA_NAME ,PARA_VALUE <span class=\"keyword\">FROM</span> V$DM_INI <span class=\"keyword\">WHERE</span> &quot;V$DM_INI&quot;.PARA_NAME <span class=\"operator\">=</span> <span class=\"string\">&#x27;PWD_POLICY&#x27;</span></span><br><span class=\"line\"><span class=\"comment\">--修改密码策略（只针对新的用户生效）  </span></span><br><span class=\"line\"><span class=\"keyword\">ALTER</span> <span class=\"keyword\">SYSTEM</span> <span class=\"keyword\">SET</span> ‘PWD_POLICY’<span class=\"operator\">=</span><span class=\"number\">31</span>  <span class=\"keyword\">BOTH</span>;  </span><br><span class=\"line\"><span class=\"comment\">--- 查看密码过期策略</span></span><br><span class=\"line\"><span class=\"keyword\">SELECT</span> A.USERNAME,B.LIFE_TIME ,GRACE_TIME <span class=\"keyword\">FROM</span>  ALL_USERS A  ,SYSUSERS B <span class=\"keyword\">WHERE</span> A.USER_ID <span class=\"operator\">=</span>B.ID</span><br><span class=\"line\"><span class=\"comment\">--修改密码有效期90天,宽限期30天</span></span><br><span class=\"line\"> <span class=\"keyword\">ALTER</span> <span class=\"keyword\">USER</span>  用户名  LIMIT PASSWORD_LIFE_TIME <span class=\"number\">90</span>, PASSWORD_GRACE_TIME <span class=\"number\">30</span>;  </span><br></pre></td></tr></table></figure>\n\n<h3 id=\"W002-无登录失败处理功能。\"><a href=\"#W002-无登录失败处理功能。\" class=\"headerlink\" title=\"W002-无登录失败处理功能。\"></a>W002-无登录失败处理功能。</h3><figure class=\"highlight sql\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">--查看失败处理策略</span></span><br><span class=\"line\"><span class=\"keyword\">SELECT</span> A.USERNAME,B.LOCK_TIME , b.FAILED_ATTEMPS ,b.CONN_IDLE_TIME <span class=\"keyword\">FROM</span>  ALL_USERS A  ,SYSUSERS B <span class=\"keyword\">WHERE</span> A.USER_ID <span class=\"operator\">=</span>B.ID  </span><br><span class=\"line\"><span class=\"comment\">--修改用户登录失败三次，锁定1分钟，空闲连接时间10分钟</span></span><br><span class=\"line\"><span class=\"keyword\">ALTER</span> <span class=\"keyword\">USER</span> 用户名  LIMIT PASSWORD_LOCK_TIME <span class=\"number\">1</span> , FAILED_LOGIN_ATTEMPS <span class=\"number\">3</span> ,CONNECT_IDLE_TIME <span class=\"number\">10</span>;  </span><br></pre></td></tr></table></figure>\n\n<h3 id=\"W003-远程管理时未采用加密措施。\"><a href=\"#W003-远程管理时未采用加密措施。\" class=\"headerlink\" title=\"W003-远程管理时未采用加密措施。\"></a>W003-远程管理时未采用加密措施。</h3><figure class=\"highlight sql\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">--使用SSL认证登录需要用户自己提供相关的SSL证书。</span></span><br><span class=\"line\"><span class=\"comment\">--使用配通讯加密算法进行通讯加密(需要重启数据库生效）</span></span><br><span class=\"line\"><span class=\"keyword\">ALTER</span> <span class=\"keyword\">SYSTEM</span> <span class=\"keyword\">SET</span> <span class=\"string\">&#x27;COMM_ENCRYPT_NAME&#x27;</span><span class=\"operator\">=</span><span class=\"string\">&#x27;DES_CFB&#x27;</span> SPFILE;</span><br><span class=\"line\"><span class=\"comment\">--可以使用的加密算法查询</span></span><br><span class=\"line\"><span class=\"keyword\">SELECT</span> <span class=\"operator\">*</span> <span class=\"keyword\">FROM</span> V$CIPHERS;</span><br></pre></td></tr></table></figure>\n\n<h2 id=\"访问策略\"><a href=\"#访问策略\" class=\"headerlink\" title=\"访问策略\"></a>访问策略</h2><h3 id=\"W005-未实现操作系统和数据库特权用户权限分离。\"><a href=\"#W005-未实现操作系统和数据库特权用户权限分离。\" class=\"headerlink\" title=\"W005-未实现操作系统和数据库特权用户权限分离。\"></a>W005-未实现操作系统和数据库特权用户权限分离。</h3><figure class=\"highlight sql\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">--创建普通用户语句。</span></span><br><span class=\"line\"><span class=\"keyword\">CREATE</span> <span class=\"keyword\">USER</span> 用户名 IDENTIFIED  <span class=\"keyword\">BY</span> &quot;密码&quot;;</span><br><span class=\"line\"><span class=\"comment\">--授权</span></span><br><span class=\"line\"><span class=\"keyword\">GRANT</span> RESOURCE,PUBLIC,VTI,SOI <span class=\"keyword\">TO</span> 用户;</span><br></pre></td></tr></table></figure>\n\n<h2 id=\"安全审计\"><a href=\"#安全审计\" class=\"headerlink\" title=\"安全审计\"></a>安全审计</h2><blockquote>\n<p>使用SYSAUDITOR账户操作</p>\n</blockquote>\n<h3 id=\"W007-数据库审计开启\"><a href=\"#W007-数据库审计开启\" class=\"headerlink\" title=\"W007-数据库审计开启\"></a>W007-数据库审计开启</h3><figure class=\"highlight sql\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br><span class=\"line\">38</span><br><span class=\"line\">39</span><br><span class=\"line\">40</span><br><span class=\"line\">41</span><br><span class=\"line\">42</span><br><span class=\"line\">43</span><br><span class=\"line\">44</span><br><span class=\"line\">45</span><br><span class=\"line\">46</span><br><span class=\"line\">47</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">--开启数据审计</span></span><br><span class=\"line\">SP_SET_ENABLE_AUDIT (<span class=\"number\">1</span>);</span><br><span class=\"line\"><span class=\"comment\">--添加审计规则(SYSDBA/SYSAUDITOR添加，用户审计、用户实施DDL审计、用户实施DML审计、用户的权限更改审计，相关数据操作员添加，用户审计、用户实施DDL审计、用户的权限更改审计)。</span></span><br><span class=\"line\"><span class=\"comment\">--用户审计</span></span><br><span class=\"line\"><span class=\"comment\">--添加用户创建／修改／删除用户操作的审计</span></span><br><span class=\"line\">SP_AUDIT_STMT(<span class=\"string\">&#x27;USER&#x27;</span>, <span class=\"string\">&#x27;用户名&#x27;</span>, <span class=\"string\">&#x27;ALL&#x27;</span>);</span><br><span class=\"line\"><span class=\"comment\">--添加用户登陆登出的审计</span></span><br><span class=\"line\">SP_AUDIT_STMT(<span class=\"string\">&#x27;CONNECT&#x27;</span>, <span class=\"string\">&#x27;用户名&#x27;</span>, <span class=\"string\">&#x27;ALL&#x27;</span>)</span><br><span class=\"line\"><span class=\"comment\">--用户权限的更改审计</span></span><br><span class=\"line\"><span class=\"comment\">--添加用户回收权限操作</span></span><br><span class=\"line\">SP_AUDIT_STMT(<span class=\"string\">&#x27;REVOKE&#x27;</span>, <span class=\"string\">&#x27;用户名&#x27;</span> , <span class=\"string\">&#x27;ALL&#x27;</span>);</span><br><span class=\"line\"><span class=\"comment\">--添加用户授权授予权限操作</span></span><br><span class=\"line\">SP_AUDIT_STMT(<span class=\"string\">&#x27;GRANT&#x27;</span>, <span class=\"string\">&#x27;用户名&#x27;</span>, <span class=\"string\">&#x27;ALL&#x27;</span>);</span><br><span class=\"line\"><span class=\"comment\">--用户实施DML操作审计</span></span><br><span class=\"line\"><span class=\"comment\">--添加用户表上删除的权限</span></span><br><span class=\"line\">SP_AUDIT_STMT(<span class=\"string\">&#x27;DELETE TABLE&#x27;</span>, <span class=\"string\">&#x27;用户名&#x27;</span>, <span class=\"string\">&#x27;ALL&#x27;</span>);</span><br><span class=\"line\"><span class=\"comment\">--添加用户表上更新的权限</span></span><br><span class=\"line\">SP_AUDIT_STMT(<span class=\"string\">&#x27;UPDATE TABLE&#x27;</span>, <span class=\"string\">&#x27;用户名&#x27;</span>, <span class=\"string\">&#x27;ALL&#x27;</span>);</span><br><span class=\"line\"><span class=\"comment\">--添加用户调用存储过程或函数操作</span></span><br><span class=\"line\">SP_AUDIT_STMT(<span class=\"string\">&#x27;EXECUTE PROCEDURE&#x27;</span>, <span class=\"string\">&#x27;用户名&#x27;</span>, <span class=\"string\">&#x27;ALL&#x27;</span>);</span><br><span class=\"line\"><span class=\"comment\">--添加用户表上查询的权限</span></span><br><span class=\"line\">SP_AUDIT_STMT(<span class=\"string\">&#x27;SELECT TABLE&#x27;</span>, <span class=\"string\">&#x27;用户名&#x27;</span>, <span class=\"string\">&#x27;ALL&#x27;</span>);</span><br><span class=\"line\"><span class=\"comment\">--添加用户表上插入的权限</span></span><br><span class=\"line\">SP_AUDIT_STMT(<span class=\"string\">&#x27;INSERT TABLE&#x27;</span>, <span class=\"string\">&#x27;用户名&#x27;</span>, <span class=\"string\">&#x27;ALL&#x27;</span>);</span><br><span class=\"line\"><span class=\"comment\">--用户实施DDL操作审计</span></span><br><span class=\"line\"><span class=\"comment\">--添加用户创建／删除角色操作</span></span><br><span class=\"line\">SP_AUDIT_STMT(<span class=\"string\">&#x27;ROLE&#x27;</span>, <span class=\"string\">&#x27;用户名&#x27;</span>, <span class=\"string\">&#x27;ALL&#x27;</span>);</span><br><span class=\"line\"><span class=\"comment\">--添加用户创建／删除／设置当前模式操作</span></span><br><span class=\"line\">SP_AUDIT_STMT(<span class=\"string\">&#x27;SCHEMA&#x27;</span>, <span class=\"string\">&#x27;用户名&#x27;</span>, <span class=\"string\">&#x27;ALL&#x27;</span>);</span><br><span class=\"line\"><span class=\"comment\">--添加用户创建／删除包规范</span></span><br><span class=\"line\">SP_AUDIT_STMT(<span class=\"string\">&#x27;PACKAGE&#x27;</span>, <span class=\"string\">&#x27;用户名&#x27;</span>, <span class=\"string\">&#x27;ALL&#x27;</span>);</span><br><span class=\"line\"><span class=\"comment\">--添加用户创建／删除包规范</span></span><br><span class=\"line\">SP_AUDIT_STMT(<span class=\"string\">&#x27;PACKAGE BODY&#x27;</span>, <span class=\"string\">&#x27;用户名&#x27;</span>, <span class=\"string\">&#x27;ALL&#x27;</span>);</span><br><span class=\"line\"><span class=\"comment\">--添加用户创建／修改／删除／清空基表操作</span></span><br><span class=\"line\">SP_AUDIT_STMT(<span class=\"string\">&#x27;TABLE&#x27;</span>, <span class=\"string\">&#x27;用户名&#x27;</span>, <span class=\"string\">&#x27;ALL&#x27;</span>);</span><br><span class=\"line\"><span class=\"comment\">--添加用户创建／删除索引操作</span></span><br><span class=\"line\">SP_AUDIT_STMT(<span class=\"string\">&#x27;INDEX&#x27;</span>, <span class=\"string\">&#x27;用户名&#x27;</span>, <span class=\"string\">&#x27;ALL&#x27;</span>);</span><br><span class=\"line\"><span class=\"comment\">--添加用户创建／修改／删除视图操作</span></span><br><span class=\"line\">SP_AUDIT_STMT(<span class=\"string\">&#x27;VIEW&#x27;</span>, <span class=\"string\">&#x27;用户名&#x27;</span>, <span class=\"string\">&#x27;ALL&#x27;</span>);</span><br><span class=\"line\"><span class=\"comment\">--添加用户创建／修改／删除触发器操作</span></span><br><span class=\"line\">SP_AUDIT_STMT(<span class=\"string\">&#x27;TRIGGER&#x27;</span>, <span class=\"string\">&#x27;用户名&#x27;</span>, <span class=\"string\">&#x27;ALL&#x27;</span>);</span><br><span class=\"line\"><span class=\"comment\">--添加用户创建／修改／删除存储模块操作</span></span><br><span class=\"line\">SP_AUDIT_STMT(<span class=\"string\">&#x27;PROCEDURE&#x27;</span>, <span class=\"string\">&#x27;用户名&#x27;</span>, <span class=\"string\">&#x27;ALL&#x27;</span>);</span><br><span class=\"line\"><span class=\"comment\">--添加用户创建／修改／删除全文索引操作</span></span><br><span class=\"line\">SP_AUDIT_STMT(<span class=\"string\">&#x27;CONTEXT&#x27;</span>, <span class=\"string\">&#x27;用户名&#x27;</span>, <span class=\"string\">&#x27;ALL&#x27;</span>);</span><br><span class=\"line\"><span class=\"comment\">--添加用户创建／修改/删除序列操作</span></span><br><span class=\"line\">SP_AUDIT_STMT(<span class=\"string\">&#x27;SEQUENCE&#x27;</span>, <span class=\"string\">&#x27;用户名&#x27;</span>, <span class=\"string\">&#x27;ALL&#x27;</span>);</span><br></pre></td></tr></table></figure>\n\n<h3 id=\"W008-数据库审计日志查看\"><a href=\"#W008-数据库审计日志查看\" class=\"headerlink\" title=\"W008-数据库审计日志查看\"></a>W008-数据库审计日志查看</h3><figure class=\"highlight sql\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">--查看审计日志</span></span><br><span class=\"line\"><span class=\"keyword\">SELECT</span> <span class=\"operator\">*</span> <span class=\"keyword\">FROM</span> &quot;SYSAUDITOR&quot;.&quot;V$AUDITRECORDS&quot;;</span><br></pre></td></tr></table></figure>\n\n<h3 id=\"W009-审计日志文件定时备份\"><a href=\"#W009-审计日志文件定时备份\" class=\"headerlink\" title=\"W009-审计日志文件定时备份\"></a>W009-审计日志文件定时备份</h3><figure class=\"highlight sql\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">--本地磁盘空间充足，可以保留180天。</span></span><br><span class=\"line\"><span class=\"comment\">--备份通过操作系统命令定时将数据库实例目录下AUDIT开头的日志文件拷贝走。</span></span><br><span class=\"line\"><span class=\"comment\">--审计日志路径（默认数据库实例目录）</span></span><br><span class=\"line\"><span class=\"keyword\">SELECT</span> <span class=\"operator\">*</span> <span class=\"keyword\">FROM</span> V$DM_INI <span class=\"keyword\">WHERE</span> &quot;V$DM_INI&quot;.PARA_NAME <span class=\"keyword\">LIKE</span> <span class=\"string\">&#x27;AUD_PATH%&#x27;</span></span><br></pre></td></tr></table></figure>\n\n<h2 id=\"入侵规范\"><a href=\"#入侵规范\" class=\"headerlink\" title=\"入侵规范\"></a>入侵规范</h2><h3 id=\"W011-未限制对设备的访问控制规则。\"><a href=\"#W011-未限制对设备的访问控制规则。\" class=\"headerlink\" title=\"W011-未限制对设备的访问控制规则。\"></a>W011-未限制对设备的访问控制规则。</h3><figure class=\"highlight sql\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">---添加允许IP地址连接用户登录数据库(做好记录服务器本地也需要相应IP登录）</span></span><br><span class=\"line\"><span class=\"keyword\">ALTER</span> <span class=\"keyword\">USER</span> &quot;用户名&quot; ALLOW_IP &quot;IP地址&quot;;</span><br><span class=\"line\"><span class=\"comment\">--查看允许登录IP。</span></span><br><span class=\"line\"><span class=\"keyword\">SELECT</span> A.USERNAME,B.LOCK_TIME , b.ALLOW_ADDR <span class=\"keyword\">FROM</span>  ALL_USERS A  ,SYSUSERS B <span class=\"keyword\">WHERE</span> A.USER_ID <span class=\"operator\">=</span>B.ID</span><br></pre></td></tr></table></figure>\n\n<h2 id=\"数据完整性\"><a href=\"#数据完整性\" class=\"headerlink\" title=\"数据完整性\"></a>数据完整性</h2><h3 id=\"W016-未采用密码技术进行通信完整性验证。\"><a href=\"#W016-未采用密码技术进行通信完整性验证。\" class=\"headerlink\" title=\"W016-未采用密码技术进行通信完整性验证。\"></a><span id=\"key1\">W016-未采用密码技术进行通信完整性验证</span>。</h3><figure class=\"highlight sql\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">--使用SSL认证登录需要用户自己提供相关的SSL证书。</span></span><br><span class=\"line\"><span class=\"comment\">--使用配通讯加密算法进行通讯加密(需要重启数据库生效）</span></span><br><span class=\"line\"><span class=\"keyword\">ALTER</span> <span class=\"keyword\">SYSTEM</span> <span class=\"keyword\">SET</span> <span class=\"string\">&#x27;COMM_ENCRYPT_NAME&#x27;</span><span class=\"operator\">=</span><span class=\"string\">&#x27;DES_CFB&#x27;</span> SPFILE;</span><br><span class=\"line\"><span class=\"comment\">--可以使用的加密算法查询</span></span><br><span class=\"line\"><span class=\"keyword\">SELECT</span> <span class=\"operator\">*</span> <span class=\"keyword\">FROM</span> V$CIPHERS;</span><br></pre></td></tr></table></figure>\n\n<h2 id=\"数据保密性\"><a href=\"#数据保密性\" class=\"headerlink\" title=\"数据保密性\"></a>数据保密性</h2><h3 id=\"W018-未对重要数据进行加密传输。\"><a href=\"#W018-未对重要数据进行加密传输。\" class=\"headerlink\" title=\"W018-未对重要数据进行加密传输。\"></a>W018-未对重要数据进行加密传输。</h3><p>参考数据<a href=\"#key1\">完整性-W016</a></p>\n<h3 id=\"W019-未对重要数据进行加密存储。\"><a href=\"#W019-未对重要数据进行加密存储。\" class=\"headerlink\" title=\"W019-未对重要数据进行加密存储。\"></a>W019-未对重要数据进行加密存储。</h3><p>相关重要字段的加密存储参考<a href=\"https://www.alipan.com/s/ktJNZEaNsmr\">数据库安全管理手册</a>（存储加密）</p>\n<h2 id=\"个人信息保护\"><a href=\"#个人信息保护\" class=\"headerlink\" title=\"个人信息保护\"></a>个人信息保护</h2><h3 id=\"W024-数据库对个人信息明文存储。\"><a href=\"#W024-数据库对个人信息明文存储。\" class=\"headerlink\" title=\"W024-数据库对个人信息明文存储。\"></a>W024-数据库对个人信息明文存储。</h3><p>相关重要字段的加密存储参考<a href=\"https://www.alipan.com/s/ktJNZEaNsmr\">数据库安全管理手册</a>（存储加密）</p>"},{"title":"达梦查询分页排序问题","abbrlink":"e057bf2e","date":"2023-06-08T14:00:55.000Z","toc":true,"_content":"<meta name=\"referrer\" content=\"no-referrer\" />\n\n<!--more-->\n\n## 问题复现\n\n- 环境：达梦7\n\n查询SQL如下\n\n```sql\nSELECT\nid,\nduty_date,\nduty_leader,\nduty_leader_id,\nduty_week,\nday_people,\nday_people_id,\nnight_people,\nnight_people_id,\ndriver_people,\nis_work,\nISNULL( ( SELECT COUNT ( id ) FROM T_OA_DUTY_PRINT_LOG WHERE is_print = '1' AND duty_id = t1.id AND created_by = 'a5051dc718b942eb876e967836ec2953' GROUP BY duty_id ), 0 ) AS PRINT_COUNT \nFROM\nT_OA_DUTY_PRINT AS t1 \nWHERE\n1 = 1 \nORDER BY\nSUBSTR ( t1.duty_date, 0, 7 ) DESC,\nduty_date ASC\n```\n\n发现数据库的查询结果数据是正确的\n\n![](http://qiniu-image.gotojava.cn/blog/2023-12-15-191114.png)\n\n但页面返回的数据排序是有问题的\n\n![](http://qiniu-image.gotojava.cn/blog/2023-12-15-191117.png)\n\n## 问题分析\n\n通过跟踪和调试，发现处理的逻辑拼接了以下代码\n\n![](http://qiniu-image.gotojava.cn/blog/2023-12-15-191122.png)\n\n那么拼接后的SQL就是这样\n\n![](http://qiniu-image.gotojava.cn/blog/2023-12-15-191125.png)\n\n```sql\nSELECT\n\t* \nFROM\n\t(\n\tSELECT\n\t\trownum rn,\n\t\tid,\n\t\tduty_date,\n\t\tduty_leader,\n\t\tduty_leader_id,\n\t\tduty_week,\n\t\tday_people,\n\t\tday_people_id,\n\t\tnight_people,\n\t\tnight_people_id,\n\t\tdriver_people,\n\t\tis_work,\n\t\tISNULL( ( SELECT COUNT ( id ) FROM T_OA_DUTY_PRINT_LOG WHERE is_print = '1' AND duty_id = t1.id AND created_by = 'a5051dc718b942eb876e967836ec2953' GROUP BY duty_id ), 0 ) AS PRINT_COUNT \n\tFROM\n\t\tT_OA_DUTY_PRINT AS t1 \n\tWHERE\n\t\t1 = 1 \n\tORDER BY\n\t\tSUBSTR ( t1.duty_date, 0, 7 ) DESC,\n\t\tduty_date ASC \n\t) template \nWHERE\n\ttemplate.rn> 0 \n\tAND template.rn<= 20\n```\n\n![](http://qiniu-image.gotojava.cn/blog/2023-12-15-191129.png)\n\n也就是查询后的数据的**ROWNUM**的值并没有被重新排序，那么由根据ROWNUM进行分页，数据的排序自然就不对了。\n\n## 解决方式\n\n```sql\nSELECT\n\tROWNUM rn,tmp.*\nFROM\n\t(\n\tSELECT\n\t\tid,\n\t\tduty_date,\n\t\tduty_leader,\n\t\tduty_leader_id,\n\t\tduty_week,\n\t\tday_people,\n\t\tday_people_id,\n\t\tnight_people,\n\t\tnight_people_id,\n\t\tdriver_people,\n\t\tis_work,\n\t\tISNULL( ( SELECT COUNT ( id ) FROM T_OA_DUTY_PRINT_LOG WHERE is_print = '1' AND duty_id = t1.id AND created_by = 'a5051dc718b942eb876e967836ec2953' GROUP BY duty_id ), 0 ) AS PRINT_COUNT \n\tFROM\n\t\tT_OA_DUTY_PRINT AS t1 \n\tWHERE\n\t\t1 = 1 \n\tORDER BY\n\t\tSUBSTR ( t1.duty_date, 0, 7 ) DESC,\n\tduty_date ASC \n\t) AS tmp\n```\n\n![image.png](http://qiniu-image.gotojava.cn/blog/2023-12-15-191131.png)\n\n## 参考\n\n- <a href=\"https://blog.csdn.net/github_34013496/article/details/74938788\">`Oracle数据库中分页排序 `</a>\n","source":"_posts/达梦查询分页排序问题.md","raw":"---\ntitle: 达梦查询分页排序问题\ncategories:\n  - 开发者笔记\ntags:\n  - 达梦数据库\nabbrlink: e057bf2e\ndate: 2023-06-08 14:00:55\ntoc: true\n---\n<meta name=\"referrer\" content=\"no-referrer\" />\n\n<!--more-->\n\n## 问题复现\n\n- 环境：达梦7\n\n查询SQL如下\n\n```sql\nSELECT\nid,\nduty_date,\nduty_leader,\nduty_leader_id,\nduty_week,\nday_people,\nday_people_id,\nnight_people,\nnight_people_id,\ndriver_people,\nis_work,\nISNULL( ( SELECT COUNT ( id ) FROM T_OA_DUTY_PRINT_LOG WHERE is_print = '1' AND duty_id = t1.id AND created_by = 'a5051dc718b942eb876e967836ec2953' GROUP BY duty_id ), 0 ) AS PRINT_COUNT \nFROM\nT_OA_DUTY_PRINT AS t1 \nWHERE\n1 = 1 \nORDER BY\nSUBSTR ( t1.duty_date, 0, 7 ) DESC,\nduty_date ASC\n```\n\n发现数据库的查询结果数据是正确的\n\n![](http://qiniu-image.gotojava.cn/blog/2023-12-15-191114.png)\n\n但页面返回的数据排序是有问题的\n\n![](http://qiniu-image.gotojava.cn/blog/2023-12-15-191117.png)\n\n## 问题分析\n\n通过跟踪和调试，发现处理的逻辑拼接了以下代码\n\n![](http://qiniu-image.gotojava.cn/blog/2023-12-15-191122.png)\n\n那么拼接后的SQL就是这样\n\n![](http://qiniu-image.gotojava.cn/blog/2023-12-15-191125.png)\n\n```sql\nSELECT\n\t* \nFROM\n\t(\n\tSELECT\n\t\trownum rn,\n\t\tid,\n\t\tduty_date,\n\t\tduty_leader,\n\t\tduty_leader_id,\n\t\tduty_week,\n\t\tday_people,\n\t\tday_people_id,\n\t\tnight_people,\n\t\tnight_people_id,\n\t\tdriver_people,\n\t\tis_work,\n\t\tISNULL( ( SELECT COUNT ( id ) FROM T_OA_DUTY_PRINT_LOG WHERE is_print = '1' AND duty_id = t1.id AND created_by = 'a5051dc718b942eb876e967836ec2953' GROUP BY duty_id ), 0 ) AS PRINT_COUNT \n\tFROM\n\t\tT_OA_DUTY_PRINT AS t1 \n\tWHERE\n\t\t1 = 1 \n\tORDER BY\n\t\tSUBSTR ( t1.duty_date, 0, 7 ) DESC,\n\t\tduty_date ASC \n\t) template \nWHERE\n\ttemplate.rn> 0 \n\tAND template.rn<= 20\n```\n\n![](http://qiniu-image.gotojava.cn/blog/2023-12-15-191129.png)\n\n也就是查询后的数据的**ROWNUM**的值并没有被重新排序，那么由根据ROWNUM进行分页，数据的排序自然就不对了。\n\n## 解决方式\n\n```sql\nSELECT\n\tROWNUM rn,tmp.*\nFROM\n\t(\n\tSELECT\n\t\tid,\n\t\tduty_date,\n\t\tduty_leader,\n\t\tduty_leader_id,\n\t\tduty_week,\n\t\tday_people,\n\t\tday_people_id,\n\t\tnight_people,\n\t\tnight_people_id,\n\t\tdriver_people,\n\t\tis_work,\n\t\tISNULL( ( SELECT COUNT ( id ) FROM T_OA_DUTY_PRINT_LOG WHERE is_print = '1' AND duty_id = t1.id AND created_by = 'a5051dc718b942eb876e967836ec2953' GROUP BY duty_id ), 0 ) AS PRINT_COUNT \n\tFROM\n\t\tT_OA_DUTY_PRINT AS t1 \n\tWHERE\n\t\t1 = 1 \n\tORDER BY\n\t\tSUBSTR ( t1.duty_date, 0, 7 ) DESC,\n\tduty_date ASC \n\t) AS tmp\n```\n\n![image.png](http://qiniu-image.gotojava.cn/blog/2023-12-15-191131.png)\n\n## 参考\n\n- <a href=\"https://blog.csdn.net/github_34013496/article/details/74938788\">`Oracle数据库中分页排序 `</a>\n","slug":"达梦查询分页排序问题","published":1,"updated":"2025-03-28T06:12:53.374Z","comments":1,"layout":"post","photos":[],"_id":"cm8se3te1001zbb8l6uhe2peo","content":"<meta name=\"referrer\" content=\"no-referrer\" />\n\n<span id=\"more\"></span>\n\n<h2 id=\"问题复现\"><a href=\"#问题复现\" class=\"headerlink\" title=\"问题复现\"></a>问题复现</h2><ul>\n<li>环境：达梦7</li>\n</ul>\n<p>查询SQL如下</p>\n<figure class=\"highlight sql\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">SELECT</span></span><br><span class=\"line\">id,</span><br><span class=\"line\">duty_date,</span><br><span class=\"line\">duty_leader,</span><br><span class=\"line\">duty_leader_id,</span><br><span class=\"line\">duty_week,</span><br><span class=\"line\">day_people,</span><br><span class=\"line\">day_people_id,</span><br><span class=\"line\">night_people,</span><br><span class=\"line\">night_people_id,</span><br><span class=\"line\">driver_people,</span><br><span class=\"line\">is_work,</span><br><span class=\"line\">ISNULL( ( <span class=\"keyword\">SELECT</span> <span class=\"built_in\">COUNT</span> ( id ) <span class=\"keyword\">FROM</span> T_OA_DUTY_PRINT_LOG <span class=\"keyword\">WHERE</span> is_print <span class=\"operator\">=</span> <span class=\"string\">&#x27;1&#x27;</span> <span class=\"keyword\">AND</span> duty_id <span class=\"operator\">=</span> t1.id <span class=\"keyword\">AND</span> created_by <span class=\"operator\">=</span> <span class=\"string\">&#x27;a5051dc718b942eb876e967836ec2953&#x27;</span> <span class=\"keyword\">GROUP</span> <span class=\"keyword\">BY</span> duty_id ), <span class=\"number\">0</span> ) <span class=\"keyword\">AS</span> PRINT_COUNT </span><br><span class=\"line\"><span class=\"keyword\">FROM</span></span><br><span class=\"line\">T_OA_DUTY_PRINT <span class=\"keyword\">AS</span> t1 </span><br><span class=\"line\"><span class=\"keyword\">WHERE</span></span><br><span class=\"line\"><span class=\"number\">1</span> <span class=\"operator\">=</span> <span class=\"number\">1</span> </span><br><span class=\"line\"><span class=\"keyword\">ORDER</span> <span class=\"keyword\">BY</span></span><br><span class=\"line\">SUBSTR ( t1.duty_date, <span class=\"number\">0</span>, <span class=\"number\">7</span> ) <span class=\"keyword\">DESC</span>,</span><br><span class=\"line\">duty_date <span class=\"keyword\">ASC</span></span><br></pre></td></tr></table></figure>\n\n<p>发现数据库的查询结果数据是正确的</p>\n<p><img src=\"http://qiniu-image.gotojava.cn/blog/2023-12-15-191114.png\"></p>\n<p>但页面返回的数据排序是有问题的</p>\n<p><img src=\"http://qiniu-image.gotojava.cn/blog/2023-12-15-191117.png\"></p>\n<h2 id=\"问题分析\"><a href=\"#问题分析\" class=\"headerlink\" title=\"问题分析\"></a>问题分析</h2><p>通过跟踪和调试，发现处理的逻辑拼接了以下代码</p>\n<p><img src=\"http://qiniu-image.gotojava.cn/blog/2023-12-15-191122.png\"></p>\n<p>那么拼接后的SQL就是这样</p>\n<p><img src=\"http://qiniu-image.gotojava.cn/blog/2023-12-15-191125.png\"></p>\n<figure class=\"highlight sql\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">SELECT</span></span><br><span class=\"line\">\t<span class=\"operator\">*</span> </span><br><span class=\"line\"><span class=\"keyword\">FROM</span></span><br><span class=\"line\">\t(</span><br><span class=\"line\">\t<span class=\"keyword\">SELECT</span></span><br><span class=\"line\">\t\trownum rn,</span><br><span class=\"line\">\t\tid,</span><br><span class=\"line\">\t\tduty_date,</span><br><span class=\"line\">\t\tduty_leader,</span><br><span class=\"line\">\t\tduty_leader_id,</span><br><span class=\"line\">\t\tduty_week,</span><br><span class=\"line\">\t\tday_people,</span><br><span class=\"line\">\t\tday_people_id,</span><br><span class=\"line\">\t\tnight_people,</span><br><span class=\"line\">\t\tnight_people_id,</span><br><span class=\"line\">\t\tdriver_people,</span><br><span class=\"line\">\t\tis_work,</span><br><span class=\"line\">\t\tISNULL( ( <span class=\"keyword\">SELECT</span> <span class=\"built_in\">COUNT</span> ( id ) <span class=\"keyword\">FROM</span> T_OA_DUTY_PRINT_LOG <span class=\"keyword\">WHERE</span> is_print <span class=\"operator\">=</span> <span class=\"string\">&#x27;1&#x27;</span> <span class=\"keyword\">AND</span> duty_id <span class=\"operator\">=</span> t1.id <span class=\"keyword\">AND</span> created_by <span class=\"operator\">=</span> <span class=\"string\">&#x27;a5051dc718b942eb876e967836ec2953&#x27;</span> <span class=\"keyword\">GROUP</span> <span class=\"keyword\">BY</span> duty_id ), <span class=\"number\">0</span> ) <span class=\"keyword\">AS</span> PRINT_COUNT </span><br><span class=\"line\">\t<span class=\"keyword\">FROM</span></span><br><span class=\"line\">\t\tT_OA_DUTY_PRINT <span class=\"keyword\">AS</span> t1 </span><br><span class=\"line\">\t<span class=\"keyword\">WHERE</span></span><br><span class=\"line\">\t\t<span class=\"number\">1</span> <span class=\"operator\">=</span> <span class=\"number\">1</span> </span><br><span class=\"line\">\t<span class=\"keyword\">ORDER</span> <span class=\"keyword\">BY</span></span><br><span class=\"line\">\t\tSUBSTR ( t1.duty_date, <span class=\"number\">0</span>, <span class=\"number\">7</span> ) <span class=\"keyword\">DESC</span>,</span><br><span class=\"line\">\t\tduty_date <span class=\"keyword\">ASC</span> </span><br><span class=\"line\">\t) template </span><br><span class=\"line\"><span class=\"keyword\">WHERE</span></span><br><span class=\"line\">\ttemplate.rn<span class=\"operator\">&gt;</span> <span class=\"number\">0</span> </span><br><span class=\"line\">\t<span class=\"keyword\">AND</span> template.rn<span class=\"operator\">&lt;=</span> <span class=\"number\">20</span></span><br></pre></td></tr></table></figure>\n\n<p><img src=\"http://qiniu-image.gotojava.cn/blog/2023-12-15-191129.png\"></p>\n<p>也就是查询后的数据的<strong>ROWNUM</strong>的值并没有被重新排序，那么由根据ROWNUM进行分页，数据的排序自然就不对了。</p>\n<h2 id=\"解决方式\"><a href=\"#解决方式\" class=\"headerlink\" title=\"解决方式\"></a>解决方式</h2><figure class=\"highlight sql\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">SELECT</span></span><br><span class=\"line\">\tROWNUM rn,tmp.<span class=\"operator\">*</span></span><br><span class=\"line\"><span class=\"keyword\">FROM</span></span><br><span class=\"line\">\t(</span><br><span class=\"line\">\t<span class=\"keyword\">SELECT</span></span><br><span class=\"line\">\t\tid,</span><br><span class=\"line\">\t\tduty_date,</span><br><span class=\"line\">\t\tduty_leader,</span><br><span class=\"line\">\t\tduty_leader_id,</span><br><span class=\"line\">\t\tduty_week,</span><br><span class=\"line\">\t\tday_people,</span><br><span class=\"line\">\t\tday_people_id,</span><br><span class=\"line\">\t\tnight_people,</span><br><span class=\"line\">\t\tnight_people_id,</span><br><span class=\"line\">\t\tdriver_people,</span><br><span class=\"line\">\t\tis_work,</span><br><span class=\"line\">\t\tISNULL( ( <span class=\"keyword\">SELECT</span> <span class=\"built_in\">COUNT</span> ( id ) <span class=\"keyword\">FROM</span> T_OA_DUTY_PRINT_LOG <span class=\"keyword\">WHERE</span> is_print <span class=\"operator\">=</span> <span class=\"string\">&#x27;1&#x27;</span> <span class=\"keyword\">AND</span> duty_id <span class=\"operator\">=</span> t1.id <span class=\"keyword\">AND</span> created_by <span class=\"operator\">=</span> <span class=\"string\">&#x27;a5051dc718b942eb876e967836ec2953&#x27;</span> <span class=\"keyword\">GROUP</span> <span class=\"keyword\">BY</span> duty_id ), <span class=\"number\">0</span> ) <span class=\"keyword\">AS</span> PRINT_COUNT </span><br><span class=\"line\">\t<span class=\"keyword\">FROM</span></span><br><span class=\"line\">\t\tT_OA_DUTY_PRINT <span class=\"keyword\">AS</span> t1 </span><br><span class=\"line\">\t<span class=\"keyword\">WHERE</span></span><br><span class=\"line\">\t\t<span class=\"number\">1</span> <span class=\"operator\">=</span> <span class=\"number\">1</span> </span><br><span class=\"line\">\t<span class=\"keyword\">ORDER</span> <span class=\"keyword\">BY</span></span><br><span class=\"line\">\t\tSUBSTR ( t1.duty_date, <span class=\"number\">0</span>, <span class=\"number\">7</span> ) <span class=\"keyword\">DESC</span>,</span><br><span class=\"line\">\tduty_date <span class=\"keyword\">ASC</span> </span><br><span class=\"line\">\t) <span class=\"keyword\">AS</span> tmp</span><br></pre></td></tr></table></figure>\n\n<p><img src=\"http://qiniu-image.gotojava.cn/blog/2023-12-15-191131.png\" alt=\"image.png\"></p>\n<h2 id=\"参考\"><a href=\"#参考\" class=\"headerlink\" title=\"参考\"></a>参考</h2><ul>\n<li><a href=\"https://blog.csdn.net/github_34013496/article/details/74938788\"><code>Oracle数据库中分页排序 </code></a></li>\n</ul>\n","excerpt":"<meta name=\"referrer\" content=\"no-referrer\" />","more":"<h2 id=\"问题复现\"><a href=\"#问题复现\" class=\"headerlink\" title=\"问题复现\"></a>问题复现</h2><ul>\n<li>环境：达梦7</li>\n</ul>\n<p>查询SQL如下</p>\n<figure class=\"highlight sql\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">SELECT</span></span><br><span class=\"line\">id,</span><br><span class=\"line\">duty_date,</span><br><span class=\"line\">duty_leader,</span><br><span class=\"line\">duty_leader_id,</span><br><span class=\"line\">duty_week,</span><br><span class=\"line\">day_people,</span><br><span class=\"line\">day_people_id,</span><br><span class=\"line\">night_people,</span><br><span class=\"line\">night_people_id,</span><br><span class=\"line\">driver_people,</span><br><span class=\"line\">is_work,</span><br><span class=\"line\">ISNULL( ( <span class=\"keyword\">SELECT</span> <span class=\"built_in\">COUNT</span> ( id ) <span class=\"keyword\">FROM</span> T_OA_DUTY_PRINT_LOG <span class=\"keyword\">WHERE</span> is_print <span class=\"operator\">=</span> <span class=\"string\">&#x27;1&#x27;</span> <span class=\"keyword\">AND</span> duty_id <span class=\"operator\">=</span> t1.id <span class=\"keyword\">AND</span> created_by <span class=\"operator\">=</span> <span class=\"string\">&#x27;a5051dc718b942eb876e967836ec2953&#x27;</span> <span class=\"keyword\">GROUP</span> <span class=\"keyword\">BY</span> duty_id ), <span class=\"number\">0</span> ) <span class=\"keyword\">AS</span> PRINT_COUNT </span><br><span class=\"line\"><span class=\"keyword\">FROM</span></span><br><span class=\"line\">T_OA_DUTY_PRINT <span class=\"keyword\">AS</span> t1 </span><br><span class=\"line\"><span class=\"keyword\">WHERE</span></span><br><span class=\"line\"><span class=\"number\">1</span> <span class=\"operator\">=</span> <span class=\"number\">1</span> </span><br><span class=\"line\"><span class=\"keyword\">ORDER</span> <span class=\"keyword\">BY</span></span><br><span class=\"line\">SUBSTR ( t1.duty_date, <span class=\"number\">0</span>, <span class=\"number\">7</span> ) <span class=\"keyword\">DESC</span>,</span><br><span class=\"line\">duty_date <span class=\"keyword\">ASC</span></span><br></pre></td></tr></table></figure>\n\n<p>发现数据库的查询结果数据是正确的</p>\n<p><img src=\"http://qiniu-image.gotojava.cn/blog/2023-12-15-191114.png\"></p>\n<p>但页面返回的数据排序是有问题的</p>\n<p><img src=\"http://qiniu-image.gotojava.cn/blog/2023-12-15-191117.png\"></p>\n<h2 id=\"问题分析\"><a href=\"#问题分析\" class=\"headerlink\" title=\"问题分析\"></a>问题分析</h2><p>通过跟踪和调试，发现处理的逻辑拼接了以下代码</p>\n<p><img src=\"http://qiniu-image.gotojava.cn/blog/2023-12-15-191122.png\"></p>\n<p>那么拼接后的SQL就是这样</p>\n<p><img src=\"http://qiniu-image.gotojava.cn/blog/2023-12-15-191125.png\"></p>\n<figure class=\"highlight sql\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">SELECT</span></span><br><span class=\"line\">\t<span class=\"operator\">*</span> </span><br><span class=\"line\"><span class=\"keyword\">FROM</span></span><br><span class=\"line\">\t(</span><br><span class=\"line\">\t<span class=\"keyword\">SELECT</span></span><br><span class=\"line\">\t\trownum rn,</span><br><span class=\"line\">\t\tid,</span><br><span class=\"line\">\t\tduty_date,</span><br><span class=\"line\">\t\tduty_leader,</span><br><span class=\"line\">\t\tduty_leader_id,</span><br><span class=\"line\">\t\tduty_week,</span><br><span class=\"line\">\t\tday_people,</span><br><span class=\"line\">\t\tday_people_id,</span><br><span class=\"line\">\t\tnight_people,</span><br><span class=\"line\">\t\tnight_people_id,</span><br><span class=\"line\">\t\tdriver_people,</span><br><span class=\"line\">\t\tis_work,</span><br><span class=\"line\">\t\tISNULL( ( <span class=\"keyword\">SELECT</span> <span class=\"built_in\">COUNT</span> ( id ) <span class=\"keyword\">FROM</span> T_OA_DUTY_PRINT_LOG <span class=\"keyword\">WHERE</span> is_print <span class=\"operator\">=</span> <span class=\"string\">&#x27;1&#x27;</span> <span class=\"keyword\">AND</span> duty_id <span class=\"operator\">=</span> t1.id <span class=\"keyword\">AND</span> created_by <span class=\"operator\">=</span> <span class=\"string\">&#x27;a5051dc718b942eb876e967836ec2953&#x27;</span> <span class=\"keyword\">GROUP</span> <span class=\"keyword\">BY</span> duty_id ), <span class=\"number\">0</span> ) <span class=\"keyword\">AS</span> PRINT_COUNT </span><br><span class=\"line\">\t<span class=\"keyword\">FROM</span></span><br><span class=\"line\">\t\tT_OA_DUTY_PRINT <span class=\"keyword\">AS</span> t1 </span><br><span class=\"line\">\t<span class=\"keyword\">WHERE</span></span><br><span class=\"line\">\t\t<span class=\"number\">1</span> <span class=\"operator\">=</span> <span class=\"number\">1</span> </span><br><span class=\"line\">\t<span class=\"keyword\">ORDER</span> <span class=\"keyword\">BY</span></span><br><span class=\"line\">\t\tSUBSTR ( t1.duty_date, <span class=\"number\">0</span>, <span class=\"number\">7</span> ) <span class=\"keyword\">DESC</span>,</span><br><span class=\"line\">\t\tduty_date <span class=\"keyword\">ASC</span> </span><br><span class=\"line\">\t) template </span><br><span class=\"line\"><span class=\"keyword\">WHERE</span></span><br><span class=\"line\">\ttemplate.rn<span class=\"operator\">&gt;</span> <span class=\"number\">0</span> </span><br><span class=\"line\">\t<span class=\"keyword\">AND</span> template.rn<span class=\"operator\">&lt;=</span> <span class=\"number\">20</span></span><br></pre></td></tr></table></figure>\n\n<p><img src=\"http://qiniu-image.gotojava.cn/blog/2023-12-15-191129.png\"></p>\n<p>也就是查询后的数据的<strong>ROWNUM</strong>的值并没有被重新排序，那么由根据ROWNUM进行分页，数据的排序自然就不对了。</p>\n<h2 id=\"解决方式\"><a href=\"#解决方式\" class=\"headerlink\" title=\"解决方式\"></a>解决方式</h2><figure class=\"highlight sql\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">SELECT</span></span><br><span class=\"line\">\tROWNUM rn,tmp.<span class=\"operator\">*</span></span><br><span class=\"line\"><span class=\"keyword\">FROM</span></span><br><span class=\"line\">\t(</span><br><span class=\"line\">\t<span class=\"keyword\">SELECT</span></span><br><span class=\"line\">\t\tid,</span><br><span class=\"line\">\t\tduty_date,</span><br><span class=\"line\">\t\tduty_leader,</span><br><span class=\"line\">\t\tduty_leader_id,</span><br><span class=\"line\">\t\tduty_week,</span><br><span class=\"line\">\t\tday_people,</span><br><span class=\"line\">\t\tday_people_id,</span><br><span class=\"line\">\t\tnight_people,</span><br><span class=\"line\">\t\tnight_people_id,</span><br><span class=\"line\">\t\tdriver_people,</span><br><span class=\"line\">\t\tis_work,</span><br><span class=\"line\">\t\tISNULL( ( <span class=\"keyword\">SELECT</span> <span class=\"built_in\">COUNT</span> ( id ) <span class=\"keyword\">FROM</span> T_OA_DUTY_PRINT_LOG <span class=\"keyword\">WHERE</span> is_print <span class=\"operator\">=</span> <span class=\"string\">&#x27;1&#x27;</span> <span class=\"keyword\">AND</span> duty_id <span class=\"operator\">=</span> t1.id <span class=\"keyword\">AND</span> created_by <span class=\"operator\">=</span> <span class=\"string\">&#x27;a5051dc718b942eb876e967836ec2953&#x27;</span> <span class=\"keyword\">GROUP</span> <span class=\"keyword\">BY</span> duty_id ), <span class=\"number\">0</span> ) <span class=\"keyword\">AS</span> PRINT_COUNT </span><br><span class=\"line\">\t<span class=\"keyword\">FROM</span></span><br><span class=\"line\">\t\tT_OA_DUTY_PRINT <span class=\"keyword\">AS</span> t1 </span><br><span class=\"line\">\t<span class=\"keyword\">WHERE</span></span><br><span class=\"line\">\t\t<span class=\"number\">1</span> <span class=\"operator\">=</span> <span class=\"number\">1</span> </span><br><span class=\"line\">\t<span class=\"keyword\">ORDER</span> <span class=\"keyword\">BY</span></span><br><span class=\"line\">\t\tSUBSTR ( t1.duty_date, <span class=\"number\">0</span>, <span class=\"number\">7</span> ) <span class=\"keyword\">DESC</span>,</span><br><span class=\"line\">\tduty_date <span class=\"keyword\">ASC</span> </span><br><span class=\"line\">\t) <span class=\"keyword\">AS</span> tmp</span><br></pre></td></tr></table></figure>\n\n<p><img src=\"http://qiniu-image.gotojava.cn/blog/2023-12-15-191131.png\" alt=\"image.png\"></p>\n<h2 id=\"参考\"><a href=\"#参考\" class=\"headerlink\" title=\"参考\"></a>参考</h2><ul>\n<li><a href=\"https://blog.csdn.net/github_34013496/article/details/74938788\"><code>Oracle数据库中分页排序 </code></a></li>\n</ul>"}],"PostAsset":[],"PostCategory":[{"post_id":"cm8se3tdb0009bb8lh3zr5mcy","category_id":"cm8se3td50004bb8l2krgd4gg","_id":"cm8se3tdh000gbb8l3x75ffq5"},{"post_id":"cm8se3td00001bb8l3h2984qz","category_id":"cm8se3td50004bb8l2krgd4gg","_id":"cm8se3tdi000kbb8l0rqu57y4"},{"post_id":"cm8se3tdc000abb8lalv5hcty","category_id":"cm8se3td50004bb8l2krgd4gg","_id":"cm8se3tdj000nbb8l25l69w8e"},{"post_id":"cm8se3tdf000ebb8lagkb4iih","category_id":"cm8se3td50004bb8l2krgd4gg","_id":"cm8se3tdk000qbb8lcphw5mtu"},{"post_id":"cm8se3td70007bb8l0lrd3fem","category_id":"cm8se3td50004bb8l2krgd4gg","_id":"cm8se3tdl000tbb8l02he1f4r"},{"post_id":"cm8se3tdj000mbb8le3mubqxt","category_id":"cm8se3td50004bb8l2krgd4gg","_id":"cm8se3tdn000xbb8ldkmuc5bz"},{"post_id":"cm8se3tdk000pbb8l4mx8gqx4","category_id":"cm8se3td50004bb8l2krgd4gg","_id":"cm8se3tdo0010bb8l89aw94g2"},{"post_id":"cm8se3tds001cbb8lebdgb6f1","category_id":"cm8se3td50004bb8l2krgd4gg","_id":"cm8se3tdw001kbb8lfi0fhens"},{"post_id":"cm8se3tdu001fbb8l7zb7e27j","category_id":"cm8se3td50004bb8l2krgd4gg","_id":"cm8se3tdx001nbb8l1tfxdjyj"},{"post_id":"cm8se3te0001ybb8lafp4acdi","category_id":"cm8se3td50004bb8l2krgd4gg","_id":"cm8se3te20022bb8lezwbdkni"},{"post_id":"cm8se3te1001zbb8l6uhe2peo","category_id":"cm8se3td50004bb8l2krgd4gg","_id":"cm8se3te20023bb8lb1n4dg1p"},{"post_id":"cm8se3tdh000jbb8l46lefoiu","category_id":"cm8se3td50004bb8l2krgd4gg","_id":"cm8se6tdd0028bb8l0rqg2md3"}],"PostTag":[{"post_id":"cm8se3td00001bb8l3h2984qz","tag_id":"cm8se3td60005bb8l1tg4ab6x","_id":"cm8se3tde000dbb8l9gnd0gkm"},{"post_id":"cm8se3tdf000ebb8lagkb4iih","tag_id":"cm8se3td60005bb8l1tg4ab6x","_id":"cm8se3tdh000ibb8l46jy3gb3"},{"post_id":"cm8se3td70007bb8l0lrd3fem","tag_id":"cm8se3tdd000cbb8l9y0d4kpf","_id":"cm8se3tdj000lbb8l192l71yf"},{"post_id":"cm8se3tdb0009bb8lh3zr5mcy","tag_id":"cm8se3tdh000hbb8lbx08huj8","_id":"cm8se3tdk000rbb8l0vtb31wd"},{"post_id":"cm8se3tdk000pbb8l4mx8gqx4","tag_id":"cm8se3tdd000cbb8l9y0d4kpf","_id":"cm8se3tdl000ubb8l86g81dgt"},{"post_id":"cm8se3tdc000abb8lalv5hcty","tag_id":"cm8se3tdj000obb8l5s8l4hj5","_id":"cm8se3tdn000ybb8lefbo7jmn"},{"post_id":"cm8se3tdk000sbb8ld6px90cg","tag_id":"cm8se3tdd000cbb8l9y0d4kpf","_id":"cm8se3tdo0011bb8lczm8f9zd"},{"post_id":"cm8se3tdm000wbb8lgemjalkb","tag_id":"cm8se3tdd000cbb8l9y0d4kpf","_id":"cm8se3tdp0014bb8ldq135ngn"},{"post_id":"cm8se3tdn000zbb8l71ih55b3","tag_id":"cm8se3tdd000cbb8l9y0d4kpf","_id":"cm8se3tdq0016bb8l8w0k7xob"},{"post_id":"cm8se3tdo0012bb8l5kpz2l8k","tag_id":"cm8se3tdd000cbb8l9y0d4kpf","_id":"cm8se3tds0019bb8la788c8jt"},{"post_id":"cm8se3tdq0015bb8lesl54d9u","tag_id":"cm8se3tdd000cbb8l9y0d4kpf","_id":"cm8se3tds001bbb8lh4dlayne"},{"post_id":"cm8se3tdg000fbb8lg6s37aki","tag_id":"cm8se3tdl000vbb8l8psj2i0s","_id":"cm8se3tdt001ebb8lenhb7cp7"},{"post_id":"cm8se3tdg000fbb8lg6s37aki","tag_id":"cm8se3tdp0013bb8l5xydfrmh","_id":"cm8se3tdu001gbb8lf6h13aw5"},{"post_id":"cm8se3tdr0017bb8l86nxcggj","tag_id":"cm8se3tdd000cbb8l9y0d4kpf","_id":"cm8se3tdv001ibb8lcrg86444"},{"post_id":"cm8se3tdj000mbb8le3mubqxt","tag_id":"cm8se3tdr0018bb8l1a23bnz0","_id":"cm8se3tdw001lbb8l4i6l4wez"},{"post_id":"cm8se3tds001cbb8lebdgb6f1","tag_id":"cm8se3td60005bb8l1tg4ab6x","_id":"cm8se3tdx001obb8l6lud4y9c"},{"post_id":"cm8se3tdu001fbb8l7zb7e27j","tag_id":"cm8se3td60005bb8l1tg4ab6x","_id":"cm8se3tdy001qbb8l8c2yh303"},{"post_id":"cm8se3tds001abb8lanug5nsc","tag_id":"cm8se3tdt001dbb8la6sm87sj","_id":"cm8se3tdy001sbb8l314e6m13"},{"post_id":"cm8se3tdv001jbb8l5vgj5h4c","tag_id":"cm8se3td60005bb8l1tg4ab6x","_id":"cm8se3tdz001ubb8l9mjjckfg"},{"post_id":"cm8se3tdz001vbb8l5nn4gmtq","tag_id":"cm8se3te0001xbb8lbwc3bjo9","_id":"cm8se3te20021bb8law4b9zt7"},{"post_id":"cm8se3te0001ybb8lafp4acdi","tag_id":"cm8se3te10020bb8lckoqcfxr","_id":"cm8se3te30025bb8l0orlfl4a"},{"post_id":"cm8se3te1001zbb8l6uhe2peo","tag_id":"cm8se3te10020bb8lckoqcfxr","_id":"cm8se3te30026bb8l8ui1evbc"},{"post_id":"cm8se3tdh000jbb8l46lefoiu","tag_id":"cm8se3td60005bb8l1tg4ab6x","_id":"cm8se6tdc0027bb8l9pu2ekhp"}],"Tag":[{"name":"Linux","_id":"cm8se3td60005bb8l1tg4ab6x"},{"name":"MySQL","_id":"cm8se3tdd000cbb8l9y0d4kpf"},{"name":"MacOS","_id":"cm8se3tdh000hbb8lbx08huj8"},{"name":"Redis7","_id":"cm8se3tdj000obb8l5s8l4hj5"},{"name":"SpringBoot","_id":"cm8se3tdl000vbb8l8psj2i0s"},{"name":"东方通","_id":"cm8se3tdp0013bb8l5xydfrmh"},{"name":"Oracle","_id":"cm8se3tdr0018bb8l1a23bnz0"},{"name":"LLM","_id":"cm8se3tdt001dbb8la6sm87sj"},{"name":"IOS","_id":"cm8se3te0001xbb8lbwc3bjo9"},{"name":"达梦数据库","_id":"cm8se3te10020bb8lckoqcfxr"}]}}